(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 6.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[   1292976,      35143]
NotebookOptionsPosition[   1229394,      33110]
NotebookOutlinePosition[   1229971,      33135]
CellTagsIndexPosition[   1229882,      33130]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Risch-Bronstein Algorithm", "Title",
 CellChangeTimes->{{3.383366221342*^9, 3.38336623312325*^9}, 
   3.384645702826625*^9, {3.395192830944612*^9, 3.395192835967496*^9}}],

Cell["Sam Blake, 2007", "Subsubtitle",
 CellChangeTimes->{{3.383366265092*^9, 3.383366267513875*^9}, 
   3.384645702826625*^9, {3.409892574070085*^9, 3.409892578425253*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "Risch"}]], "Input",
 CellChangeTimes->{{3.410333246998753*^9, 3.410333248200531*^9}, {
  3.41034157530688*^9, 3.410341594702174*^9}}],

Cell[BoxData[
 StyleBox["\<\"Risch[f,x] uses the Risch/Bronstein algorithm to find the \
indefinite integral of f wrt x. At present we require f to be a rational or \
transcendental function.\"\>", "MSG"]], "Print", "PrintUsage",
 CellChangeTimes->{3.414052589145389*^9},
 CellTags->"Info3414092188-3301112"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Risch", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Exp", "[", "x", "]"}], " ", 
      RowBox[{"Sinh", "[", "x", "]"}], 
      SuperscriptBox[
       RowBox[{"Cosh", "[", "x", "]"}], "4"], 
      SuperscriptBox[
       RowBox[{"Sin", "[", "x", "]"}], "2"], 
      SuperscriptBox[
       RowBox[{"Cos", "[", "x", "]"}], "3"]}], ",", "x"}], "]"}], "//", 
   "Simplify"}], "//", "TraditionalForm"}]], "Input",
 CellChangeTimes->{{3.4098908821149893`*^9, 3.409890981171177*^9}, {
   3.40989107445575*^9, 3.409891117305758*^9}, {3.4098911705099277`*^9, 
   3.40989119812269*^9}, 3.409891252102991*^9, {3.409891290183988*^9, 
   3.4098913255823917`*^9}, {3.409891356031001*^9, 3.4098913796780453`*^9}, {
   3.409891437233611*^9, 3.409891456912388*^9}, {3.4098915540242643`*^9, 
   3.4098915682460833`*^9}, {3.409892496388865*^9, 3.409892499052368*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"2", "+", 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "4"}], " ", "x"}]], "1088"], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "2"}], " ", "x"}]]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"2", " ", "x"}]]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"4", " ", "x"}]]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"6", " ", "x"}]]}]}], ")"}], " ", 
    RowBox[{"cos", "(", "x", ")"}]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"2", "-", 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "4"}], " ", "x"}]], "3200"], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "2"}], " ", "x"}]]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"2", " ", "x"}]]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"4", " ", "x"}]]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"6", " ", "x"}]]}]}], ")"}], " ", 
    RowBox[{"cos", "(", 
     RowBox[{"3", " ", "x"}], ")"}]}], "-", 
   FractionBox[
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "4"}], " ", "x"}]], " ", 
     RowBox[{"cos", "(", 
      RowBox[{"5", " ", "x"}], ")"}]}], "5248"], "+", 
   RowBox[{"2", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "2"}], " ", "x"}]], " ", 
    RowBox[{"cos", "(", 
     RowBox[{"5", " ", "x"}], ")"}]}], "+", 
   RowBox[{"2", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"2", " ", "x"}]], " ", 
    RowBox[{"cos", "(", 
     RowBox[{"5", " ", "x"}], ")"}]}], "+", 
   RowBox[{"2", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"4", " ", "x"}]], " ", 
    RowBox[{"cos", "(", 
     RowBox[{"5", " ", "x"}], ")"}]}], "+", 
   RowBox[{"2", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"6", " ", "x"}]], " ", 
    RowBox[{"cos", "(", 
     RowBox[{"5", " ", "x"}], ")"}]}], "+", 
   RowBox[{"2", " ", 
    RowBox[{"cos", "(", 
     RowBox[{"5", " ", "x"}], ")"}]}], "-", 
   FractionBox[
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "4"}], " ", "x"}]], " ", 
     RowBox[{"sin", "(", "x", ")"}]}], "4352"], "+", 
   FractionBox[
    RowBox[{"3", " ", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "4"}], " ", "x"}]], " ", 
     RowBox[{"sin", "(", 
      RowBox[{"3", " ", "x"}], ")"}]}], "12800"], "+", 
   FractionBox[
    RowBox[{"5", " ", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "4"}], " ", "x"}]], " ", 
     RowBox[{"sin", "(", 
      RowBox[{"5", " ", "x"}], ")"}]}], "20992"]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{{3.409890889539261*^9, 3.4098909819548187`*^9}, {
   3.409891074787253*^9, 3.409891118749173*^9}, {3.40989116560539*^9, 
   3.409891200120522*^9}, 3.409891254605935*^9, 3.4098912941572227`*^9, 
   3.409891328910501*^9, {3.409891358951647*^9, 3.4098913810844517`*^9}, {
   3.409891438681198*^9, 3.4098914577214212`*^9}, {3.409891555085566*^9, 
   3.409891568981019*^9}, 3.4098924998625793`*^9, 3.409897467275351*^9, 
   3.4099046849961433`*^9, 3.409906849862365*^9, 3.409909279638649*^9, {
   3.410223789510563*^9, 3.4102237921657*^9}, 3.410332962475238*^9, 
   3.410337694044796*^9, 3.413022368790441*^9, 3.414052824752556*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    RowBox[{"Log", "[", 
     RowBox[{"x", "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Exp", "[", "x", "]"}], "-", "1"}], ")"}]}], "]"}], ",", 
    "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"this", " ", "is", " ", "a", " ", "bug"}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"should", " ", "be", " ", "non", " ", "elementary"}], "..."}], 
     " ", "Tracked", " ", "bug", " ", "down", " ", 
     RowBox[{"to", ":", " ", 
      RowBox[{"Risch", "[", 
       RowBox[{
        RowBox[{"x", "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Exp", "[", "x", "]"}], "-", "1"}], ")"}]}], ",", " ", 
        "x"}], "]"}]}]}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.3955786876486607`*^9, 3.395578692414494*^9}, {
  3.3992856060345182`*^9, 3.3992856290959187`*^9}, {3.399285860705511*^9, 
  3.399285867064117*^9}, {3.410386691302829*^9, 3.410386703742918*^9}, {
  3.410394818562173*^9, 3.410394832433117*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PureLogPart", "::", "\<\"warning\"\>"}], ":", 
  " ", "\<\"Integral not elementary -- roots of resultant polynomial are non \
constant.\"\>"}]], "Message", "MSG",
 CellChangeTimes->{
  3.410397193249947*^9, {3.4103973543246593`*^9, 3.410397358402402*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RischLogarithmicPolynomial", "::", "\<\"warning\"\>"}], ":", 
  " ", "\<\"Integral not elementary -- non-elementary recursive integration \
or introduction of new logarithms.\"\>"}]], "Message", "MSG",
 CellChangeTimes->{
  3.410397193249947*^9, {3.4103973543246593`*^9, 3.410397358423189*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"Risch", "[", 
   RowBox[{
    RowBox[{"Log", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["\[ExponentialE]", "x"]}], ")"}], " ", "x"}], "]"}], 
    ",", "x"}], "]"}],
  HoldForm]], "Output",
 CellChangeTimes->{{3.399287265652985*^9, 3.399287274542365*^9}, {
   3.399287423490172*^9, 3.3992874579001427`*^9}, 3.399287496521948*^9, 
   3.399381923455842*^9, 3.40193748394911*^9, 3.4040315786565027`*^9, {
   3.408009955522491*^9, 3.4080099569550667`*^9}, {3.4090205716751738`*^9, 
   3.409020573922344*^9}, 3.410081819144752*^9, {3.410345149840116*^9, 
   3.410345151660246*^9}, {3.410381981536771*^9, 3.410381994778922*^9}, 
   3.410382049740901*^9, 3.4103965465780973`*^9, 3.410396773202984*^9, 
   3.410396829126803*^9, 3.410396878524832*^9, {3.410397161262504*^9, 
   3.410397163045573*^9}, 3.410397193270088*^9, {3.4103973543566437`*^9, 
   3.41039735843433*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Risch", "[", 
  RowBox[{
   FractionBox["x", 
    RowBox[{
     RowBox[{"Exp", "[", "x", "]"}], "-", "1"}]], ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.410386586320889*^9, 3.4103865961020927`*^9}, {
  3.410386712758974*^9, 3.410386713542062*^9}, {3.410393139385689*^9, 
  3.410393142246604*^9}, {3.41039321128846*^9, 3.4103932156440783`*^9}, {
  3.410395923057362*^9, 3.410395926368334*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PureLogPart", "::", "\<\"warning\"\>"}], ":", 
  " ", "\<\"Integral not elementary -- roots of resultant polynomial are non \
constant.\"\>"}]], "Message", "MSG",
 CellChangeTimes->{
  3.4103959273130903`*^9, 3.410396293053568*^9, {3.410396526853385*^9, 
   3.4103965441602793`*^9}, 3.41039682388974*^9, 3.410396879117117*^9, 
   3.410397194215843*^9, {3.410397354923764*^9, 3.410397358809742*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"Risch", "[", 
   RowBox[{
    FractionBox["x", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SuperscriptBox["\[ExponentialE]", "x"]}]], ",", "x"}], "]"}],
  HoldForm]], "Output",
 CellChangeTimes->{
  3.410386596540987*^9, 3.4103867227200613`*^9, 3.410392492573327*^9, 
   3.41039285648146*^9, 3.4103931447256203`*^9, 3.410393216924244*^9, 
   3.410395927320866*^9, 3.4103962930741253`*^9, {3.410396526939761*^9, 
   3.410396544185976*^9}, 3.4103968239205637`*^9, 3.410396879137638*^9, 
   3.4103971942342157`*^9, {3.4103973549445267`*^9, 3.410397358830493*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "this", " ", "will", " ", "clean", " ", "up", " ", "a", " ", "lot", " ", 
    "of", " ", "code"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Thread", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "b", ",", "c"}], "}"}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.410518974000648*^9, 3.4105189811411333`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    FractionBox[
     SuperscriptBox["x", "2"], 
     RowBox[{
      SuperscriptBox["x", "4"], "+", 
      SuperscriptBox["x", "2"], "+", "1"}]], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"should", " ", "factor", " ", 
    RowBox[{
     RowBox[{"biquadratic", "!!"}], "!"}]}], "  ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.412420260418393*^9, 3.412420292012011*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"RootSum", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"1", "+", 
      SuperscriptBox["#1", "2"], "+", 
      SuperscriptBox["#1", "4"]}], "&"}], ",", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"Log", "[", 
        RowBox[{"x", "-", "#1"}], "]"}], " ", "#1"}], 
      RowBox[{"1", "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["#1", "2"]}]}]], "&"}]}], "]"}]}]], "Output",
 CellChangeTimes->{{3.412420276088923*^9, 3.4124202799600697`*^9}, 
   3.413022355453823*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    RowBox[{"Log", "[", 
     RowBox[{
      SuperscriptBox["x", "4"], "+", "x", "+", "1"}], "]"}], ",", "x"}], 
   "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{
   "where", " ", "are", " ", "these", " ", "errors", " ", "coming", " ", 
    "from", "??"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.413536940836051*^9, 3.413536946039281*^9}, {
  3.413537011828464*^9, 3.4135370186080008`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "4"}], " ", "x"}], "+", 
  RowBox[{"x", " ", 
   RowBox[{"Log", "[", 
    RowBox[{"1", "+", "x", "+", 
     SuperscriptBox["x", "4"]}], "]"}]}], "+", 
  RowBox[{"RootSum", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"1", "+", "#1", "+", 
      SuperscriptBox["#1", "4"]}], "&"}], ",", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"4", " ", 
        RowBox[{"Log", "[", 
         RowBox[{"x", "-", "#1"}], "]"}]}], "+", 
       RowBox[{"3", " ", 
        RowBox[{"Log", "[", 
         RowBox[{"x", "-", "#1"}], "]"}], " ", "#1"}]}], 
      RowBox[{"1", "+", 
       RowBox[{"4", " ", 
        SuperscriptBox["#1", "3"]}]}]], "&"}]}], "]"}]}]], "Output",
 CellChangeTimes->{{3.413536952086446*^9, 3.413536960607252*^9}, 
   3.414052877411977*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"1536", "+", "718", 
  RowBox[{"(*", " ", 
   RowBox[{"lines", " ", "of", " ", "Risch", " ", "code"}], " ", 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.4142647462781267`*^9, 3.4142647625165977`*^9}, {
  3.41426524815923*^9, 3.414265252884925*^9}}],

Cell[BoxData["2254"], "Output",
 CellChangeTimes->{3.414264762883542*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Top Level Call to Risch", "Section",
 CellChangeTimes->{{3.39244303946*^9, 3.3924430484128733`*^9}, {
  3.397447152550468*^9, 3.397447156641838*^9}}],

Cell["Eventually I could include a timing using SessionTime[]", "Text",
 CellChangeTimes->{{3.410159721594202*^9, 3.4101597342874203`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RischTrace", "[", 
   RowBox[{"msg_", ",", "val_", ",", "\"\<In\>\""}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{"rischDebug", ",", 
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Enter \>\"", ",", 
      RowBox[{"ToString", "[", "msg", "]"}], ",", "\"\<: \>\"", ",", 
      RowBox[{"comma", "[", "val", "]"}]}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.404954334510817*^9, 3.404954398635262*^9}, {
  3.404954478662711*^9, 3.40495456342762*^9}, {3.404954616727004*^9, 
  3.4049546253394003`*^9}, {3.404954939012075*^9, 3.404954985578865*^9}, {
  3.404955038700321*^9, 3.404955053915966*^9}, {3.404955092604653*^9, 
  3.4049551073559027`*^9}, {3.404955148820601*^9, 3.4049551664126883`*^9}, {
  3.404955268302042*^9, 3.404955352445382*^9}, {3.404955783793247*^9, 
  3.404955859568469*^9}, {3.404956302401711*^9, 3.404956305671026*^9}, {
  3.404956421628325*^9, 3.404956429291712*^9}, {3.4049568633572617`*^9, 
  3.404956867724873*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RischTrace", "[", 
   RowBox[{"msg_", ",", "val_", ",", "\"\<Out\>\""}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{"rischDebug", ",", 
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Exit \>\"", ",", 
      RowBox[{"ToString", "[", "msg", "]"}], ",", "\"\<: \>\"", ",", 
      RowBox[{"comma", "[", "val", "]"}]}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.404954334510817*^9, 3.404954398635262*^9}, {
  3.404954478662711*^9, 3.40495456342762*^9}, {3.404954616727004*^9, 
  3.4049546253394003`*^9}, {3.404954939012075*^9, 3.404954985578865*^9}, {
  3.404955038700321*^9, 3.404955053915966*^9}, {3.404955092604653*^9, 
  3.4049551073559027`*^9}, {3.404955148820601*^9, 3.4049551664126883`*^9}, {
  3.404955268302042*^9, 3.404955352445382*^9}, {3.404955783793247*^9, 
  3.404955859568469*^9}, {3.404955892446295*^9, 3.404955902239863*^9}, {
  3.404956308671569*^9, 3.404956311358971*^9}, {3.404956432836175*^9, 
  3.4049564375317383`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"comma", "[", "lst_List", "]"}], ":=", 
  RowBox[{"Row", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"First", "[", "lst", "]"}], ",", 
      RowBox[{"Thread", "[", 
       RowBox[{"{", 
        RowBox[{"\"\<, \>\"", ",", 
         RowBox[{
          RowBox[{"Rest", "[", "lst", "]"}], "//", "Flatten"}]}], "}"}], 
       "]"}]}], "}"}], "//", "Flatten"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4049562008842793`*^9, 3.404956293150969*^9}, {
  3.405672372003627*^9, 3.405672374192729*^9}, {3.40755431683148*^9, 
  3.407554326174635*^9}, {3.408850862187269*^9, 3.40885086573097*^9}, {
  3.40885098033113*^9, 3.408850984751506*^9}, {3.408851137481741*^9, 
  3.4088511380852327`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"comma", "[", "lst_", "]"}], ":=", "lst"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.404956314314753*^9, 3.4049563213257303`*^9}}],

Cell[CellGroupData[{

Cell["Top level Risch", "Subsection",
 CellChangeTimes->{{3.392445203772128*^9, 3.3924452232301073`*^9}, 
   3.404718143119299*^9, {3.4088541646668463`*^9, 3.408854165226698*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Risch", "::", "usage"}], "=", 
   "\"\<Risch[f,x] uses the Risch/Bronstein algorithm to find the indefinite \
\\\nintegral of f wrt x. At present we require f to be a rational or \
transcendental function.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.40818085554653*^9, 3.408180952939336*^9}, {
  3.408180992417832*^9, 3.408180999673499*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{"0", ",", "x_"}], "]"}], ":=", "0"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{"expr_", ",", "x_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"expr", " ", "x"}], "/;", 
   RowBox[{"FreeQ", "[", 
    RowBox[{"expr", ",", "x"}], "]"}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.404718463371993*^9, 3.404718527082994*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RischParams", "[", 
   RowBox[{"expr_", ",", "x_"}], "]"}], ":=", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"#", "/:", 
       RowBox[{"Sign", "[", "#", "]"}], "=", "1"}], ")"}], "&"}], ",", 
    RowBox[{"DeleteCases", "[", 
     RowBox[{
      RowBox[{"PureVariables", "[", "expr", "]"}], ",", "x"}], "]"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4047050880472*^9, 3.404705186514577*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{"f_", ",", "x_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "integrand", ",", "res", ",", "X", ",", "internal", ",", "theta", ",", 
      "tower", ",", "Dtower", ",", "solution", ",", "result"}], "}"}], ",", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"(*", " ", 
     RowBox[{
     "External", " ", "call", " ", "to", " ", "the", " ", "Risch", " ", 
      "integration", " ", "algorithm"}], " ", "*)"}], "\[IndentingNewLine]", 
    "\t", 
    RowBox[{
     RowBox[{"RischTrace", "[", 
      RowBox[{"Risch", ",", 
       RowBox[{"{", 
        RowBox[{"f", ",", "x"}], "}"}], ",", "\"\<In\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "Try", " ", "lookup", " ", "for", " ", "some", " ", "integrals", " ", 
        "which", " ", "we", " ", 
        RowBox[{"don", "'"}], "t", " ", "handle", " ", "too", " ", "well"}], 
       ",", "\[IndentingNewLine]", "\t", 
       RowBox[{
       "specifically", " ", "trig", " ", "integrals", " ", "and", " ", "some",
         " ", "integrals", " ", "with", " ", "symbolic", " ", 
        "parameters"}]}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"res", "=", 
      RowBox[{"RischTable", "[", 
       RowBox[{"f", ",", "x"}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"FreeQ", "[", 
        RowBox[{"res", ",", "RischTable"}], "]"}], ",", 
       RowBox[{"Return", "[", "res", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "Convert", " ", "the", " ", "input", " ", "to", " ", "internal", " ", 
        "form"}], ",", " ", 
       RowBox[{
        RowBox[{"from", " ", "here", " ", "on", " ", "Log"}], " ", "=", 
        RowBox[{">", " ", "rischLog"}]}]}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"integrand", ",", "X"}], "}"}], "=", 
      RowBox[{"InputConvert", "[", 
       RowBox[{"f", ",", "x"}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "all", " ", "parameters", " ", "in", " ", "the", " ", "integrand", " ", 
       "are", " ", "assumed", " ", "to", " ", "be", " ", "positive"}], " ", 
      "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"RischParams", "[", 
      RowBox[{"integrand", ",", "X"}], "]"}], ";", "\t", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "determine", " ", "the", " ", "structure", " ", "of", " ", 
       "integrand"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"internal", ",", "theta", ",", "tower", ",", "Dtower", ",", 
        RowBox[{"{", "}"}]}], "}"}], "=", 
      RowBox[{"RischStructure", "[", 
       RowBox[{"integrand", ",", "X"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"call", " ", "internal", " ", "integration", " ", "routine"}], 
      " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"solution", "=", 
      RowBox[{"RischInternal", "[", 
       RowBox[{"internal", ",", "theta", ",", "tower", ",", "Dtower"}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"is", " ", "soluton", " ", 
       RowBox[{"elementary", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"SameQ", "[", 
        RowBox[{"solution", ",", "$Failed"}], "]"}], ",", 
       RowBox[{"Return", "[", " ", 
        RowBox[{"HoldForm", "[", 
         RowBox[{"Risch", "[", 
          RowBox[{"f", ",", "x"}], "]"}], "]"}], " ", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"convert", " ", "to", " ", "external", " ", "form"}], " ", 
      "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"result", "=", 
      RowBox[{"OutputConvert", "[", 
       RowBox[{"f", ",", "solution", ",", "theta", ",", "tower", ",", "x"}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Clear", " ", "assumptions", " ", "on", " ", "parameters"}], 
      " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"Clear", "/@", 
      RowBox[{"PureVariables", "[", "integrand", "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"RischTrace", "[", 
      RowBox[{"Risch", ",", "result", ",", "\"\<Out\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", "\t", "result"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.3924428277455697`*^9, 3.392442845911691*^9}, {
   3.392442885198182*^9, 3.392442963901352*^9}, {3.3924430717764688`*^9, 
   3.3924430851256638`*^9}, {3.3924431307412558`*^9, 
   3.3924431882239122`*^9}, {3.39244326453364*^9, 3.3924433626347027`*^9}, {
   3.392443417884147*^9, 3.3924434441018467`*^9}, {3.3924435277521296`*^9, 
   3.392443555251672*^9}, {3.392443618692896*^9, 3.392443730083067*^9}, {
   3.3924438021466894`*^9, 3.392443908449546*^9}, {3.39244395652868*^9, 
   3.392443989345869*^9}, {3.392444022323288*^9, 3.392444255308304*^9}, {
   3.3924443123503265`*^9, 3.3924444298192387`*^9}, {3.3924444827253137`*^9, 
   3.3924445918622446`*^9}, {3.3924446610517344`*^9, 3.392444680149195*^9}, {
   3.392444751732126*^9, 3.3924447937425346`*^9}, {3.392444860558611*^9, 
   3.392445004305309*^9}, {3.392445082157254*^9, 3.392445091831165*^9}, {
   3.39244517703368*^9, 3.392445179857741*^9}, {3.392445632748966*^9, 
   3.392445662762123*^9}, {3.3926754397476254`*^9, 3.3926754521538754`*^9}, {
   3.3927044592609997`*^9, 3.3927044931984997`*^9}, {3.392761683731125*^9, 
   3.3927616849655*^9}, {3.392762368668625*^9, 3.392762380449875*^9}, {
   3.392762444043625*^9, 3.39276244962175*^9}, {3.392762482793625*^9, 
   3.392762499606125*^9}, {3.392762585387375*^9, 3.392762611137375*^9}, {
   3.392762767106125*^9, 3.392762770153*^9}, {3.39285907067025*^9, 
   3.392859132217125*^9}, {3.392859206014*^9, 3.392859311842125*^9}, {
   3.39286028992025*^9, 3.3928602907015*^9}, {3.392871967671625*^9, 
   3.39287199893725*^9}, {3.392872511452875*^9, 3.392872803890375*^9}, {
   3.392872938156*^9, 3.392872944984125*^9}, {3.392872976484125*^9, 
   3.392872984156*^9}, {3.392873025515375*^9, 3.392873079140375*^9}, {
   3.392873203390375*^9, 3.39287335624975*^9}, {3.392873395906*^9, 
   3.3928735812185*^9}, {3.392873619859125*^9, 3.392873666781*^9}, {
   3.392873747671625*^9, 3.392873765015375*^9}, 3.39287507456225*^9, {
   3.3928751212185*^9, 3.392875134781*^9}, {3.39293243065525*^9, 
   3.392932434045875*^9}, {3.393527477666625*^9, 3.39352751699475*^9}, {
   3.393537313979125*^9, 3.393537321666625*^9}, {3.394403714593*^9, 
   3.394403720264875*^9}, {3.3944037656555*^9, 3.394403765983625*^9}, {
   3.394404583218*^9, 3.39440460693675*^9}, {3.394405067889875*^9, 
   3.394405076983625*^9}, {3.394405160421125*^9, 3.394405165139875*^9}, {
   3.39440520537425*^9, 3.394405231264875*^9}, {3.395196859979143*^9, 
   3.395196862206759*^9}, {3.395196922154704*^9, 3.395196926266111*^9}, {
   3.3951973434954987`*^9, 3.395197346366934*^9}, {3.395197656206684*^9, 
   3.395197667869766*^9}, {3.395198691189383*^9, 3.3951986931454144`*^9}, {
   3.395301926493593*^9, 3.395301935842043*^9}, {3.3953085966009483`*^9, 
   3.3953085974081097`*^9}, {3.395308643233005*^9, 3.395308643448188*^9}, {
   3.3953113297332697`*^9, 3.3953113308281927`*^9}, {3.3953153340600023`*^9, 
   3.3953153345389223`*^9}, {3.3957403493108473`*^9, 3.395740376761773*^9}, {
   3.3961636554825487`*^9, 3.3961637005066023`*^9}, {3.3961637520825768`*^9, 
   3.396163754810412*^9}, {3.396163798579728*^9, 3.3961638018345947`*^9}, {
   3.396163836658722*^9, 3.396163855378874*^9}, {3.396163890883978*^9, 
   3.396164095629015*^9}, {3.3961641638687077`*^9, 3.396164227428755*^9}, {
   3.396164294874284*^9, 3.396164295474457*^9}, {3.396164348534754*^9, 
   3.396164349046867*^9}, {3.396164411149127*^9, 3.396164424509976*^9}, {
   3.396164591235528*^9, 3.3961646078753757`*^9}, {3.3961715429012003`*^9, 
   3.396171543436323*^9}, {3.396171721462735*^9, 3.396171743596567*^9}, {
   3.3964165242885447`*^9, 3.396416524613285*^9}, {3.398140943610545*^9, 
   3.398141251221307*^9}, {3.4045462071703587`*^9, 3.404546373539076*^9}, {
   3.404704665376717*^9, 3.404704729888184*^9}, {3.40470505704185*^9, 
   3.404705078700272*^9}, {3.4047051476543417`*^9, 3.404705160734342*^9}, {
   3.404705196856093*^9, 3.404705432032395*^9}, {3.404705489575068*^9, 
   3.4047056013974133`*^9}, {3.404711184654335*^9, 3.404711204691882*^9}, {
   3.404718530685388*^9, 3.4047185312679977`*^9}, {3.4047208923420267`*^9, 
   3.4047209037655897`*^9}, {3.404956454624818*^9, 3.4049565107273893`*^9}, {
   3.404984618388751*^9, 3.404984653775281*^9}, {3.40662251186982*^9, 
   3.4066225128020353`*^9}, {3.407965478889647*^9, 3.407965479585257*^9}, {
   3.409054688888362*^9, 3.409054693972818*^9}, {3.409822743028146*^9, 
   3.409822745291566*^9}, {3.409824208382228*^9, 3.409824239332293*^9}, {
   3.409824307164344*^9, 3.409824307268347*^9}, {3.409824414190275*^9, 
   3.40982441762006*^9}, {3.410333352504642*^9, 3.410333489688237*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Risch Internal", "Subsection",
 CellChangeTimes->{{3.4047056781227913`*^9, 3.404705680792132*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Options", "[", "RischInternal", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"\"\<RecursiveCall\>\"", "\[Rule]", "False"}], ",", 
    RowBox[{"\"\<ExtendThetas\>\"", "\[Rule]", "True"}]}], "}"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.404705774405954*^9, 3.404705841694784*^9}, {
   3.404711269612466*^9, 3.404711298911701*^9}, 3.407990349873066*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RischInternal", "[", 
   RowBox[{"0", ",", "intheta_", ",", "intower_", ",", "inDtower_", ",", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{"0", ",", "intheta", ",", "intower", ",", "inDtower"}], 
   "}"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.407990384605838*^9, 3.407990387395821*^9}, {
  3.408852331337645*^9, 3.408852342271084*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RischInternal", "[", 
   RowBox[{
   "internal_", ",", "intheta_", ",", "intower_", ",", "inDtower_", ",", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"recursive", ",", "extendtheta", ",", 
      RowBox[{"integrand", "=", "internal"}], ",", "theta", ",", "tower", ",",
       "Dtower", ",", "fp", ",", "fs", ",", "fn", ",", "rationalsoln", ",", 
      "simplePart", ",", "\[IndentingNewLine]", "reducedPart", ",", 
      "polyPart", ",", "logPart", ",", "polysoln", ",", "logsoln", ",", "rep",
       ",", "res"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Main", " ", "Algorithm"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"RischTrace", "[", 
      RowBox[{"RischInternal", ",", 
       RowBox[{"{", 
        RowBox[{"internal", ",", "intheta", ",", "intower", ",", "inDtower"}],
         "}"}], ",", "\"\<In\>\""}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"recursive", "=", 
      RowBox[{"OptionValue", "[", "\"\<RecursiveCall\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"extendtheta", "=", 
      RowBox[{"OptionValue", "[", "\"\<ExtendThetas\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"recursive", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"theta", ",", "tower", ",", "Dtower"}], "}"}], "=", 
        RowBox[{"UpdateExtensionField", "[", 
         RowBox[{
         "internal", ",", "intheta", ",", "intower", ",", "inDtower"}], 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"theta", ",", "tower", ",", "Dtower"}], "}"}], "=", 
        RowBox[{"{", 
         RowBox[{"intheta", ",", "intower", ",", "inDtower"}], "}"}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Canonical", " ", "representation"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"fp", ",", "fs", ",", "fn"}], "}"}], " ", "=", " ", 
      RowBox[{"CanonicalRepresentation", "[", 
       RowBox[{"integrand", ",", "theta", ",", "tower", ",", "Dtower"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"rational", " ", "part"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"rationalsoln", ",", "simplePart", ",", "reducedPart"}], "}"}],
       "=", 
      RowBox[{"HermiteReduction", "[", 
       RowBox[{"fn", ",", "theta", ",", "Dtower"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"polyPart", "=", 
      RowBox[{"Simplify", "[", 
       RowBox[{"fp", "+", "fs"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"logPart", "=", 
      RowBox[{"Together", "[", 
       RowBox[{"simplePart", "+", "reducedPart"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"polynomial", " ", "part"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"polysoln", "=", 
      RowBox[{"RischPolynomial", "[", 
       RowBox[{
       "polyPart", ",", "theta", ",", "tower", ",", "Dtower", ",", 
        "extendtheta"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"SameQ", "[", 
        RowBox[{"polysoln", ",", "$Failed"}], "]"}], ",", 
       RowBox[{"Return", "[", "$Failed", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"logarithmic", " ", "part"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"logPart", " ", "=!=", "0"}], ",", "\[IndentingNewLine]", 
       "\t\t", 
       RowBox[{"logsoln", "=", 
        RowBox[{"PureLogPart", "[", 
         RowBox[{
         "logPart", ",", "theta", ",", "tower", ",", "Dtower", ",", 
          "extendtheta"}], "]"}]}], "\[IndentingNewLine]", "\t\t", ",", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"logsoln", "=", "0"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"SameQ", "[", 
        RowBox[{"logsoln", ",", "$Failed"}], "]"}], ",", 
       RowBox[{"Return", "[", "$Failed", "]"}]}], " ", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{"rationalsoln", "+", "polysoln", "+", "logsoln"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"RischTrace", "[", 
      RowBox[{"RischInternal", ",", "res", ",", "\"\<Out\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"recursive", ",", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"rep", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "&"}], "/@", 
          RowBox[{"Thread", "[", 
           RowBox[{"{", 
            RowBox[{"intower", ",", "intheta"}], "}"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"res", "//.", "rep"}], ",", "intheta", ",", "intower", ",", 
          "inDtower"}], "}"}]}], ",", "\[IndentingNewLine]", "\t", "res"}], 
      "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4047056941454887`*^9, 3.404705706171857*^9}, {
   3.404705765696385*^9, 3.404705772961046*^9}, {3.404705846258643*^9, 
   3.404705919412065*^9}, {3.4047060911471443`*^9, 3.404706138553825*^9}, {
   3.404706171419118*^9, 3.404706179922843*^9}, {3.404706223672737*^9, 
   3.4047062644807863`*^9}, {3.4047112310289593`*^9, 3.404711440589143*^9}, {
   3.404711495626264*^9, 3.404711514126089*^9}, {3.4047115529617167`*^9, 
   3.404711579840515*^9}, {3.404711744003195*^9, 3.4047117490376263`*^9}, {
   3.4047119380401487`*^9, 3.404711962152152*^9}, {3.404712006486744*^9, 
   3.404712007054186*^9}, {3.404712124128415*^9, 3.4047121439691677`*^9}, {
   3.404712429289175*^9, 3.40471255268491*^9}, {3.4047126198842173`*^9, 
   3.4047126895803328`*^9}, {3.404712760931882*^9, 3.404712855918023*^9}, {
   3.4047129685244217`*^9, 3.40471303525443*^9}, {3.404713073598617*^9, 
   3.404713103973768*^9}, {3.404713209271196*^9, 3.404713227320826*^9}, {
   3.404720778786141*^9, 3.404720811880522*^9}, {3.4047208536933937`*^9, 
   3.404720876897176*^9}, {3.4047209888095903`*^9, 3.404721023761998*^9}, {
   3.4047210607705507`*^9, 3.404721073465273*^9}, {3.404956548974111*^9, 
   3.4049566089127693`*^9}, {3.405147491550952*^9, 3.4051474944596987`*^9}, {
   3.405147828019058*^9, 3.405147856371916*^9}, {3.407988880527652*^9, 
   3.4079888902071733`*^9}, {3.4079903464349213`*^9, 3.407990378346086*^9}, {
   3.4081533474811983`*^9, 3.408153351936702*^9}, {3.40885166141962*^9, 
   3.408851666498577*^9}, {3.4088533193086767`*^9, 3.408853319564952*^9}, {
   3.409201378732594*^9, 3.4092014152124367`*^9}, {3.4092014526546583`*^9, 
   3.4092014538451777`*^9}, {3.409201505105266*^9, 3.409201543825306*^9}, 
   3.409906319652473*^9, {3.4099064337161493`*^9, 3.4099064367778387`*^9}, {
   3.409906493586508*^9, 3.409906519988413*^9}, {3.409907434922544*^9, 
   3.409907435245723*^9}, {3.409907486946703*^9, 3.409907488578011*^9}, {
   3.409908175020441*^9, 3.409908175339861*^9}, {3.409908270906644*^9, 
   3.409908292639024*^9}, {3.4099084346977777`*^9, 3.409908435020447*^9}, {
   3.4100799764475193`*^9, 3.41007997702354*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RischInternal", "[", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"1", "+", 
     SuperscriptBox["x", "5"]}]], ",", 
   RowBox[{"{", "x", "}"}], ",", 
   RowBox[{"{", "x", "}"}], ",", 
   RowBox[{"{", "1", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.404720946987109*^9, 3.404720950609408*^9}, 
   3.407656206117536*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    FractionBox["1", "5"]}], " ", 
   SqrtBox[
    RowBox[{
     FractionBox["1", "2"], " ", 
     RowBox[{"(", 
      RowBox[{"5", "-", 
       SqrtBox["5"]}], ")"}]}]], " ", 
   RowBox[{"ArcTan", "[", 
    FractionBox[
     RowBox[{"1", "+", 
      SqrtBox["5"], "-", 
      RowBox[{"4", " ", "x"}]}], 
     SqrtBox[
      RowBox[{"10", "-", 
       RowBox[{"2", " ", 
        SqrtBox["5"]}]}]]], "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "5"], " ", 
   SqrtBox[
    RowBox[{
     FractionBox["1", "2"], " ", 
     RowBox[{"(", 
      RowBox[{"5", "+", 
       SqrtBox["5"]}], ")"}]}]], " ", 
   RowBox[{"ArcTan", "[", 
    FractionBox[
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SqrtBox["5"], "+", 
      RowBox[{"4", " ", "x"}]}], 
     SqrtBox[
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{"5", "+", 
         SqrtBox["5"]}], ")"}]}]]], "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "5"], " ", 
   RowBox[{"rischLog", "[", 
    RowBox[{"1", "+", "x"}], "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "20"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     SqrtBox["5"]}], ")"}], " ", 
   RowBox[{"rischLog", "[", 
    RowBox[{"1", "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SqrtBox["5"]}], ")"}], " ", "x"}], "+", 
     SuperscriptBox["x", "2"]}], "]"}]}], "-", 
  RowBox[{
   FractionBox["1", "20"], " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     SqrtBox["5"]}], ")"}], " ", 
   RowBox[{"rischLog", "[", 
    RowBox[{"1", "-", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SqrtBox["5"]}], ")"}], " ", "x"}], "+", 
     SuperscriptBox["x", "2"]}], "]"}]}]}]], "Output",
 CellChangeTimes->{
  3.4047209513120527`*^9, 3.404720993637394*^9, 3.4047210259848557`*^9, {
   3.4047210754988127`*^9, 3.4047210963380003`*^9}, {3.404721158340692*^9, 
   3.404721164276443*^9}, 3.404984597296254*^9, {3.407656193226739*^9, 
   3.4076562063891773`*^9}, 3.407988672848007*^9, 3.40815335670422*^9, 
   3.408854454627383*^9, 3.40912687094125*^9, 3.409822757043154*^9, 
   3.409906323132793*^9, 3.410334185334324*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Tests for classes of integrands", "Subsection",
 CellChangeTimes->{{3.3924453182467346`*^9, 3.392445347729128*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"TrigQ", "[", 
   RowBox[{"f_", ",", "x_"}], "]"}], ":=", 
  RowBox[{"!", 
   RowBox[{"FreeQ", "[", 
    RowBox[{"f", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
        "Sin", "|", "Cos", "|", "Tan", "|", "Sec", "|", "Csc", "|", "Cot"}], 
        ")"}], "[", "a_", "]"}], "/;", 
      RowBox[{"!", 
       RowBox[{"FreeQ", "[", 
        RowBox[{"a", ",", "x"}], "]"}]}]}]}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.3926758787305*^9, 3.392675880652375*^9}, 
   3.392757602435*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"HypQ", "[", 
   RowBox[{"f_", ",", "x_"}], "]"}], ":=", 
  RowBox[{"!", 
   RowBox[{"FreeQ", "[", 
    RowBox[{"f", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
        "Sinh", "|", "Cosh", "|", "Tanh", "|", "Sech", "|", "Csch", "|", 
         "Coth"}], ")"}], "[", "a_", "]"}], "/;", 
      RowBox[{"!", 
       RowBox[{"FreeQ", "[", 
        RowBox[{"a", ",", "x"}], "]"}]}]}]}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.39286137692025*^9, 3.39286139304525*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"LogExpQ", "[", 
   RowBox[{"f_", ",", "x_"}], "]"}], ":=", 
  RowBox[{"!", 
   RowBox[{"FreeQ", "[", 
    RowBox[{"f", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"rischLog", "|", "rischExp"}], ")"}], "[", "a_", "]"}], "/;", 
      RowBox[{"!", 
       RowBox[{"FreeQ", "[", 
        RowBox[{"a", ",", "x"}], "]"}]}]}]}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.392861405685875*^9, 3.392861431264*^9}, {
  3.395145320121636*^9, 3.395145320534544*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"AlgebraicQ", "[", 
   RowBox[{"fun_", ",", " ", "x_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Cases", "[", 
    RowBox[{"fun", ",", 
     RowBox[{
      SuperscriptBox["p_", "n_Rational"], "/;", 
      RowBox[{"!", 
       RowBox[{"FreeQ", "[", 
        RowBox[{"p", ",", "x"}], "]"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "Infinity"}], "}"}]}], "]"}], "=!=", 
   RowBox[{"{", "}"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.3927589959975*^9, 3.392759037638125*^9}, {
  3.39275922406*^9, 3.392759229388125*^9}, {3.39293360009275*^9, 
  3.3929336073115*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"rischSpecialQ", "[", 
   RowBox[{"fun_", ",", "x_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Cases", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"FreeQ", "[", 
          RowBox[{"fun", ",", "#"}], "]"}], "&"}], "/@", 
        RowBox[{"{", 
         RowBox[{
         "BesselJ", ",", "ExpIntegralEi", ",", "ExpIntegralE", ",", 
          "LogIntegral", ",", "PolyLog", ",", "FresnelC", ",", "FresnelS", 
          ",", "SinIntegral", ",", "CosIntegral", ",", "CoshIntegral", ",", 
          "SinhIntegral"}], "}"}]}], ",", "False"}], "]"}], "===", 
     RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", "\t", "False", ",", 
    "\[IndentingNewLine]", "\t", "True"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.39275998340375*^9, 3.392760092794375*^9}, {
  3.39276014784125*^9, 3.3927601483725*^9}, {3.392760223981875*^9, 
  3.39276022634125*^9}, {3.392760394856875*^9, 3.392760395200625*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AlgebraicQ", "[", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"Exp", "[", 
      RowBox[{"2", "x"}], "]"}], "+", 
     RowBox[{"Exp", "[", "x", "]"}], "-", "1"}], 
    RowBox[{
     RowBox[{"Exp", "[", "x", "]"}], "+", "1"}]], ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.39275924596625*^9, 3.392759250685*^9}}],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{3.409822765877853*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"IsIntegrandZero", "[", 
   RowBox[{"integrand_", ",", "x_"}], "]"}], ":=", "\[IndentingNewLine]", 
  "\t", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"integrand", " ", "===", " ", "0"}], " ", "||", " ", 
     RowBox[{"integrand", " ", "==", " ", "0"}]}], ",", "\[IndentingNewLine]",
     "\t\t", "True", ",", "\[IndentingNewLine]", "\t\t", "False", ",", 
    "\[IndentingNewLine]", "\t\t", "False"}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.392445355810749*^9, 3.3924454981554303`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"IsIntegrandConstant", "[", 
   RowBox[{"integrand_", ",", "x_"}], "]"}], ":=", "\[IndentingNewLine]", 
  "\t", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"FreeQ", "[", 
      RowBox[{
       RowBox[{"Cancel", "[", "integrand", "]"}], ",", "x"}], "]"}], "&&", 
     RowBox[{"integrand", "=!=", "0"}], "&&", 
     RowBox[{"integrand", "!=", "0"}]}], ",", "\[IndentingNewLine]", "\t\t", 
    "True", ",", "\[IndentingNewLine]", "\t\t", "False", ",", 
    "\[IndentingNewLine]", "\t\t", "False"}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.3924456865963955`*^9, 3.3924457902053776`*^9}, {
  3.3924458473775873`*^9, 3.3924458541973934`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Here", " ", "we", " ", "also", " ", "need", " ", "to", " ", "allow", " ",
      "for", " ", "polynomials", " ", "of", " ", "the", " ", "form", " ", 
     RowBox[{"x", "^", 
      RowBox[{"-", "3"}]}]}], " ", "+", " ", 
    RowBox[{
     RowBox[{"x", "^", 
      RowBox[{"-", "5"}]}], " ", 
     RowBox[{"etc", ".", " ", "and"}], " ", "for", " ", 
     "\[IndentingNewLine]", "\"\<polynomials\>\"", " ", "like", " ", 
     RowBox[{"x", "^", 
      RowBox[{"(", 
       RowBox[{"1", "/", "2"}], ")"}]}]}], " ", "-", " ", 
    RowBox[{"45", " ", 
     RowBox[{"x", "^", 
      RowBox[{"(", 
       RowBox[{"34", "/", "43"}], ")"}]}]}], " ", "+", " ", 
    RowBox[{
     RowBox[{"x", "^", "n"}], " ", 
     RowBox[{"etc", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"polyQ", "[", 
    RowBox[{"integrand_", ",", "x_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"test1", ",", " ", "test2", ",", " ", "listExpr"}], "}"}], ",", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "test", " ", "if", " ", "the", " ", "integrand", " ", "is", " ", "free",
        " ", "of", " ", "the", " ", "usual", " ", "elementary", " ", 
       "functions"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"test1", "=", 
       RowBox[{"!", 
        RowBox[{"FreeQ", "[", 
         RowBox[{"integrand", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
            "rischExp", "|", "rischLog", "|", "Sin", "|", "Cos", "|", "Tan", 
             "|", "Sec", "|", "Csc", "|", "Cot", "|", "\[IndentingNewLine]", 
             "\t\t", "Sinh", "|", "Cosh", "|", "Tanh", "|", "Csch", "|", 
             "Coth", "|", "Sech"}], ")"}], "[", 
           RowBox[{"p_", "?", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"FreeQ", "[", 
                RowBox[{"#", ",", "x"}], "]"}]}], "&"}], ")"}]}], "]"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", "\t", 
      RowBox[{"If", "[", 
       RowBox[{"test1", ",", 
        RowBox[{"Return", "[", "False", "]"}]}], " ", "]"}], ";", 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"(*", " ", 
       RowBox[{"we", " ", 
        RowBox[{"don", "'"}], "t", " ", "want", " ", 
        RowBox[{"1", "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"x", "^", "n"}], "+", "x"}], ")"}]}], " ", "to", " ", 
        "get", " ", "through"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Head", "[", 
          RowBox[{"Denominator", "[", 
           RowBox[{"Together", "[", "integrand", "]"}], "]"}], "]"}], "===", 
         "Plus"}], ",", 
        RowBox[{"Return", "[", "False", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"(*", " ", 
       RowBox[{
       "test", " ", "if", " ", "the", " ", "integrand", " ", "is", " ", 
        "free", " ", "of", " ", "the", " ", "\"\<Rischable\>\"", " ", 
        "special", " ", "functions"}], " ", "*)"}], "\[IndentingNewLine]", 
      "\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"rischSpecialQ", "[", 
         RowBox[{"integrand", ",", "x"}], "]"}], ",", 
        RowBox[{"Return", "[", "False", "]"}]}], " ", "]"}], ";", 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "test", " ", "if", " ", "the", " ", "integral", " ", "is", " ", 
         "computable", " ", "using", " ", "the", " ", "formulae", " ", 
         RowBox[{"Risch", "[", 
          RowBox[{
           RowBox[{"x", "^", "n"}], ",", " ", "x"}], "]"}]}], ":=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"x", "^", 
            RowBox[{"(", 
             RowBox[{"n", " ", "+", " ", "1"}], ")"}]}], "/", 
           RowBox[{"(", 
            RowBox[{"n", " ", "+", " ", "1"}], ")"}]}], " ", "or", 
          "\[IndentingNewLine]", "\t", "using", " ", 
          RowBox[{"Risch", "[", 
           RowBox[{
            RowBox[{"1", "/", "x"}], ",", " ", "x"}], "]"}]}], ":=", " ", 
         RowBox[{"rischLog", "[", "x", "]"}]}]}], " ", "*)"}], 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"listExpr", " ", "=", " ", 
       RowBox[{"Flatten", "[", 
        RowBox[{"{", 
         RowBox[{"integrand", "//.", 
          RowBox[{
           RowBox[{"a_", "+", "b_"}], ":>", 
           RowBox[{"{", 
            RowBox[{"a", ",", "b"}], "}"}]}]}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"PolynomialQ", "[", 
          RowBox[{"integrand", ",", "x"}], "]"}], "||", 
         RowBox[{"And", "@@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"MatchQ", "[", 
              RowBox[{"#", ",", 
               RowBox[{
                RowBox[{"a_.", "*", 
                 SuperscriptBox["x", "n_."]}], "/;", 
                RowBox[{"FreeQ", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"a", ",", "n"}], "}"}], ",", "x"}], "]"}]}]}], 
              "]"}], "&"}], "/@", 
            RowBox[{"Select", "[", 
             RowBox[{"listExpr", ",", 
              RowBox[{
               RowBox[{"!", 
                RowBox[{"FreeQ", "[", 
                 RowBox[{"#", ",", "x"}], "]"}]}], "&"}]}], "]"}]}], 
           ")"}]}]}], ",", "\[IndentingNewLine]", "\t\t", "True", ",", 
        "\[IndentingNewLine]", "\t\t", "False", ",", "\[IndentingNewLine]", 
        "\t\t", "False"}], "\[IndentingNewLine]", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.392445918630043*^9, 3.3924459254798927`*^9}, {
   3.392445974009675*^9, 3.392446027146082*^9}, {3.392504942467125*^9, 
   3.392504967342125*^9}, {3.3927548834975*^9, 3.3927549126225*^9}, {
   3.392754973638125*^9, 3.392755121950625*^9}, {3.3927552523725*^9, 
   3.392755346731875*^9}, {3.39275538071625*^9, 3.392755425825625*^9}, {
   3.3927555094975*^9, 3.39275554671625*^9}, {3.39275635784125*^9, 
   3.3927564003725*^9}, {3.392756713763125*^9, 3.39275696834125*^9}, {
   3.392756999888125*^9, 3.392757000325625*^9}, 3.392757046919375*^9, {
   3.392760407138125*^9, 3.39276041321625*^9}, {3.3928595718265*^9, 
   3.3928596273265*^9}, {3.392862562873125*^9, 3.392862563685625*^9}, {
   3.392862593716875*^9, 3.392862609045*^9}, {3.392867844248125*^9, 
   3.392867844904375*^9}, {3.3928679378575*^9, 3.392867950529375*^9}, {
   3.392869365545*^9, 3.392869386795*^9}, {3.392869987859125*^9, 
   3.3928700558435*^9}, {3.392870323031*^9, 3.3928704998435*^9}, {
   3.392870530265375*^9, 3.392870560077875*^9}, {3.39352753730725*^9, 
   3.393527538791625*^9}, {3.395299387283505*^9, 3.395299415562869*^9}, {
   3.3952997006069927`*^9, 3.395299767114916*^9}, {3.4019572491322203`*^9, 
   3.401957272779961*^9}, {3.410072737406699*^9, 3.410072775371627*^9}, {
   3.410072838669536*^9, 3.410072840196434*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"polyQ", "[", 
  RowBox[{
   RowBox[{
    SuperscriptBox["x", "n"], "+", "1"}], ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.41007250763763*^9, 3.4100725180815697`*^9}, {
  3.410072615843972*^9, 3.4100726159697523`*^9}, {3.410072750450047*^9, 
  3.410072750689761*^9}, {3.410072843996063*^9, 3.410072845065769*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.4100725184850807`*^9, {3.410072616064364*^9, 3.410072617180171*^9}, {
   3.410072748045209*^9, 3.410072764339142*^9}, 3.410072854702524*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"polyQ", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     FractionBox["1", "2"], 
     SuperscriptBox["x", "7"]}], "+", 
    RowBox[{"4", " ", 
     SuperscriptBox["x", 
      RowBox[{
       RowBox[{"-", "1"}], "/", "2"}]]}], "-", 
    FractionBox["15", "x"], "+", 
    RowBox[{"23", 
     SuperscriptBox["x", "645"]}]}], ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.39275680181*^9, 3.392756805825625*^9}, 
   3.410072849693406*^9}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.4100728549711437`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"polyQ", "[", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], " ", 
      SuperscriptBox["x", "5"]}], "-", 
     RowBox[{"4", " ", 
      SuperscriptBox["x", "4"]}], "-", 
     RowBox[{"6", " ", 
      SuperscriptBox["x", "3"]}], "+", 
     RowBox[{"3", " ", 
      SuperscriptBox["x", "2"]}], "-", 
     RowBox[{"4", " ", "x"}], "+", "9"}], 
    RowBox[{"4", " ", 
     SuperscriptBox["x", "2"]}]], ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.39275680181*^9, 3.392756805825625*^9}, {
   3.3953143577264338`*^9, 3.395314364486663*^9}, 3.410072850780851*^9}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.410072855220778*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"polyQ", "[", 
  RowBox[{
   RowBox[{
    SuperscriptBox["x", "2"], "+", "x", "+", "1"}], ",", "x"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.39275680181*^9, 3.392756805825625*^9}, {
   3.3927568746225*^9, 3.39275688081*^9}, {3.3928679113575*^9, 
   3.39286791501375*^9}, {3.392867955404375*^9, 3.39286795576375*^9}, 
   3.39287007843725*^9, {3.392870446796625*^9, 3.392870447281*^9}, 
   3.41007285162024*^9}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.410072857203993*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"polyQ", "[", 
  RowBox[{
   FractionBox["1", 
    RowBox[{
     SuperscriptBox["x", "n"], "+", "x"}]], ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.39275680181*^9, 3.392756805825625*^9}, {
   3.3927568746225*^9, 3.39275688081*^9}, {3.3928679113575*^9, 
   3.39286791501375*^9}, {3.392867955404375*^9, 3.39286795576375*^9}, 
   3.39287007843725*^9, {3.392870446796625*^9, 3.392870447281*^9}, {
   3.39529936449436*^9, 3.395299367965007*^9}, 3.410072853156303*^9}],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{3.410072857720566*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"IsIntegrandRational", "[", 
   RowBox[{"integrand_", ",", "x_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "singleFrac", "}"}], ",", "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"singleFrac", "=", 
      RowBox[{"Together", "[", "integrand", "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"IsIntegrandPolynomial", "[", 
         RowBox[{
          RowBox[{"Numerator", "[", "singleFrac", "]"}], ",", "x"}], "]"}], "&&",
         "\[IndentingNewLine]", "\t\t", 
        RowBox[{"IsIntegrandPolynomial", "[", 
         RowBox[{
          RowBox[{"Denominator", "[", "singleFrac", "]"}], ",", "x"}], "]"}], 
        "&&", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"!", 
         RowBox[{"FreeQ", "[", 
          RowBox[{
           RowBox[{"Denominator", "[", "singleFrac", "]"}], ",", "x"}], 
          "]"}]}], " ", "&&", " ", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"!", 
         RowBox[{"AlgebraicQ", "[", 
          RowBox[{"integrand", ",", "x"}], "]"}]}]}], ",", 
       "\[IndentingNewLine]", "\t\t\t", "True", ",", "\[IndentingNewLine]", 
       "\t\t\t", "False", ",", "\[IndentingNewLine]", "\t\t\t", "False"}], 
      "\[IndentingNewLine]", "\t", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.3924461151225853`*^9, 3.3924463035935936`*^9}, {
  3.392446439268685*^9, 3.392446513335187*^9}, {3.3924466014418783`*^9, 
  3.392446604616443*^9}, {3.39275909321625*^9, 3.392759112685*^9}, {
  3.39293376465525*^9, 3.39293380584275*^9}, {3.395300301052141*^9, 
  3.3953003046517*^9}, {3.3953003702053843`*^9, 3.3953003810624228`*^9}}],

Cell[BoxData[
 RowBox[{"IsIntegrandRational", "[", 
  RowBox[{
   FractionBox["1", 
    RowBox[{
     SuperscriptBox["x", "n"], "+", "x"}]], ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.395300418577873*^9, 3.3953004287080107`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"IsIntegrandAlgebraic", "[", 
   RowBox[{"integrand_", ",", "x_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Cases", "[", 
    RowBox[{"integrand", ",", 
     RowBox[{
      SuperscriptBox["p_", "n_Rational"], "/;", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"FreeQ", "[", 
         RowBox[{"p", ",", "x"}], "]"}]}], "&&", 
       RowBox[{"FreeQ", "[", 
        RowBox[{"n", ",", "x"}], "]"}], "&&", 
       RowBox[{
        RowBox[{"Exponent", "[", 
         RowBox[{"p", ",", "x"}], "]"}], "<", "3"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "Infinity"}], "}"}]}], "]"}], "=!=", 
   RowBox[{"{", "}"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.39250443610775*^9, 3.392504442810875*^9}, {
  3.392504548779625*^9, 3.39250457385775*^9}, {3.3926743725601254`*^9, 
  3.3926744070132504`*^9}, {3.3926744531851254`*^9, 3.3926745161695004`*^9}, {
  3.392858806685875*^9, 3.392858809373375*^9}, {3.39285888198275*^9, 
  3.392858882060875*^9}, {3.3952047177493143`*^9, 3.395204721301012*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"IsIntegrandSpecial", "[", 
   RowBox[{"integrand_", ",", "x_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
      "He", " ", "we", " ", "want", " ", "integrals", " ", "containing", " ", 
       "\"\<Rischable\>\"", " ", "special", " ", "functions", " ", "and", " ",
        "logarithms"}], ",", " ", "exponentials", ",", " ", 
      RowBox[{"but", " ", "NO", " ", "\[IndentingNewLine]", 
       RowBox[{"radicals", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Make", " ", "sure", " ", "there", " ", "are", " ", "no", " ", 
      RowBox[{"algebraic", "'"}], "s", " ", "present", " ", "in", " ", "the", 
      " ", "integrand"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"AlgebraicQ", "[", 
         RowBox[{"integrand", ",", "x"}], "]"}], "===", "True"}], ",", 
       RowBox[{"Return", "[", "False", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Check", " ", "that", " ", "at", " ", "least", " ", "one", " ", "of", 
       " ", "the", " ", "the", " ", "Rischable", " ", "special", " ", 
       "functions", " ", "are", " ", "present"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Test", " ", "if", " ", "any", " ", "of", " ", "the", " ", "Risch", " ",
        "usable", " ", "special", " ", "functions", " ", "are", " ", 
       "present", " ", "in", " ", "the", " ", "integrand"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"rischSpecialQ", "[", 
        RowBox[{"integrand", ",", "x"}], "]"}], ",", "\[IndentingNewLine]", 
       "\t", "False", ",", "\[IndentingNewLine]", "\t", "True", ",", 
       "\[IndentingNewLine]", "\t", "True"}], "\[IndentingNewLine]", 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.392758638825625*^9, 3.392758645435*^9}, {
   3.39275871156*^9, 3.3927587739975*^9}, {3.3927593064975*^9, 
   3.392759368981875*^9}, {3.39275939984125*^9, 3.392759400169375*^9}, {
   3.39275996809125*^9, 3.39275996940375*^9}, 3.392760025435*^9, {
   3.392760269669375*^9, 3.392760275356875*^9}, {3.3976218138915052`*^9, 
   3.397621814291494*^9}}],

Cell[BoxData[
 RowBox[{"IsIntegrandSpecial", "[", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"1", "-", 
     RowBox[{"BesselJ", "[", 
      RowBox[{"2", ",", "x"}], "]"}]}]], ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.39275937509125*^9, 3.392759384825625*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Integration of Polynomials", "Subsection",
 CellChangeTimes->{{3.392504620685875*^9, 3.392504623873375*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RischPolynomial", "[", 
   RowBox[{
   "polyPart_", ",", "intheta_", ",", "intower_", ",", "inDtower_", ",", 
    "extendtheta_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"theta", ",", "tower", ",", "Dtower", ",", "b", ",", "res"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Integration", " ", "of", " ", "transcendental", " ", "polynomials"}], 
     " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"RischTrace", "[", 
      RowBox[{"RischPolynomial", ",", "polyPart", ",", "\"\<In\>\""}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"SameQ", "[", 
        RowBox[{"polyPart", ",", "0"}], "]"}], ",", 
       RowBox[{"Return", "[", "0", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"theta", ",", "tower", ",", "Dtower"}], "}"}], "=", 
      RowBox[{"{", 
       RowBox[{"intheta", ",", "intower", ",", "inDtower"}], "}"}]}], 
     RowBox[{"(*", " ", 
      RowBox[{"UpdateExtensionField", "[", 
       RowBox[{"polyPart", ",", "intheta", ",", "intower", ",", "inDtower"}], 
       "]"}], "*)"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"SameQ", "[", 
        RowBox[{
         RowBox[{"Head", "[", 
          RowBox[{"Last", "[", "tower", "]"}], "]"}], ",", "rischLog"}], 
        "]"}], ",", "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"res", ",", "b"}], "}"}], "=", 
         RowBox[{"RischLogarithmicPolynomial", "[", 
          RowBox[{
          "polyPart", ",", "theta", ",", "tower", ",", "Dtower", ",", 
           "extendtheta"}], "]"}]}], ";", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", "b"}], ",", "\[IndentingNewLine]", "\t\t\t", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{"RischLogarithmicPolynomial", "::", "warning"}], "]"}], 
           ";", "\[IndentingNewLine]", "\t\t\t", 
           RowBox[{"res", "=", "$Failed"}]}]}], "\[IndentingNewLine]", "\t\t",
          "]"}]}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"SameQ", "[", 
        RowBox[{
         RowBox[{"Head", "[", 
          RowBox[{"Last", "[", "tower", "]"}], "]"}], ",", "rischExp"}], 
        "]"}], ",", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"res", "=", 
        RowBox[{"RischExponentialPolynomial", "[", 
         RowBox[{
         "polyPart", ",", "theta", ",", "tower", ",", "Dtower", ",", 
          "extendtheta"}], "]"}]}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"SameQ", "[", 
        RowBox[{
         RowBox[{"Length", "[", "theta", "]"}], ",", "1"}], "]"}], ",", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"res", "=", 
        RowBox[{"RischBasePolynomial", "[", 
         RowBox[{
          RowBox[{"polyPart", "//", "Together"}], ",", "theta", ",", "tower", 
          ",", "Dtower", ",", "extendtheta"}], "]"}]}], ",", 
       "\[IndentingNewLine]", "\t", "True", ",", "\[IndentingNewLine]", 
       "\t\t", 
       RowBox[{"res", "=", "$Failed"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"RischTrace", "[", 
      RowBox[{"RischPolynomial", ",", "res", ",", "\"\<Out\>\""}], "]"}], ";",
      "\[IndentingNewLine]", "res"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4047120103000298`*^9, 3.404712048491132*^9}, {
  3.404712086625444*^9, 3.404712233430492*^9}, {3.404712342422311*^9, 
  3.404712409311655*^9}, {3.404713371334778*^9, 3.4047133940876904`*^9}, {
  3.404956656795862*^9, 3.40495679186858*^9}, {3.405147897270566*^9, 
  3.405147945318088*^9}, {3.4051480096506777`*^9, 3.405148017574044*^9}, {
  3.4051480616382093`*^9, 3.4051480825747147`*^9}, {3.409055123827755*^9, 
  3.409055142139208*^9}, {3.409056779941802*^9, 3.409056780987554*^9}, {
  3.4091224757595167`*^9, 3.409122491818017*^9}, {3.409123335186335*^9, 
  3.4091233591935062`*^9}, {3.409124342581616*^9, 3.409124351084174*^9}, {
  3.410203644144821*^9, 3.4102037034692707`*^9}, {3.410203796776185*^9, 
  3.4102038059577427`*^9}, {3.410335954617783*^9, 3.4103359590486593`*^9}, {
  3.410341961560178*^9, 3.4103419639968643`*^9}, {3.410342475014628*^9, 
  3.4103424763304853`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RischBasePolynomial", "[", 
   RowBox[{
   "p_", ",", "theta_", ",", "tower_", ",", "Dtower_", ",", "extendtheta_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x", "=", 
       RowBox[{"First", "[", "theta", "]"}]}], ",", "n", ",", "d", ",", 
      "poly", ",", "rat", ",", "res"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"RischTrace", "[", 
      RowBox[{"RischBasePolynomial", ",", 
       RowBox[{"{", 
        RowBox[{
        "p", ",", "theta", ",", "tower", ",", "Dtower", ",", "extendtheta"}], 
        "}"}], ",", "\"\<In\>\""}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"n", ",", "d"}], "}"}], "=", 
      RowBox[{"PolynomialQuotientRemainder", "[", 
       RowBox[{
        RowBox[{"Numerator", "[", "p", "]"}], ",", 
        RowBox[{"Denominator", "[", "p", "]"}], ",", "x"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"poly", "=", 
      RowBox[{"rischpoly", "[", 
       RowBox[{"n", ",", "x"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"rat", "=", 
      RowBox[{"First", "[", "\[IndentingNewLine]", 
       RowBox[{"RischInternal", "[", 
        RowBox[{"d", ",", "theta", ",", "tower", ",", "Dtower", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<RecursiveCall\>\"", "\[Rule]", "True"}], ",", 
           RowBox[{"\"\<ExtendThetas\>\"", "\[Rule]", "extendtheta"}]}], 
          "}"}]}], "]"}], "\[IndentingNewLine]", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{"poly", "+", "rat"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"RischTrace", "[", 
      RowBox[{"RischBasePolynomial", ",", "res", ",", "\"\<Out\>\""}], "]"}], 
     ";", "\[IndentingNewLine]", "res"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4091233148669*^9, 3.4091234636019506`*^9}, {
  3.4091235152090473`*^9, 3.4091235591061068`*^9}, {3.409123589106183*^9, 
  3.409123717336092*^9}, {3.409123797506961*^9, 3.409123854585978*^9}, {
  3.40912416766142*^9, 3.409124176634295*^9}, {3.409124639106168*^9, 
  3.4091246440188503`*^9}, {3.409125005486354*^9, 3.409125007851467*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"rischpoly", "[", 
   RowBox[{"0", ",", "x_"}], "]"}], ":=", "0"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rischpoly", "[", 
   RowBox[{
    RowBox[{"a_:", "1"}], ",", "x_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"a", " ", "x"}], "/;", 
   RowBox[{"FreeQ", "[", 
    RowBox[{"a", ",", "x"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rischpoly", "[", 
   RowBox[{
    RowBox[{"a_.", " ", 
     RowBox[{"x_", "^", "n_."}]}], ",", "x_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"a", " ", 
    RowBox[{
     RowBox[{"x", "^", 
      RowBox[{"(", 
       RowBox[{"n", "+", "1"}], ")"}]}], "/", 
     RowBox[{"(", 
      RowBox[{"n", "+", "1"}], ")"}]}]}], "/;", 
   RowBox[{
    RowBox[{"n", "=!=", 
     RowBox[{"-", "1"}]}], "&&", 
    RowBox[{"FreeQ", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a", ",", "n"}], "}"}], ",", "x"}], 
     "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rischpoly", "[", 
   RowBox[{
    RowBox[{"a_", "+", "b_"}], ",", "x_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"rischpoly", "[", 
    RowBox[{"a", ",", "x"}], "]"}], "+", 
   RowBox[{"rischpoly", "[", 
    RowBox[{"b", ",", "x"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rischpoly", "[", 
   RowBox[{
    RowBox[{"a_.", "/", "x_"}], ",", "x_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"a", " ", 
    RowBox[{"rischLog", "[", "x", "]"}]}], "/;", 
   RowBox[{"FreeQ", "[", 
    RowBox[{"a", ",", "x"}], "]"}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4090551096465473`*^9, 3.409055178517264*^9}, {
   3.409056337093384*^9, 3.4090563704700937`*^9}, {3.409056444382337*^9, 
   3.409056458719054*^9}, 3.4090565168893833`*^9, {3.4090565488729277`*^9, 
   3.409056646215564*^9}, {3.409056676753639*^9, 3.409056691695483*^9}, {
   3.409123146155177*^9, 3.4091231721451902`*^9}, {3.40912347143003*^9, 
   3.409123489392868*^9}, {3.409123569060602*^9, 3.409123576389052*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rischpoly", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"5", " ", 
     SuperscriptBox["x", 
      RowBox[{"-", "9"}]]}], "-", 
    RowBox[{"65", " ", 
     SuperscriptBox["x", 
      RowBox[{"-", "4"}]]}]}], ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.3926742076851254`*^9, 3.3926742283726254`*^9}, {
   3.3926742676851254`*^9, 3.3926742678257504`*^9}, {3.4051481476905203`*^9, 
   3.4051481734877357`*^9}, {3.409056398119974*^9, 3.409056416908456*^9}, 
   3.409123497401013*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox["5", 
    RowBox[{"8", " ", 
     SuperscriptBox["x", "8"]}]]}], "+", 
  FractionBox["65", 
   RowBox[{"3", " ", 
    SuperscriptBox["x", "3"]}]]}]], "Output",
 CellChangeTimes->{
  3.396416686283661*^9, 3.404718213177189*^9, {3.405148142178623*^9, 
   3.405148174122575*^9}, 3.4079654087068853`*^9, {3.409056381873192*^9, 
   3.409056421306862*^9}, 3.409056465990744*^9, {3.409056507972621*^9, 
   3.409056523950253*^9}, 3.409056561008573*^9, {3.409056600205434*^9, 
   3.409056648668662*^9}, {3.409056679922822*^9, 3.4090567113447113`*^9}, 
   3.409122495451158*^9, 3.4091231740342817`*^9, 3.409123499299465*^9, 
   3.409123577846427*^9, 3.409126928013208*^9, 3.409822810992938*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rischpoly", "[", 
  RowBox[{
   RowBox[{"x", "+", "1"}], ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.3926742076851254`*^9, 3.3926742283726254`*^9}, {
   3.3926742676851254`*^9, 3.3926742678257504`*^9}, {3.392870826515375*^9, 
   3.39287085287475*^9}, {3.392870970140375*^9, 3.3928709748435*^9}, {
   3.39287100731225*^9, 3.392871009109125*^9}, {3.4051481770630302`*^9, 
   3.405148186359271*^9}, 3.409056469782959*^9, {3.409056510837832*^9, 
   3.4090565275328712`*^9}, 3.4091235025982*^9}],

Cell[BoxData[
 RowBox[{"x", "+", 
  FractionBox[
   SuperscriptBox["x", "2"], "2"]}]], "Output",
 CellChangeTimes->{
  3.3964166868331633`*^9, 3.4047182151027393`*^9, 3.405148187016985*^9, 
   3.407965410306664*^9, 3.409056473069194*^9, {3.40905651130855*^9, 
   3.40905653283144*^9}, {3.409056602886978*^9, 3.409056711593371*^9}, 
   3.409122496655695*^9, 3.4091231745873632`*^9, 3.409123503323057*^9, 
   3.409123578312744*^9, 3.409126928599156*^9, 3.409822811374949*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rischpoly", "[", 
  RowBox[{
   RowBox[{
    SuperscriptBox["x", "n"], "-", 
    RowBox[{"9", " ", 
     SuperscriptBox["x", "7"]}], "-", 
    RowBox[{"37", "x"}], "+", "1"}], ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.392504986748375*^9, 3.392504992904625*^9}, {
   3.3925056488265*^9, 3.3925056490765*^9}, {3.3926741423726254`*^9, 
   3.3926741532320004`*^9}, {3.3926742013570004`*^9, 
   3.3926742017788754`*^9}, {3.392935427202125*^9, 3.392935444795875*^9}, {
   3.392935509077125*^9, 3.39293550940525*^9}, {3.405148195105584*^9, 
   3.4051482004315853`*^9}, 3.409056486151271*^9, 3.40912350593178*^9}],

Cell[BoxData[
 RowBox[{"x", "-", 
  FractionBox[
   RowBox[{"37", " ", 
    SuperscriptBox["x", "2"]}], "2"], "-", 
  FractionBox[
   RowBox[{"9", " ", 
    SuperscriptBox["x", "8"]}], "8"], "+", 
  FractionBox[
   SuperscriptBox["x", 
    RowBox[{"1", "+", "n"}]], 
   RowBox[{"1", "+", "n"}]]}]], "Output",
 CellChangeTimes->{
  3.3964166871688013`*^9, 3.404718216935273*^9, {3.4051481965588818`*^9, 
   3.405148201402349*^9}, 3.407965410739875*^9, 3.409056489934175*^9, {
   3.409056620863455*^9, 3.409056711810588*^9}, 3.409122496945141*^9, 
   3.409123175311607*^9, 3.409123506578309*^9, 3.409123578642487*^9, 
   3.409126928982649*^9, 3.409822811592948*^9, 3.410073019788569*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{"rischpoly", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "1"}], "-", 
     RowBox[{"2", "/", "x"}]}], ",", "x"}], "]"}]}]], "Input",
 CellChangeTimes->{
  3.3926968762453747`*^9, {3.395199543068644*^9, 3.395199547257077*^9}, {
   3.395199920693966*^9, 3.39519992230762*^9}, {3.405148208343403*^9, 
   3.4051482113925133`*^9}, 3.4090564783333387`*^9, {3.4091231789417973`*^9, 
   3.4091231870877943`*^9}, 3.409123508886701*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "x"}], "-", 
  RowBox[{"2", " ", 
   RowBox[{"rischLog", "[", "x", "]"}]}]}]], "Output",
 CellChangeTimes->{
  3.396416687686729*^9, 3.404718219837569*^9, {3.405148205327327*^9, 
   3.40514821213527*^9}, 3.407965411406116*^9, 3.409056481749392*^9, 
   3.409056623585417*^9, {3.409056654166751*^9, 3.4090567125762663`*^9}, 
   3.409122497244248*^9, {3.409123176180532*^9, 3.409123187600916*^9}, 
   3.4091235095789948`*^9, 3.409123579354184*^9, 3.409126929498932*^9, 
   3.40982281435725*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Integration of Algebraic Functions", "Subsection",
 CellChangeTimes->{{3.3928547064987497`*^9, 3.3928547179518747`*^9}, {
   3.395149021729514*^9, 3.395149028295298*^9}, 3.3964165431318817`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RischAlgebraic", "[", 
   RowBox[{"integrand_", ",", "x_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"linearAlgebraic", ",", " ", "quadraticAlgebraic"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Work", " ", "in", " ", "progress"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "Print", "[", 
      "\"\<Integration of algebraic functions are not yet implemented!\>\"", 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "$Failed", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.3928547187487497`*^9, 3.3928547592174997`*^9}, {
  3.3928580807331247`*^9, 3.3928583016706247`*^9}, {3.392858571014*^9, 
  3.3928585767015*^9}, {3.392858975498375*^9, 3.39285903023275*^9}, {
  3.392935839983375*^9, 3.39293584121775*^9}, {3.3964164761694813`*^9, 
  3.396416501079317*^9}, {3.404718244909342*^9, 3.40471824793848*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Integration of Special Functions", "Subsection",
 CellChangeTimes->{{3.3964165489602957`*^9, 3.396416553139662*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RischSpecialExtension", "[", 
   RowBox[{"integrand_", ",", "x_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"Work", " ", "to", " ", "do", " ", "here"}], ",", " ", 
      RowBox[{
      "mainly", " ", "in", " ", "structure", " ", "theorem", " ", 
       "implementation"}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "Print", "[", "\"\<Integration failed, integral may be elementary.\>\"", 
      "]"}], ";", "\[IndentingNewLine]", "$Failed"}]}], "\[IndentingNewLine]",
    "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.3964165679051533`*^9, 3.396416617751093*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["IO Conversions", "Subsection",
 CellChangeTimes->{{3.395193539384067*^9, 3.395193542385724*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"myTrigToExp", "[", "f_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "F", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"RischTrace", "[", 
      RowBox[{"myTrigToExp", ",", "f", ",", "\"\<In\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"F", "=", 
      RowBox[{"f", "//.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Sin", "\[RuleDelayed]", "rischSin"}], ",", 
         RowBox[{"Cos", "\[RuleDelayed]", "rischCos"}], ",", 
         RowBox[{"Sinh", "\[RuleDelayed]", "rischSinh"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Cosh", "\[RuleDelayed]", "rischCosh"}], ",", 
         RowBox[{"Tan", "\[RuleDelayed]", "rischTan"}], ",", 
         RowBox[{"Tanh", "\[RuleDelayed]", "rischTanh"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Csc", "[", "arg_", "]"}], "\[RuleDelayed]", 
          RowBox[{"1", "/", 
           RowBox[{"rischSin", "[", "arg", "]"}]}]}], ",", 
         RowBox[{
          RowBox[{"Cot", "[", "arg_", "]"}], "\[RuleDelayed]", 
          RowBox[{"1", "/", 
           RowBox[{"rischTan", "[", "arg", "]"}]}]}], ",", 
         RowBox[{
          RowBox[{"Sec", "[", "arg_", "]"}], "\[RuleDelayed]", 
          RowBox[{"1", "/", 
           RowBox[{"rischCos", "[", "arg", "]"}]}]}], ",", 
         "\[IndentingNewLine]", "\t\t", 
         RowBox[{
          RowBox[{"Csch", "[", "arg_", "]"}], "\[RuleDelayed]", 
          RowBox[{"1", "/", 
           RowBox[{"rischSinh", "[", "arg", "]"}]}]}], ",", 
         RowBox[{
          RowBox[{"Coth", "[", "arg_", "]"}], "\[RuleDelayed]", 
          RowBox[{"1", "/", 
           RowBox[{"rischTanh", "[", "arg", "]"}]}]}], ",", 
         RowBox[{
          RowBox[{"Sech", "[", "arg_", "]"}], "\[RuleDelayed]", 
          RowBox[{"1", "/", 
           RowBox[{"rischCosh", "[", "arg", "]"}]}]}]}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"F", "=", 
      RowBox[{"F", "//.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"rischSin", "[", "arg_", "]"}], "\[RuleDelayed]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"I", "/", "2"}], ")"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"1", "/", 
              RowBox[{"rischExp", "[", 
               RowBox[{"I", " ", "arg"}], "]"}]}], "-", 
             RowBox[{"rischExp", "[", 
              RowBox[{"I", " ", "arg"}], "]"}]}], ")"}]}]}], ",", 
         RowBox[{
          RowBox[{"rischCos", "[", "arg_", "]"}], "\[RuleDelayed]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", "2"}], ")"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"rischExp", "[", 
              RowBox[{"I", " ", "arg"}], "]"}], "+", 
             RowBox[{"1", "/", 
              RowBox[{"rischExp", "[", 
               RowBox[{"I", " ", "arg"}], "]"}]}]}], ")"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"rischTan", "[", "arg_", "]"}], "\[RuleDelayed]", 
          RowBox[{"I", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"1", "/", 
               RowBox[{"rischExp", "[", 
                RowBox[{"I", " ", "arg"}], "]"}]}], "-", 
              RowBox[{"rischExp", "[", 
               RowBox[{"I", " ", "arg"}], "]"}]}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"1", "/", 
               RowBox[{"rischExp", "[", 
                RowBox[{"I", " ", "arg"}], "]"}]}], "+", 
              RowBox[{"rischExp", "[", 
               RowBox[{"I", " ", "arg"}], "]"}]}], ")"}]}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"rischSinh", "[", "arg_", "]"}], "\[RuleDelayed]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"rischExp", "[", "arg", "]"}], "-", 
             RowBox[{"1", "/", 
              RowBox[{"rischExp", "[", "arg", "]"}]}]}], ")"}], "/", "2"}]}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"rischCosh", "[", "arg_", "]"}], "\[RuleDelayed]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"rischExp", "[", "arg", "]"}], "+", 
             RowBox[{"1", "/", 
              RowBox[{"rischExp", "[", "arg", "]"}]}]}], ")"}], "/", "2"}]}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"rischTanh", "[", "arg_", "]"}], "\[RuleDelayed]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"rischExp", "[", "arg", "]"}], "-", 
             RowBox[{"1", "/", 
              RowBox[{"rischExp", "[", "arg", "]"}]}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"rischExp", "[", "arg", "]"}], "+", 
             RowBox[{"1", "/", 
              RowBox[{"rischExp", "[", "arg", "]"}]}]}], ")"}]}]}]}], 
        "}"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"RischTrace", "[", 
      RowBox[{"myTrigToExp", ",", "F", ",", "\"\<Out\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", "F"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.396749281576665*^9, 3.396749337431212*^9}, {
   3.39674943741803*^9, 3.396749437868433*^9}, {3.3967494992024927`*^9, 
   3.396749574736229*^9}, {3.39674960774677*^9, 3.396749752992999*^9}, {
   3.396749792513562*^9, 3.3967498274729567`*^9}, {3.396749961707889*^9, 
   3.3967500923743143`*^9}, {3.396750146046761*^9, 3.3967504319245768`*^9}, {
   3.396750486350459*^9, 3.396750513548231*^9}, {3.396752450999073*^9, 
   3.3967524809975224`*^9}, {3.3967525176640577`*^9, 3.396752534998251*^9}, {
   3.396752613673107*^9, 3.3967526140701923`*^9}, {3.3967528541368713`*^9, 
   3.39675285843812*^9}, 3.396753084409713*^9, {3.404956921068853*^9, 
   3.4049569744537582`*^9}, {3.409053928822434*^9, 3.4090539602148647`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"InputConvert", "[", 
   RowBox[{"f_", ",", "var_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "integrand", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"RischTrace", "[", 
      RowBox[{"InputConvert", ",", 
       RowBox[{"{", 
        RowBox[{"f", ",", "var"}], "}"}], ",", "\"\<In\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"integrand", "=", 
      RowBox[{
       RowBox[{"TrigToExp", "[", 
        RowBox[{"myTrigToExp", "[", "f", "]"}], "]"}], "//.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Log", ":>", "rischLog"}], ",", 
         RowBox[{"Exp", ":>", "rischExp"}], ",", 
         RowBox[{
          RowBox[{"E", "^", "a_"}], ":>", 
          RowBox[{"rischExp", "[", "a", "]"}]}]}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "we", " ", "use", " ", "the", " ", "following", " ", "rule", " ", 
        "because", " ", 
        RowBox[{"Exp", "[", 
         RowBox[{"x", " ", 
          RowBox[{"Log", "[", "x", "]"}]}], "]"}], " ", "gets", " ", 
        "automatically", " ", "converted", " ", "to", " ", 
        RowBox[{"x", "^", "x"}]}], ",", " ", 
       RowBox[{
       "which", " ", "we", " ", "do", " ", "not", " ", "want", " ", "for", 
        " ", "our", " ", "structure", " ", 
        RowBox[{"theorems", ".", " ", "For"}], " ", "example", " ", 
        RowBox[{"Risch", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", " ", "+", " ", 
             RowBox[{"Log", "[", "x", "]"}]}], ")"}], 
           RowBox[{"x", "^", "x"}]}], ",", " ", "x"}], "]"}]}]}], " ", "*)"}],
      "\[IndentingNewLine]", 
     RowBox[{"integrand", "=", 
      RowBox[{"integrand", "/.", 
       RowBox[{
        SuperscriptBox["a_", "b_"], ":>", 
        RowBox[{
         RowBox[{"rischExp", "[", 
          RowBox[{"b", " ", 
           RowBox[{"rischLog", "[", "a", "]"}]}], "]"}], "/;", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"FreeQ", "[", 
            RowBox[{"b", ",", "var"}], "]"}]}], "&&", 
          RowBox[{"a", "=!=", "E"}]}]}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"integrand", "=", 
      RowBox[{
       RowBox[{"Cancel", "[", 
        RowBox[{"Together", "[", "integrand", "]"}], "]"}], "//.", 
       RowBox[{
        RowBox[{"rischLog", "[", 
         RowBox[{"a_", "/", "b_"}], "]"}], "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"rischLog", "[", "a", "]"}], "-", 
         RowBox[{"rischLog", "[", "b", "]"}]}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"RischTrace", "[", 
      RowBox[{"InputConvert", ",", 
       RowBox[{"{", 
        RowBox[{"integrand", ",", "var"}], "}"}], ",", "\"\<Out\>\""}], "]"}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"integrand", ",", "var"}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.392154991122375*^9, 3.392154994934875*^9}, {
   3.39215503241925*^9, 3.392155131028625*^9}, {3.392760612950625*^9, 
   3.392760613294375*^9}, {3.39276065440375*^9, 3.392760714685*^9}, {
   3.392872840156*^9, 3.392872845296625*^9}, {3.392872913327875*^9, 
   3.392872926515375*^9}, {3.39287338568725*^9, 3.392873389109125*^9}, {
   3.39293233284275*^9, 3.392932344639625*^9}, {3.392933233483375*^9, 
   3.392933235639625*^9}, {3.39431085256075*^9, 3.394310858967*^9}, {
   3.39431093499825*^9, 3.394310939201375*^9}, {3.3951936083663883`*^9, 
   3.395193733612533*^9}, {3.3955781851519403`*^9, 3.3955781887234993`*^9}, {
   3.3964173098484077`*^9, 3.396417362750086*^9}, {3.396417605353073*^9, 
   3.39641760606211*^9}, {3.3964176611775312`*^9, 3.396417665166535*^9}, {
   3.396417709534759*^9, 3.396417710359223*^9}, 3.396438906127036*^9, {
   3.3967492787372513`*^9, 3.396749278803591*^9}, {3.396750540481373*^9, 
   3.3967505438403997`*^9}, {3.396753487454742*^9, 3.39675349310329*^9}, {
   3.3967540747864313`*^9, 3.396754095479022*^9}, {3.3967541286819553`*^9, 
   3.3967542073141623`*^9}, {3.3968687269635353`*^9, 3.396868752061982*^9}, {
   3.3968688956933193`*^9, 3.396868901610216*^9}, {3.396869402775399*^9, 
   3.3968694145157433`*^9}, {3.396869665591501*^9, 3.396869665684823*^9}, {
   3.397454643590603*^9, 3.397454648112822*^9}, 3.4047047153340893`*^9, {
   3.40470489335079*^9, 3.4047049064122343`*^9}, {3.4047049392120113`*^9, 
   3.404704963339184*^9}, {3.404956980349292*^9, 3.404957031349489*^9}}],

Cell[BoxData[
 RowBox[{"InputConvert", "[", 
  RowBox[{
   RowBox[{"Sin", "[", 
    RowBox[{"Cos", "[", "x", "]"}], "]"}], ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.39674941764334*^9, 3.3967494244614573`*^9}}],

Cell[BoxData[
 RowBox[{"InputConvert", "[", 
  RowBox[{
   FractionBox[
    RowBox[{"Cos", "[", "x", "]"}], 
    RowBox[{"1", "+", 
     RowBox[{
      RowBox[{"Sin", "[", "x", "]"}], " ", 
      RowBox[{"Cos", "[", "x", "]"}]}]}]], ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.392155001966125*^9, 3.392155019184875*^9}, {
  3.392155063184875*^9, 3.392155070309875*^9}, {3.39215511954425*^9, 
  3.392155142763*^9}}],

Cell[BoxData[
 RowBox[{"InputConvert", "[", 
  RowBox[{
   FractionBox[
    RowBox[{"Cosh", "[", "x", "]"}], 
    RowBox[{"1", "+", 
     RowBox[{"Sinh", "[", "x", "]"}]}]], ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.392155001966125*^9, 3.392155019184875*^9}, {
  3.392155063184875*^9, 3.392155070309875*^9}, {3.39215511954425*^9, 
  3.392155142763*^9}, {3.39215518404425*^9, 3.392155188341125*^9}, {
  3.395193592940219*^9, 3.395193593963279*^9}}],

Cell[BoxData[
 RowBox[{"InputConvert", "[", 
  RowBox[{
   RowBox[{
    SuperscriptBox["x", "x"], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"Log", "[", "x", "]"}]}], ")"}]}], ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.392155144841125*^9, 3.3921551588255*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"OutputConvert", "[", 
   RowBox[{
   "integrand_", ",", "result_", ",", "theta_", ",", "tower_", ",", "var_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"solution", ",", "reps"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"RischTrace", "[", 
      RowBox[{"OutputConvert", ",", 
       RowBox[{"{", 
        RowBox[{"integrand", ",", "result"}], "}"}], ",", "\"\<In\>\""}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"remove", " ", "theta", " ", "notation"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"reps", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"First", "[", "#", "]"}], "\[Rule]", 
         RowBox[{"Last", "[", "#", "]"}]}], "&"}], "/@", 
       RowBox[{"Thread", "[", 
        RowBox[{"{", 
         RowBox[{"theta", ",", "tower"}], "}"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"solution", "=", 
      RowBox[{"result", "//.", "reps"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Convert", " ", "back", " ", "out", " ", "of", " ", "our", " ", 
       "internal", " ", "log", " ", "form"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"solution", "=", 
      RowBox[{"solution", "//.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"rischLog", "\[Rule]", "Log"}], ",", 
         RowBox[{"rischExp", "\[Rule]", "Exp"}], ",", 
         RowBox[{
          RowBox[{"Log", "[", 
           RowBox[{"a_", "/", 
            RowBox[{"b_", "?", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"FreeQ", "[", 
                RowBox[{"#", ",", "var"}], "]"}], "&"}], ")"}]}]}], "]"}], 
          "\[RuleDelayed]", 
          RowBox[{"Log", "[", "a", "]"}]}]}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"write", " ", "as", " ", "trigs", " ", "if", " ", "possible"}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"solution", "=", 
      RowBox[{"solution", "/.", 
       RowBox[{
        RowBox[{
         RowBox[{"c1_.", " ", 
          RowBox[{"Log", "[", 
           RowBox[{
            RowBox[{"-", "\[ImaginaryI]"}], "+", 
            RowBox[{"Exp", "[", 
             RowBox[{"I", " ", "a_.", " ", "var"}], "]"}]}], "]"}]}], "+", 
         RowBox[{"c2_.", 
          RowBox[{"Log", "[", 
           RowBox[{"\[ImaginaryI]", "+", 
            RowBox[{"Exp", "[", 
             RowBox[{"I", " ", "a_.", " ", "var"}], "]"}]}], "]"}]}]}], 
        "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"c2", " ", 
          RowBox[{"Log", "[", 
           RowBox[{
            RowBox[{"Sec", "[", 
             RowBox[{"a", " ", "var"}], "]"}], "+", 
            RowBox[{"Tan", "[", 
             RowBox[{"a", " ", "var"}], "]"}]}], "]"}]}], "/;", 
         RowBox[{
          RowBox[{"FreeQ", "[", 
           RowBox[{"a", ",", "var"}], "]"}], "&&", 
          RowBox[{"c1", "===", 
           RowBox[{"-", "c2"}]}], "&&", 
          RowBox[{
           RowBox[{"Sign", "[", "c2", "]"}], "===", "1"}]}]}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"TrigQ", "[", 
        RowBox[{"integrand", ",", 
         RowBox[{"First", "[", "tower", "]"}]}], "]"}], ",", 
       RowBox[{"solution", " ", "=", " ", 
        RowBox[{"FixedPoint", "[", 
         RowBox[{"ExpToTrig", ",", "solution"}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Log", "[", 
         RowBox[{"a", " ", 
          RowBox[{"b", "[", "x", "]"}]}], "]"}], " ", "=", " ", 
        RowBox[{
         RowBox[{"Log", "[", "a", "]"}], " ", "+", " ", 
         RowBox[{"Log", "[", 
          RowBox[{"b", "[", "x", "]"}], "]"}]}]}], ",", " ", 
       RowBox[{"where", " ", 
        RowBox[{"Log", "[", "a", "]"}], " ", "is", " ", 
        RowBox[{"constant", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"solution", "=", 
      RowBox[{"solution", "//.", 
       RowBox[{
        RowBox[{"Log", "[", 
         RowBox[{"a_", "/", "b_"}], "]"}], "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"Log", "[", "a", "]"}], "/;", 
         RowBox[{"FreeQ", "[", 
          RowBox[{"b", ",", "var"}], "]"}]}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"solution", "=", 
      RowBox[{"solution", "//.", 
       RowBox[{
        RowBox[{"Log", "[", 
         RowBox[{"a_", " ", "v_"}], "]"}], "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"Log", "[", "v", "]"}], "/;", 
         RowBox[{
          RowBox[{"FreeQ", "[", 
           RowBox[{"a", ",", "var"}], "]"}], "&&", 
          RowBox[{"!", 
           RowBox[{"FreeQ", "[", 
            RowBox[{"v", ",", "var"}], "]"}]}]}]}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"solution", "=", 
      RowBox[{"solution", "//.", 
       RowBox[{
        RowBox[{
         RowBox[{"a_.", " ", 
          RowBox[{"Cosh", "[", "X_", "]"}]}], "+", 
         RowBox[{"a_.", " ", 
          RowBox[{"Sinh", "[", "X_", "]"}]}]}], "\[RuleDelayed]", 
        RowBox[{"Exp", "[", "X", "]"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"solution", "=", 
      RowBox[{"solution", "/.", 
       RowBox[{
        RowBox[{"Log", "[", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", "a_.", " ", "var"}], "]"}], "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"2", " ", "a_.", " ", "var"}], "]"}]}]}], "]"}], 
        "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"Log", "[", 
          RowBox[{"Sin", "[", 
           RowBox[{"a", " ", "var"}], "]"}], "]"}], "/;", 
         RowBox[{"FreeQ", "[", 
          RowBox[{"a", ",", "var"}], "]"}]}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"solution", "=", 
      RowBox[{"solution", "/.", 
       RowBox[{
        RowBox[{"Log", "[", 
         RowBox[{"1", "+", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", "a_.", " ", "var"}], "]"}], "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"2", " ", "a_.", " ", "var"}], "]"}]}]}], "]"}], 
        "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"Log", "[", 
          RowBox[{"Cos", "[", 
           RowBox[{"a", " ", "var"}], "]"}], "]"}], "/;", 
         RowBox[{"FreeQ", "[", 
          RowBox[{"a", ",", "var"}], "]"}]}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"back", " ", "to", " ", "original", " ", "variable"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"solution", " ", "=", " ", 
      RowBox[{"solution", "/.", 
       RowBox[{"rischVar", "\[Rule]", "var"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"RischTrace", "[", 
      RowBox[{"OutputConvert", ",", "solution", ",", "\"\<Out\>\""}], "]"}], 
     ";", "\[IndentingNewLine]", "solution"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.39276081946625*^9, 3.3927608478725*^9}, {
   3.39276149455925*^9, 3.3927616362155*^9}, 3.392762683043625*^9, {
   3.39276272193425*^9, 3.39276276180925*^9}, {3.39276279874675*^9, 
   3.39276280074675*^9}, {3.392861924592125*^9, 3.39286202748275*^9}, {
   3.395144396789707*^9, 3.395144400115991*^9}, {3.3952007917705727`*^9, 
   3.395200801728115*^9}, {3.395315644767386*^9, 3.395315645702551*^9}, 
   3.395542631959958*^9, {3.395733323231248*^9, 3.3957333562794*^9}, {
   3.396777623657412*^9, 3.3967776418974953`*^9}, {3.396777692332217*^9, 
   3.396777738211693*^9}, {3.39686962533841*^9, 3.396869652511269*^9}, {
   3.39727653881911*^9, 3.397276579264937*^9}, 3.3972766096816597`*^9, {
   3.39903323625671*^9, 3.399033242143911*^9}, {3.399033277200976*^9, 
   3.399033348185401*^9}, {3.399033681944936*^9, 3.3990337067392807`*^9}, {
   3.399034190728984*^9, 3.399034196339149*^9}, {3.399547769426799*^9, 
   3.399547790303464*^9}, {3.399547852402603*^9, 3.399547854878812*^9}, {
   3.401942403687978*^9, 3.4019424518648787`*^9}, {3.404704738591555*^9, 
   3.40470481202429*^9}, {3.404704850932053*^9, 3.404704860000622*^9}, {
   3.404984674091164*^9, 3.404984822938237*^9}, {3.404984869377453*^9, 
   3.404984907291133*^9}, 3.4054058239714537`*^9, {3.40540587213756*^9, 
   3.405405914962038*^9}, {3.407965485897888*^9, 3.407965488537397*^9}, {
   3.409139570640011*^9, 3.409139582557946*^9}, {3.409822994327183*^9, 
   3.4098231045757923`*^9}, {3.409823198619578*^9, 3.409823252088396*^9}, {
   3.409823859156148*^9, 3.409823909977437*^9}, {3.409824063738999*^9, 
   3.4098240771375637`*^9}, {3.409824159242495*^9, 3.4098241778810577`*^9}, {
   3.409886971764599*^9, 3.4098870184691668`*^9}, {3.409887081145453*^9, 
   3.409887095920763*^9}, {3.409887157848322*^9, 3.409887263213264*^9}, 
   3.409887314534628*^9, {3.409887364093152*^9, 3.409887434836564*^9}, {
   3.409887487912209*^9, 3.4098874880368423`*^9}, {3.40988768153587*^9, 
   3.409887703708577*^9}, {3.409887765375566*^9, 3.409887768164665*^9}, {
   3.409887934470158*^9, 3.4098879386670027`*^9}, {3.4098879697741947`*^9, 
   3.409888057387087*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Sin", "[", "x", "]"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"Cos", "[", "x", "]"}], "]"}]}], ",", "x"}], "]"}], "//", 
  "Timing"}]], "Input",
 CellChangeTimes->{{3.4040318141893253`*^9, 3.404031815332505*^9}, 
   3.404984831957006*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.024955999999999978`", ",", 
   RowBox[{"-", 
    RowBox[{"Sin", "[", 
     RowBox[{"Cos", "[", "x", "]"}], "]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.409126827467877*^9, {3.409823087125964*^9, 3.40982310667382*^9}, 
   3.409823254303648*^9, 3.409824070694151*^9, 3.409887505205599*^9, 
   3.409887769683818*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Small Integration Table", "Subsection",
 CellChangeTimes->{{3.4102247877239647`*^9, 3.4102247905028667`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"RischTable", "[", 
    RowBox[{
     SuperscriptBox["x_", "n_."], ",", "x_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"x", "^", 
      RowBox[{"(", 
       RowBox[{"n", "+", "1"}], ")"}]}], "/", 
     RowBox[{"(", 
      RowBox[{"n", "+", "1"}], ")"}]}], "/;", 
    RowBox[{
     RowBox[{"FreeQ", "[", 
      RowBox[{"n", ",", "x"}], "]"}], "&&", 
     RowBox[{"n", "=!=", 
      RowBox[{"-", "1"}]}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RischTable", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"a_.", " ", "x_"}], "+", "b_."}], ")"}], "^", "n_."}], ",", 
     "x_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"a", " ", "x"}], "+", "b"}], ")"}], "^", 
      RowBox[{"(", 
       RowBox[{"n", "+", "1"}], ")"}]}], "/", 
     RowBox[{"(", 
      RowBox[{"a", 
       RowBox[{"(", 
        RowBox[{"n", "+", "1"}], ")"}]}], ")"}]}], "/;", 
    RowBox[{
     RowBox[{"FreeQ", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a", ",", "b", ",", "n"}], "}"}], ",", "x"}], "]"}], "&&", 
     RowBox[{"n", "=!=", 
      RowBox[{"-", "1"}]}]}]}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.410224792889851*^9, 3.410224850443162*^9}, {
   3.410224883477871*^9, 3.410224890307263*^9}, {3.4102937652211037`*^9, 
   3.4102937659633703`*^9}, {3.4102938746209908`*^9, 3.410293906260696*^9}, {
   3.410293944903737*^9, 3.4102939687253304`*^9}, 3.410333083008019*^9, {
   3.410333145986699*^9, 3.410333153239839*^9}, {3.410333184327816*^9, 
   3.4103331853867197`*^9}, {3.410333561586954*^9, 3.410333640556085*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Risch", "[", 
  RowBox[{
   RowBox[{"x", "^", "n"}], ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.4103335196761513`*^9, 3.4103335232622337`*^9}}],

Cell[BoxData[
 FractionBox[
  SuperscriptBox["x", 
   RowBox[{"1", "+", "n"}]], 
  RowBox[{"1", "+", "n"}]]], "Output",
 CellChangeTimes->{3.41033352398097*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Risch", "[", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"4", "x"}], "-", "1"}], ")"}], "n"], ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.410333800227449*^9, 3.410333813090806*^9}}],

Cell[BoxData[
 FractionBox[
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     RowBox[{"4", " ", "x"}]}], ")"}], 
   RowBox[{"1", "+", "n"}]], 
  RowBox[{"4", " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", "n"}], ")"}]}]]], "Output",
 CellChangeTimes->{3.410333813844151*^9}]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Algebraic Preliminaries", "Section",
 CellChangeTimes->{{3.3847251351545*^9, 3.384725146232625*^9}, {
  3.38474297631075*^9, 3.384742977263875*^9}}],

Cell[CellGroupData[{

Cell["Pseudo-Division", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PolyPseudoDivide", "[", 
   RowBox[{"a_", ",", "b_", ",", "var_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"A", "=", "a"}], ",", 
      RowBox[{"B", "=", "b"}], ",", 
      RowBox[{"x", "=", "var"}], ",", "w", ",", "n", ",", "Q", ",", "R", ",", 
      "deg", ",", "T", ",", "res"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"Reference", ":", " ", 
       RowBox[{"Symbolic", " ", "Integration"}]}], ",", " ", "Bronstein", ",",
       " ", 
      RowBox[{"p", ".9"}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
      "Given", " ", "an", " ", "integral", " ", "domain", " ", "D", " ", 
       "and", " ", "A"}], ",", 
      RowBox[{
       RowBox[{"B", " ", "in", " ", 
        RowBox[{"D", "[", "x", "]"}], " ", "with", " ", "B"}], " ", 
       "\[NotEqual]", " ", "0"}], ",", " ", 
      RowBox[{
      "return", " ", "\[IndentingNewLine]", "the", " ", "pseudo", " ", 
       "quotient", " ", "and", " ", "pseudo", " ", "remainder", " ", "of", 
       " ", "A"}], ",", "B"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"RischTrace", "[", 
      RowBox[{"PolyPseudoDivide", ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", "b", ",", "var"}], "}"}], ",", "\"\<In\>\""}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"w", "=", 
      RowBox[{"lc", "[", 
       RowBox[{"B", ",", "x"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"n", "=", 
      RowBox[{
       RowBox[{"Exponent", "[", 
        RowBox[{"A", ",", "x"}], "]"}], "-", 
       RowBox[{"Exponent", "[", 
        RowBox[{"B", ",", "x"}], "]"}], "+", "1"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Q", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"R", "=", "A"}], ";", "\[IndentingNewLine]", 
     RowBox[{"deg", "=", 
      RowBox[{
       RowBox[{"Exponent", "[", 
        RowBox[{"R", ",", "x"}], "]"}], "-", 
       RowBox[{"Exponent", "[", 
        RowBox[{"B", ",", "x"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"R", "=!=", "0"}], "&&", 
        RowBox[{"deg", "\[GreaterEqual]", "0"}]}], ",", "\[IndentingNewLine]",
        "\t", 
       RowBox[{
        RowBox[{"T", "=", 
         RowBox[{
          RowBox[{"lc", "[", 
           RowBox[{"R", ",", "x"}], "]"}], 
          SuperscriptBox["x", "deg"]}]}], ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"n", "=", 
         RowBox[{"n", "-", "1"}]}], ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"Q", "=", 
         RowBox[{"Expand", "[", 
          RowBox[{
           RowBox[{"w", " ", "Q"}], "+", "T"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"R", "=", 
         RowBox[{"Expand", "[", 
          RowBox[{
           RowBox[{"w", " ", "R"}], "-", 
           RowBox[{"T", " ", "B"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\t", 
        RowBox[{"deg", "=", 
         RowBox[{
          RowBox[{"Exponent", "[", 
           RowBox[{"R", ",", "x"}], "]"}], "-", 
          RowBox[{"Exponent", "[", 
           RowBox[{"B", ",", "x"}], "]"}]}]}], ";"}]}], "\[IndentingNewLine]",
       "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          SuperscriptBox["w", "n"], " ", "Q"}], ",", 
         RowBox[{
          SuperscriptBox["w", "n"], " ", "R"}]}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"RischTrace", "[", 
      RowBox[{"PolyPseudoDivide", ",", "res", ",", "\"\<Out\>\""}], "]"}], 
     ";", "\[IndentingNewLine]", "res"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.385691428011375*^9, 3.385691472573875*^9}, {
   3.39085810824675*^9, 3.3908581712155*^9}, {3.390858565106125*^9, 
   3.390858572668625*^9}, {3.404957058048517*^9, 3.404957116007312*^9}, {
   3.404983516539998*^9, 3.4049835401133223`*^9}, 3.414054264182767*^9}],

Cell["Example:", "Text"],

Cell[BoxData[
 RowBox[{"PolyPseudoDivide", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"3", " ", 
     SuperscriptBox["x", "3"]}], "+", 
    SuperscriptBox["x", "2"], "+", "x", "+", "5"}], ",", 
   RowBox[{
    RowBox[{"5", " ", 
     SuperscriptBox["x", "2"]}], "-", 
    RowBox[{"3", " ", "x"}], "+", "1"}], ",", "x"}], "]"}]], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Coefficient of Largest Power", "Subsection",
 CellChangeTimes->{{3.384724861592*^9, 3.38472487637325*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"lc", "[", 
   RowBox[{"f_", ",", "x_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"FreeQ", "[", 
      RowBox[{"f", ",", "x"}], "]"}]}], ",", 
    RowBox[{"Coefficient", "[", 
     RowBox[{"f", ",", 
      SuperscriptBox["x", 
       RowBox[{"Exponent", "[", 
        RowBox[{"f", ",", "x"}], "]"}]]}], "]"}], ",", "f"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.390858184153*^9, 3.390858211606125*^9}, {
  3.409385194178583*^9, 3.409385195115253*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "find", " ", "the", " ", "coefficient", " ", "of", " ", "the", " ", 
    "polynomial", " ", "f", " ", "wrt", " ", "x"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"lc", "=", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"FreeQ", "[", 
         RowBox[{"#1", ",", "#2"}], "]"}]}], ",", 
       RowBox[{"Coefficient", "[", 
        RowBox[{"#1", ",", 
         SuperscriptBox["#2", 
          RowBox[{"Exponent", "[", 
           RowBox[{"#1", ",", "#2"}], "]"}]]}], "]"}], ",", "#1"}], "]"}], 
     "&"}]}], ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.409384855325693*^9, 3.4093849086639023`*^9}, {
  3.409385197392537*^9, 3.409385197904932*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"lc", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"8", 
     SuperscriptBox["x", "23"]}], "+", 
    RowBox[{"3", 
     SuperscriptBox["x", "3"]}], "-", "1"}], ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.4074723417510157`*^9, 3.4074723685000887`*^9}}],

Cell[BoxData["8"], "Output",
 CellChangeTimes->{{3.407472360248274*^9, 3.407472369540189*^9}, {
  3.4093851866323423`*^9, 3.409385199613146*^9}}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Primitive Polynomial", "Subsection",
 CellChangeTimes->{{3.3847215357795*^9, 3.384721545763875*^9}, {
  3.38472239262325*^9, 3.384722394076375*^9}, {3.38472547031075*^9, 
  3.3847254706545*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "make", " ", "the", " ", "polynomial", " ", "p", " ", "primitive", " ", 
    "wrt", " ", "x"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"primitive", "[", 
    RowBox[{"p_", ",", "theta_", ",", "var_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"FreeQ", "[", 
         RowBox[{"p", ",", "var"}], "]"}], "||", 
        RowBox[{"!", 
         RowBox[{"FreeQ", "[", 
          RowBox[{
           RowBox[{"Denominator", "[", "p", "]"}], ",", "var"}], "]"}]}], "||", 
        RowBox[{"!", 
         RowBox[{"NumberQ", "[", "#", "]"}]}]}], ",", "p", ",", 
       RowBox[{"Collect", "[", 
        RowBox[{
         RowBox[{"p", "/", "#"}], ",", "var"}], "]"}]}], "]"}], "&"}], "[", 
    RowBox[{"PolynomialGCD", "@@", 
     RowBox[{"CoefficientList", "[", 
      RowBox[{"p", ",", "var"}], "]"}]}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.3847215481545*^9, 3.38472156931075*^9}, {
   3.384721870217*^9, 3.3847218747795*^9}, {3.384721925795125*^9, 
   3.384722262482625*^9}, {3.384722400107625*^9, 3.384722417263875*^9}, {
   3.384722449576375*^9, 3.384722474045125*^9}, 3.3906962507805*^9, {
   3.3906963097805*^9, 3.39069631868675*^9}, {3.390696387077375*^9, 
   3.390696387468*^9}, {3.390696532764875*^9, 3.39069658593675*^9}, {
   3.3908582178405*^9, 3.3908582323405*^9}, {3.395315816622637*^9, 
   3.395315833693276*^9}, {3.395729520257167*^9, 3.3957295502862997`*^9}, {
   3.3957301676663923`*^9, 3.395730171559544*^9}, {3.395730292692215*^9, 
   3.39573029956155*^9}, {3.395730589870041*^9, 3.395730603923024*^9}, {
   3.395730771235866*^9, 3.395730783131534*^9}, {3.3957311261094913`*^9, 
   3.39573112685817*^9}, {3.395731171701791*^9, 3.395731188722417*^9}, 
   3.3957312585486813`*^9, {3.39573132571128*^9, 3.3957313282092867`*^9}, {
   3.395731411215582*^9, 3.395731451524342*^9}, {3.3957338689581337`*^9, 
   3.395733874725956*^9}, {3.395733909532175*^9, 3.395733933085853*^9}, 
   3.395734197403244*^9, {3.395734229362208*^9, 3.3957342326892138`*^9}, {
   3.395734413544011*^9, 3.3957344176077843`*^9}, {3.3957344526291523`*^9, 
   3.3957345089281*^9}, {3.395734541071679*^9, 3.395734552787765*^9}, {
   3.395734648339377*^9, 3.395734782707553*^9}, 3.3957348337804937`*^9, {
   3.3957348810254707`*^9, 3.395734905641103*^9}, {3.395734948660305*^9, 
   3.395735044223853*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "make", " ", "the", " ", "polynomial", " ", "p", " ", "primitive", " ", 
    "wrt", " ", "x"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"primitive", "[", 
    RowBox[{"p_", ",", "var_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"FreeQ", "[", 
         RowBox[{"p", ",", "var"}], "]"}], "||", 
        RowBox[{"!", 
         RowBox[{"FreeQ", "[", 
          RowBox[{
           RowBox[{"Denominator", "[", "p", "]"}], ",", "var"}], "]"}]}], "||", 
        RowBox[{"!", 
         RowBox[{"NumberQ", "[", "#", "]"}]}]}], ",", "p", ",", 
       RowBox[{"Collect", "[", 
        RowBox[{
         RowBox[{"p", "/", "#"}], ",", "var"}], "]"}]}], "]"}], "&"}], "[", 
    " ", 
    RowBox[{"PolynomialGCD", "@@", 
     RowBox[{"CoefficientList", "[", 
      RowBox[{"p", ",", "var"}], "]"}]}], " ", "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.3847215481545*^9, 3.38472156931075*^9}, {
   3.384721870217*^9, 3.3847218747795*^9}, {3.384721925795125*^9, 
   3.384722262482625*^9}, {3.384722400107625*^9, 3.384722417263875*^9}, {
   3.384722449576375*^9, 3.384722474045125*^9}, 3.3906962507805*^9, {
   3.3906963097805*^9, 3.39069631868675*^9}, {3.390696387077375*^9, 
   3.390696387468*^9}, {3.390696532764875*^9, 3.39069658593675*^9}, {
   3.3908582178405*^9, 3.3908582323405*^9}, {3.395315816622637*^9, 
   3.395315833693276*^9}, {3.395729520257167*^9, 3.3957295502862997`*^9}, {
   3.3957301676663923`*^9, 3.395730171559544*^9}, {3.395730292692215*^9, 
   3.39573029956155*^9}, {3.395730589870041*^9, 3.395730603923024*^9}, {
   3.395730771235866*^9, 3.395730783131534*^9}, {3.3957311261094913`*^9, 
   3.39573112685817*^9}, {3.395731171701791*^9, 3.395731188722417*^9}, 
   3.3957312585486813`*^9, {3.39573132571128*^9, 3.3957313282092867`*^9}, {
   3.395731411215582*^9, 3.395731451524342*^9}, {3.3957338689581337`*^9, 
   3.395733874725956*^9}, {3.395733909532175*^9, 3.395733933085853*^9}, 
   3.395734197403244*^9, {3.395734229362208*^9, 3.3957342326892138`*^9}, {
   3.395734413544011*^9, 3.3957344176077843`*^9}, {3.3957344526291523`*^9, 
   3.3957345089281*^9}, {3.395734541071679*^9, 3.395734552787765*^9}, {
   3.395734648339377*^9, 3.395734782707553*^9}, 3.3957348337804937`*^9, {
   3.3957348810254707`*^9, 3.395734905641103*^9}, {3.395734948660305*^9, 
   3.395735044223853*^9}, {3.397942163688622*^9, 3.39794216844423*^9}, {
   3.398140568335711*^9, 3.3981405703634367`*^9}, {3.3981597883195887`*^9, 
   3.398159790995125*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PrimitiveArg", "[", 
  RowBox[{
   RowBox[{"rischLog", "[", 
    RowBox[{"100", "+", 
     RowBox[{"100", " ", 
      SuperscriptBox["x", "2"]}]}], "]"}], ",", 
   RowBox[{"{", "x", "}"}], ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.395733814471561*^9, 3.3957338228718557`*^9}, {
  3.395733882160828*^9, 3.395733883783688*^9}}],

Cell[BoxData[
 RowBox[{"rischLog", "[", 
  RowBox[{"1", "+", 
   SuperscriptBox["x", "2"]}], "]"}]], "Output",
 CellChangeTimes->{3.397877455855549*^9, 3.3981406403973913`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PrimitiveArg", "[", 
  RowBox[{
   RowBox[{"rischLog", "[", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       SubscriptBox["\"\<\[Theta]\>\"", "2"], "x"]}], "+", 
     SubscriptBox["\"\<\[Theta]\>\"", "3"]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     SubscriptBox["\"\<\[Theta]\>\"", "1"], ",", 
     SubscriptBox["\"\<\[Theta]\>\"", "2"]}], "}"}], ",", 
   SubscriptBox["\"\<\[Theta]\>\"", "2"]}], "]"}]], "Input",
 CellChangeTimes->{{3.395729471846333*^9, 3.3957294838763037`*^9}, {
  3.395730962118639*^9, 3.395730985748073*^9}, {3.3957312128344088`*^9, 
  3.3957312154874983`*^9}}],

Cell[BoxData[
 RowBox[{"rischLog", "[", 
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     SubscriptBox["\<\"\[Theta]\"\>", "2"], "x"]}], "+", 
   SubscriptBox["\<\"\[Theta]\"\>", "3"]}], "]"}]], "Output",
 CellChangeTimes->{3.397877456501047*^9, 3.398140640872357*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"primitive", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"36", " ", 
     SuperscriptBox["x", "2"]}], "+", 
    RowBox[{"36", "x"}], "+", "36"}], ",", 
   RowBox[{"{", "x", "}"}], ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.384722266295125*^9, 3.384722277342*^9}, {
  3.384722464388875*^9, 3.384722477732625*^9}, {3.393543099447875*^9, 
  3.39354310461975*^9}, {3.3935431748385*^9, 3.393543178822875*^9}, {
  3.395730836640534*^9, 3.395730838119917*^9}}],

Cell[BoxData[
 RowBox[{"1", "+", "x", "+", 
  SuperscriptBox["x", "2"]}]], "Output",
 CellChangeTimes->{
  3.3978772923608103`*^9, {3.397877451237616*^9, 3.397877457174018*^9}, 
   3.398140641141617*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"primitive", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"4", "t", " ", "x"}], "+", "1"}], ",", 
   RowBox[{"{", "t", "}"}], ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.39572971701617*^9, 3.395729761223448*^9}, {
  3.395730841258464*^9, 3.395730842743752*^9}}],

Cell[BoxData[
 RowBox[{"1", "+", 
  RowBox[{"4", " ", "t", " ", "x"}]}]], "Output",
 CellChangeTimes->{{3.3978774521944103`*^9, 3.397877464422092*^9}, 
   3.39814064158208*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"PrimitiveArg", "[", 
   RowBox[{"f_", ",", "theta_", ",", "var_"}], "]"}], ":=", 
  RowBox[{"f", "/.", 
   RowBox[{
    RowBox[{"rischLog", "[", "arg_", "]"}], "\[RuleDelayed]", 
    RowBox[{"rischLog", "[", 
     RowBox[{"primitive", "[", 
      RowBox[{"arg", ",", "theta", ",", "var"}], "]"}], "]"}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.3935429720885*^9, 3.393543013760375*^9}, {
   3.393543062760375*^9, 3.393543087276*^9}, {3.3935457245885*^9, 
   3.39354574080725*^9}, {3.395313394921527*^9, 3.395313399374674*^9}, {
   3.395730705251618*^9, 3.3957307105450497`*^9}, 3.395734598214562*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PrimitiveArg", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     SqrtBox["3"], " ", 
     RowBox[{"ArcTan", "[", 
      FractionBox[
       RowBox[{"1", "-", 
        RowBox[{"2", " ", "x"}]}], 
       SqrtBox["3"]], "]"}]}], "+", 
    RowBox[{"4", " ", 
     RowBox[{"rischLog", "[", 
      RowBox[{"4", "-", 
       RowBox[{"4", " ", "x"}], "+", 
       RowBox[{"4", " ", 
        SuperscriptBox["x", "2"]}]}], "]"}]}]}], ",", 
   RowBox[{"{", "x", "}"}], ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.393543015135375*^9, 3.393543034260375*^9}, 
   3.393544032229125*^9, {3.39354573468225*^9, 3.393545734854125*^9}, {
   3.395313404079482*^9, 3.395313404422975*^9}, {3.3957308479958553`*^9, 
   3.3957308489290457`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SqrtBox["3"], " ", 
   RowBox[{"ArcTan", "[", 
    FractionBox[
     RowBox[{"1", "-", 
      RowBox[{"2", " ", "x"}]}], 
     SqrtBox["3"]], "]"}]}], "+", 
  RowBox[{"4", " ", 
   RowBox[{"rischLog", "[", 
    RowBox[{"1", "-", "x", "+", 
     SuperscriptBox["x", "2"]}], "]"}]}]}]], "Output",
 CellChangeTimes->{3.39814064246634*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PrimitiveArg", "[", 
  RowBox[{
   RowBox[{"rischLog", "[", 
    RowBox[{"100", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       SuperscriptBox["x", "2"]}], ")"}]}], "]"}], ",", 
   RowBox[{"{", "x", "}"}], ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.395313367569512*^9, 3.395313380421653*^9}, {
  3.395313414238319*^9, 3.395313418125811*^9}, {3.395730852562769*^9, 
  3.395730853464126*^9}}],

Cell[BoxData[
 RowBox[{"rischLog", "[", 
  RowBox[{"1", "+", 
   SuperscriptBox["x", "2"]}], "]"}]], "Output",
 CellChangeTimes->{3.398140642798348*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Monic Polynomial", "Subsection",
 CellChangeTimes->{{3.3847224831545*^9, 3.38472248974825*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"monic", "[", 
   RowBox[{"p_", ",", "var_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"FreeQ", "[", 
     RowBox[{"p", ",", "var"}], "]"}], ",", "1", ",", 
    RowBox[{"Collect", "[", 
     RowBox[{
      RowBox[{"Expand", "[", 
       RowBox[{"p", "/", 
        RowBox[{"lc", "[", 
         RowBox[{"p", ",", "var"}], "]"}]}], "]"}], ",", "var"}], "]"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.384722491467*^9, 3.384722532342*^9}, {
   3.38472261924825*^9, 3.384722621592*^9}, {3.384722717920125*^9, 
   3.3847227505295*^9}, {3.3847231736545*^9, 3.3847231847795*^9}, 
   3.385445286058375*^9, 3.385505797836875*^9, 3.38550584554*^9, 
   3.3856873342145*^9, {3.3957286890118093`*^9, 3.395728694849011*^9}, {
   3.395729312458015*^9, 3.395729321392324*^9}, {3.3957328744013557`*^9, 
   3.3957329584290533`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"logMonic", "[", 
   RowBox[{"p_", ",", "theta_", ",", "var_"}], "]"}], ":=", 
  RowBox[{"Which", "[", "\[IndentingNewLine]", "\t\t\t\t\t\t\t\t", 
   RowBox[{
    RowBox[{"FreeQ", "[", 
     RowBox[{"p", ",", "var"}], "]"}], ",", "\[IndentingNewLine]", 
    "\t\t\t\t\t\t\t\t\t\t", "1", ",", "\[IndentingNewLine]", 
    "\t\t\t\t\t\t\t\t", 
    RowBox[{"FreeQ", "[", 
     RowBox[{
      RowBox[{"lc", "[", 
       RowBox[{"p", ",", "var"}], "]"}], ",", "theta"}], "]"}], ",", 
    "\[IndentingNewLine]", "\t\t\t\t\t\t\t\t\t\t", "p", ",", 
    "\[IndentingNewLine]", "\t\t\t\t\t\t\t\t", "True", ",", 
    "\[IndentingNewLine]", "\t\t\t\t\t\t\t\t\t\t", 
    RowBox[{"Collect", "[", 
     RowBox[{
      RowBox[{"Expand", "[", 
       RowBox[{"p", "/", 
        RowBox[{"lc", "[", 
         RowBox[{"p", ",", "var"}], "]"}]}], "]"}], ",", "var"}], "]"}]}], 
   "\[IndentingNewLine]", "\t\t\t\t\t\t", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.395732947899146*^9, 3.39573303453174*^9}}],

Cell[BoxData[
 RowBox[{"monic", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"45", "t", " ", 
     SuperscriptBox["x", "5"]}], "-", 
    RowBox[{"t", " ", "x"}], "+", "1"}], ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.384722755357625*^9, 3.384722760545125*^9}, {
  3.387341480121125*^9, 3.38734148801175*^9}}],

Cell[BoxData[
 RowBox[{"monic", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     SubscriptBox["\[Theta]", "2"]}], "+", 
    RowBox[{"x", " ", 
     SubscriptBox["\[Theta]", "3"]}]}], ",", " ", 
   SubscriptBox["\[Theta]", "3"]}], "]"}]], "Input",
 CellChangeTimes->{{3.395729141970002*^9, 3.395729214835763*^9}}],

Cell[BoxData[
 RowBox[{"monic", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     SubscriptBox["\"\<\[Theta]\>\"", "1"]}], "+", 
    RowBox[{"x", " ", 
     SubscriptBox["\"\<\[Theta]\>\"", "2"]}]}], ",", 
   SubscriptBox["\"\<\[Theta]\>\"", "2"]}], "]"}]], "Input",
 CellChangeTimes->{{3.395729945925865*^9, 3.395729950164678*^9}}],

Cell[BoxData[
 RowBox[{"monic", "[", 
  RowBox[{
   RowBox[{"8", "x"}], ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.3847231624045*^9, 3.384723166576375*^9}, {
  3.385687343417625*^9, 3.385687353652*^9}}],

Cell[BoxData[
 RowBox[{"monic", "[", 
  RowBox[{"4", ",", "z"}], "]"}]], "Input",
 CellChangeTimes->{{3.390108562916375*^9, 3.39010859277575*^9}, {
  3.395313335998144*^9, 3.39531333834904*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Extended Euclidean Algorithm", "Subsection",
 CellChangeTimes->{{3.384715824201375*^9, 3.384715830138875*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ExtendedEuclidean", "[", 
   RowBox[{"a_", ",", "b_", ",", "c_", ",", "x_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"g", ",", "t", ",", "s", ",", "q", ",", "r", ",", "res"}], "}"}],
     ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"Reference", ":", " ", 
       RowBox[{"Symbolic", " ", "Integration"}]}], ",", " ", "Bronstein", ",",
       " ", 
      RowBox[{"p", ".14"}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
      "Given", " ", "a", " ", "Euclidean", " ", "domain", " ", "D", " ", 
       "and", " ", "a"}], ",", "b", ",", 
      RowBox[{"c", " ", "in", " ", "D", " ", "with", " ", "c", " ", "in", " ", 
       RowBox[{"(", 
        RowBox[{"a", ",", "b"}], ")"}]}], ",", " ", 
      RowBox[{"return", "\[IndentingNewLine]", "s"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{
        "t", " ", "in", " ", "D", " ", "such", " ", "that", " ", "s", "*", 
         "a"}], " ", "+", " ", 
        RowBox[{"t", "*", "b"}]}], " ", "=", " ", "c"}]}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"RischTrace", "[", 
      RowBox[{"ExtendedEuclidean", ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", "b", ",", "c", ",", "x"}], "}"}], ",", 
       "\"\<In\>\""}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"g", ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "s"}], "}"}]}], "}"}], "=", 
      RowBox[{"PolynomialExtendedGCD", "[", 
       RowBox[{"a", ",", "b", ",", "x"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"q", "=", 
      RowBox[{"PolynomialQuotient", "[", 
       RowBox[{"c", ",", "g", ",", "x"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"t", ",", "s"}], "}"}], "=", 
      RowBox[{"q", "*", 
       RowBox[{"{", 
        RowBox[{"t", ",", "s"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"q", ",", "r"}], "}"}], "=", 
      RowBox[{"PolynomialQuotientRemainder", "[", 
       RowBox[{"t", ",", "b", ",", "x"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{"{", 
       RowBox[{"r", ",", 
        RowBox[{"Together", "[", 
         RowBox[{"s", "+", 
          RowBox[{"q", "*", "a"}]}], "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"RischTrace", "[", 
      RowBox[{"ExtendedEuclidean", ",", "res", ",", "\"\<Out\>\""}], "]"}], 
     ";", "\[IndentingNewLine]", "res"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.384715986842*^9, 3.38471599031075*^9}, {
  3.384716028717*^9, 3.38471605512325*^9}, {3.390858439278*^9, 
  3.3908585528405*^9}, {3.3953217881028833`*^9, 3.395321793053418*^9}, {
  3.395564930131144*^9, 3.395564934959487*^9}, {3.404957175758894*^9, 
  3.404957253228319*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Squarefree Factorization", "Subsection",
 CellChangeTimes->{{3.3847151592795*^9, 3.38471516612325*^9}, {
  3.404955880032093*^9, 3.4049558814298763`*^9}}],

Cell["p. 29, Bronstein, Symbolic Integration 1", "Text"],

Cell[TextData[{
 "Given a unique factorization domain ",
 StyleBox["D",
  FontSlant->"Italic"],
 " of characteristic 0 and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"A", "\[Element]", 
     RowBox[{"D", "[", "x", "]"}]}], ","}], TraditionalForm]]],
 " return ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["A", "1"], ",", 
    SubscriptBox["A", "2"], ",", "\[CenterEllipsis]", ",", 
    RowBox[{
     SubscriptBox["A", "m"], "\[Element]", 
     RowBox[{"D", "[", "x", "]"}]}]}], TraditionalForm]]],
 " such that ",
 Cell[BoxData[
  FormBox[
   RowBox[{"A", "=", 
    RowBox[{
     UnderoverscriptBox["\[Product]", 
      RowBox[{"k", "=", "1"}], "m"], 
     SuperscriptBox[
      SubscriptBox["A", "k"], "k"]}]}], TraditionalForm]]],
 " is a squarefree factorization of ",
 StyleBox["A",
  FontSlant->"Italic"],
 ". ",
 Cell[BoxData[
  FormBox[Cell[""], TraditionalForm]]]
}], "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Squarefree", "[", 
   RowBox[{"a_", ",", "var_"}], "]"}], ":=", 
  RowBox[{"Catch", "[", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"A", "=", "a"}], ",", "c", ",", "S", ",", "Sstar", ",", "Sneg",
        ",", 
       RowBox[{"k", "=", "1"}], ",", "Y"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Reference", ":", " ", 
        RowBox[{"Symbolic", " ", "Integration"}]}], ",", " ", "Bronstein", 
       ",", " ", 
       RowBox[{"p", ".29"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "Given", " ", "a", " ", "unique", " ", "factorisation", " ", "domain", 
        " ", "D", " ", "of", " ", "characteristic", " ", "0", " ", "and", " ",
         "A", " ", "in", " ", 
        RowBox[{"D", "[", "x", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"return", " ", "A_", "1"}], ",", "...", ",", 
       RowBox[{
        RowBox[{"A_m", " ", "in", " ", 
         RowBox[{"D", "[", "x", "]"}], " ", "such", " ", "that", " ", "A"}], 
        " ", "=", " ", 
        RowBox[{
         RowBox[{"Product", "[", 
          RowBox[{
           RowBox[{"A_", 
            RowBox[{
             RowBox[{"{", "k", "}"}], "^", "k"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "1", ",", "m"}], "}"}]}], "]"}], " ", "is", " ",
          "a", " ", "\[IndentingNewLine]", "squarefree", " ", "factorisation",
          " ", "of", " ", 
         RowBox[{"A", "."}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"RischTrace", "[", 
       RowBox[{"Squarefree", ",", 
        RowBox[{"{", 
         RowBox[{"a", ",", "var"}], "}"}], ",", "\"\<In\>\""}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"PolynomialGCD", "@@", 
        RowBox[{"CoefficientList", "[", 
         RowBox[{"A", ",", "var"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"S", "=", 
       RowBox[{"Cancel", "[", 
        RowBox[{"A", "/", "c"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Sneg", "=", 
       RowBox[{"PolynomialGCD", "[", 
        RowBox[{"S", ",", 
         RowBox[{"D", "[", 
          RowBox[{"S", ",", "var"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Sstar", "=", 
       RowBox[{"Cancel", "[", 
        RowBox[{"S", "/", "Sneg"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"SameQ", "[", 
         RowBox[{
          RowBox[{"Exponent", "[", 
           RowBox[{"Sneg", ",", "var"}], "]"}], ",", "0"}], "]"}], ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"RischTrace", "[", 
          RowBox[{"Squarefree", ",", "A", ",", "\"\<Out\>\""}], "]"}], ";", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{"Throw", "[", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"A", ",", "1"}], "}"}], "}"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"A", "=", 
       RowBox[{
        RowBox[{"Reap", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Exponent", "[", 
              RowBox[{"Sneg", ",", "var"}], "]"}], ">", "0"}], ",", 
            "\[IndentingNewLine]", "\t", 
            RowBox[{
             RowBox[{"Y", "=", 
              RowBox[{"Expand", "[", 
               RowBox[{"PolynomialGCD", "[", 
                RowBox[{"Sstar", ",", "Sneg"}], "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"A", "=", 
              RowBox[{"Sow", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Cancel", "[", 
                  RowBox[{"Sstar", "/", "Y"}], "]"}], ",", "k"}], "}"}], 
               "]"}]}], ";", "\[IndentingNewLine]", "\t", 
             RowBox[{"Sstar", "=", "Y"}], ";", "\[IndentingNewLine]", "\t", 
             RowBox[{"Sneg", "=", 
              RowBox[{"Cancel", "[", 
               RowBox[{"Sneg", "/", "Y"}], "]"}]}], ";", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"k", "++"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"k", ">", "1"}], ",", 
            RowBox[{"Sow", "[", 
             RowBox[{"{", 
              RowBox[{"Sstar", ",", "k"}], "}"}], "]"}]}], "]"}]}], 
         "\[IndentingNewLine]", "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"A", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"c", " ", "Sneg", " ", 
          RowBox[{"A", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", "1"}], "}"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"RischTrace", "[", 
       RowBox[{"Squarefree", ",", "A", ",", "\"\<Out\>\""}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Throw", "[", "A", "]"}]}]}], "\[IndentingNewLine]", "]"}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.384715281638875*^9, 3.38471530081075*^9}, {
   3.38471553712325*^9, 3.384715542013875*^9}, {3.38471565087325*^9, 
   3.38471569787325*^9}, {3.384715994826375*^9, 3.38471599699825*^9}, {
   3.384716133201375*^9, 3.38471619256075*^9}, {3.3847214736545*^9, 
   3.384721495638875*^9}, {3.3854893721055*^9, 3.385489532933625*^9}, {
   3.385489583902375*^9, 3.385489588793*^9}, {3.385490415589875*^9, 
   3.38549044513675*^9}, 3.385501734275625*^9, {3.38550179785375*^9, 
   3.38550181701*^9}, {3.385501858338125*^9, 3.385501859588125*^9}, {
   3.385792039205517*^9, 3.3857920699897823`*^9}, {3.3857926434944415`*^9, 
   3.385792669321579*^9}, {3.38734063507425*^9, 3.387340653043*^9}, {
   3.39010741002575*^9, 3.3901074106195*^9}, {3.390858581653*^9, 
   3.390858615887375*^9}, {3.39085869218425*^9, 3.39085879124675*^9}, {
   3.395321919966264*^9, 3.395321939451125*^9}, {3.395321972409284*^9, 
   3.395322059782958*^9}, 3.3953221065637493`*^9, {3.395322174534997*^9, 
   3.3953221875421667`*^9}, {3.395322425584659*^9, 3.395322446413911*^9}, {
   3.3953224862389307`*^9, 3.395322494311808*^9}, {3.395322558894761*^9, 
   3.395322685656686*^9}, {3.395322738933916*^9, 3.3953227487092113`*^9}, {
   3.404957391924583*^9, 3.404957451419488*^9}, 3.404985032422914*^9, {
   3.405145522279339*^9, 3.405145526782699*^9}, {3.407452561887205*^9, 
   3.4074525739305353`*^9}, {3.407453155686369*^9, 3.407453161182083*^9}, {
   3.4079651222054977`*^9, 3.407965143810627*^9}, {3.409901612892117*^9, 
   3.4099017124625597`*^9}, {3.4099017640587177`*^9, 3.409901765382378*^9}, {
   3.409908971496375*^9, 3.40990897279186*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Squarefree", "[", 
   RowBox[{"a_", ",", "var_"}], "]"}], ":=", 
  RowBox[{"Catch", "[", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"A", "=", "a"}], ",", "c", ",", "S", ",", "Sstar", ",", "Sneg",
        ",", 
       RowBox[{"k", "=", "1"}], ",", "Y"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Reference", ":", " ", 
        RowBox[{"Symbolic", " ", "Integration"}]}], ",", " ", "Bronstein", 
       ",", " ", 
       RowBox[{"p", ".29"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "Given", " ", "a", " ", "unique", " ", "factorisation", " ", "domain", 
        " ", "D", " ", "of", " ", "characteristic", " ", "0", " ", "and", " ",
         "A", " ", "in", " ", 
        RowBox[{"D", "[", "x", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"return", " ", "A_", "1"}], ",", "...", ",", 
       RowBox[{
        RowBox[{"A_m", " ", "in", " ", 
         RowBox[{"D", "[", "x", "]"}], " ", "such", " ", "that", " ", "A"}], 
        " ", "=", " ", 
        RowBox[{
         RowBox[{"Product", "[", 
          RowBox[{
           RowBox[{"A_", 
            RowBox[{
             RowBox[{"{", "k", "}"}], "^", "k"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "1", ",", "m"}], "}"}]}], "]"}], " ", "is", " ",
          "a", " ", "\[IndentingNewLine]", "squarefree", " ", "factorisation",
          " ", "of", " ", 
         RowBox[{"A", "."}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"RischTrace", "[", 
       RowBox[{"Squarefree", ",", 
        RowBox[{"{", 
         RowBox[{"a", ",", "var"}], "}"}], ",", "\"\<In\>\""}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"PolynomialGCD", "@@", 
        RowBox[{"CoefficientList", "[", 
         RowBox[{"A", ",", "var"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"S", "=", 
       RowBox[{"Cancel", "[", 
        FractionBox["A", "c"], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Sneg", "=", 
       RowBox[{"PolynomialGCD", "[", 
        RowBox[{"S", ",", 
         RowBox[{"D", "[", 
          RowBox[{"S", ",", "var"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Sstar", "=", 
       RowBox[{"Cancel", "[", 
        RowBox[{"S", "/", "Sneg"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"SameQ", "[", 
         RowBox[{
          RowBox[{"Exponent", "[", 
           RowBox[{"Sneg", ",", "var"}], "]"}], ",", "0"}], "]"}], ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"RischTrace", "[", 
          RowBox[{"Squarefree", ",", "A", ",", "\"\<Out\>\""}], "]"}], ";", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{"Throw", "[", "A", "]"}]}]}], "\[IndentingNewLine]", "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"A", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Reap", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"While", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Exponent", "[", 
               RowBox[{"Sneg", ",", "var"}], "]"}], ">", "0"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{
              RowBox[{"Y", "=", 
               RowBox[{"Expand", "[", 
                RowBox[{"PolynomialGCD", "[", 
                 RowBox[{"Sstar", ",", "Sneg"}], "]"}], "]"}]}], ";", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"A", "=", 
               RowBox[{"Sow", "[", 
                RowBox[{"Cancel", "[", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"Sstar", "/", "Y"}], ")"}], "^", "k"}], "]"}], 
                "]"}]}], ";", "\[IndentingNewLine]", "\t", 
              RowBox[{"Sstar", "=", "Y"}], ";", "\[IndentingNewLine]", "\t", 
              RowBox[{"Sneg", "=", 
               RowBox[{"Cancel", "[", 
                RowBox[{"Sneg", "/", "Y"}], "]"}]}], ";", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"k", "++"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"k", ">", "1"}], ",", 
             RowBox[{"Sow", "[", 
              SuperscriptBox["Sstar", "k"], "]"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}], "//", "Flatten"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"A", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "=", 
       RowBox[{"c", " ", "Sneg", " ", 
        RowBox[{"First", "[", "A", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"RischTrace", "[", 
       RowBox[{"Squarefree", ",", "A", ",", "\"\<Out\>\""}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Throw", "[", "A", "]"}]}]}], "\[IndentingNewLine]", "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.384715281638875*^9, 3.38471530081075*^9}, {
   3.38471553712325*^9, 3.384715542013875*^9}, {3.38471565087325*^9, 
   3.38471569787325*^9}, {3.384715994826375*^9, 3.38471599699825*^9}, {
   3.384716133201375*^9, 3.38471619256075*^9}, {3.3847214736545*^9, 
   3.384721495638875*^9}, {3.3854893721055*^9, 3.385489532933625*^9}, {
   3.385489583902375*^9, 3.385489588793*^9}, {3.385490415589875*^9, 
   3.38549044513675*^9}, 3.385501734275625*^9, {3.38550179785375*^9, 
   3.38550181701*^9}, {3.385501858338125*^9, 3.385501859588125*^9}, {
   3.385792039205517*^9, 3.3857920699897823`*^9}, {3.3857926434944415`*^9, 
   3.385792669321579*^9}, {3.38734063507425*^9, 3.387340653043*^9}, {
   3.39010741002575*^9, 3.3901074106195*^9}, {3.390858581653*^9, 
   3.390858615887375*^9}, {3.39085869218425*^9, 3.39085879124675*^9}, {
   3.395321919966264*^9, 3.395321939451125*^9}, {3.395321972409284*^9, 
   3.395322059782958*^9}, 3.3953221065637493`*^9, {3.395322174534997*^9, 
   3.3953221875421667`*^9}, {3.395322425584659*^9, 3.395322446413911*^9}, {
   3.3953224862389307`*^9, 3.395322494311808*^9}, {3.395322558894761*^9, 
   3.395322685656686*^9}, {3.395322738933916*^9, 3.3953227487092113`*^9}, {
   3.404957391924583*^9, 3.404957451419488*^9}, 3.404985032422914*^9, {
   3.405145522279339*^9, 3.405145526782699*^9}, {3.407452561887205*^9, 
   3.4074525739305353`*^9}, {3.407453155686369*^9, 3.407453161182083*^9}, {
   3.4079651222054977`*^9, 3.407965143810627*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Squarefree", "[", 
  RowBox[{
   RowBox[{
    SuperscriptBox["x", "8"], "+", 
    RowBox[{"6", " ", 
     SuperscriptBox["x", "6"]}], "+", 
    RowBox[{"12", " ", 
     SuperscriptBox["x", "4"]}], "+", 
    RowBox[{"8", " ", 
     SuperscriptBox["x", "2"]}]}], ",", "x"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", 
   SuperscriptBox["x", "2"], ",", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"2", "+", 
      SuperscriptBox["x", "2"]}], ")"}], "3"]}], "}"}]], "Output",
 CellChangeTimes->{{3.404957318887841*^9, 3.404957356689474*^9}, 
   3.404957453470386*^9, {3.404985029517766*^9, 3.404985034769944*^9}, 
   3.407452579766286*^9, 3.407453162876808*^9, 3.4079651512746153`*^9, {
   3.409901671799673*^9, 3.409901713986224*^9}, 3.409901767389038*^9, 
   3.409906971850707*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Squarefree", "[", 
  RowBox[{
   RowBox[{"432", "+", 
    RowBox[{"1944", " ", "x"}], "+", 
    RowBox[{"3708", " ", 
     SuperscriptBox["x", "2"]}], "+", 
    RowBox[{"3922", " ", 
     SuperscriptBox["x", "3"]}], "+", 
    RowBox[{"2522", " ", 
     SuperscriptBox["x", "4"]}], "+", 
    RowBox[{"1012", " ", 
     SuperscriptBox["x", "5"]}], "+", 
    RowBox[{"248", " ", 
     SuperscriptBox["x", "6"]}], "+", 
    RowBox[{"34", " ", 
     SuperscriptBox["x", "7"]}], "+", 
    RowBox[{"2", " ", 
     SuperscriptBox["x", "8"]}]}], ",", "x"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"1", "+", "x"}], ")"}], "2"], ",", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"6", "+", 
      RowBox[{"5", " ", "x"}], "+", 
      SuperscriptBox["x", "2"]}], ")"}], "3"]}], "}"}]], "Output",
 CellChangeTimes->{3.404985036555215*^9, 3.407452580526791*^9, 
  3.407453163901731*^9, 3.4079651517236023`*^9, 3.40990171483887*^9, 
  3.40990176826963*^9, 3.409906972317342*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Squarefree", "[", 
  RowBox[{
   SuperscriptBox["x", "4"], ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.3855018220725*^9, 3.385501829713125*^9}, {
  3.407452585464254*^9, 3.4074525926689997`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "1", ",", "1", ",", 
   SuperscriptBox["x", "4"]}], "}"}]], "Output",
 CellChangeTimes->{
  3.404985037382985*^9, {3.4074525886724453`*^9, 3.407452593416493*^9}, 
   3.407453164335413*^9, 3.407965152057248*^9, 3.409901717455308*^9, 
   3.40990176861884*^9, 3.409906973086507*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["SubResultant", "Subsection"],

Cell["p. 24, Bronstein, Symbolic Integration 1", "Text"],

Cell[TextData[{
 "Given an integral domain ",
 StyleBox["D",
  FontSlant->"Italic"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"A", ",", 
    RowBox[{"B", "\[Element]", 
     RowBox[{"D", "[", "x", "]"}]}]}], TraditionalForm]]],
 " with ",
 Cell[BoxData[
  FormBox[
   RowBox[{"B", "\[NotEqual]", "0"}], TraditionalForm]]],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"deg", "(", "A", ")"}], "\[GreaterEqual]", 
     RowBox[{"deg", "(", "B", ")"}]}], ","}], TraditionalForm]]],
 " return ",
 Cell[BoxData[
  FormBox[
   RowBox[{"resultant", "(", 
    RowBox[{"A", ",", "B"}], ")"}], TraditionalForm]]],
 " and the subresultant PRS ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{
     SubscriptBox["R", "0"], ",", 
     SubscriptBox["R", "0"], ",", "\[CenterEllipsis]", ",", 
     SubscriptBox["R", "k"], ",", "0"}], ")"}], TraditionalForm]]],
 " of ",
 StyleBox["A",
  FontSlant->"Italic"],
 " and ",
 StyleBox["B",
  FontSlant->"Italic"],
 "."
}], "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SubResultant", "[", 
   RowBox[{"a_", ",", "b_", ",", "var_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"A", "=", "a"}], ",", 
      RowBox[{"B", "=", "b"}], ",", 
      RowBox[{"x", "=", "var"}], ",", "R", ",", "i", ",", "gamma", ",", 
      "delta", ",", "beta", ",", "rnew", ",", "r", ",", "Q", ",", "c", ",", 
      "s", ",", "ply", ",", "Rem", ",", "k", ",", "res"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"RischTrace", "[", 
      RowBox[{"SubResultant", ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", "b", ",", "var"}], "}"}], ",", "\"\<In\>\""}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Reference", ":", " ", 
        RowBox[{"Symbolic", " ", "Integration"}]}], ",", " ", "Bronstein", 
       ",", " ", 
       RowBox[{"p", ".24"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "Given", " ", "an", " ", "integral", " ", "domain", " ", "D", " ", 
        "and", " ", "A"}], ",", 
       RowBox[{
        RowBox[{"B", " ", "in", " ", 
         RowBox[{"D", "[", "x", "]"}], " ", "with", " ", "B"}], " ", "!=", 
        " ", 
        RowBox[{"0", " ", "and", " ", "deg", 
         RowBox[{"(", "A", ")"}]}], " ", ">=", " ", 
        RowBox[{"deg", 
         RowBox[{"(", "B", ")"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"return", " ", "resultant", 
        RowBox[{"(", 
         RowBox[{"A", ",", "B"}], ")"}], " ", "and", " ", "the", " ", 
        "subresultant", " ", "polynomial", " ", "remainder", " ", "sequence", 
        " ", "of", " ", "A", " ", "and", " ", 
        RowBox[{"B", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"R", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", "A", "}"}], ",", 
        RowBox[{"{", "B", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"i", "=", "2"}], ";", "\[IndentingNewLine]", 
     RowBox[{"gamma", "=", 
      RowBox[{"{", 
       RowBox[{"-", "1"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"delta", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Exponent", "[", 
         RowBox[{"A", ",", "x"}], "]"}], "-", 
        RowBox[{"Exponent", "[", 
         RowBox[{"B", ",", "x"}], "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"beta", "=", 
      RowBox[{"{", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}], 
        RowBox[{"delta", "+", "1"}]], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"r", "=", 
      RowBox[{"{", 
       RowBox[{"lc", "[", 
        RowBox[{
         RowBox[{"R", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", "x"}], "]"}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Not", "[", 
         RowBox[{"SameQ", "[", 
          RowBox[{
           RowBox[{"R", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", "0"}], "]"}], "]"}], "&&", 
        RowBox[{"i", "<", "10"}]}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"AppendTo", "[", 
         RowBox[{"r", ",", 
          RowBox[{"lc", "[", 
           RowBox[{
            RowBox[{"R", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", "x"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"Rem", "=", 
         RowBox[{"Last", "[", 
          RowBox[{"PolyPseudoDivide", "[", 
           RowBox[{
            RowBox[{"R", "[", 
             RowBox[{"[", 
              RowBox[{"i", "-", "1"}], "]"}], "]"}], ",", 
            RowBox[{"R", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", "x"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"R", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{"Join", "[", 
           RowBox[{"R", ",", "  ", 
            RowBox[{"{", 
             RowBox[{"Cancel", "[", 
              RowBox[{"Rem", "/", 
               RowBox[{"beta", "[", 
                RowBox[{"[", 
                 RowBox[{"i", "-", "1"}], "]"}], "]"}]}], "]"}], "}"}]}], 
           "   ", "]"}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"R", "[", 
            RowBox[{"[", 
             RowBox[{"i", "+", "1"}], "]"}], "]"}], "\[Equal]", "0"}], ",", 
          RowBox[{"Break", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        "\t", 
        RowBox[{"i", "=", 
         RowBox[{"i", "+", "1"}]}], ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"gamma", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{"Join", "[", 
           RowBox[{"gamma", ",", 
            RowBox[{"{", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"-", 
                 RowBox[{"r", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", "-", "1"}], "]"}], "]"}]}], ")"}], 
               RowBox[{"delta", "[", 
                RowBox[{"[", 
                 RowBox[{"i", "-", "2"}], "]"}], "]"}]], " ", 
              SuperscriptBox[
               RowBox[{"gamma", "[", 
                RowBox[{"[", 
                 RowBox[{"i", "-", "2"}], "]"}], "]"}], 
               RowBox[{"1", "-", 
                RowBox[{"delta", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", "-", "2"}], "]"}], "]"}]}]]}], "}"}]}], "]"}], 
          "]"}]}], ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"delta", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{"Join", "[", 
           RowBox[{"delta", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Exponent", "[", 
               RowBox[{
                RowBox[{"R", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", "-", "1"}], "]"}], "]"}], ",", "x"}], "]"}], 
              "-", 
              RowBox[{"Exponent", "[", 
               RowBox[{
                RowBox[{"R", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", "x"}], "]"}]}], "}"}]}],
            "]"}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"beta", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{"Join", "[", 
           RowBox[{"beta", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"r", "[", 
                RowBox[{"[", 
                 RowBox[{"i", "-", "1"}], "]"}], "]"}]}], " ", 
              SuperscriptBox[
               RowBox[{"gamma", "[", 
                RowBox[{"[", 
                 RowBox[{"i", "-", "1"}], "]"}], "]"}], 
               RowBox[{"delta", "[", 
                RowBox[{"[", 
                 RowBox[{"i", "-", "1"}], "]"}], "]"}]]}], "}"}]}], "]"}], 
          "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"k", "=", 
      RowBox[{"i", "-", "1"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Exponent", "[", 
         RowBox[{
          RowBox[{"R", "[", 
           RowBox[{"[", 
            RowBox[{"k", "+", "1"}], "]"}], "]"}], ",", "x"}], "]"}], ">", 
        "0"}], ",", 
       RowBox[{"Return", "[", " ", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", "0", "}"}], ",", "R"}], "]"}], " ", "]"}]}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Exponent", "[", 
         RowBox[{
          RowBox[{"R", "[", 
           RowBox[{"[", "k", "]"}], "]"}], ",", "x"}], "]"}], "==", "1"}], 
       ",", 
       RowBox[{"Return", "[", " ", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"R", "[", 
            RowBox[{"[", "k", "]"}], "]"}], "}"}], ",", "R"}], "]"}], " ", 
        "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"s", "=", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"c", "=", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"OddQ", "[", 
            RowBox[{"Exponent", "[", 
             RowBox[{
              RowBox[{"R", "[", 
               RowBox[{"[", "j", "]"}], "]"}], ",", "x"}], "]"}], "]"}], "&&", 
           RowBox[{"OddQ", "[", 
            RowBox[{"Exponent", "[", 
             RowBox[{
              RowBox[{"R", "[", 
               RowBox[{"[", 
                RowBox[{"j", "+", "1"}], "]"}], "]"}], ",", "x"}], "]"}], 
            "]"}]}], ",", "\[IndentingNewLine]", "\t\t", 
          RowBox[{
           RowBox[{"s", "=", 
            RowBox[{"-", "s"}]}], ";"}]}], "\[IndentingNewLine]", "\t", "]"}],
         ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"c", "=", 
         RowBox[{"c", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"beta", "[", 
              RowBox[{"[", "j", "]"}], "]"}], "/", 
             SuperscriptBox[
              RowBox[{"r", "[", 
               RowBox[{"[", "j", "]"}], "]"}], 
              RowBox[{"1", "+", 
               RowBox[{"delta", "[", 
                RowBox[{"[", "j", "]"}], "]"}]}]]}], ")"}], 
           RowBox[{"Exponent", "[", 
            RowBox[{
             RowBox[{"R", "[", 
              RowBox[{"[", 
               RowBox[{"j", "+", "1"}], "]"}], "]"}], ",", "x"}], "]"}]], " ", 
          SuperscriptBox[
           RowBox[{"r", "[", 
            RowBox[{"[", "j", "]"}], "]"}], 
           RowBox[{
            RowBox[{"Exponent", "[", 
             RowBox[{
              RowBox[{"R", "[", 
               RowBox[{"[", "j", "]"}], "]"}], ",", "x"}], "]"}], "-", 
            RowBox[{"Exponent", "[", 
             RowBox[{
              RowBox[{"R", "[", 
               RowBox[{"[", 
                RowBox[{"j", "+", "2"}], "]"}], "]"}], ",", "x"}], 
             "]"}]}]]}]}], ";"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"k", "-", "1"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"s", " ", "c", " ", 
          SuperscriptBox[
           RowBox[{"R", "[", 
            RowBox[{"[", 
             RowBox[{"k", "+", "1"}], "]"}], "]"}], 
           RowBox[{"Exponent", "[", 
            RowBox[{
             RowBox[{"R", "[", 
              RowBox[{"[", "k", "]"}], "]"}], ",", "x"}], "]"}]]}], "}"}], 
        ",", "R"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"RischTrace", "[", 
      RowBox[{"SubResultant", ",", "res", ",", "\"\<Out\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", "res"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.385687874105125*^9, 3.3856878948395*^9}, {
   3.3856879328395*^9, 3.385687955402*^9}, {3.385688002230125*^9, 
   3.385688013042625*^9}, {3.38568976812075*^9, 3.385689808730125*^9}, {
   3.385689896105125*^9, 3.385689904402*^9}, {3.385689934573875*^9, 
   3.385689934980125*^9}, 3.3856915185895*^9, {3.3902518820932503`*^9, 
   3.3902518997182503`*^9}, {3.3902519391401253`*^9, 
   3.3902519394526253`*^9}, {3.3906267263125*^9, 3.390626733515625*^9}, {
   3.39062712634375*^9, 3.390627126484375*^9}, {3.3908588677155*^9, 
   3.390858945574875*^9}, {3.395565176788834*^9, 3.395565181774014*^9}, {
   3.4049574722148247`*^9, 3.4049575611790857`*^9}, {3.404981881058457*^9, 
   3.40498189670776*^9}, {3.404982103585496*^9, 3.404982149999165*^9}, {
   3.404982187446718*^9, 3.404982281788526*^9}, {3.40498239204268*^9, 
   3.404982395891891*^9}, {3.404982440462634*^9, 3.404982462149164*^9}, {
   3.404982531547909*^9, 3.404982594312502*^9}, {3.404982634855722*^9, 
   3.404982659152698*^9}, {3.404983221527664*^9, 3.404983250794862*^9}, {
   3.40498332995693*^9, 3.4049833313823223`*^9}, {3.4049834255217743`*^9, 
   3.4049834944019833`*^9}, {3.404983566080611*^9, 3.404983757390552*^9}, {
   3.40498378835297*^9, 3.4049838394674883`*^9}, {3.4049838831477623`*^9, 
   3.404984012320216*^9}}],

Cell[CellGroupData[{

Cell["Examples", "Subsubsection",
 CellChangeTimes->{3.38575225677925*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SubResultant", "[", 
  RowBox[{
   RowBox[{
    SuperscriptBox["x", "2"], "+", "1"}], ",", 
   RowBox[{
    SuperscriptBox["x", "2"], "-", "1"}], ",", "x"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"4", ",", 
   RowBox[{"1", "+", 
    SuperscriptBox["x", "2"]}], ",", 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    SuperscriptBox["x", "2"]}], ",", 
   RowBox[{"-", "2"}], ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.404981884610467*^9, 3.404981899074726*^9}, 
   3.404982212311849*^9, 3.404982505780175*^9, 3.404982847260392*^9, 
   3.404983245714595*^9, {3.404983435755952*^9, 3.404983497401301*^9}, 
   3.40498354837516*^9, 3.40498358086477*^9, {3.4049836114128323`*^9, 
   3.4049836663400297`*^9}, {3.404983700841042*^9, 3.404983762092354*^9}, 
   3.404983797465444*^9, {3.4049838288916492`*^9, 3.4049838420624743`*^9}, 
   3.4049838978736353`*^9, {3.4049839792058783`*^9, 3.404983994999605*^9}, {
   3.4049842539572687`*^9, 3.404984256452005*^9}, 3.4074532824425507`*^9, 
   3.40747216564361*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Resultant", "[", 
  RowBox[{
   RowBox[{
    SuperscriptBox["x", "2"], "+", "1"}], ",", 
   RowBox[{
    SuperscriptBox["x", "2"], "-", "1"}], ",", "x"}], "]"}]], "Input"],

Cell[BoxData["4"], "Output",
 CellChangeTimes->{3.404981900340516*^9, 3.407453283102867*^9, 
  3.407472166275238*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SubResultant", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"3", " ", "t", " ", 
     SuperscriptBox["x", "2"]}], "-", 
    SuperscriptBox["t", "3"], "-", "4"}], ",", 
   RowBox[{
    SuperscriptBox["x", "2"], "+", 
    RowBox[{
     SuperscriptBox["t", "3"], " ", "x"}], "-", "9"}], ",", "x"}], 
  "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"4", "-", 
    RowBox[{"27", " ", "t"}], "+", 
    SuperscriptBox["t", "3"], "+", 
    RowBox[{"3", " ", 
     SuperscriptBox["t", "4"], " ", "x"}]}], ",", 
   RowBox[{
    RowBox[{"-", "4"}], "-", 
    SuperscriptBox["t", "3"], "+", 
    RowBox[{"3", " ", "t", " ", 
     SuperscriptBox["x", "2"]}]}], ",", 
   RowBox[{
    RowBox[{"-", "9"}], "+", 
    RowBox[{
     SuperscriptBox["t", "3"], " ", "x"}], "+", 
    SuperscriptBox["x", "2"]}], ",", 
   RowBox[{"4", "-", 
    RowBox[{"27", " ", "t"}], "+", 
    SuperscriptBox["t", "3"], "+", 
    RowBox[{"3", " ", 
     SuperscriptBox["t", "4"], " ", "x"}]}], ",", 
   RowBox[{"16", "-", 
    RowBox[{"216", " ", "t"}], "+", 
    RowBox[{"729", " ", 
     SuperscriptBox["t", "2"]}], "+", 
    RowBox[{"8", " ", 
     SuperscriptBox["t", "3"]}], "-", 
    RowBox[{"54", " ", 
     SuperscriptBox["t", "4"]}], "+", 
    SuperscriptBox["t", "6"], "-", 
    RowBox[{"12", " ", 
     SuperscriptBox["t", "7"]}], "-", 
    RowBox[{"3", " ", 
     SuperscriptBox["t", "10"]}]}], ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{3.404981903158992*^9, 3.407472166796618*^9}]
}, Open  ]],

Cell["Both these results agree with Bronstein p. 25.", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"a", "=", 
   RowBox[{"1", "+", 
    RowBox[{"4", " ", "x"}], "-", 
    RowBox[{
     SqrtBox["2"], " ", "x"}], "-", 
    RowBox[{
     SqrtBox["3"], " ", "x"}], "+", 
    RowBox[{"9", " ", 
     SuperscriptBox["x", "2"]}], "+", 
    RowBox[{"2", " ", 
     SqrtBox["2"], " ", 
     SuperscriptBox["x", "2"]}], "+", 
    RowBox[{
     SqrtBox["3"], " ", 
     SuperscriptBox["x", "2"]}], "-", 
    RowBox[{
     SqrtBox["2"], " ", 
     SuperscriptBox["x", "3"]}], "-", 
    RowBox[{"3", " ", 
     SqrtBox["3"], " ", 
     SuperscriptBox["x", "3"]}], "+", 
    RowBox[{"2", " ", 
     SqrtBox["2"], " ", 
     SuperscriptBox["x", "4"]}], "+", 
    RowBox[{"3", " ", 
     SqrtBox["3"], " ", 
     SuperscriptBox["x", "4"]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SqrtBox["3"], "-", "x", "+", 
      SuperscriptBox["x", "2"]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      SqrtBox["2"], "+", "x", "+", 
      SuperscriptBox["x", "3"]}], ")"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.3902517600151253`*^9, 3.3902517663276253`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SubResultant", "[", 
    RowBox[{
     RowBox[{"a", "-", 
      RowBox[{"z", " ", 
       RowBox[{"D", "[", 
        RowBox[{"b", ",", "x"}], "]"}]}]}], ",", "b", ",", "x"}], "]"}], "//",
    "Timing"}], "//", "First"}]], "Input",
 CellChangeTimes->{{3.3902517687026253`*^9, 3.3902517837807503`*^9}, {
  3.3902518190776253`*^9, 3.3902518262026253`*^9}, {3.3902519139838753`*^9, 
  3.3902519175932503`*^9}, {3.3902522063432503`*^9, 3.3902522704995003`*^9}, {
  3.390626694953125*^9, 3.39062669553125*^9}, {3.390627137375*^9, 
  3.390627175546875*^9}, {3.404981926258707*^9, 3.404981935966601*^9}}],

Cell[BoxData["2.239681`"], "Output",
 CellChangeTimes->{{3.40498193014557*^9, 3.404981939018998*^9}, 
   3.404982071117889*^9, 3.404982723994244*^9, {3.404984003192453*^9, 
   3.404984018984487*^9}, {3.40498430972497*^9, 3.404984316932993*^9}, 
   3.407453221719799*^9, 3.407472174134437*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"a1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "19"}], " ", 
     RowBox[{"x", "^", "6"}]}], "+", 
    RowBox[{"2", " ", 
     RowBox[{"x", "^", "5"}]}], "-", 
    RowBox[{"15", " ", 
     RowBox[{"x", "^", "3"}]}], "-", 
    RowBox[{"14", " ", 
     RowBox[{"x", "^", "2"}]}], "+", "7"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "10"}], " ", 
     RowBox[{"x", "^", "18"}]}], "+", 
    RowBox[{"5", " ", 
     RowBox[{"x", "^", "17"}]}], "-", 
    RowBox[{"8", " ", 
     RowBox[{"x", "^", "16"}]}], "-", 
    RowBox[{"18", " ", 
     RowBox[{"x", "^", "15"}]}], "-", 
    RowBox[{"x", "^", "14"}], "+", 
    RowBox[{"7", " ", 
     RowBox[{"x", "^", "13"}]}], "-", 
    RowBox[{"11", " ", 
     RowBox[{"x", "^", "12"}]}], "-", 
    RowBox[{"10", " ", 
     RowBox[{"x", "^", "11"}]}], "+", 
    RowBox[{"14", " ", 
     RowBox[{"x", "^", "10"}]}], "+", 
    RowBox[{"19", " ", 
     RowBox[{"x", "^", "8"}]}], "+", 
    RowBox[{"18", " ", 
     RowBox[{"x", "^", "6"}]}], "+", 
    RowBox[{"16", " ", 
     RowBox[{"x", "^", "5"}]}], "-", 
    RowBox[{"8", " ", 
     RowBox[{"x", "^", "3"}]}], "-", 
    RowBox[{"19", " ", 
     RowBox[{"x", "^", "2"}]}], "-", 
    RowBox[{"17", " ", "x"}], "-", "16"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.4049831707547073`*^9, 3.404983184499024*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SubResultant", "[", 
    RowBox[{
     RowBox[{"a1", "-", 
      RowBox[{"z", " ", 
       RowBox[{"D", "[", 
        RowBox[{"b1", ",", "x"}], "]"}]}]}], ",", "b1", ",", "x"}], "]"}], "//",
    "Timing"}], "//", "First"}]], "Input",
 CellChangeTimes->{{3.4049832032401333`*^9, 3.404983206205735*^9}, {
  3.404984263161336*^9, 3.4049842835927067`*^9}, {3.407472187009609*^9, 
  3.407472188638445*^9}}],

Cell[BoxData["0.03381999999999996`"], "Output",
 CellChangeTimes->{{3.407472176997725*^9, 3.407472189263454*^9}}]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Total Derivative", "Subsection",
 CellChangeTimes->{{3.384715111451375*^9, 3.38471511974825*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Unprotect", "[", "Derivative", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Derivative", "[", "1", "]"}], "[", "rischExp", "]"}], "[", "f_", 
   "]"}], ":=", 
  RowBox[{"rischExp", "[", "f", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Derivative", "[", "1", "]"}], "[", "rischLog", "]"}], "[", "f_", 
   "]"}], ":=", 
  RowBox[{"1", "/", "f"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Protect", "[", "Derivative", "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.395202896988863*^9, 3.3952030339817944`*^9}, {
  3.409020317307907*^9, 3.409020321169367*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Unprotect", "[", "D", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"rischExp", "[", "f_", "]"}], ",", "x_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{"f", ",", "x"}], "]"}], 
   RowBox[{"rischExp", "[", "f", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"rischLog", "[", "f_", "]"}], ",", "x_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{"f", ",", "x"}], "]"}], "/", "f"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Protect", "[", "D", "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.3952021159799643`*^9, 3.3952021988619547`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"TotalDerivation", "[", 
   RowBox[{
    RowBox[{"a_", "+", "b_"}], ",", "intheta_", ",", "inDtower_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"TotalDerivation", "[", 
    RowBox[{"a", ",", "intheta", ",", "inDtower"}], "]"}], "+", 
   RowBox[{"TotalDerivation", "[", 
    RowBox[{"b", ",", "intheta", ",", "inDtower"}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.406195159193446*^9, 3.406195183768222*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"TotalDerivation", "[", 
   RowBox[{"fun_", ",", "intheta_", ",", "inDtower_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"theta", ",", "Dtower", ",", "result", ",", "kD"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"RischTrace", "[", 
      RowBox[{"TotalDerivation", ",", 
       RowBox[{"{", 
        RowBox[{"fun", ",", "intheta", ",", "inDtower"}], "}"}], ",", 
       "\"\<In\>\""}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Total", " ", "derivative", " ", "of", " ", "fun", " ", "wrt", " ", 
       "the", " ", "tower", " ", "of", " ", 
       RowBox[{"extensions", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "intheta", "]"}], "\[Equal]", "1"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"Rational", " ", "Case"}], " ", "*)"}], "\[IndentingNewLine]",
        "\t", 
       RowBox[{
        RowBox[{"result", "=", 
         RowBox[{"D", "[", 
          RowBox[{"fun", ",", 
           RowBox[{"First", "[", "intheta", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"RischTrace", "[", 
         RowBox[{"TotalDerivation", ",", "result", ",", "\"\<In\>\""}], "]"}],
         ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"Return", "[", "result", "]"}]}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Cull", " ", "the", " ", "extensions", " ", "if", " ", "appropriate"}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"theta", ",", "Dtower"}], "}"}], "=", 
      RowBox[{"UpdateExtensionField", "[", 
       RowBox[{"fun", ",", "intheta", ",", "inDtower"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"case", " ", "where", " ", "no", " ", "thetas", " ", "remain"}],
       " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "theta", "]"}], "\[Equal]", "1"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"result", "=", 
         RowBox[{"D", "[", 
          RowBox[{"fun", ",", 
           RowBox[{"First", "[", "theta", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"RischTrace", "[", 
         RowBox[{"TotalDerivation", ",", "result", ",", "\"\<In\>\""}], "]"}],
         ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"Return", "[", "result", "]"}]}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Differentiation", " ", "with", " ", "thetas", " ", "present"}],
       " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"result", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{
        RowBox[{"result", " ", "=", " ", 
         RowBox[{"result", " ", "+", " ", 
          RowBox[{
           RowBox[{"Dtower", "[", 
            RowBox[{"[", "i", "]"}], "]"}], " ", 
           RowBox[{"D", "[", 
            RowBox[{"fun", ",", 
             RowBox[{"theta", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}]}]}], ";"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "theta", "]"}]}], "}"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"result", "=", 
      RowBox[{"Collect", "[", 
       RowBox[{
        RowBox[{"Expand", "[", "result", "]"}], ",", 
        RowBox[{"Last", "[", "theta", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"RischTrace", "[", 
      RowBox[{"TotalDerivation", ",", "result", ",", "\"\<Out\>\""}], "]"}], 
     ";", "\[IndentingNewLine]", "result"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.3904433527018747`*^9, 3.3904433957174997`*^9}, {
   3.3904434316081247`*^9, 3.3904434773268747`*^9}, {3.3904435291081247`*^9, 
   3.3904435534206247`*^9}, {3.3904436063581247`*^9, 
   3.3904436705299997`*^9}, {3.3904439770143747`*^9, 
   3.3904440612487497`*^9}, {3.3904441027174997`*^9, 
   3.3904441458737497`*^9}, {3.3904441945299997`*^9, 
   3.3904442274831247`*^9}, {3.3904444255768747`*^9, 
   3.3904444257487497`*^9}, {3.3904444994674997`*^9, 
   3.3904446336549997`*^9}, {3.3904472111081247`*^9, 
   3.3904472441237497`*^9}, {3.3904473501081247`*^9, 
   3.3904473846706247`*^9}, {3.3904474822799997`*^9, 
   3.3904475213424997`*^9}, {3.3904475521393747`*^9, 
   3.3904475608268747`*^9}, {3.3904476593424997`*^9, 
   3.3904476596081247`*^9}, {3.3904477194362497`*^9, 
   3.3904477243112497`*^9}, {3.3904477689987497`*^9, 
   3.3904478035299997`*^9}, {3.3904478411081247`*^9, 
   3.3904478904831247`*^9}, {3.3904480205768747`*^9, 
   3.3904480339362497`*^9}, {3.3904480678737497`*^9, 
   3.3904480993581247`*^9}, {3.3904481657956247`*^9, 
   3.3904481658737497`*^9}, {3.3904483138268747`*^9, 
   3.3904483228893747`*^9}, {3.3904483842018747`*^9, 
   3.3904483866706247`*^9}, {3.3904484314674997`*^9, 
   3.3904484516706247`*^9}, {3.3904485073581247`*^9, 
   3.3904485100612497`*^9}, {3.3904486213424997`*^9, 
   3.3904486216393747`*^9}, {3.3904487366549997`*^9, 
   3.3904487766237497`*^9}, {3.3904489009518747`*^9, 
   3.3904489320924997`*^9}, {3.3904489741237497`*^9, 
   3.3904490027018747`*^9}, {3.3904490331862497`*^9, 
   3.3904490560768747`*^9}, {3.3904491618737497`*^9, 
   3.3904491817956247`*^9}, {3.3904496612487497`*^9, 
   3.3904496646549997`*^9}, {3.3904497981393747`*^9, 
   3.3904498368112497`*^9}, {3.3904499584049997`*^9, 
   3.3904502297174997`*^9}, {3.3904502700299997`*^9, 
   3.3904503737487497`*^9}, {3.3904504133268747`*^9, 
   3.3904504778112497`*^9}, {3.3904505158737497`*^9, 
   3.3904505872331247`*^9}, {3.3904506173268747`*^9, 
   3.3904507280456247`*^9}, {3.3904508153581247`*^9, 
   3.3904508351706247`*^9}, {3.3904508725299997`*^9, 
   3.3904508925768747`*^9}, {3.3904509274362497`*^9, 
   3.3904509578112497`*^9}, {3.3904510365924997`*^9, 
   3.3904510787018747`*^9}, {3.3904511105612497`*^9, 
   3.3904511401393747`*^9}, {3.3904513708737497`*^9, 
   3.3904514627487497`*^9}, {3.3904515160924997`*^9, 
   3.3904515657018747`*^9}, {3.39067955518675*^9, 3.390679557296125*^9}, {
   3.39067959068675*^9, 3.39067959193675*^9}, {3.390679768218*^9, 
   3.39067984431175*^9}, {3.390679975046125*^9, 3.39067997693675*^9}, {
   3.390680020671125*^9, 3.390680021889875*^9}, 3.390680061671125*^9, {
   3.39068031949925*^9, 3.390680320108625*^9}, {3.39068036199925*^9, 
   3.390680363858625*^9}, {3.390699648952375*^9, 3.390699740593*^9}, {
   3.3908589887155*^9, 3.3908590110905*^9}, {3.394424981468*^9, 
   3.394425014671125*^9}, {3.3944264384518747`*^9, 3.3944264551081247`*^9}, {
   3.4049576126157103`*^9, 3.404957695784296*^9}, {3.404963091946171*^9, 
   3.404963140288076*^9}, {3.404963182708857*^9, 3.404963211896593*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ToPolynomial", "[", 
   RowBox[{"p_", ",", "x_"}], "]"}], ":=", 
  RowBox[{"Total", "[", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"p", "[", 
        RowBox[{"[", "#", "]"}], "]"}], " ", 
       RowBox[{"x", "^", 
        RowBox[{"(", 
         RowBox[{"#", "-", "1"}], ")"}]}]}], "&"}], ",", 
     RowBox[{"Range", "[", 
      RowBox[{"Length", "[", "p", "]"}], "]"}]}], "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.38544055798025*^9, 3.38544061035525*^9}, {
  3.385440857620875*^9, 3.38544088385525*^9}, {3.40745331353578*^9, 
  3.4074533152369223`*^9}, {3.4095237845191927`*^9, 3.409523784700283*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"kappaD", "[", 
   RowBox[{"fun_", ",", "theta_", ",", "Dtower_"}], "]"}], ":=", 
  RowBox[{"ToPolynomial", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"TotalDerivation", "[", 
         RowBox[{"#", ",", 
          RowBox[{"Most", "[", "theta", "]"}], ",", 
          RowBox[{"Most", "[", "Dtower", "]"}]}], "]"}], "&"}], ",", 
       RowBox[{"CoefficientList", "[", 
        RowBox[{"fun", ",", 
         RowBox[{"Last", "[", "theta", "]"}]}], " ", "]"}]}], "]"}], "//", 
     "Expand"}], ",", 
    RowBox[{"Last", "[", "theta", "]"}]}], " ", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.3904490880612497`*^9, 3.3904491351706247`*^9}, {
  3.3904491944987497`*^9, 3.3904491962956247`*^9}, {3.3904492731549997`*^9, 
  3.3904492810299997`*^9}, {3.3904493209831247`*^9, 3.3904493222799997`*^9}, {
  3.3904493730456247`*^9, 3.3904493805768747`*^9}, {3.3904494952018747`*^9, 
  3.3904495452174997`*^9}, {3.3904497024518747`*^9, 3.3904497237331247`*^9}, {
  3.3904527829987497`*^9, 3.3904527834674997`*^9}, {3.394425039733625*^9, 
  3.394425049077375*^9}, {3.3944264607331247`*^9, 3.3944264637643747`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TotalDerivation", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"rischLog", "[", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SubscriptBox["\"\<\[Theta]\>\"", "1"]}], "]"}], "+", 
    RowBox[{"rischLog", "[", 
     RowBox[{"1", "+", 
      SubscriptBox["\"\<\[Theta]\>\"", "1"]}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["\"\<\[Theta]\>\"", "1"], ",", 
     SubscriptBox["\"\<\[Theta]\>\"", "2"], ",", 
     SubscriptBox["\"\<\[Theta]\>\"", "3"], ",", 
     SubscriptBox["\"\<\[Theta]\>\"", "4"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     FractionBox["1", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SubscriptBox["\"\<\[Theta]\>\"", "1"]}]], ",", 
     FractionBox["1", 
      SubscriptBox["\"\<\[Theta]\>\"", "1"]], ",", 
     FractionBox["1", 
      RowBox[{"1", "+", 
       SubscriptBox["\"\<\[Theta]\>\"", "1"]}]]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.4061950251423197`*^9, 3.406195028838533*^9}, {
  3.4061951451206493`*^9, 3.406195148805502*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    SubscriptBox["\<\"\[Theta]\"\>", "1"]}]], "+", 
  FractionBox["1", 
   RowBox[{"1", "+", 
    SubscriptBox["\<\"\[Theta]\"\>", "1"]}]]}]], "Output",
 CellChangeTimes->{
  3.406195029747875*^9, 3.406195064939643*^9, {3.406195145890977*^9, 
   3.4061951494508953`*^9}, 3.407453325429265*^9, 3.410397777060256*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"p", "=", 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    RowBox[{"2", " ", "x"}], "+", 
    RowBox[{"4", " ", 
     SuperscriptBox["t", "5"], " ", 
     SuperscriptBox["x", "4"]}], "-", 
    RowBox[{"4", " ", 
     SuperscriptBox["t", "4"], " ", 
     SuperscriptBox["x", "3"], " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", "x"}], ")"}]}], "+", 
    RowBox[{
     SuperscriptBox["t", "3"], " ", 
     SuperscriptBox["x", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "3"}], "+", 
       RowBox[{"2", " ", "x"}]}], ")"}]}], "+", 
    RowBox[{
     SuperscriptBox["t", "2"], " ", "x", " ", 
     RowBox[{"(", 
      RowBox[{"2", "+", 
       RowBox[{"7", " ", "x"}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["x", "2"]}]}], ")"}]}], "-", 
    RowBox[{"t", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"4", " ", "x"}], "+", 
       RowBox[{"4", " ", 
        SuperscriptBox["x", "2"]}]}], ")"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.38466205940525*^9, 3.3846620658115*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TotalDerivation", "[", 
  RowBox[{"p", ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "t"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["t", "2"]}], "+", 
      FractionBox["1", 
       RowBox[{"2", " ", "x"}]], "-", 
      FractionBox[
       RowBox[{"3", " ", "t"}], 
       RowBox[{"2", " ", "x"}]]}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.3904485249831247`*^9, 3.3904485372487497`*^9}, 
   3.3904511000768747`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["t", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "4"}], "-", 
     RowBox[{"7", " ", "x"}]}], ")"}]}], "+", 
  RowBox[{"t", " ", 
   RowBox[{"(", 
    RowBox[{"2", "-", 
     FractionBox["3", 
      RowBox[{"2", " ", "x"}]], "-", 
     RowBox[{"2", " ", "x"}]}], ")"}]}], "+", 
  FractionBox["1", 
   RowBox[{"2", " ", "x"}]], "-", 
  RowBox[{"2", " ", "x"}], "+", 
  RowBox[{"10", " ", 
   SuperscriptBox["t", "4"], " ", 
   SuperscriptBox["x", "3"]}], "-", 
  RowBox[{"14", " ", 
   SuperscriptBox["t", "5"], " ", 
   SuperscriptBox["x", "3"]}], "-", 
  RowBox[{"20", " ", 
   SuperscriptBox["t", "6"], " ", 
   SuperscriptBox["x", "4"]}], "+", 
  RowBox[{
   SuperscriptBox["t", "3"], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"15", " ", "x"}], "2"], "-", 
     RowBox[{"3", " ", 
      SuperscriptBox["x", "2"]}]}], ")"}]}], "+", 
  RowBox[{"t", " ", 
   RowBox[{"(", 
    RowBox[{"2", "+", 
     RowBox[{"7", " ", "x"}], "+", 
     RowBox[{"2", " ", 
      SuperscriptBox["x", "2"]}]}], ")"}]}], "+", 
  RowBox[{
   SuperscriptBox["t", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"9", " ", "x"}], "2"]}], "+", 
     RowBox[{"3", " ", 
      SuperscriptBox["x", "2"]}]}], ")"}]}], "+", 
  RowBox[{
   SuperscriptBox["t", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     RowBox[{"4", " ", "x"}], "+", 
     RowBox[{"4", " ", 
      SuperscriptBox["x", "2"]}]}], ")"}]}], "+", 
  RowBox[{
   SuperscriptBox["t", "3"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "8"}], " ", 
      SuperscriptBox["x", "2"]}], "-", 
     RowBox[{"8", " ", 
      SuperscriptBox["x", "3"]}]}], ")"}]}], "+", 
  RowBox[{
   SuperscriptBox["t", "4"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"9", " ", 
      SuperscriptBox["x", "2"]}], "-", 
     RowBox[{"6", " ", 
      SuperscriptBox["x", "3"]}]}], ")"}]}], "+", 
  RowBox[{
   SuperscriptBox["t", "3"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "4"}], " ", "x"}], "-", 
     RowBox[{"14", " ", 
      SuperscriptBox["x", "2"]}], "-", 
     RowBox[{"4", " ", 
      SuperscriptBox["x", "3"]}]}], ")"}]}], "+", 
  RowBox[{
   SuperscriptBox["t", "4"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"12", " ", 
      SuperscriptBox["x", "2"]}], "+", 
     RowBox[{"8", " ", 
      SuperscriptBox["x", "3"]}]}], ")"}]}], "+", 
  RowBox[{
   SuperscriptBox["t", "5"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"16", " ", 
      SuperscriptBox["x", "3"]}], "+", 
     RowBox[{"16", " ", 
      SuperscriptBox["x", "4"]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.407453329335431*^9, 3.410397777867955*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TotalDerivation", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"theta", "[", "1", "]"}], 
    RowBox[{"theta", "[", "2", "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"theta", "[", "1", "]"}], ",", 
     RowBox[{"theta", "[", "2", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"theta", "[", "1", "]"}], ",", 
     RowBox[{"1", "/", "x"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.3904471481081247`*^9, 3.3904471597174997`*^9}, 
   3.3904484870612497`*^9, {3.3904486961237497`*^9, 3.3904487072799997`*^9}, 
   3.3904493934831247`*^9, {3.3904497437174997`*^9, 3.3904497542643747`*^9}, {
   3.394425083764875*^9, 3.39442513356175*^9}, {3.394425239577375*^9, 
   3.394425242546125*^9}, {3.3944264771862497`*^9, 3.3944264996549997`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   SubscriptBox["\[Theta]", "1"], "x"], "+", 
  RowBox[{
   SubscriptBox["\[Theta]", "1"], " ", 
   SubscriptBox["\[Theta]", "2"]}]}]], "Output",
 CellChangeTimes->{3.4103977801797543`*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Splitting Factorization", "Subsection",
 CellChangeTimes->{{3.384715147732625*^9, 3.38471515212325*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SplitFactor", "[", 
   RowBox[{"p_", ",", "theta_", ",", "Dtower_"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"S", ",", "Qn", ",", "Qs", ",", "res"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"RischTrace", "[", 
      RowBox[{"SplitFactor", ",", 
       RowBox[{"{", 
        RowBox[{"p", ",", "theta", ",", "Dtower"}], "}"}], ",", 
       "\"\<In\>\""}], "]"}], ";", "\n", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Reference", ":", " ", 
        RowBox[{"Symbolic", " ", "Integration"}]}], ",", " ", "Bronstein", 
       ",", " ", 
       RowBox[{"p", ".100"}]}], " ", "*)"}], "\n", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Given", " ", "a", " ", "derivation", " ", "D", " ", "on", " ", 
        RowBox[{"k", "[", "t", "]"}], " ", "and", " ", "p", " ", "in", " ", 
        RowBox[{"k", "[", "t", "]"}]}], ",", " ", 
       RowBox[{
        RowBox[{"return", " ", 
         RowBox[{"(", 
          RowBox[{"p_n", ",", "p_s"}], ")"}], " ", "in", " ", 
         RowBox[{
          RowBox[{"k", "[", "t", "]"}], "^", "2"}], " ", "such", " ", "that", 
         "\[IndentingNewLine]", "p"}], " ", "=", " ", 
        RowBox[{"p_n", "*", "p_s", " ", "is", " ", "special"}]}], ",", " ", 
       RowBox[{
       "and", " ", "each", " ", "squarefree", " ", "factor", " ", "of", " ", 
        "p_n", " ", "is", " ", "normal"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"S", " ", "=", " ", 
      RowBox[{"Cancel", "[", 
       RowBox[{
        RowBox[{"PolynomialGCD", "[", 
         RowBox[{"p", ",", 
          RowBox[{"TotalDerivation", "[", 
           RowBox[{"p", ",", "theta", ",", "Dtower"}], "]"}]}], "]"}], "/", 
        RowBox[{"PolynomialGCD", "[", 
         RowBox[{"p", ",", 
          RowBox[{"D", "[", 
           RowBox[{"p", ",", 
            RowBox[{"Last", "[", "theta", "]"}]}], "]"}]}], "]"}]}], "]"}]}], 
     ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{"exact", " ", "division"}], " ", "*)"}], "\n", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Exponent", "[", 
         RowBox[{"S", ",", 
          RowBox[{"Last", "[", "theta", "]"}]}], "]"}], " ", "===", " ", 
        "0"}], ",", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{"p", ",", "1"}], "}"}], "]"}]}], "]"}], ";", "\n", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Qn", ",", "Qs"}], "}"}], " ", "=", " ", 
      RowBox[{"SplitFactor", "[", 
       RowBox[{
        RowBox[{"Cancel", "[", 
         RowBox[{"p", "/", "S"}], "]"}], ",", "theta", ",", "Dtower"}], 
       "]"}]}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{"exact", " ", "division"}], " ", "*)"}], "\n", 
     RowBox[{"res", "=", 
      RowBox[{"Expand", "[", 
       RowBox[{"{", 
        RowBox[{"Qn", ",", 
         RowBox[{"S", " ", "Qs"}]}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"RischTrace", "[", 
      RowBox[{"SplitFactor", ",", "res", ",", "\"\<Out\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", "res"}]}], "\n", "]"}], " "}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.3846621211865*^9, 3.3846621579365*^9}, {
   3.384662218249*^9, 3.384662222733375*^9}, {3.384662289639625*^9, 
   3.38466230765525*^9}, {3.384662349749*^9, 3.384662411108375*^9}, {
   3.3846624945615*^9, 3.38466255815525*^9}, {3.385441476074*^9, 
   3.385441478402125*^9}, 3.385441544120875*^9, {3.38549618688525*^9, 
   3.38549621451025*^9}, {3.385501523150625*^9, 3.385501523838125*^9}, {
   3.387420406584125*^9, 3.387420413865375*^9}, {3.387426463411375*^9, 
   3.387426464802*^9}, {3.389042875951125*^9, 3.389042879169875*^9}, {
   3.3904449796081247`*^9, 3.3904450303893747`*^9}, {3.3904451704987497`*^9, 
   3.3904451789362497`*^9}, {3.3904452111549997`*^9, 
   3.3904452480768747`*^9}, {3.3904453252956247`*^9, 
   3.3904453324206247`*^9}, {3.3904454034518747`*^9, 
   3.3904454299049997`*^9}, {3.390859038668625*^9, 3.39085912699675*^9}, {
   3.395565798983883*^9, 3.395565799365052*^9}, {3.3956600729647923`*^9, 
   3.3956600783004837`*^9}, {3.404957714815518*^9, 3.404957783943948*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"p", "=", 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    RowBox[{"2", " ", "x"}], "+", 
    RowBox[{"4", " ", 
     SuperscriptBox["t", "5"], " ", 
     SuperscriptBox["x", "4"]}], "-", 
    RowBox[{"4", " ", 
     SuperscriptBox["t", "4"], " ", 
     SuperscriptBox["x", "3"], " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", "x"}], ")"}]}], "+", 
    RowBox[{
     SuperscriptBox["t", "3"], " ", 
     SuperscriptBox["x", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "3"}], "+", 
       RowBox[{"2", " ", "x"}]}], ")"}]}], "+", 
    RowBox[{
     SuperscriptBox["t", "2"], " ", "x", " ", 
     RowBox[{"(", 
      RowBox[{"2", "+", 
       RowBox[{"7", " ", "x"}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["x", "2"]}]}], ")"}]}], "-", 
    RowBox[{"t", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"4", " ", "x"}], "+", 
       RowBox[{"4", " ", 
        SuperscriptBox["x", "2"]}]}], ")"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.38466205940525*^9, 3.3846620658115*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dt", "=", 
   RowBox[{
    RowBox[{"-", 
     SuperscriptBox["t", "2"]}], "+", 
    FractionBox["1", 
     RowBox[{"2", " ", "x"}]], "-", 
    FractionBox[
     RowBox[{"3", " ", "t"}], 
     RowBox[{"2", " ", "x"}]]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.38466206884275*^9, 3.38466207703025*^9}, 
   3.3854407478865*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SplitFactor", "[", 
  RowBox[{"p", ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "t"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["t", "2"]}], "+", 
      FractionBox["1", 
       RowBox[{"2", " ", "x"}]], "-", 
      FractionBox[
       RowBox[{"3", " ", "t"}], 
       RowBox[{"2", " ", "x"}]]}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.38466204709275*^9, 3.384662050374*^9}, {
   3.384662095639625*^9, 3.3846621120615*^9}, {3.384662295639625*^9, 
   3.384662299639625*^9}, 3.385440749995875*^9, {3.38544613660525*^9, 
   3.385446142902125*^9}, {3.385496225307125*^9, 3.385496225479*^9}, {
   3.3904450475143747`*^9, 3.3904450602331247`*^9}, {3.3904453901549997`*^9, 
   3.3904453926237497`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"-", "2"}], " ", "x"}], "+", 
    RowBox[{"2", " ", "t", " ", "x"}], "+", 
    RowBox[{"4", " ", "t", " ", 
     SuperscriptBox["x", "2"]}], "-", 
    RowBox[{"4", " ", 
     SuperscriptBox["t", "2"], " ", 
     SuperscriptBox["x", "2"]}], "-", 
    RowBox[{"2", " ", 
     SuperscriptBox["t", "2"], " ", 
     SuperscriptBox["x", "3"]}], "+", 
    RowBox[{"2", " ", 
     SuperscriptBox["t", "3"], " ", 
     SuperscriptBox["x", "3"]}]}], ",", 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    RowBox[{"2", " ", "t"}], "+", 
    FractionBox["1", 
     RowBox[{"2", " ", "x"}]], "+", 
    RowBox[{"2", " ", 
     SuperscriptBox["t", "2"], " ", "x"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.4049577874944897`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", "x"}], "+", 
      RowBox[{"2", " ", "t", " ", "x"}], "+", 
      RowBox[{"4", " ", "t", " ", 
       SuperscriptBox["x", "2"]}], "-", 
      RowBox[{"4", " ", 
       SuperscriptBox["t", "2"], " ", 
       SuperscriptBox["x", "2"]}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["t", "2"], " ", 
       SuperscriptBox["x", "3"]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["t", "3"], " ", 
       SuperscriptBox["x", "3"]}]}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"2", " ", "t"}], "+", 
      FractionBox["1", 
       RowBox[{"2", " ", "x"}]], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["t", "2"], " ", "x"}]}], ")"}]}], "//", "Expand"}], "//", 
  RowBox[{
   RowBox[{"Collect", "[", 
    RowBox[{"#", ",", "t"}], "]"}], "&"}]}]], "Input",
 CellChangeTimes->{{3.384662460249*^9, 3.384662476139625*^9}, {
  3.385501545650625*^9, 3.3855015490725*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Splitting Squarefree Factorization", "Subsection",
 CellChangeTimes->{{3.384716771592*^9, 3.38471678043575*^9}, {
  3.384720435545125*^9, 3.384720435888875*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SplitSquarefreeFactor", "[", 
   RowBox[{"p_", ",", "theta_", ",", "tower_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Plist", ",", "term", ",", "P", ",", 
      RowBox[{"S", "=", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"n", "=", 
       RowBox[{"{", "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"RischTrace", "[", 
      RowBox[{"SplitSquarefreeFactor", ",", 
       RowBox[{"{", 
        RowBox[{"p", ",", "theta", ",", "tower"}], "}"}], ",", "\"\<In\>\""}],
       "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Reference", ":", " ", 
        RowBox[{"Symbolic", " ", "Integration"}]}], ",", " ", "Bronstein", 
       ",", " ", 
       RowBox[{"p", ".102"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Given", " ", "a", " ", "derivation", " ", "D", " ", "on", " ", 
        RowBox[{"k", "[", "t", "]"}], " ", "and", " ", "p", " ", "in", " ", 
        RowBox[{"k", "[", "t", "]"}]}], ",", " ", 
       RowBox[{
        RowBox[{"return", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"N_", "1"}], ",", "...", ",", "N_m"}], ")"}], 
         "\[IndentingNewLine]", "and", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"S_", "1"}], ",", "...", ",", "S_m"}], ")"}], " ", "in", 
         " ", 
         RowBox[{
          RowBox[{"k", "[", "t", "]"}], "^", "m"}], " ", "such", " ", "that", 
         " ", "p"}], "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"N_", "1", "*", "N_", 
             RowBox[{
              RowBox[{"{", "2", "}"}], "^", "2"}], "*"}], "..."}], "*", "N_", 
           RowBox[{
            RowBox[{"{", "m", "}"}], "^", "m"}]}], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"S_", 
             RowBox[{"{", "1", "}"}], "*", "S_", 
             RowBox[{
              RowBox[{"{", "2", "}"}], "^", "2"}], "*"}], "..."}], "*", "S_", 
           RowBox[{
            RowBox[{"{", "m", "}"}], "^", "m"}]}], ")"}], 
         "\[IndentingNewLine]", "is", " ", "a", " ", "splitting", " ", 
         "factorisation", " ", "of", " ", "p", " ", "and", " ", "the", " ", 
         "N_i", " ", "and", " ", "S_i", " ", "are", " ", "squarefree", " ", 
         "and", " ", "coprime"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"P", "=", 
      RowBox[{"First", "/@", 
       RowBox[{"Squarefree", "[", 
        RowBox[{"p", ",", 
         RowBox[{"Last", "[", "theta", "]"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"AppendTo", "[", 
         RowBox[{"S", ",", 
          RowBox[{"Expand", "@", 
           RowBox[{"PolynomialGCD", "[", 
            RowBox[{
             RowBox[{"Part", "[", 
              RowBox[{"P", ",", "i"}], "]"}], ",", 
             RowBox[{"Collect", "[", 
              RowBox[{
               RowBox[{"TotalDerivation", "[", 
                RowBox[{
                 RowBox[{"Part", "[", 
                  RowBox[{"P", ",", "i"}], "]"}], ",", "theta", ",", 
                 "tower"}], "]"}], ",", 
               RowBox[{"Last", "[", "theta", "]"}]}], "]"}]}], "]"}]}]}], 
         "]"}], ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"n", ",", 
          RowBox[{"Cancel", "[", 
           RowBox[{
            RowBox[{"Part", "[", 
             RowBox[{"P", ",", "i"}], "]"}], "/", 
            RowBox[{"Part", "[", 
             RowBox[{"S", ",", "i"}], "]"}]}], "]"}]}], "]"}], ";"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "P", "]"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"RischTrace", "[", 
      RowBox[{"SplitSquarefreeFactor", ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "S"}], "}"}], ",", "\"\<Out\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"n", ",", "S"}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.3874062513835*^9, 3.387406334071*^9}, {
   3.387406444117875*^9, 3.3874064463835*^9}, {3.387406919992875*^9, 
   3.387406950805375*^9}, {3.387407020555375*^9, 3.387407020899125*^9}, {
   3.38904364696675*^9, 3.389043670326125*^9}, {3.389043706857375*^9, 
   3.389043706998*^9}, {3.389044276044875*^9, 3.389044287623*^9}, {
   3.389044360513625*^9, 3.389044363232375*^9}, {3.389044553982375*^9, 
   3.38904455477925*^9}, {3.389044636576125*^9, 3.38904464227925*^9}, {
   3.390109055635125*^9, 3.39010906215075*^9}, {3.390109357416375*^9, 
   3.390109445822625*^9}, {3.390110251291375*^9, 3.390110255228875*^9}, {
   3.39011037658825*^9, 3.3901103784945*^9}, {3.3904530428581247`*^9, 
   3.3904530609362497`*^9}, {3.3904532018424997`*^9, 
   3.3904532120143747`*^9}, {3.3904533884518747`*^9, 
   3.3904534229674997`*^9}, {3.390677803702375*^9, 3.3906778270305*^9}, {
   3.3908591488405*^9, 3.390859350324875*^9}, {3.3978799866499853`*^9, 
   3.397879996953577*^9}, {3.397880059441999*^9, 3.397880140025403*^9}, {
   3.3978801957482347`*^9, 3.397880196098686*^9}, {3.4049578077497177`*^9, 
   3.404957848243312*^9}, {3.409908551111079*^9, 3.409908564863017*^9}, {
   3.410395710099536*^9, 3.410395720221819*^9}, {3.410395874575304*^9, 
   3.4103958748394327`*^9}, 3.410396997800707*^9, {3.410397033967547*^9, 
   3.410397040219782*^9}, {3.410397099193461*^9, 3.4103971478348083`*^9}, {
   3.410397178501746*^9, 3.4103971808586187`*^9}, {3.410397337799357*^9, 
   3.410397340911133*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SplitSquarefreeFactor", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "rischZ"}], "+", "x"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     SubscriptBox["\[Theta]", "1"], ",", "rischZ"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     SubscriptBox["\[Theta]", "1"], ",", "1"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.4103956852470284`*^9, 3.4103956905854197`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "1", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "rischZ"}], "+", "x"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.410395877276404*^9, 3.410396999811693*^9, {3.4103971353819017`*^9, 
   3.4103971488964787`*^9}, 3.410397182248455*^9, 3.410397342630012*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"p", "=", 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    RowBox[{"2", " ", "x"}], "+", 
    RowBox[{"4", " ", 
     SuperscriptBox["t", "5"], " ", 
     SuperscriptBox["x", "4"]}], "-", 
    RowBox[{"4", " ", 
     SuperscriptBox["t", "4"], " ", 
     SuperscriptBox["x", "3"], " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", "x"}], ")"}]}], "+", 
    RowBox[{
     SuperscriptBox["t", "3"], " ", 
     SuperscriptBox["x", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "3"}], "+", 
       RowBox[{"2", " ", "x"}]}], ")"}]}], "+", 
    RowBox[{
     SuperscriptBox["t", "2"], " ", "x", " ", 
     RowBox[{"(", 
      RowBox[{"2", "+", 
       RowBox[{"7", " ", "x"}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["x", "2"]}]}], ")"}]}], "-", 
    RowBox[{"t", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"4", " ", "x"}], "+", 
       RowBox[{"4", " ", 
        SuperscriptBox["x", "2"]}]}], ")"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.38466205940525*^9, 3.3846620658115*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"d", "=", 
   RowBox[{
    RowBox[{"-", 
     SuperscriptBox["t", "2"]}], "+", 
    FractionBox["1", 
     RowBox[{"2", " ", "x"}]], "-", 
    FractionBox[
     RowBox[{"3", " ", "t"}], 
     RowBox[{"2", " ", "x"}]]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.38466206884275*^9, 3.38466207703025*^9}, {
  3.384716583420125*^9, 3.384716583545125*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SplitSquarefreeFactor", "[", 
  RowBox[{"p", ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "t"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["t", "2"]}], "+", 
      FractionBox["1", 
       RowBox[{"2", " ", "x"}]], "-", 
      FractionBox[
       RowBox[{"3", " ", "t"}], 
       RowBox[{"2", " ", "x"}]]}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.385496258650875*^9, 3.385496258838375*^9}, {
  3.3904523285299997`*^9, 3.3904523400456247`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "t"}], ")"}], " ", "x"}], ",", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"t", " ", "x"}]}], ")"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"2", " ", "t"}], "+", 
      FractionBox["1", 
       RowBox[{"2", " ", "x"}]], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["t", "2"], " ", "x"}]}], ",", 
     FractionBox["1", "2"]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.409908569019884*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "t"}], ")"}], " ", "x"}], ")"}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{"t", " ", "x"}]}], ")"}]}], ")"}], "2"]}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"2", " ", "t"}], "+", 
        FractionBox["1", 
         RowBox[{"2", " ", "x"}]], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["t", "2"], " ", "x"}]}], ")"}], 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["1", "2"], ")"}], "2"]}], ")"}]}], "//", "Expand"}], "//", 
  RowBox[{
   RowBox[{"Collect", "[", 
    RowBox[{"#", ",", "t"}], "]"}], "&"}]}]], "Input",
 CellChangeTimes->{
  3.3847200622795*^9, {3.3847201629045*^9, 3.38472020881075*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Canonical Representation", "Subsection",
 CellChangeTimes->{{3.384721000951375*^9, 3.38472100668575*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"CanonicalRepresentation", "[", 
   RowBox[{"f_", ",", "theta_", ",", "tower_", ",", "Dtower_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "a", ",", "b", ",", "c", ",", "d", ",", "q", ",", "r", ",", "dn", ",", 
      "ds", ",", "res"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"RischTrace", "[", 
      RowBox[{"CanonicalRepresentation", ",", 
       RowBox[{"{", 
        RowBox[{"f", ",", "theta", ",", "Dtower"}], "}"}], ",", 
       "\"\<In\>\""}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Reference", ":", " ", 
        RowBox[{"Symbolic", " ", "Integration"}]}], ",", " ", "Bronstein", 
       ",", " ", 
       RowBox[{"p", ".103"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Example", " ", "in", " ", "Bronstein", " ", 
       RowBox[{"p", ".", " ", "140"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"canonical", " ", "representation", " ", "returns", " ", 
        RowBox[{"(", 
         RowBox[{"f_p", ",", "f_s", ",", "f_n"}], ")"}]}], ",", " ", 
       RowBox[{
       "where", " ", "f_p", " ", "is", " ", "the", " ", "polynomial", " ", 
        "part", "\[IndentingNewLine]", "of", " ", "f"}], ",", " ", 
       RowBox[{
       "f_s", " ", "is", " ", "the", " ", "special", " ", "part", " ", "of", 
        " ", "f"}], ",", " ", 
       RowBox[{
       "and", " ", "f_n", " ", "is", " ", "the", " ", "normal", " ", "part", 
        " ", "of", " ", 
        RowBox[{"f", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a", ",", "d"}], "}"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Numerator", "[", "f", "]"}], ",", 
        RowBox[{"Denominator", "[", "f", "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"q", ",", "r"}], "}"}], "=", 
      RowBox[{"PolynomialQuotientRemainder", "[", 
       RowBox[{"a", ",", "d", ",", 
        RowBox[{"Last", "[", "theta", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"dn", ",", "ds"}], "}"}], "=", 
      RowBox[{"SplitFactor", "[", 
       RowBox[{"d", ",", "theta", ",", "Dtower"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"b", ",", "c"}], "}"}], "=", 
      RowBox[{"ExtendedEuclidean", "[", 
       RowBox[{"dn", ",", "ds", ",", "r", ",", 
        RowBox[{"Last", "[", "theta", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Together", "[", "q", "]"}], ",", 
        RowBox[{"Cancel", "[", 
         RowBox[{"b", "/", "ds"}], "]"}], ",", 
        RowBox[{"Cancel", "[", 
         RowBox[{"c", "/", "dn"}], "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"RischTrace", "[", 
      RowBox[{"CanonicalRepresentation", ",", "res", ",", "\"\<Out\>\""}], 
      "]"}], ";", "\[IndentingNewLine]", "res"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.384721010576375*^9, 3.384721021420125*^9}, {
   3.38472132312325*^9, 3.384721439326375*^9}, {3.38472313674825*^9, 
   3.384723158467*^9}, {3.384723197482625*^9, 3.3847232321545*^9}, {
   3.384723277717*^9, 3.3847233077795*^9}, {3.38472339274825*^9, 
   3.3847234422795*^9}, {3.384723680201375*^9, 3.384723801420125*^9}, {
   3.3854444811365*^9, 3.3854445061365*^9}, {3.385444735574*^9, 
   3.3854447378865*^9}, {3.385445143449*^9, 3.38544523329275*^9}, {
   3.385445295464625*^9, 3.385445297558375*^9}, {3.385445538839625*^9, 
   3.385445539183375*^9}, {3.385445595089625*^9, 3.385445598495875*^9}, {
   3.385446005870875*^9, 3.385446015120875*^9}, {3.385446108714625*^9, 
   3.385446117199*^9}, {3.385446223870875*^9, 3.38544627160525*^9}, {
   3.38548449293575*^9, 3.38548451943575*^9}, 3.385484583467*^9, {
   3.385485145699625*^9, 3.3854851477465*^9}, {3.3854962751665*^9, 
   3.385496311479*^9}, {3.38549894291625*^9, 3.385499032650625*^9}, {
   3.38550021310375*^9, 3.38550021376*^9}, {3.3855042244475*^9, 
   3.385504229744375*^9}, {3.3855042741975*^9, 3.385504280244375*^9}, {
   3.385504713525625*^9, 3.3855047158225*^9}, {3.38550548507125*^9, 
   3.385505490211875*^9}, {3.385505607618125*^9, 3.38550560794625*^9}, {
   3.385505765336875*^9, 3.3855057712275*^9}, {3.385506492961875*^9, 
   3.38550649354*^9}, {3.385677528231*^9, 3.38567755019975*^9}, {
   3.385679292340375*^9, 3.38567929251225*^9}, {3.38570097117025*^9, 
   3.385700990060875*^9}, {3.3904454744674997`*^9, 3.3904455568893747`*^9}, {
   3.3904456535299997`*^9, 3.3904456602956247`*^9}, {3.3904457059831247`*^9, 
   3.3904457145768747`*^9}, {3.3904458415612497`*^9, 
   3.3904458436081247`*^9}, {3.3904459130924997`*^9, 
   3.3904459216862497`*^9}, {3.390859383418625*^9, 3.390859394199875*^9}, {
   3.395660159470862*^9, 3.3956601687270927`*^9}, {3.395660811177099*^9, 
   3.395660812759776*^9}, {3.395660842819335*^9, 3.395660851768078*^9}, {
   3.395660934927248*^9, 3.395660961364121*^9}, {3.396783062803747*^9, 
   3.396783064123375*^9}, {3.3973730283108187`*^9, 3.397373072582513*^9}, {
   3.3973731684314632`*^9, 3.3973731720227737`*^9}, {3.4049578593310947`*^9, 
   3.404957934567801*^9}, {3.404958871948298*^9, 3.4049588724837627`*^9}, {
   3.4091221559110003`*^9, 3.409122160709497*^9}, {3.409122290716023*^9, 
   3.409122290874752*^9}, {3.409944908712699*^9, 3.409944929976118*^9}, {
   3.409944965482798*^9, 3.409944970336348*^9}, {3.40994510119273*^9, 
   3.4099451050244417`*^9}, {3.4100722197309313`*^9, 3.410072240848775*^9}, {
   3.4100728230173388`*^9, 3.41007282986449*^9}, {3.410072876852366*^9, 
   3.410072894570394*^9}, {3.410072927682777*^9, 3.410072959105277*^9}, 
   3.410073071187252*^9, {3.4100799501540213`*^9, 3.4100800601868763`*^9}, {
   3.410080135242806*^9, 3.410080238803384*^9}, {3.410080279036948*^9, 
   3.4100803051307487`*^9}, {3.41008046732469*^9, 3.410080513763555*^9}, {
   3.4100805951719103`*^9, 3.410080631659512*^9}, {3.4100808370294933`*^9, 
   3.410080842561676*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CanonicalRepresentation", "[", 
  RowBox[{
   FractionBox[
    SubsuperscriptBox["\[Theta]", "1", "2"], 
    RowBox[{"1", "+", 
     SubsuperscriptBox["\[Theta]", "1", "2"]}]], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"theta", "[", "1", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"rischExp", "[", "x", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"theta", "[", "1", "]"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.410080345405511*^9, 3.410080381611106*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", 
   FractionBox[
    SubsuperscriptBox["\[Theta]", "1", "2"], 
    RowBox[{"1", "+", 
     SubsuperscriptBox["\[Theta]", "1", "2"]}]]}], "}"}]], "Output",
 CellChangeTimes->{3.410080382381743*^9, 3.410080475914509*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CanonicalRepresentation", "[", 
  RowBox[{
   FractionBox[
    RowBox[{"1", "+", 
     SubscriptBox["\[Theta]", "1"], "-", 
     SubsuperscriptBox["\[Theta]", "1", "2"], "+", 
     RowBox[{"2", " ", 
      SuperscriptBox["x", "2"], " ", 
      SubsuperscriptBox["\[Theta]", "1", "2"]}], "-", 
     SubsuperscriptBox["\[Theta]", "1", "3"], "+", 
     RowBox[{"4", " ", "x", " ", 
      SubsuperscriptBox["\[Theta]", "1", "3"]}], "+", 
     RowBox[{"2", " ", 
      SubsuperscriptBox["\[Theta]", "1", "4"]}]}], 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"x", "+", 
        SubscriptBox["\[Theta]", "1"]}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SubsuperscriptBox["\[Theta]", "1", "2"]}], ")"}]}]], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"theta", "[", "1", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"theta", "[", "1", "]"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.40994485646558*^9, 3.409944878755962*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "0", ",", 
   FractionBox[
    RowBox[{"1", "+", 
     RowBox[{"2", " ", 
      SuperscriptBox["x", "2"]}], "+", 
     SubscriptBox["\[Theta]", "1"], "+", 
     RowBox[{"4", " ", "x", " ", 
      SubscriptBox["\[Theta]", "1"]}], "+", 
     SubsuperscriptBox["\[Theta]", "1", "2"], "-", 
     SubsuperscriptBox["\[Theta]", "1", "3"]}], 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"x", "+", 
        SubscriptBox["\[Theta]", "1"]}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SubsuperscriptBox["\[Theta]", "1", "2"]}], ")"}]}]]}], "}"}]], "Output",
 CellChangeTimes->{3.40994487925089*^9, 3.409944938810381*^9, 
  3.409944990994413*^9, 3.409945070845311*^9, 3.410080190760274*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CanonicalRepresentation", "[", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"-", 
      SubscriptBox["\[Theta]", "1"]}], "-", 
     SubscriptBox["\[Theta]", "2"], "+", 
     RowBox[{
      SubscriptBox["\[Theta]", "1"], " ", 
      SubscriptBox["\[Theta]", "2"]}], "-", 
     RowBox[{
      SubsuperscriptBox["\[Theta]", "1", "2"], " ", 
      SubscriptBox["\[Theta]", "2"]}], "+", 
     RowBox[{
      SubscriptBox["\[Theta]", "1"], " ", 
      SubsuperscriptBox["\[Theta]", "2", "2"]}]}], 
    RowBox[{
     RowBox[{"-", "1"}], "-", 
     SubsuperscriptBox["\[Theta]", "1", "2"], "+", 
     SubscriptBox["\[Theta]", "2"], "+", 
     RowBox[{
      SubsuperscriptBox["\[Theta]", "1", "2"], " ", 
      SubscriptBox["\[Theta]", "2"]}], "+", 
     SubsuperscriptBox["\[Theta]", "2", "2"], "+", 
     RowBox[{
      SubsuperscriptBox["\[Theta]", "1", "2"], " ", 
      SubsuperscriptBox["\[Theta]", "2", "2"]}]}]], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"theta", "[", "1", "]"}], ",", 
     RowBox[{"theta", "[", "2", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{
      RowBox[{"Log", "[", "2", "]"}], " ", 
      RowBox[{"theta", "[", "1", "]"}]}], ",", 
     RowBox[{
      RowBox[{"Log", "[", "3", "]"}], " ", 
      RowBox[{"theta", "[", "2", "]"}]}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.4091218066072817`*^9, 3.409121844478427*^9}, {
  3.4091221964195232`*^9, 3.40912219777835*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    SubscriptBox["\[Theta]", "1"], 
    RowBox[{"1", "+", 
     SubsuperscriptBox["\[Theta]", "1", "2"]}]], ",", "0", ",", 
   RowBox[{"-", 
    FractionBox[
     SubscriptBox["\[Theta]", "2"], 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SubscriptBox["\[Theta]", "2"], "+", 
      SubsuperscriptBox["\[Theta]", "2", "2"]}]]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.409122284626992*^9, 3.409122292762453*^9}, 
   3.409908585627391*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"CanonicalRepresentation", "[", 
   RowBox[{
    FractionBox[
     RowBox[{"1", "-", 
      SubscriptBox["\[Theta]", "1"], "-", 
      RowBox[{"2", " ", "x", " ", 
       SubscriptBox["\[Theta]", "1"]}], "+", 
      SubscriptBox["\[Theta]", "2"]}], 
     RowBox[{
      RowBox[{"-", 
       SubscriptBox["\[Theta]", "1"]}], "+", 
      RowBox[{"x", " ", 
       SubscriptBox["\[Theta]", "2"]}]}]], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", 
      SubscriptBox["\[Theta]", "1"], ",", 
      SubscriptBox["\[Theta]", "2"]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"2", " ", "x"}]}], ")"}], " ", 
       SubscriptBox["\[Theta]", "1"]}], ",", 
      FractionBox["1", "x"]}], "}"}]}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"this", " ", "is", " ", "correct"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.395659961761594*^9, 3.3956600146723747`*^9}, {
  3.395661044976399*^9, 3.3956610485414677`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox["1", "x"], ",", "0", ",", 
   FractionBox[
    RowBox[{"x", "+", 
     SubscriptBox["\[Theta]", "1"], "-", 
     RowBox[{"x", " ", 
      SubscriptBox["\[Theta]", "1"]}], "-", 
     RowBox[{"2", " ", 
      SuperscriptBox["x", "2"], " ", 
      SubscriptBox["\[Theta]", "1"]}]}], 
    RowBox[{"x", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        SubscriptBox["\[Theta]", "1"]}], "+", 
       RowBox[{"x", " ", 
        SubscriptBox["\[Theta]", "2"]}]}], ")"}]}]]}], "}"}]], "Output",
 CellChangeTimes->{3.404957944740837*^9, 3.407453425665155*^9, 
  3.409908586443242*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CanonicalRepresentation", "[", 
  RowBox[{
   FractionBox[
    RowBox[{"x", "-", "t"}], 
    SuperscriptBox["t", "2"]], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "t"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"1", "+", 
      SuperscriptBox["t", "2"]}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.384723807342*^9, 3.384723841482625*^9}, {
   3.38544472548025*^9, 3.385444728933375*^9}, {3.385445547902125*^9, 
   3.385445548027125*^9}, {3.385445604074*^9, 3.3854456041365*^9}, {
   3.385496317025875*^9, 3.38549631713525*^9}, {3.38549887216625*^9, 
   3.3854989154475*^9}, 3.385499051806875*^9, {3.3904456708581247`*^9, 
   3.3904456840612497`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", 
   FractionBox[
    RowBox[{
     RowBox[{"-", "t"}], "+", "x"}], 
    SuperscriptBox["t", "2"]]}], "}"}]], "Output",
 CellChangeTimes->{3.3967830665790987`*^9, 3.407453430133127*^9, 
  3.409908586959383*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CanonicalRepresentation", "[", 
  RowBox[{
   FractionBox[
    RowBox[{"1", "+", "x", "+", 
     SuperscriptBox["x", "2"]}], 
    RowBox[{"x", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", "x"}], ")"}], "2"]}]], ",", 
   RowBox[{"{", "x", "}"}], ",", 
   RowBox[{"{", "1", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.385443305245875*^9, {3.385444561120875*^9, 3.38544456566775*^9}, {
   3.385445355745875*^9, 3.38544535585525*^9}, {3.3854455453865*^9, 
   3.3854455455115*^9}, {3.385445606777125*^9, 3.385445631620875*^9}, {
   3.38544609048025*^9, 3.3854460906365*^9}, {3.385446278558375*^9, 
   3.385446285074*^9}, 3.385484575217*^9, 3.3854851402465*^9, {
   3.385496321213375*^9, 3.385496321463375*^9}, 3.38550023104125*^9, {
   3.3904457402174997`*^9, 3.3904457484674997`*^9}, {3.3904459050924997`*^9, 
   3.3904459085768747`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", 
   FractionBox[
    RowBox[{"1", "+", "x", "+", 
     SuperscriptBox["x", "2"]}], 
    RowBox[{"x", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", "x"}], ")"}], "2"]}]]}], "}"}]], "Output",
 CellChangeTimes->{3.396783067405528*^9, 3.407453431245842*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CanonicalRepresentation", "[", 
  RowBox[{
   FractionBox[
    RowBox[{"1", "-", "t", "-", 
     SuperscriptBox["t", "2"], "-", 
     SuperscriptBox["t", "3"]}], 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SuperscriptBox["t", "2"]}], ")"}], "2"], " ", 
     SuperscriptBox["x", "2"]}]], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "t"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"1", "/", "t"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.38549125263675*^9, {3.385491283433625*^9, 3.385491283589875*^9}, {
   3.385491556668*^9, 3.385491559714875*^9}, {3.385496325229*^9, 
   3.385496328619625*^9}, 3.385498546244375*^9, {3.38549889916625*^9, 
   3.385498904213125*^9}, {3.38549906016625*^9, 3.38549906776*^9}, {
   3.38550084329125*^9, 3.38550084372875*^9}, {3.385500885431875*^9, 
   3.385500898681875*^9}, {3.38550420797875*^9, 3.38550421316625*^9}, {
   3.3904459346393747`*^9, 3.3904459479674997`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", 
   FractionBox[
    RowBox[{"1", "-", "t", "-", 
     SuperscriptBox["t", "2"], "-", 
     SuperscriptBox["t", "3"]}], 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SuperscriptBox["t", "2"]}], ")"}], "2"], " ", 
     SuperscriptBox["x", "2"]}]]}], "}"}]], "Output",
 CellChangeTimes->{3.39678306802262*^9, 3.4074534320382233`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CanonicalRepresentation", "[", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"2", " ", "t"}], "-", "x", "+", 
     RowBox[{"4", " ", "t", " ", "x"}], "+", 
     RowBox[{"2", " ", "t", " ", 
      SuperscriptBox["x", "2"]}]}], 
    RowBox[{"x", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", "x"}], ")"}], "2"]}]], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "t"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"1", "/", "x"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.38550572082125*^9, 3.385505743665*^9}, 
   3.385505812149375*^9, {3.385675717684125*^9, 3.385675726777875*^9}, {
   3.3904459590143747`*^9, 3.3904459717174997`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"2", " ", "t"}], "-", "x", "+", 
     RowBox[{"4", " ", "t", " ", "x"}], "+", 
     RowBox[{"2", " ", "t", " ", 
      SuperscriptBox["x", "2"]}]}], 
    RowBox[{"x", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", "x"}], ")"}], "2"]}]], ",", "0", ",", "0"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.396783070925991*^9, 3.407453433278183*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Remainder", "Subsection",
 CellChangeTimes->{{3.38472405368575*^9, 3.384724055138875*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Remainder", "[", 
   RowBox[{"x_", ",", "a_", ",", "var_"}], "]"}], ":=", 
  RowBox[{"Quiet", "[", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"X", ",", "b", ",", "c", ",", "res"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"RischTrace", "[", 
       RowBox[{"Remainder", ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "a", ",", "var"}], "}"}], ",", "\"\<In\>\""}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"Reference", ":", " ", 
         RowBox[{"Symbolic", " ", "Integration"}]}], ",", " ", "Bronstein", 
        ",", " ", 
        RowBox[{"p", ".115"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"example", " ", "at", " ", "p", ".190"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"X", "=", 
       RowBox[{"Cancel", "[", "x", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"b", ",", "c"}], "}"}], "=", 
       RowBox[{"ExtendedEuclidean", "[", 
        RowBox[{"a", ",", 
         RowBox[{"Denominator", "[", "X", "]"}], ",", "1", ",", "var"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"res", "=", 
       RowBox[{"PolynomialRemainder", "[", 
        RowBox[{
         RowBox[{"Expand", "[", 
          RowBox[{
           RowBox[{"Numerator", "[", "X", "]"}], " ", "c"}], "]"}], ",", "a", 
         ",", "var"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"RischTrace", "[", 
       RowBox[{"Remainder", ",", "res", ",", "\"\<Out\>\""}], "]"}], ";", 
      "\[IndentingNewLine]", "res"}]}], "\[IndentingNewLine]", "]"}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.38472405843575*^9, 3.384724125451375*^9}, {
  3.38472424962325*^9, 3.384724362232625*^9}, {3.384724535670125*^9, 
  3.3847245736545*^9}, {3.387407222430375*^9, 3.387407222649125*^9}, {
  3.3908613436205*^9, 3.390861395229875*^9}, {3.39607545743099*^9, 
  3.3960754616882067`*^9}, {3.404958010495964*^9, 3.4049580959210653`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"a", "=", 
   RowBox[{
    SuperscriptBox["t", "2"], "+", 
    RowBox[{"2", " ", "x", " ", "t"}], "+", 
    SuperscriptBox["x", "2"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", 
       FractionBox["1", 
        SuperscriptBox["x", "2"]]}], ")"}], 
     SuperscriptBox["t", "2"]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", "x"}], "-", "1", "+", 
       FractionBox["2", "x"]}], ")"}], "t"}], "+", 
    SuperscriptBox["x", "2"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p", "=", "t"}], ";"}]}], "Input",
 CellChangeTimes->{{3.38472444637325*^9, 3.3847244959045*^9}}],

Cell[BoxData[
 RowBox[{"Remainder", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "b"}], "/", "a"}], ",", "p", ",", "t"}], "]"}]], "Input",
 CellChangeTimes->{{3.384724364263875*^9, 3.384724369295125*^9}, {
  3.3847244320295*^9, 3.384724444263875*^9}, {3.38472450218575*^9, 
  3.384724507982625*^9}, {3.385441625574*^9, 3.385441628370875*^9}}],

Cell[BoxData[
 RowBox[{"Remainder", "[", 
  RowBox[{
   RowBox[{
    SuperscriptBox["x", "2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"x", "+", "t"}], ")"}], "2"]}], ",", "0", ",", "t"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.396075415581842*^9, 3.396075429301906*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Value at Infinity", "Subsection",
 CellChangeTimes->{{3.384724654045125*^9, 3.384724658138875*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ValueAtInfinity", "[", 
   RowBox[{"f_", ",", "var_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "b", ",", "res"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"RischTrace", "[", 
      RowBox[{"ValueAtInfinity", ",", 
       RowBox[{"{", 
        RowBox[{"f", ",", "var"}], "}"}], ",", "\"\<In\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Value", " ", "at", " ", "infinity"}], ",", " ", 
       RowBox[{"Bronstein", " ", 
        RowBox[{"p", ".", " ", "118"}]}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"f", "===", "0"}], ",", 
       RowBox[{"Return", "[", "0", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"a", "=", 
      RowBox[{"Numerator", "[", "f", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"b", "=", 
      RowBox[{"Denominator", "[", "f", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Exponent", "[", 
         RowBox[{"b", ",", "var"}], "]"}], ">", 
        RowBox[{"Exponent", "[", 
         RowBox[{"a", ",", "var"}], "]"}]}], ",", "0"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{"Cancel", "[", 
       RowBox[{
        RowBox[{"lc", "[", 
         RowBox[{"a", ",", "var"}], "]"}], "/", 
        RowBox[{"lc", "[", 
         RowBox[{"b", ",", "var"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"RischTrace", "[", 
      RowBox[{"ValueAtInfinity", ",", "res", ",", "\"\<Out\>\""}], "]"}], ";",
      "\[IndentingNewLine]", "res"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.384724660388875*^9, 3.384724763701375*^9}, {
  3.384724904717*^9, 3.384724955467*^9}, {3.404958127626843*^9, 
  3.404958181640799*^9}, {3.414057337260302*^9, 3.41405733930405*^9}}],

Cell[BoxData[
 RowBox[{"ValueAtInfinity", "[", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"3", " ", 
      SuperscriptBox["x", "5"]}], "+", "x", "+", "3"}], 
    RowBox[{
     RowBox[{"4", " ", "t", " ", 
      SuperscriptBox["x", "5"]}], "+", 
     RowBox[{"6", " ", "t"}]}]], ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.38472492593575*^9, 3.384724946795125*^9}, {
  3.384724983717*^9, 3.384725015701375*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Monic Polynomial Heuristic", "Subsection",
 CellChangeTimes->{{3.39014737646775*^9, 3.39014738146775*^9}}],

Cell[BoxData[
 RowBox[{"conjrule", ":=", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"a_:", "0"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"b_:", "1"}], ")"}], " ", 
      SqrtBox["n_"]}]}], 
    RowBox[{"c_", "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"d_:", "1"}], ")"}], 
      SqrtBox["n_"]}]}]], "\[RuleDelayed]", 
   RowBox[{"Simplify", "[", 
    FractionBox[
     RowBox[{"Expand", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"a", "+", 
         RowBox[{"b", 
          SqrtBox["n"]}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"c", "-", 
         RowBox[{"d", 
          SqrtBox["n"]}]}], ")"}]}], "]"}], 
     RowBox[{"Expand", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"c", "+", 
         RowBox[{"d", 
          SqrtBox["n"]}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"c", "-", 
         RowBox[{"d", 
          SqrtBox["n"]}]}], ")"}]}], "]"}]], "]"}]}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"monic", "[", 
   RowBox[{"result_", ",", "var_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "output", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"output", "=", 
     RowBox[{"result", "//.", 
      RowBox[{
       RowBox[{"Log", "[", "f_", "]"}], "\[RuleDelayed]", 
       RowBox[{
        RowBox[{"Log", "[", 
         RowBox[{"Collect", "[", 
          RowBox[{
           RowBox[{"Expand", "[", 
            RowBox[{"Plus", "@@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"#1", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], 
                  SuperscriptBox[
                   RowBox[{
                    RowBox[{"Variables", "[", "f", "]"}], 
                    "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                   RowBox[{
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", "1"}]]}], "&"}], "/@", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"i", ",", 
                    RowBox[{"Simplify", "[", 
                    RowBox[{"Divide", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"CoefficientList", "[", 
                    RowBox[{"f", ",", 
                    RowBox[{
                    RowBox[{"Variables", "[", "f", "]"}], 
                    "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
                    "]"}], "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"CoefficientList", "[", 
                    RowBox[{"f", ",", 
                    RowBox[{
                    RowBox[{"Variables", "[", "f", "]"}], 
                    "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
                    "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"Length", "[", 
                    RowBox[{"CoefficientList", "[", 
                    RowBox[{"f", ",", 
                    RowBox[{
                    RowBox[{"Variables", "[", "f", "]"}], 
                    "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
                    "]"}], "]"}], "]"}], "]"}]}], "]"}], "]"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"CoefficientList", "[", 
                    RowBox[{"f", ",", 
                    RowBox[{
                    RowBox[{"Variables", "[", "f", "]"}], 
                    "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
                    "]"}], "]"}]}], "}"}]}], "]"}]}], "/.", "conjrule"}], 
              ")"}]}], "]"}], ",", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Variables", "[", "f", "]"}], "\[LeftDoubleBracket]", 
              "1", "\[RightDoubleBracket]"}], ")"}], 
            RowBox[{"_", ":", "1"}]]}], "]"}], "]"}], "/;", 
        RowBox[{"!", 
         RowBox[{"FreeQ", "[", 
          RowBox[{"f", ",", "var"}], "]"}]}]}]}]}]}]}], "\[IndentingNewLine]",
    "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.39293337059275*^9, 3.3929334166865*^9}, {
   3.392933887233375*^9, 3.39293392496775*^9}, {3.39293401840525*^9, 
   3.392934024608375*^9}, 3.392934107639625*^9, {3.392934172889625*^9, 
   3.39293418853025*^9}, {3.39293442340525*^9, 3.392934425577125*^9}, {
   3.392934483577125*^9, 3.3929344854365*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Order Function", "Subsection",
 CellChangeTimes->{{3.391310718464875*^9, 3.391310720496125*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"OrderFunction", "[", 
   RowBox[{"0", ",", "a_", ",", "toptheta_"}], "]"}], ":=", "0"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.408009316559816*^9, 3.408009327412455*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"OrderFunction", "[", 
   RowBox[{"x_", ",", "a_", ",", "toptheta_"}], "]"}], ":=", 
  RowBox[{"Catch", "[", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "n", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"RischTrace", "[", 
       RowBox[{"OrderFunction", ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "a", ",", "toptheta"}], "}"}], ",", "\"\<In\>\""}],
        "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"The", " ", "Order", " ", "Function"}], ",", " ", 
        RowBox[{"reference", ":", " ", 
         RowBox[{"Symbolic", " ", "Integration"}]}], ",", " ", "Bronstein", 
        ",", " ", 
        RowBox[{"p", ".107"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"v_", 
          RowBox[{"{", "a", "}"}], 
          RowBox[{"(", "0", ")"}]}], " ", "=", " ", "Infinity"}], ",", " ", 
        RowBox[{"for", " ", "x", " ", "in", " ", 
         RowBox[{"D", "\\", 
          RowBox[{"{", "0", "}"}]}]}], ",", " ", 
        RowBox[{
         RowBox[{"v_", 
          RowBox[{"{", "a", "}"}], 
          RowBox[{"(", "x", ")"}]}], " ", "=", " ", 
         RowBox[{"max", 
          RowBox[{"(", 
           RowBox[{"n", " ", "in", " ", "N", " ", "such", " ", "that", " ", 
            RowBox[{"a", "^", "n"}], " ", "divides", " ", "x"}], ")"}]}]}]}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"a", "==", "0"}], ",", 
        RowBox[{"Throw", "[", "Infinity", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"FreeQ", "[", 
         RowBox[{
          RowBox[{"Denominator", "[", "x", "]"}], ",", "toptheta"}], "]"}], 
        ",", "\[IndentingNewLine]", "\t\t", 
        RowBox[{
         RowBox[{"n", "=", "0"}], ";", "\[IndentingNewLine]", "\t\t", 
         RowBox[{"While", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"PolynomialRemainder", "[", 
             RowBox[{"x", ",", 
              SuperscriptBox["a", "n"], ",", "toptheta"}], "]"}], "===", 
            "0"}], ",", 
           RowBox[{"n", "++"}]}], "]"}], ";", "\[IndentingNewLine]", "\t\t", 
         RowBox[{"RischTrace", "[", 
          RowBox[{"OrderFunction", ",", 
           RowBox[{"n", "-", "1"}], ",", "\"\<Out\>\""}], "]"}], ";", 
         "\[IndentingNewLine]", "\t\t", 
         RowBox[{"Throw", "[", 
          RowBox[{"n", "-", "1"}], "]"}]}], "\[IndentingNewLine]", "\t\t", 
        ",", "\[IndentingNewLine]", "\t", "True", ",", "\[IndentingNewLine]", 
        "\t\t", 
        RowBox[{"Throw", "[", 
         RowBox[{
          RowBox[{"OrderFunction", "[", 
           RowBox[{
            RowBox[{"Numerator", "[", "x", "]"}], ",", "a", ",", "toptheta"}],
            "]"}], "-", 
          RowBox[{"OrderFunction", "[", 
           RowBox[{
            RowBox[{"Denominator", "[", "x", "]"}], ",", "a", ",", 
            "toptheta"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBmIQ7ZSQUpDp8tLRKeEWlD5QCqHbG8D0A88JELphMoT+
swki37gZwhfbDeHvgdAPTu6H0DonIPSTsxB55UsQvutTCJ33FkJfFMoCy7uL
gekHElIQfh+EfqBjCOEnmEP4X9whdLMXiD7fnH5/i+9Lxzk18Q9BtMZSLacq
v5eOIQW+wSC6L5IjEkRfn3YCTG/Ya1wIptN+gulvF/gqQDTf80ddYL4Iu2th
3EvH/H5rdxDNPG1LCog++HFuBogGAMV+k/c=
  "]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"OrderFunction", "[", 
  RowBox[{
   FractionBox[
    RowBox[{"2", " ", "\[ImaginaryI]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SubsuperscriptBox["\[Theta]", "1", "4"]}], ")"}]}], 
    SubsuperscriptBox["\[Theta]", "1", "2"]], ",", 
   SubscriptBox["\[Theta]", "1"], ",", 
   SubscriptBox["\[Theta]", "1"]}], "]"}]], "Input",
 CellChangeTimes->{{3.396588203331953*^9, 3.39658822114822*^9}}],

Cell[BoxData[
 RowBox[{"-", "2"}]], "Output",
 CellChangeTimes->{{3.396588221810295*^9, 3.396588239601845*^9}, 
   3.39658839160607*^9, 3.3965884330737877`*^9, {3.396588537471971*^9, 
   3.39658856371243*^9}, {3.396588624635743*^9, 3.396588632191126*^9}, 
   3.396782972664207*^9, 3.404958534248768*^9, 3.4074535158905973`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"OrderFunction", "[", 
  RowBox[{
   SubsuperscriptBox["\[Theta]", "1", "2"], ",", 
   SubscriptBox["\[Theta]", "1"], ",", 
   SubscriptBox["\[Theta]", "1"]}], "]"}]], "Input",
 CellChangeTimes->{{3.396588203331953*^9, 3.39658822114822*^9}, {
  3.39658844079031*^9, 3.396588450035574*^9}}],

Cell[BoxData["2"], "Output",
 CellChangeTimes->{
  3.396588564345566*^9, {3.3965886262213078`*^9, 3.396588632793906*^9}, 
   3.396782977280238*^9, 3.4049585371660137`*^9, 3.407453516531259*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"OrderFunction", "[", 
  RowBox[{
   FractionBox[
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       SubsuperscriptBox["\[Theta]", "1", "2"]}], ")"}]}], 
    SubscriptBox["\[Theta]", "1"]], ",", 
   SubscriptBox["\[Theta]", "1"], ",", 
   SubscriptBox["\[Theta]", "1"]}], "]"}]], "Input",
 CellChangeTimes->{{3.396588192701392*^9, 3.396588196329364*^9}, {
  3.396588343086986*^9, 3.396588355362679*^9}}],

Cell[BoxData[
 RowBox[{"-", "1"}]], "Output",
 CellChangeTimes->{
  3.396588356010957*^9, 3.3965883922305326`*^9, 3.396588433931655*^9, {
   3.396588627617976*^9, 3.396588633467081*^9}, 3.4049585392131023`*^9, 
   3.407453517232346*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Clear", "[", "t", "]"}]], "Input",
 CellChangeTimes->{{3.4074535292307587`*^9, 3.407453530688128*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"OrderFunction", "[", 
  RowBox[{
   RowBox[{
    FractionBox["t", 
     SuperscriptBox["x", "2"]], "+", 
    FractionBox["2", "x"], "-", "1"}], ",", "t", ",", "t"}], "]"}]], "Input",
 CellChangeTimes->{{3.391311427418*^9, 3.391311433089875*^9}, {
  3.39131200238675*^9, 3.391312011746125*^9}, {3.391312320558625*^9, 
  3.391312320933625*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.396588044520505*^9, 3.396588393479485*^9, 3.3965886342832823`*^9, {
   3.407453518124259*^9, 3.407453531941801*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"OrderFunction", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", 
        FractionBox["1", 
         SuperscriptBox["x", "2"]]}], ")"}], 
      SuperscriptBox["t", "2"]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", "x"}], "-", "1", "+", 
        RowBox[{"2", "/", "x"}]}], ")"}], "t"}], "+", 
     SuperscriptBox["x", "2"]}], ",", "t", ",", "t"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"agrees", " ", "with", " ", "Bronstein"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.396180562928563*^9, 3.396180612027413*^9}, {
  3.396180701100389*^9, 3.396180706195657*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.396588395291028*^9, 3.396588634888317*^9, {3.407453519683283*^9, 
   3.407453532527714*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"OrderFunction", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"t", "/", 
      SuperscriptBox["x", "2"]}], "-", "1", "+", 
     RowBox[{"2", "/", "x"}]}], ",", "t", ",", "t"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"agrees", " ", "with", " ", "Bronstein"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.396180562928563*^9, 3.396180629714485*^9}, 
   3.396180710078965*^9}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.396588396546063*^9, 3.3965886356101294`*^9, {3.407453521980426*^9, 
   3.407453533014007*^9}}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Rioboo Conversion", "Subsection",
 CellChangeTimes->{{3.393520980027875*^9, 3.393520989981*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"LogToReal", "[", 
   RowBox[{"R_", ",", "S_", ",", "theta_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "x", ",", "y", ",", "rRe", ",", "rIm", ",", "sRe", ",", "sIm", ",", 
      "roots", ",", "log", ",", "atan", ",", "a", ",", "b", ",", "a1", ",", 
      "\[IndentingNewLine]", "b1", ",", "a2", ",", "b2", ",", "root", ",", 
      "logarg", ",", "logterm", ",", "atanterm", ",", "result"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"RischTrace", "[", 
      RowBox[{"LogToReal", ",", 
       RowBox[{"{", 
        RowBox[{"R", ",", "S", ",", "theta"}], "}"}], ",", "\"\<In\>\""}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"rRe", "=", 
      RowBox[{"ComplexExpand", "[", 
       RowBox[{"Re", "[", 
        RowBox[{"R", "/.", 
         RowBox[{"rischZ", "\[Rule]", 
          RowBox[{"x", "+", 
           RowBox[{"I", " ", "y"}]}]}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rIm", "=", 
      RowBox[{"ComplexExpand", "[", 
       RowBox[{"Im", "[", 
        RowBox[{"R", "/.", 
         RowBox[{"rischZ", "\[Rule]", 
          RowBox[{"x", "+", 
           RowBox[{"I", " ", "y"}]}]}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"sRe", "=", 
      RowBox[{"ComplexExpand", "[", 
       RowBox[{"Re", "[", 
        RowBox[{"S", "/.", 
         RowBox[{"rischZ", "\[Rule]", 
          RowBox[{"x", "+", 
           RowBox[{"I", " ", "y"}]}]}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"sIm", "=", 
      RowBox[{"ComplexExpand", "[", 
       RowBox[{"Im", "[", 
        RowBox[{"S", "/.", 
         RowBox[{"rischZ", "\[Rule]", 
          RowBox[{"x", "+", 
           RowBox[{"I", " ", "y"}]}]}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "both", " ", "sRe", " ", "and", " ", "sIm", " ", "are", " ", "at", " ", 
       "most", " ", "quadratic", " ", "polynomials"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"roots", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", "y"}], "}"}], "/.", 
       RowBox[{"Solve", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"rRe", "\[Equal]", "0"}], "&&", 
          RowBox[{"rIm", "\[Equal]", "0"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"result", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Which", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "roots", "]"}], "\[Equal]", "1"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{
           RowBox[{"Sign", "[", 
            RowBox[{"Last", "[", "roots", "]"}], "]"}], ",", "1"}], "]"}], 
         ",", "\[IndentingNewLine]", "\t\t", 
         RowBox[{
          RowBox[{"logarg", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"sRe", "/.", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"x", "\[Rule]", 
                  RowBox[{"First", "[", "roots", "]"}]}], ",", 
                 RowBox[{"y", "\[Rule]", 
                  RowBox[{"Last", "[", "roots", "]"}]}]}], "}"}]}], ")"}], 
             "^", "2"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"sIm", "/.", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"x", "\[Rule]", 
                  RowBox[{"First", "[", "roots", "]"}]}], ",", 
                 RowBox[{"y", "\[Rule]", 
                  RowBox[{"Last", "[", "roots", "]"}]}]}], "}"}]}], ")"}], 
             "^", "2"}]}]}], ";", "\[IndentingNewLine]", "\t\t", 
          RowBox[{"logterm", "=", 
           RowBox[{
            RowBox[{"First", "[", "roots", "]"}], " ", 
            RowBox[{"rischLog", "[", 
             RowBox[{"primitive", "[", 
              RowBox[{
               RowBox[{"Together", "[", "logarg", "]"}], ",", "theta"}], 
              "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", "\t\t", 
          RowBox[{"atanterm", "=", 
           RowBox[{
            RowBox[{"Last", "[", "roots", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"LogToAtan", "[", 
               RowBox[{"sRe", ",", "sIm", ",", "theta"}], "]"}], "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"x", "\[Rule]", 
                 RowBox[{"First", "[", "roots", "]"}]}], ",", 
                RowBox[{"y", "\[Rule]", 
                 RowBox[{"Last", "[", "roots", "]"}]}]}], "}"}]}], ")"}]}]}], 
          ";", "\[IndentingNewLine]", "\t\t", 
          RowBox[{"result", "=", 
           RowBox[{
            RowBox[{"Simplify", "[", "logterm", "]"}], "+", 
            RowBox[{"Simplify", "[", "atanterm", "]"}]}]}]}]}], "]"}], ",", 
       "\[IndentingNewLine]", "True", ",", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"root", "=", 
           RowBox[{"roots", "[", 
            RowBox[{"[", "rt", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          "\t\t", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"SameQ", "[", 
             RowBox[{
              RowBox[{"Sign", "[", 
               RowBox[{"Last", "[", "root", "]"}], "]"}], ",", "1"}], "]"}], 
            ",", "\[IndentingNewLine]", "\t\t", 
            RowBox[{
             RowBox[{"logarg", "=", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"sRe", "/.", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"x", "\[Rule]", 
                    RowBox[{"First", "[", "root", "]"}]}], ",", 
                    RowBox[{"y", "\[Rule]", 
                    RowBox[{"Last", "[", "root", "]"}]}]}], "}"}]}], ")"}], 
                "^", "2"}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"sIm", "/.", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"x", "\[Rule]", 
                    RowBox[{"First", "[", "root", "]"}]}], ",", 
                    RowBox[{"y", "\[Rule]", 
                    RowBox[{"Last", "[", "root", "]"}]}]}], "}"}]}], ")"}], 
                "^", "2"}]}]}], ";", "\[IndentingNewLine]", "\t\t", 
             RowBox[{"logterm", "=", 
              RowBox[{
               RowBox[{"First", "[", "root", "]"}], " ", 
               RowBox[{"rischLog", "[", 
                RowBox[{"primitive", "[", 
                 RowBox[{
                  RowBox[{"Together", "[", "logarg", "]"}], ",", "theta"}], 
                 "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", "\t\t", 
             RowBox[{"atanterm", "=", 
              RowBox[{
               RowBox[{"Last", "[", "root", "]"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"LogToAtan", "[", 
                  RowBox[{"sRe", ",", "sIm", ",", "theta"}], "]"}], "/.", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"x", "\[Rule]", 
                    RowBox[{"First", "[", "root", "]"}]}], ",", 
                   RowBox[{"y", "\[Rule]", 
                    RowBox[{"Last", "[", "root", "]"}]}]}], "}"}]}], 
                ")"}]}]}], ";", "\[IndentingNewLine]", "\t\t", 
             RowBox[{"result", "=", 
              RowBox[{"result", "+", 
               RowBox[{"Simplify", "[", "logterm", "]"}], "+", 
               RowBox[{"Simplify", "[", "atanterm", "]"}]}]}]}]}], "]"}]}], 
         ",", "\[IndentingNewLine]", "\t", 
         RowBox[{"{", 
          RowBox[{"rt", ",", "1", ",", 
           RowBox[{"Length", "[", "roots", "]"}]}], "}"}]}], "]"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"RischTrace", "[", 
      RowBox[{"LogToReal", ",", "result", ",", "\"\<Out\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", "result"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.404958671317225*^9, 3.4049587306761303`*^9}, 
   3.407965179636969*^9, 3.409130013442297*^9, {3.409132082786344*^9, 
   3.4091320871340933`*^9}, {3.409132589382427*^9, 3.409132615963594*^9}, {
   3.409132676189239*^9, 3.409132686474978*^9}, {3.409132738725052*^9, 
   3.4091327524467573`*^9}, {3.409132785972546*^9, 3.409132789771119*^9}, {
   3.409132883356843*^9, 3.409132888860471*^9}, {3.409132924927331*^9, 
   3.409132925142392*^9}, {3.409133172480302*^9, 3.40913317409622*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "a", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a", "/:", 
   RowBox[{"Sign", "[", "a", "]"}], "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"LogToReal", "[", 
  RowBox[{
   RowBox[{"1", "+", 
    RowBox[{"16", " ", 
     SuperscriptBox["a", "6"], " ", 
     SuperscriptBox["rischZ", "2"]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "4"}], " ", 
     SuperscriptBox["a", "4"], " ", "rischZ"}], "+", "x"}], ",", "x"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.404545912886869*^9, 3.404545915964459*^9}, {
  3.404958749311561*^9, 3.4049587549828463`*^9}, {3.404985081999264*^9, 
  3.404985084918475*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"ArcTan", "[", 
    FractionBox["x", "a"], "]"}], 
   RowBox[{"2", " ", 
    SuperscriptBox["a", "3"]}]]}]], "Output",
 CellChangeTimes->{{3.404545917755286*^9, 3.4045459460082684`*^9}, 
   3.404545978911693*^9, 3.404546010605528*^9, 3.404548746818452*^9, {
   3.404958737155141*^9, 3.404958756244961*^9}, {3.404985076237924*^9, 
   3.4049850853777637`*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"LogToAtan", "[", 
   RowBox[{"a_", ",", "b_", ",", "var_"}], "]"}], ":=", 
  RowBox[{"Quiet", "[", 
   RowBox[{"Catch", "[", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"A", "=", "a"}], ",", 
        RowBox[{"B", "=", "b"}], ",", "d", ",", "c", ",", "g", ",", "res"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"RischTrace", "[", 
        RowBox[{"LogToAtan", ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b", ",", "var"}], "}"}], ",", "\"\<In\>\""}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"Rioboo", " ", "Conversion"}], ",", " ", 
         RowBox[{"reference", ":", " ", 
          RowBox[{"Symbolic", " ", "Integration"}]}], ",", " ", "Bronstein", 
         ",", " ", 
         RowBox[{"p", ".107"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "Given", " ", "a", " ", "field", " ", "K", " ", "of", " ", 
          "characteristic", " ", "0", " ", "such", " ", "that", " ", 
          RowBox[{"Sqrt", "[", 
           RowBox[{"-", "1"}], "]"}], " ", "is", " ", "not", " ", "in", " ", 
          "K", " ", "and", "\[IndentingNewLine]", "A"}], ",", 
         RowBox[{
          RowBox[{"B", " ", "in", " ", 
           RowBox[{"K", "[", "x", "]"}], " ", "with", " ", "B"}], "!=", "0"}],
          ",", " ", 
         RowBox[{
          RowBox[{
          "return", " ", "a", " ", "sum", " ", "f", " ", "of", " ", 
           "arctangents", " ", "of", " ", "polynomials", " ", "in", " ", 
           RowBox[{"K", "[", "x", "]"}], "\[IndentingNewLine]", "such", " ", 
           "that", " ", 
           RowBox[{"D", "[", 
            RowBox[{"f", ",", "x"}], "]"}]}], " ", "=", " ", 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"I", " ", 
             RowBox[{"Log", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"a", " ", "+", " ", 
                 RowBox[{"I", " ", "B"}]}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{"A", " ", "-", " ", 
                 RowBox[{"I", " ", "B"}]}], ")"}]}], "]"}]}], ",", "x"}], 
           "]"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Mod", "[", 
            RowBox[{"A", ",", "B"}], "]"}], "\[Equal]", "0"}], "||", 
          RowBox[{
           RowBox[{"PolynomialMod", "[", 
            RowBox[{"A", ",", "B"}], "]"}], "\[Equal]", "0"}]}], ",", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"RischTrace", "[", 
           RowBox[{"LogToAtan", ",", 
            RowBox[{"{", 
             RowBox[{"a", ",", "b", ",", "var"}], "}"}], ",", "\"\<Out\>\""}],
            "]"}], ";", "\[IndentingNewLine]", "\t", 
          RowBox[{"Throw", "[", 
           RowBox[{"2", " ", 
            RowBox[{"ArcTan", "[", 
             FractionBox["A", "B"], "]"}]}], "]"}]}]}], "\[IndentingNewLine]",
         "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Exponent", "[", 
           RowBox[{"A", ",", "var"}], "]"}], "<", 
          RowBox[{"Exponent", "[", 
           RowBox[{"B", ",", "var"}], "]"}]}], ",", "\[IndentingNewLine]", 
         "\t", 
         RowBox[{
          RowBox[{"RischTrace", "[", 
           RowBox[{"LogToAtan", ",", 
            RowBox[{"HoldForm", "[", 
             RowBox[{"LogToAtan", "[", 
              RowBox[{
               RowBox[{"-", "B"}], ",", "A", ",", "var"}], "]"}], "]"}], ",", 
            "\"\<Out\>\""}], "]"}], ";", "\[IndentingNewLine]", "\t", 
          RowBox[{"Throw", "[", 
           RowBox[{"LogToAtan", "[", 
            RowBox[{
             RowBox[{"-", "B"}], ",", "A", ",", "var"}], "]"}], "]"}]}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"d", ",", "c"}], "}"}], "=", 
        RowBox[{"ExtendedEuclidean", "[", 
         RowBox[{"B", ",", 
          RowBox[{"-", "A"}], ",", 
          RowBox[{"PolynomialGCD", "[", 
           RowBox[{"A", ",", "B"}], "]"}], ",", "var"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"g", "=", 
        RowBox[{"PolynomialGCD", "[", 
         RowBox[{"A", ",", "B"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"res", "=", 
        RowBox[{
         RowBox[{"2", " ", 
          RowBox[{"ArcTan", "[", 
           RowBox[{"Simplify", "[", 
            FractionBox[
             RowBox[{
              RowBox[{"A", " ", "d"}], "+", 
              RowBox[{"B", " ", "c"}]}], "g"], "]"}], "]"}]}], "+", 
         RowBox[{"LogToAtan", "[", 
          RowBox[{"d", ",", "c", ",", "var"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"RischTrace", "[", 
        RowBox[{"LogToAtan", ",", "res", ",", "\"\<Out\>\""}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Throw", "[", "res", "]"}]}]}], "\[IndentingNewLine]", "]"}], 
    "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.393520994152875*^9, 3.39352112363725*^9}, {
   3.3935223866685*^9, 3.39352240369975*^9}, 3.39352255632475*^9, {
   3.393523024840375*^9, 3.393523031152875*^9}, {3.393523062465375*^9, 
   3.3935230854185*^9}, {3.393523120715375*^9, 3.393523120856*^9}, {
   3.3935326493385*^9, 3.3935326643385*^9}, {3.395546605301056*^9, 
   3.395546608891053*^9}, {3.3979554051565123`*^9, 3.397955430795663*^9}, {
   3.397955570092746*^9, 3.397955580123704*^9}, {3.3979587535353193`*^9, 
   3.397958754636292*^9}, {3.40495881143076*^9, 3.4049590144557943`*^9}}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Integration of Transcendental Functions", "Section",
 CellChangeTimes->{{3.384725156951375*^9, 3.38472516437325*^9}}],

Cell[CellGroupData[{

Cell["Hermite Reduction (Linear Version)", "Subsection",
 CellChangeTimes->{{3.409905324116131*^9, 3.409905330523992*^9}}],

Cell["\<\
AXIOM'S Linear Hermite Algorithm:

-- Hermite Reduction on f, every squarefree factor of denom(f) is normal wrt D
-- this is really a \"parallel\" Hermite reduction, in the sense that
-- every multiple factor of the denominator gets reduced at each pass
-- so if the denominator is P1 P2**2 ... Pn**n, this requires O(n)
-- reduction steps instead of O(n**2), like Mack's algorithm
-- (D.Mack, On Rational Integration, Univ. of Utah C.S. Tech.Rep. UCP-38,1975)
-- returns [g, b, d] s.t. f = g' + b/d and d is squarefree and normal wrt D
    normalHermiteIntegrate(f, derivation) ==
      a := numer f
      q := denom f
      p:UP    := 0
      mult:UP := 1
      qhat := (q exquo (g0 := g := gcd(q, differentiate q)))::UP
      while(degree(qbar := g) > 0) repeat
        qbarhat := (qbar exquo (g := gcd(qbar, differentiate qbar)))::UP
        qtil:= - ((qhat * (derivation qbar)) exquo qbar)::UP
        bc :=
         extendedEuclidean(qtil, qbarhat, a)::Record(coef1:UP, coef2:UP)
        qr := divide(bc.coef1, qbarhat)
        a  := bc.coef2 + qtil * qr.quotient - derivation(qr.remainder)
               * (qhat exquo qbarhat)::UP
        p  := p + mult * qr.remainder
        mult:= mult * qbarhat
      [p / g0, a, qhat]\
\>", "Text",
 CellChangeTimes->{{3.407617997998591*^9, 3.407618015150758*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"this", " ", "is", " ", "buggy"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"HermiteReduceLinear", "[", 
    RowBox[{"f_", ",", "theta_", ",", "Dtower_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "d", ",", 
       RowBox[{"g", "=", "0"}], ",", "dn", ",", "ds", ",", "dnn", ",", "dns", 
       ",", "dq", ",", "b", ",", "c", ",", "res"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"RischTrace", "[", 
       RowBox[{"HermiteReduceLinear", ",", 
        RowBox[{"{", 
         RowBox[{"f", ",", "theta", ",", "Dtower"}], "}"}], ",", 
        "\"\<In\>\""}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"Mack", "'"}], "s", " ", "version", " ", "of", " ", "Hermite",
         " ", 
        RowBox[{"reduction", ".", " ", "Unlike"}], " ", "the", " ", 
        "traditional", "\[IndentingNewLine]", "Hermite", " ", "reduction", 
        " ", "algorithm", " ", "this", " ", "does", " ", "not", " ", 
        "require", " ", "a", " ", "partial", " ", "fraction", 
        "\[IndentingNewLine]", "decomposition", " ", "and", " ", "is", " ", 
        "O", 
        RowBox[{"(", "n", ")"}], " ", "instead", " ", "of", " ", "O", 
        RowBox[{"(", 
         RowBox[{"n", "^", "2"}], ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "Given", " ", "a", " ", "field", " ", "K", " ", "and", " ", "A"}], 
        ",", 
        RowBox[{"D", " ", "which", " ", "lie", " ", "in", " ", 
         RowBox[{"K", "[", "x", "]"}], " ", "with", " ", "D", " ", "nonzero", 
         " ", "and", " ", "coprime", " ", "with", " ", "A"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"return", " ", "g"}], ",", 
        RowBox[{
         RowBox[{"h", " ", "in", " ", "K", 
          RowBox[{"(", "x", ")"}], " ", "such", " ", "that", " ", 
          RowBox[{"A", "/", "D"}]}], " ", "=", " ", 
         RowBox[{
          RowBox[{"TotalDerivation", "[", 
           RowBox[{"g", ",", "theta", ",", "Dtower"}], "]"}], " ", "+", " ", 
          RowBox[{
          "h", " ", "and", " ", "h", "\[IndentingNewLine]", "has", " ", "a", 
           " ", "squarefree", " ", 
           RowBox[{"denominator", "."}]}]}]}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a", ",", "d"}], "}"}], "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Numerator", "[", "f", "]"}], ",", 
         RowBox[{"Denominator", "[", "f", "]"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dn", "=", 
       RowBox[{"PolynomialGCD", "[", 
        RowBox[{"d", ",", 
         RowBox[{"TotalDerivation", "[", 
          RowBox[{"d", ",", "theta", ",", "Dtower"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ds", "=", 
       RowBox[{"Cancel", "[", 
        RowBox[{"d", "/", "dn"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", "ds", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"res", "=", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"a", "/", "d"}], ",", "0"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Exponent", "[", 
          RowBox[{"dn", ",", 
           RowBox[{"Last", "[", "theta", "]"}]}], "]"}], ">", "0"}], ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"dnn", "=", 
          RowBox[{"PolynomialGCD", "[", 
           RowBox[{"dn", ",", 
            RowBox[{"TotalDerivation", "[", 
             RowBox[{"dn", ",", "theta", ",", "Dtower"}], "]"}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", "\t", 
         RowBox[{"dns", "=", 
          RowBox[{"Cancel", "[", 
           RowBox[{"dn", "/", "dnn"}], "]"}]}], ";", "\[IndentingNewLine]", 
         "\t", 
         RowBox[{"dq", "=", 
          RowBox[{"Cancel", "[", 
           RowBox[{
            RowBox[{"-", "ds"}], " ", 
            RowBox[{
             RowBox[{"TotalDerivation", "[", 
              RowBox[{"dn", ",", "theta", ",", "Dtower"}], "]"}], "/", 
             "dn"}]}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"b", ",", "c"}], "}"}], "=", 
          RowBox[{"ExtendedEuclidean", "[", 
           RowBox[{"dq", ",", "dns", ",", "a", ",", 
            RowBox[{"Last", "[", "theta", "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{"a", "=", 
          RowBox[{"Expand", "[", 
           RowBox[{"c", "-", 
            RowBox[{"Cancel", "[", 
             RowBox[{
              RowBox[{"TotalDerivation", "[", 
               RowBox[{"b", ",", "theta", ",", "Dtower"}], "]"}], 
              RowBox[{"ds", "/", "dns"}]}], "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{"g", "=", 
          RowBox[{"g", "+", 
           RowBox[{"Cancel", "[", 
            RowBox[{"b", "/", "dn"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         "\t", 
         RowBox[{"dn", "=", "dnn"}], ";", "\[IndentingNewLine]", "\t", 
         RowBox[{"res", "=", 
          RowBox[{"{", 
           RowBox[{"g", ",", 
            RowBox[{"a", "/", "ds"}], ",", "ds"}], "}"}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"RischTrace", "[", 
       RowBox[{"HermiteReduceLinear", ",", "res", ",", "\"\<Out\>\""}], "]"}],
       ";", "\[IndentingNewLine]", "res"}]}], "\[IndentingNewLine]", 
    "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.409905331972951*^9, 3.409905514495463*^9}, {
  3.409905547367341*^9, 3.4099056548571453`*^9}, {3.409905687642956*^9, 
  3.409905772338595*^9}, {3.409905806987495*^9, 3.409905852299562*^9}, {
  3.4099058991956*^9, 3.409906012612969*^9}, {3.40990604579701*^9, 
  3.409906095285709*^9}, {3.409906166664084*^9, 3.409906173206113*^9}, {
  3.409906213232502*^9, 3.409906241934346*^9}, {3.409906286992755*^9, 
  3.4099062870863647`*^9}, {3.409906462448598*^9, 3.409906466646371*^9}, {
  3.4099067274577217`*^9, 3.409906765175782*^9}, {3.409907108346561*^9, 
  3.4099071534570827`*^9}, {3.409907371922011*^9, 3.40990741187261*^9}, {
  3.4099081296962337`*^9, 3.409908133408608*^9}, {3.409908256140584*^9, 
  3.409908257011952*^9}, {3.409908416802629*^9, 3.409908420926263*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"HermiteReduceLinear", "[", 
  RowBox[{
   FractionBox[
    RowBox[{"1", "-", 
     RowBox[{"theta", "[", "1", "]"}]}], 
    RowBox[{
     SuperscriptBox["x", "2"], "-", 
     SuperscriptBox[
      RowBox[{"theta", "[", "1", "]"}], "2"]}]], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"theta", "[", "1", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"1", "/", "x"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.409907052230788*^9, 3.409907082960319*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", 
   FractionBox[
    RowBox[{"1", "-", 
     SubscriptBox["\[Theta]", "1"]}], 
    RowBox[{
     SuperscriptBox["x", "2"], "-", 
     SubsuperscriptBox["\[Theta]", "1", "2"]}]], ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.4099070776007433`*^9, 3.409907083796638*^9}, {
   3.409907142525136*^9, 3.409907156003127*^9}, 3.409907842351428*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"HermiteReduceLinear", "[", 
   RowBox[{
    FractionBox[
     RowBox[{"x", "-", "t"}], 
     SuperscriptBox["t", "2"]], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "t"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", 
      RowBox[{"1", "+", 
       SuperscriptBox["t", "2"]}]}], "}"}]}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"example", " ", "from", " ", "Bronstein"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.384727182717*^9, 3.384727203701375*^9}, {
   3.384727441920125*^9, 3.3847274420295*^9}, {3.3847301715295*^9, 
   3.384730174717*^9}, {3.384743334967*^9, 3.384743335076375*^9}, {
   3.38474614706075*^9, 3.38474615131075*^9}, 3.38544538823025*^9, {
   3.385445916902125*^9, 3.38544591704275*^9}, {3.385446305949*^9, 
   3.385446306058375*^9}, {3.385446950027125*^9, 3.3854469501365*^9}, 
   3.385484365701375*^9, 3.385484453513875*^9, 3.3854845994045*^9, {
   3.385484749638875*^9, 3.3854847676545*^9}, {3.385485629309*^9, 
   3.385485643418375*^9}, {3.3854858891215*^9, 3.385485893059*^9}, {
   3.385490325668*^9, 3.385490328558625*^9}, 3.385491584464875*^9, {
   3.385494653698625*^9, 3.3854946596205*^9}, {3.385495977729*^9, 
   3.385495981963375*^9}, {3.385496042400875*^9, 3.38549605219775*^9}, {
   3.3854986088225*^9, 3.385498613088125*^9}, {3.385498660385*^9, 
   3.38549866635375*^9}, {3.38568031212075*^9, 3.3856803203395*^9}, {
   3.385684437402*^9, 3.385684438073875*^9}, {3.3904448291393747`*^9, 
   3.3904448402487497`*^9}, {3.40990619998215*^9, 3.409906207237651*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    FractionBox["x", "t"]}], ",", 
   RowBox[{"-", "x"}], ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.4099061924951077`*^9, 3.409906243175255*^9}, 
   3.4099062896059217`*^9, {3.409906602833044*^9, 3.40990661682843*^9}, 
   3.409906766704824*^9, 3.4099068614518833`*^9, 3.409907159664166*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Hermite Reduction (Quadratic version)", "Subsection",
 CellChangeTimes->{{3.384725184420125*^9, 3.384725191013875*^9}, {
  3.409905316300202*^9, 3.409905321444018*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"HermiteReduction", "[", 
   RowBox[{"f_", ",", "theta_", ",", "Dtower_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "fp", ",", "fs", ",", "fn", ",", "a", ",", "d", ",", "dsqf", ",", 
      "dlist", ",", "dseq", ",", 
      RowBox[{"g", "=", "0"}], ",", "v", ",", "u", ",", "b", ",", "c", ",", 
      "q", ",", "r", ",", "result"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"RischTrace", "[", 
      RowBox[{"HermiteReduction", ",", 
       RowBox[{"{", 
        RowBox[{"f", ",", "theta", ",", "Dtower"}], "}"}], ",", 
       "\"\<In\>\""}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Hermite", " ", "Reduction"}], " ", "-", " ", 
        RowBox[{"quadratic", " ", "version"}]}], ",", " ", 
       RowBox[{"reference", ":", " ", 
        RowBox[{"Symbolic", " ", "Integration"}]}], ",", " ", 
       RowBox[{"Bronstein", " ", 
        RowBox[{"p", ".", " ", "139"}]}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a", ",", "d"}], "}"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Numerator", "[", "f", "]"}], ",", 
        RowBox[{"Denominator", "[", "f", "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dsqf", "=", 
      RowBox[{"First", "/@", 
       RowBox[{"Squarefree", "[", 
        RowBox[{"d", ",", 
         RowBox[{"Last", "[", "theta", "]"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "dsqf", "]"}], "===", "1"}], ",", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"RischTrace", "[", 
         RowBox[{"HermiteReduction", ",", 
          RowBox[{"{", 
           RowBox[{"f", ",", "theta", ",", "Dtower"}], "}"}], ",", 
          "\"\<Out\>\""}], "]"}], ";", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"Return", "[", " ", 
         RowBox[{"{", 
          RowBox[{"0", ",", "f", ",", "0"}], "}"}], " ", "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Exponent", "[", 
           RowBox[{
            RowBox[{"dsqf", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"Last", "[", "theta", "]"}]}], "]"}], ">", "0"}], ",", 
         "\[IndentingNewLine]", "\t\t", 
         RowBox[{
          RowBox[{"v", "=", 
           RowBox[{"dsqf", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          "\t\t", 
          RowBox[{"u", "=", 
           RowBox[{"Cancel", "[", 
            RowBox[{"d", "/", 
             RowBox[{"v", "^", "i"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          "\t\t", 
          RowBox[{"Do", "[", "\[IndentingNewLine]", "\t\t\t", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{"b", ",", "c"}], "}"}], "=", 
              RowBox[{"ExtendedEuclidean", "[", 
               RowBox[{
                RowBox[{"u", " ", 
                 RowBox[{"TotalDerivation", "[", 
                  RowBox[{"v", ",", "theta", ",", "Dtower"}], "]"}]}], ",", 
                "v", ",", 
                RowBox[{"-", 
                 RowBox[{"Cancel", "[", 
                  RowBox[{"a", "/", "j"}], "]"}]}], ",", 
                RowBox[{"Last", "[", "theta", "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", "\t\t\t", 
             RowBox[{"g", "=", 
              RowBox[{"g", "+", 
               RowBox[{"Cancel", "[", 
                RowBox[{"b", "/", 
                 RowBox[{"v", "^", "j"}]}], "]"}]}]}], ";", 
             "\[IndentingNewLine]", "\t\t\t", 
             RowBox[{"a", "=", 
              RowBox[{"Expand", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "j"}], " ", "c"}], "-", 
                RowBox[{"u", " ", 
                 RowBox[{"TotalDerivation", "[", 
                  RowBox[{"b", ",", "theta", ",", "Dtower"}], "]"}]}]}], 
               "]"}]}]}], "\[IndentingNewLine]", "\t\t", ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", 
              RowBox[{"i", "-", "1"}], ",", "1", ",", 
              RowBox[{"-", "1"}]}], "}"}]}], "\[IndentingNewLine]", "\t\t", 
           "]"}], ";", "\[IndentingNewLine]", "\t\t", 
          RowBox[{"d", "=", 
           RowBox[{"u", " ", "v"}]}]}]}], "\[IndentingNewLine]", "\t", "]"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "2", ",", 
         RowBox[{"Length", "[", "dsqf", "]"}]}], "}"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"q", "=", 
      RowBox[{"PolynomialQuotient", "[", 
       RowBox[{"a", ",", 
        RowBox[{"Expand", "[", 
         RowBox[{"u", " ", "v"}], "]"}], ",", 
        RowBox[{"Last", "[", "theta", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"r", "=", 
      RowBox[{"PolynomialRemainder", "[", 
       RowBox[{"a", ",", 
        RowBox[{"Expand", "[", 
         RowBox[{"u", " ", "v"}], "]"}], ",", 
        RowBox[{"Last", "[", "theta", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"result", "=", 
      RowBox[{"{", 
       RowBox[{"g", ",", 
        RowBox[{"Cancel", "[", 
         RowBox[{"r", "/", 
          RowBox[{"(", 
           RowBox[{"u", " ", "v"}], ")"}]}], "]"}], ",", 
        RowBox[{"Cancel", "[", "q", "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"RischTrace", "[", 
      RowBox[{"HermiteReduction", ",", "result", ",", "\"\<Out\>\""}], "]"}], 
     ";", "\[IndentingNewLine]", "result"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.384725194607625*^9, 3.384725307842*^9}, {
   3.384725428451375*^9, 3.384725491342*^9}, {3.384725624982625*^9, 
   3.384725641763875*^9}, {3.384725678795125*^9, 3.384725762717*^9}, {
   3.38472579637325*^9, 3.38472581249825*^9}, {3.384725864967*^9, 
   3.384725872295125*^9}, {3.384725968795125*^9, 3.384726003920125*^9}, {
   3.38472611656075*^9, 3.384726250092*^9}, {3.38472628218575*^9, 
   3.38472638606075*^9}, {3.38472643156075*^9, 3.38472643887325*^9}, {
   3.384726595763875*^9, 3.384726700217*^9}, {3.384726981295125*^9, 
   3.384727175732625*^9}, {3.384727239326375*^9, 3.384727260342*^9}, {
   3.384727482326375*^9, 3.3847275355295*^9}, {3.384728506342*^9, 
   3.384728572107625*^9}, {3.3847286921545*^9, 3.384728734076375*^9}, {
   3.38472883781075*^9, 3.384728900420125*^9}, {3.384728935013875*^9, 
   3.38472897887325*^9}, {3.384729029138875*^9, 3.38472912599825*^9}, {
   3.384729180217*^9, 3.38472918918575*^9}, {3.384729219982625*^9, 
   3.384729226732625*^9}, {3.3847293327795*^9, 3.3847293345295*^9}, {
   3.384729579107625*^9, 3.38472958368575*^9}, {3.384729724951375*^9, 
   3.38472976849825*^9}, {3.384729807701375*^9, 3.3847298182795*^9}, {
   3.384729864357625*^9, 3.3847298659045*^9}, {3.384730354951375*^9, 
   3.384730365545125*^9}, {3.384730409326375*^9, 3.38473042987325*^9}, {
   3.384730487763875*^9, 3.384730513826375*^9}, {3.3847305704045*^9, 
   3.3847306260295*^9}, {3.384730820295125*^9, 3.384730822357625*^9}, {
   3.384737562388875*^9, 3.38473757012325*^9}, {3.3847376032795*^9, 
   3.38473762931075*^9}, {3.38474274693575*^9, 3.384742753076375*^9}, {
   3.384742790263875*^9, 3.384742815951375*^9}, {3.384742911295125*^9, 
   3.384742966513875*^9}, {3.384743239888875*^9, 3.384743247951375*^9}, {
   3.384743370763875*^9, 3.38474339006075*^9}, {3.384744888045125*^9, 
   3.384744965920125*^9}, {3.38474560593575*^9, 3.384745693076375*^9}, {
   3.3847458541545*^9, 3.38474588418575*^9}, {3.384746028576375*^9, 
   3.384746052967*^9}, {3.38474657299825*^9, 3.38474659006075*^9}, {
   3.385441651277125*^9, 3.38544166329275*^9}, {3.385443147120875*^9, 
   3.385443192339625*^9}, {3.385443228839625*^9, 3.385443240652125*^9}, {
   3.385444311277125*^9, 3.385444315777125*^9}, {3.385444757433375*^9, 
   3.385444777699*^9}, {3.385444853214625*^9, 3.385444879808375*^9}, {
   3.3854449415115*^9, 3.385445034245875*^9}, {3.3854453163865*^9, 
   3.385445316714625*^9}, {3.38544536923025*^9, 3.3854453696365*^9}, {
   3.385445402699*^9, 3.385445412308375*^9}, {3.3854454757615*^9, 
   3.3854454842615*^9}, 3.385445515370875*^9, 3.385445698433375*^9, {
   3.385445945464625*^9, 3.3854459595115*^9}, {3.385446348558375*^9, 
   3.38544642073025*^9}, {3.385446461464625*^9, 3.385446564745875*^9}, {
   3.385446635339625*^9, 3.385446702339625*^9}, {3.38544677991775*^9, 
   3.38544678248025*^9}, {3.385446834824*^9, 3.385446836714625*^9}, {
   3.385446957824*^9, 3.38544697454275*^9}, {3.3854470060115*^9, 
   3.385447033714625*^9}, {3.385484458107625*^9, 3.385484461842*^9}, {
   3.385484822513875*^9, 3.385484827326375*^9}, 3.385484870295125*^9, {
   3.385485225309*^9, 3.3854852282465*^9}, {3.38548590890275*^9, 
   3.385485922324625*^9}, {3.38548839277775*^9, 3.385488393012125*^9}, 
   3.385488448434*^9, {3.385488498512125*^9, 3.3854885278715*^9}, {
   3.385489006121125*^9, 3.385489009964875*^9}, {3.38548905594925*^9, 
   3.38548906557425*^9}, {3.385489096871125*^9, 3.385489101496125*^9}, {
   3.385489237714875*^9, 3.385489243543*^9}, {3.385496025650875*^9, 
   3.385496034775875*^9}, {3.38549608213525*^9, 3.3854960826665*^9}, {
   3.38549613482275*^9, 3.385496145775875*^9}, {3.385496291213375*^9, 
   3.38549629176025*^9}, {3.38549635438525*^9, 3.385496374619625*^9}, {
   3.38549642244775*^9, 3.3854964259165*^9}, {3.385496857494625*^9, 
   3.38549690244775*^9}, {3.38549856141625*^9, 3.3854985616975*^9}, {
   3.385498702994375*^9, 3.385498705181875*^9}, {3.385498834635*^9, 
   3.3854988368225*^9}, {3.38549907241625*^9, 3.38549909476*^9}, {
   3.38550015904125*^9, 3.38550015935375*^9}, {3.38550024729125*^9, 
   3.385500247775625*^9}, {3.385500538900625*^9, 3.385500539119375*^9}, {
   3.38550060601*^9, 3.38550060647875*^9}, {3.385500853681875*^9, 
   3.385500853931875*^9}, {3.38550101941625*^9, 3.385501059885*^9}, {
   3.385501165431875*^9, 3.385501169400625*^9}, {3.38550120885375*^9, 
   3.385501215056875*^9}, {3.385501367681875*^9, 3.38550137029125*^9}, {
   3.38550144376*^9, 3.385501449806875*^9}, {3.385501896806875*^9, 
   3.385501897306875*^9}, {3.385502049213125*^9, 3.38550205104125*^9}, {
   3.385502089556875*^9, 3.38550209747875*^9}, {3.385502206525625*^9, 
   3.3855022081975*^9}, {3.385503910025625*^9, 3.385503913650625*^9}, {
   3.38550431116625*^9, 3.385504319619375*^9}, {3.385504698744375*^9, 
   3.38550470072875*^9}, 3.385505082963125*^9, {3.3855053329475*^9, 
   3.3855053345725*^9}, {3.385505395681625*^9, 3.38550539675975*^9}, {
   3.3855055062275*^9, 3.385505525665*^9}, {3.385507468993125*^9, 
   3.38550747632125*^9}, {3.385508196180625*^9, 3.385508206743125*^9}, {
   3.385677245996625*^9, 3.3856772531685*^9}, {3.385677473121625*^9, 
   3.38567748001225*^9}, {3.385677556231*^9, 3.385677561152875*^9}, {
   3.385677687184125*^9, 3.38567774082475*^9}, {3.38567928063725*^9, 
   3.385679282246625*^9}, {3.38567985724575*^9, 3.3856798729645*^9}, 
   3.385682692698875*^9, {3.38568275793325*^9, 3.385682759402*^9}, {
   3.385684422152*^9, 3.3856844239645*^9}, {3.385701113217125*^9, 
   3.385701115904625*^9}, {3.39011263658825*^9, 3.390112648197625*^9}, {
   3.390112691432*^9, 3.39011269190075*^9}, {3.3904423105456247`*^9, 
   3.3904423203112497`*^9}, {3.3904424738893747`*^9, 
   3.3904424866393747`*^9}, {3.3904425241706247`*^9, 
   3.3904425276862497`*^9}, {3.3904425605924997`*^9, 
   3.3904425688112497`*^9}, {3.3904425997799997`*^9, 
   3.3904426047018747`*^9}, {3.3904428328893747`*^9, 
   3.3904428500299997`*^9}, {3.3904429179518747`*^9, 
   3.3904429182956247`*^9}, {3.3904431301393747`*^9, 
   3.3904431489206247`*^9}, {3.3904447047018747`*^9, 
   3.3904447606081247`*^9}, {3.3904447997799997`*^9, 
   3.3904448129831247`*^9}, {3.3904448630612497`*^9, 
   3.3904449417018747`*^9}, {3.3904460794987497`*^9, 
   3.3904460803581247`*^9}, {3.3904470962956247`*^9, 
   3.3904471185299997`*^9}, {3.3904511652018747`*^9, 
   3.3904511656549997`*^9}, {3.3904512290456247`*^9, 
   3.3904512510612497`*^9}, {3.3904515943424997`*^9, 
   3.3904515947643747`*^9}, {3.39071007724925*^9, 3.39071008243675*^9}, {
   3.390710635796125*^9, 3.390710636171125*^9}, {3.390769028373375*^9, 
   3.3907690394515*^9}, {3.390769108935875*^9, 3.390769125639*^9}, {
   3.390769173123375*^9, 3.390769176904625*^9}, {3.39076921354525*^9, 
   3.390769250373375*^9}, {3.390769374467125*^9, 3.39076940604525*^9}, {
   3.390769445123375*^9, 3.390769452092125*^9}, {3.390770908764*^9, 
   3.390770912717125*^9}, {3.3907719405765*^9, 3.390771944967125*^9}, {
   3.39079575179675*^9, 3.39079576135925*^9}, {3.390861566167375*^9, 
   3.390861574198625*^9}, {3.3909442611555*^9, 3.390944314218*^9}, {
   3.390947870921125*^9, 3.390947873577375*^9}, {3.3928493096081247`*^9, 
   3.3928493496706247`*^9}, {3.3928495034987497`*^9, 
   3.3928495061237497`*^9}, {3.3928502226862497`*^9, 
   3.3928503083581247`*^9}, {3.3928503494518747`*^9, 
   3.3928503524049997`*^9}, {3.3928504094831247`*^9, 
   3.3928504144987497`*^9}, {3.3928506349206247`*^9, 
   3.3928506701081247`*^9}, {3.3928507771862497`*^9, 
   3.3928508889049997`*^9}, {3.39442467787425*^9, 3.39442469006175*^9}, {
   3.395190401365024*^9, 3.395190444442379*^9}, 3.395314641001832*^9, 
   3.39531483043433*^9, {3.395314877615354*^9, 3.3953148792597322`*^9}, {
   3.395315016421577*^9, 3.395315046261283*^9}, {3.39549367261054*^9, 
   3.395493764305045*^9}, 3.3958330974329653`*^9, 3.396416397880825*^9, {
   3.397961748064712*^9, 3.397961756992263*^9}, {3.401233782728471*^9, 
   3.401233847693489*^9}, {3.404714073153925*^9, 3.4047141242523527`*^9}, {
   3.4047141603816547`*^9, 3.404714185135078*^9}, {3.404959075869135*^9, 
   3.404959186298057*^9}, {3.407617643223349*^9, 3.407617643662499*^9}, {
   3.407963068693329*^9, 3.407963088743371*^9}, {3.407963130305282*^9, 
   3.407963150071706*^9}, {3.4079632332325363`*^9, 3.4079632629278193`*^9}, {
   3.4079634566253967`*^9, 3.407963517871326*^9}, {3.407963575081497*^9, 
   3.4079635773196507`*^9}, {3.4099086301341057`*^9, 3.409908777330888*^9}, {
   3.409909015037397*^9, 3.40990901772305*^9}, {3.4099091290276423`*^9, 
   3.4099091597556543`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"HermiteReduction", "[", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"x", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"theta", "[", "1", "]"}]}], ")"}], "2"]}]], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"theta", "[", "1", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"1", "/", "x"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.4079634007039213`*^9, 3.4079634334327307`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", 
   FractionBox["1", 
    RowBox[{"x", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SubscriptBox["\[Theta]", "1"]}], ")"}], "2"]}]], ",", "0"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.407963434478792*^9, {3.407963468615302*^9, 3.4079635199151707`*^9}, 
   3.409906623974634*^9, 3.409908661314382*^9, 3.4099086940508633`*^9, 
   3.409908778452359*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Examples", "Subsubsection",
 CellChangeTimes->{{3.385679901511375*^9, 3.385679902698875*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"HermiteReduction", "[", 
   RowBox[{
    FractionBox[
     RowBox[{"x", "-", "t"}], 
     SuperscriptBox["t", "2"]], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "t"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", 
      RowBox[{"1", "+", 
       SuperscriptBox["t", "2"]}]}], "}"}]}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"example", " ", "from", " ", "Bronstein"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.384727182717*^9, 3.384727203701375*^9}, {
   3.384727441920125*^9, 3.3847274420295*^9}, {3.3847301715295*^9, 
   3.384730174717*^9}, {3.384743334967*^9, 3.384743335076375*^9}, {
   3.38474614706075*^9, 3.38474615131075*^9}, 3.38544538823025*^9, {
   3.385445916902125*^9, 3.38544591704275*^9}, {3.385446305949*^9, 
   3.385446306058375*^9}, {3.385446950027125*^9, 3.3854469501365*^9}, 
   3.385484365701375*^9, 3.385484453513875*^9, 3.3854845994045*^9, {
   3.385484749638875*^9, 3.3854847676545*^9}, {3.385485629309*^9, 
   3.385485643418375*^9}, {3.3854858891215*^9, 3.385485893059*^9}, {
   3.385490325668*^9, 3.385490328558625*^9}, 3.385491584464875*^9, {
   3.385494653698625*^9, 3.3854946596205*^9}, {3.385495977729*^9, 
   3.385495981963375*^9}, {3.385496042400875*^9, 3.38549605219775*^9}, {
   3.3854986088225*^9, 3.385498613088125*^9}, {3.385498660385*^9, 
   3.38549866635375*^9}, {3.38568031212075*^9, 3.3856803203395*^9}, {
   3.385684437402*^9, 3.385684438073875*^9}, {3.3904448291393747`*^9, 
   3.3904448402487497`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    FractionBox["x", "t"]}], ",", "0", ",", 
   RowBox[{"-", "x"}]}], "}"}]], "Output",
 CellChangeTimes->{3.4099061924951077`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      FractionBox[
       RowBox[{"Log", "[", "x", "]"}], 
       RowBox[{"x", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"Log", "[", "x", "]"}], "2"], "+", "1"}], ")"}], "4"]}]], 
      ",", "x"}], "]"}], "//", "Together"}], ")"}], "/.", 
  RowBox[{
   RowBox[{"Log", "[", "x", "]"}], "\[Rule]", "t"}]}]], "Input",
 CellChangeTimes->{{3.38550374660375*^9, 3.385503754088125*^9}, {
   3.385503837963125*^9, 3.38550383816625*^9}, {3.38550389047875*^9, 
   3.385503895619375*^9}, {3.385503983635*^9, 3.3855039859475*^9}, 
   3.38550418035375*^9, {3.385505045494375*^9, 3.385505050525625*^9}, {
   3.385701687123375*^9, 3.38570169917025*^9}, 3.38570176060775*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"HermiteReduction", "[", 
  RowBox[{
   FractionBox[
    RowBox[{"1", "-", "t", "-", 
     RowBox[{"7", " ", 
      SuperscriptBox["t", "2"]}], "-", 
     SuperscriptBox["t", "3"]}], 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SuperscriptBox["t", "2"]}], ")"}], "5"], " ", 
     SuperscriptBox["x", "2"]}]], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "t"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"1", "/", "x"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.385503757385*^9, 3.3855037680725*^9}, 
   3.3855038423225*^9, 3.385503901088125*^9, 3.38550398985375*^9, 
   3.38550418472875*^9, 3.385505054885*^9, {3.385505316494375*^9, 
   3.385505316619375*^9}, 3.385505405399375*^9, 3.385507116930625*^9, {
   3.38568443274575*^9, 3.385684433511375*^9}, {3.3904460514206247`*^9, 
   3.3904460584674997`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox["t", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SuperscriptBox["t", "2"]}], ")"}], "4"], " ", "x"}]], ",", "0", ",", 
   "0"}], "}"}]], "Output",
 CellChangeTimes->{3.409906186415133*^9, 3.409906263500835*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{"m", " ", "x"}], 
       RowBox[{
        SuperscriptBox["x", "6"], "+", "n"}]], "+", 
      RowBox[{"Log", "[", "x", "]"}]}], ",", "x"}], "]"}], "//", "Together"}],
   ")"}]], "Input",
 CellChangeTimes->{{3.385677612246625*^9, 3.38567764419975*^9}}],

Cell[BoxData[
 RowBox[{"HermiteReduction", "[", 
  RowBox[{
   FractionBox[
    RowBox[{
     SuperscriptBox["n", "2"], "+", 
     RowBox[{"m", " ", "n", " ", "x"}], "+", 
     RowBox[{"2", " ", "n", " ", 
      SuperscriptBox["x", "6"]}], "-", 
     RowBox[{"5", " ", "m", " ", 
      SuperscriptBox["x", "7"]}], "+", 
     SuperscriptBox["x", "12"]}], 
    RowBox[{"x", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"n", "+", 
        SuperscriptBox["x", "6"]}], ")"}], "2"]}]], ",", 
   RowBox[{"{", "x", "}"}], ",", 
   RowBox[{"{", "1", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.3856776020435*^9, 3.385677647731*^9}, {
  3.385684441323875*^9, 3.385684443105125*^9}, {3.3904460911706247`*^9, 
  3.3904460978268747`*^9}}],

Cell[BoxData[
 RowBox[{"(", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{
      FractionBox["x", 
       RowBox[{
        SuperscriptBox["x", "6"], "+", "1"}]], "+", 
      RowBox[{"Log", "[", "x", "]"}]}], ",", "x"}], "]"}], "//", "Together"}],
   ")"}]], "Input",
 CellChangeTimes->{{3.385446885558375*^9, 3.385446885777125*^9}, {
  3.385485657824625*^9, 3.385485657949625*^9}}],

Cell[BoxData[
 RowBox[{"HermiteReduction", "[", 
  RowBox[{
   FractionBox[
    RowBox[{"1", "+", "x", "+", 
     RowBox[{"2", " ", 
      SuperscriptBox["x", "6"]}], "-", 
     RowBox[{"5", " ", 
      SuperscriptBox["x", "7"]}], "+", 
     SuperscriptBox["x", "12"]}], 
    RowBox[{"x", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SuperscriptBox["x", "6"]}], ")"}], "2"]}]], ",", 
   RowBox[{"{", "x", "}"}], ",", 
   RowBox[{"{", "1", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.38544689379275*^9, 3.385485662605875*^9, {3.38549610607275*^9, 
   3.38549610619775*^9}, {3.385684446917625*^9, 3.385684447386375*^9}, {
   3.3857003923265*^9, 3.385700393529625*^9}, {3.3904461061393747`*^9, 
   3.3904461115612497`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{
       FractionBox[
        RowBox[{"Log", "[", "x", "]"}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["x", "45"], "+", 
           SuperscriptBox[
            RowBox[{"Log", "[", "x", "]"}], "21"]}], ")"}], "9"]], "+", 
       RowBox[{"Log", "[", "x", "]"}]}], ",", "x"}], "]"}], "//", 
    "Together"}], ")"}], "/.", 
  RowBox[{
   RowBox[{"Log", "[", "x", "]"}], "\[Rule]", "t"}]}]], "Input",
 CellChangeTimes->{{3.385677932746625*^9, 3.38567799394975*^9}, {
  3.38567805019975*^9, 3.385678140246625*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"HermiteReduction", "[", 
   RowBox[{"%", ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "t"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", 
      RowBox[{"1", "/", "x"}]}], "}"}]}], "]"}], "//", "Timing"}]], "Input",
 CellChangeTimes->{{3.385677995496625*^9, 3.3856780645435*^9}, 
   3.385678095606*^9, {3.38567814538725*^9, 3.385678146215375*^9}, {
   3.385684449730125*^9, 3.38568445030825*^9}, {3.3857004042015*^9, 
   3.385700448389*^9}, {3.3904461217331247`*^9, 3.3904461315299997`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      FractionBox[
       RowBox[{"Exp", "[", "x", "]"}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"Exp", "[", "x", "]"}]}], ")"}], "4"]], ",", "x"}], "]"}], "//",
     "Together"}], ")"}], "/.", 
  RowBox[{
   RowBox[{"Exp", "[", "x", "]"}], "\[Rule]", "t"}]}]], "Input",
 CellChangeTimes->{{3.385678168590375*^9, 3.38567819713725*^9}}],

Cell[BoxData[
 RowBox[{"HermiteReduction", "[", 
  RowBox[{"%", ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "t"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "t"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.385678199356*^9, 3.38567820807475*^9}, {
  3.38568445274575*^9, 3.38568445374575*^9}, {3.3904461478268747`*^9, 
  3.3904461534206247`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"D", "[", 
   RowBox[{
    FractionBox[
     RowBox[{
      SuperscriptBox[
       RowBox[{"Tan", "[", "x", "]"}], "2"], "+", "1"}], 
     RowBox[{"x", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SuperscriptBox[
          RowBox[{"Tan", "[", "x", "]"}], "3"]}], ")"}], "4"]}]], ",", "x"}], 
   "]"}], "//", "Together"}]], "Input",
 CellChangeTimes->{{3.385678825481*^9, 3.385678855559125*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Integrate", "[", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"2", " ", "x", " ", 
       SuperscriptBox[
        RowBox[{"Sec", "[", "x", "]"}], "2"], " ", 
       RowBox[{"Tan", "[", "x", "]"}]}], "-", 
      SuperscriptBox[
       RowBox[{"Tan", "[", "x", "]"}], "2"], "-", 
      RowBox[{"12", " ", "x", " ", 
       SuperscriptBox[
        RowBox[{"Sec", "[", "x", "]"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"Tan", "[", "x", "]"}], "2"]}], "-", 
      SuperscriptBox[
       RowBox[{"Tan", "[", "x", "]"}], "3"], "-", 
      RowBox[{"10", " ", "x", " ", 
       SuperscriptBox[
        RowBox[{"Sec", "[", "x", "]"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"Tan", "[", "x", "]"}], "4"]}], "-", 
      SuperscriptBox[
       RowBox[{"Tan", "[", "x", "]"}], "5"]}], 
     RowBox[{
      SuperscriptBox["x", "2"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SuperscriptBox[
          RowBox[{"Tan", "[", "x", "]"}], "3"]}], ")"}], "5"]}]], ",", "x"}], 
   "]"}], "//", "Timing"}]], "Input",
 CellChangeTimes->{{3.385678865996625*^9, 3.385678873965375*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"D", "[", 
    RowBox[{
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"Tan", "[", "x", "]"}], "2"], "+", "1"}], 
      RowBox[{"x", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox[
           RowBox[{"Tan", "[", "x", "]"}], "3"]}], ")"}], "4"]}]], ",", "x"}],
     "]"}], ")"}], "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     SuperscriptBox[
      RowBox[{"Sec", "[", "x", "]"}], "2"], "\[Rule]", 
     RowBox[{"1", "+", 
      SuperscriptBox["t", "2"]}]}], ",", 
    RowBox[{
     RowBox[{"Tan", "[", "x", "]"}], "\[Rule]", "t"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.3856788962935*^9, 3.38567891457475*^9}, {
  3.3857011332015*^9, 3.3857011335765*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"HermiteReduction", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"1", "+", 
        SuperscriptBox["t", "2"]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox["t", "3"]}], ")"}], "4"], " ", 
        SuperscriptBox["x", "2"]}]]}], "-", 
     FractionBox[
      RowBox[{"12", " ", 
       SuperscriptBox["t", "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["t", "2"]}], ")"}], "2"]}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["t", "3"]}], ")"}], "5"], " ", "x"}]], "+", 
     FractionBox[
      RowBox[{"2", " ", "t", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SuperscriptBox["t", "2"]}], ")"}]}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["t", "3"]}], ")"}], "4"], " ", "x"}]]}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "t"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", 
      RowBox[{"1", "+", 
       SuperscriptBox["t", "2"]}]}], "}"}]}], "]"}], "//", 
  "Timing"}]], "Input",
 CellChangeTimes->{{3.385678885840375*^9, 3.385678887621625*^9}, {
   3.385678918481*^9, 3.385678935356*^9}, {3.385684456402*^9, 
   3.3856844573395*^9}, 3.385701139139*^9, {3.3857944988322864`*^9, 
   3.385794500504691*^9}, {3.3904461655143747`*^9, 3.3904461728112497`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"HermiteReduction", "[", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"4", " ", 
       SuperscriptBox["x", "9"]}], "+", 
      RowBox[{"21", 
       SuperscriptBox["x", "6"]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["x", "3"]}], "-", 
      RowBox[{"3", 
       SuperscriptBox["x", "2"]}], "-", "3"}], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["x", "7"], "-", "x", "+", "1"}], ")"}], "2"]], ",", 
    RowBox[{"{", "x", "}"}], ",", 
    RowBox[{"{", "1", "}"}]}], "]"}], "//", "Timing", 
  RowBox[{"(*", " ", 
   RowBox[{
   "example", " ", "of", " ", "Hermite", " ", "Reduction", " ", "from", " ", 
    "Hardy"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.3857007855765*^9, 3.3857008098265*^9}, {
   3.3857008584515*^9, 3.3857008637015*^9}, {3.385700919185875*^9, 
   3.385700931779625*^9}, 3.38570102423275*^9, {3.385701256514*^9, 
   3.385701305092125*^9}, {3.385701408873375*^9, 3.385701409014*^9}, {
   3.385701445029625*^9, 3.385701463685875*^9}, {3.385794502167082*^9, 
   3.3857945032185936`*^9}, {3.3904461853112497`*^9, 3.3904461892799997`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"D", "[", 
   RowBox[{
    FractionBox[
     RowBox[{
      SuperscriptBox["x", "5"], "-", 
      RowBox[{"4", 
       SuperscriptBox["x", "7"]}]}], 
     RowBox[{"Log", "[", 
      RowBox[{"Log", "[", "x", "]"}], "]"}]], ",", "x"}], "]"}], "//", 
  "Together"}]], "Input",
 CellChangeTimes->{{3.390146493295875*^9, 3.390146564670875*^9}, {
  3.390146603514625*^9, 3.3901466104365*^9}, {3.390146720795875*^9, 
  3.39014672484275*^9}, {3.3904461944987497`*^9, 3.3904461953268747`*^9}}],

Cell[BoxData[
 RowBox[{"%", "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"Log", "[", "x", "]"}], "\[Rule]", "t1"}], ",", 
    RowBox[{
     RowBox[{"Log", "[", 
      RowBox[{"Log", "[", "x", "]"}], "]"}], "\[Rule]", "t2"}]}], 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.390146626358375*^9, 3.39014670065525*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"HermiteReduction", "[", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["x", "4"]}], "+", 
      RowBox[{"5", " ", "t1", " ", "t2", " ", 
       SuperscriptBox["x", "4"]}], "+", 
      RowBox[{"4", " ", 
       SuperscriptBox["x", "6"]}], "-", 
      RowBox[{"28", " ", "t1", " ", "t2", " ", 
       SuperscriptBox["x", "6"]}]}], 
     RowBox[{"t1", " ", 
      SuperscriptBox["t2", "2"]}]], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "t1", ",", "t2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", 
      RowBox[{"1", "/", "x"}], ",", 
      FractionBox["1", 
       RowBox[{"x", " ", "t1"}]]}], "}"}]}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"example", " ", "of", " ", "two", " ", "extensions"}], " ", 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.390146728452125*^9, 3.390146762733375*^9}, {
  3.390146795045875*^9, 3.390146804139625*^9}, {3.3904462069049997`*^9, 
  3.3904462258737497`*^9}}],

Cell[BoxData[
 RowBox[{"integrand", "=", 
  RowBox[{
   RowBox[{"Together", "[", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{
       FractionBox[
        RowBox[{"1", "-", 
         RowBox[{"Log", "[", "x", "]"}]}], 
        RowBox[{"x", "+", 
         RowBox[{"Log", "[", "x", "]"}]}]], "+", 
       RowBox[{"Log", "[", 
        RowBox[{"Log", "[", "x", "]"}], "]"}]}], ",", "x"}], "]"}], "]"}], "/.", 
   RowBox[{
    RowBox[{"Log", "[", "x", "]"}], "\[Rule]", "t"}]}]}]], "Input",
 CellChangeTimes->{{3.390703398483625*^9, 3.390703441327375*^9}, {
  3.390706406827375*^9, 3.390706430358625*^9}, {3.390710105139875*^9, 
  3.390710106889875*^9}, {3.3907481253265*^9, 3.390748182404625*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"HermiteReduction", "[", 
   RowBox[{"integrand", ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "t"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", 
      RowBox[{"1", "/", "x"}]}], "}"}]}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"Example", " ", "from", " ", "thesis"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.390748115514*^9, 3.390748123342125*^9}, {
  3.39074818823275*^9, 3.39074821367025*^9}}],

Cell[BoxData[
 RowBox[{"integrand", "=", 
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"x", " ", 
       RowBox[{"Cos", "[", "x", "]"}]}], "-", 
      RowBox[{"Sin", "[", "x", "]"}]}], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"x", "-", 
        RowBox[{"Sin", "[", "x", "]"}]}], ")"}], "2"]], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Sin", "[", "x", "]"}], "\[Rule]", 
       FractionBox[
        RowBox[{"2", " ", 
         RowBox[{"Tan", "[", 
          RowBox[{"x", "/", "2"}], "]"}]}], 
        RowBox[{
         SuperscriptBox[
          RowBox[{"Tan", "[", 
           RowBox[{"x", "/", "2"}], "]"}], "2"], "+", "1"}]]}], ",", 
      RowBox[{
       RowBox[{"Cos", "[", "x", "]"}], "\[Rule]", 
       FractionBox[
        RowBox[{"1", "-", 
         SuperscriptBox[
          RowBox[{"Tan", "[", 
           RowBox[{"x", "/", "2"}], "]"}], "2"]}], 
        RowBox[{"1", "+", 
         SuperscriptBox[
          RowBox[{"Tan", "[", 
           RowBox[{"x", "/", "2"}], "]"}], "2"]}]]}]}], "}"}]}], "//", 
   "Cancel", 
   RowBox[{"(*", " ", 
    RowBox[{"Example", " ", "from", " ", "thesis"}], " ", "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.3907645535765*^9, 3.39076463492025*^9}, 
   3.390796476031125*^9}],

Cell[BoxData[
 RowBox[{"integrand", "=", 
  RowBox[{"integrand", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Tan", "[", 
      RowBox[{"x", "/", "2"}], "]"}], "\[Rule]", "t"}], "}"}], 
   RowBox[{"(*", " ", 
    RowBox[{"Example", " ", "from", " ", "thesis"}], " ", "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.390764645092125*^9, 3.390764657310875*^9}, 
   3.39079647835925*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"HermiteReduction", "[", 
    RowBox[{"integrand", ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "t"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{
        FractionBox["1", "2"], "+", 
        RowBox[{
         FractionBox["1", "2"], 
         SuperscriptBox["t", "2"]}]}]}], "}"}]}], "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{"t", "\[Rule]", 
     RowBox[{"Tan", "[", 
      RowBox[{"x", "/", "2"}], "]"}]}], "}"}]}], "//", "Simplify", 
  RowBox[{"(*", " ", 
   RowBox[{"Example", " ", "from", " ", "thesis"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.390764661498375*^9, 3.390764733842125*^9}, {
   3.390776007810875*^9, 3.3907760327015*^9}, {3.3907765082015*^9, 
   3.3907765235765*^9}, {3.39078013329525*^9, 3.39078013485775*^9}, 
   3.390796479218625*^9}],

Cell[BoxData[
 RowBox[{"integrand2", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"x", " ", 
        RowBox[{"Cos", "[", "x", "]"}]}], "-", 
       RowBox[{"Sin", "[", "x", "]"}]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"x", "-", 
         RowBox[{"Sin", "[", "x", "]"}]}], ")"}], "2"]], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Sin", "[", "x", "]"}], "\[Rule]", 
        FractionBox[
         RowBox[{
          RowBox[{"Exp", "[", 
           RowBox[{"\[ImaginaryI]", " ", "x"}], "]"}], "-", 
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", "\[ImaginaryI]"}], " ", "x"}], "]"}]}], 
         RowBox[{"2", " ", "\[ImaginaryI]"}]]}], ",", 
       RowBox[{
        RowBox[{"Cos", "[", "x", "]"}], "\[Rule]", 
        FractionBox[
         RowBox[{
          RowBox[{"Exp", "[", 
           RowBox[{"\[ImaginaryI]", " ", "x"}], "]"}], "+", 
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", "\[ImaginaryI]"}], " ", "x"}], "]"}]}], "2"]}]}], 
      "}"}]}], "//", "Cancel"}], "//", "Simplify", 
   RowBox[{"(*", " ", 
    RowBox[{"Example", " ", "from", " ", "thesis"}], " ", "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.3907650567015*^9, 3.390765107389*^9}, 
   3.390796480531125*^9}],

Cell[BoxData[
 RowBox[{"integrand2", "=", 
  RowBox[{
   RowBox[{"integrand2", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Exp", "[", 
        RowBox[{"\[ImaginaryI]", " ", "x"}], "]"}], "\[Rule]", "t"}], ",", 
      RowBox[{
       RowBox[{"Exp", "[", 
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "x"}], "]"}], "\[Rule]", 
       SuperscriptBox["t", "2"]}]}], "}"}]}], "//", "ExpandNumerator", 
   RowBox[{"(*", " ", 
    RowBox[{"Example", " ", "from", " ", "thesis"}], " ", "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.390765117717125*^9, 3.390765149498375*^9}, {
   3.390781540342125*^9, 3.3907815437015*^9}, 3.390796481953*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"HermiteReduction", "[", 
     RowBox[{"integrand2", ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "t"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", 
        RowBox[{"\[ImaginaryI]", " ", "t"}]}], "}"}]}], "]"}], "/.", 
    RowBox[{"t", "\[Rule]", 
     RowBox[{"Exp", "[", 
      RowBox[{"\[ImaginaryI]", " ", "x"}], "]"}]}]}], "//", "ExpToTrig"}], "//",
   "Simplify", 
  RowBox[{"(*", " ", 
   RowBox[{"Example", " ", "from", " ", "thesis"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.390765156935875*^9, 3.390765176904625*^9}, 
   3.390795776624875*^9, 3.390796483187375*^9}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Polynomial Reduction", "Subsection",
 CellChangeTimes->{{3.38474343212325*^9, 3.384743435857625*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PolynomialReduction", "[", 
   RowBox[{"p_", ",", "theta_", ",", "tower_", ",", "Dtower_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"m", ",", "q0", ",", "q", ",", "r"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"Polynomial", " ", "reduction"}], ",", " ", 
      RowBox[{"Bronstein", " ", 
       RowBox[{"p", ".", " ", "141"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "For", " ", "non", " ", "linear", " ", "monomials", " ", "we", " ", 
      "can", " ", "reduce", " ", "any", " ", "polynomial", " ", "in", " ", 
      RowBox[{"k", "[", "t", "]"}], " ", "as", " ", "the", " ", "sum", 
      "\[IndentingNewLine]", "of", " ", "a", " ", "derivative", " ", "and", 
      " ", "a", " ", "polynomial", " ", "of", " ", "degree", " ", "less", " ", 
      RowBox[{"than", " ", "\\", "delta"}], 
      RowBox[{"(", "t", ")"}]}], "\[IndentingNewLine]", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Exponent", "[", 
         RowBox[{"p", ",", 
          RowBox[{"Last", "[", "theta", "]"}]}], "]"}], "<", 
        RowBox[{"Exponent", "[", 
         RowBox[{
          RowBox[{"Last", "[", "Dtower", "]"}], ",", 
          RowBox[{"Last", "[", "theta", "]"}]}], "]"}]}], ",", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", "p"}], "}"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"m", "=", 
      RowBox[{
       RowBox[{"Exponent", "[", 
        RowBox[{"p", ",", 
         RowBox[{"Last", "[", "theta", "]"}]}], "]"}], "-", 
       RowBox[{"Exponent", "[", 
        RowBox[{
         RowBox[{"Last", "[", "Dtower", "]"}], ",", 
         RowBox[{"Last", "[", "theta", "]"}]}], "]"}], "+", "1"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"q0", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"lc", "[", 
          RowBox[{"p", ",", 
           RowBox[{"Last", "[", "theta", "]"}]}], "]"}], "/", 
         RowBox[{"(", 
          RowBox[{"m", "*", 
           RowBox[{"lc", "[", 
            RowBox[{
             RowBox[{"Last", "[", "Dtower", "]"}], ",", 
             RowBox[{"Last", "[", "theta", "]"}]}], "]"}]}], ")"}]}], ")"}], 
       SuperscriptBox[
        RowBox[{"Last", "[", "theta", "]"}], "m"]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"q", ",", "r"}], "}"}], "=", 
      RowBox[{"PolynomialReduction", "[", 
       RowBox[{
        RowBox[{"p", "-", 
         RowBox[{"TotalDerivation", "[", 
          RowBox[{"q0", ",", "theta", ",", "Dtower"}], "]"}]}], ",", "theta", 
        ",", "tower", ",", "Dtower"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"q0", "+", "q"}], ",", "r"}], "}"}]}]}], "\[IndentingNewLine]",
    "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.384743445170125*^9, 3.384743537357625*^9}, {
  3.38568385537075*^9, 3.385683906198875*^9}, {3.385683941323875*^9, 
  3.385684179042625*^9}, {3.385684245261375*^9, 3.385684257792625*^9}, {
  3.3856843045895*^9, 3.385684325902*^9}, {3.38568446843325*^9, 
  3.38568447712075*^9}, {3.38568537018325*^9, 3.3856853822145*^9}, {
  3.3856854140895*^9, 3.38568541424575*^9}, {3.385794652643456*^9, 
  3.385794700582389*^9}, {3.39442312599925*^9, 3.394423173218*^9}, {
  3.3944232264055*^9, 3.394423229546125*^9}, {3.39442330462425*^9, 
  3.3944233709055*^9}, {3.394423525764875*^9, 3.3944235330305*^9}, {
  3.394423593202375*^9, 3.394423661452375*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PolynomialReduction", "[", 
  RowBox[{
   RowBox[{"1", "+", 
    RowBox[{"x", " ", 
     RowBox[{"theta", "[", "1", "]"}]}], "+", 
    SuperscriptBox[
     RowBox[{"theta", "[", "1", "]"}], "2"]}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"theta", "[", "1", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"Tan", "[", "x", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"1", "+", 
      SuperscriptBox[
       RowBox[{"theta", "[", "1", "]"}], "2"]}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.38568448368325*^9, 3.385684537980125*^9}, {
  3.385794688725339*^9, 3.385794691319069*^9}, {3.394423548702375*^9, 
  3.394423582952375*^9}, {3.3944236157805*^9, 3.394423619639875*^9}, {
  3.39442366862425*^9, 3.39442367362425*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   SubscriptBox["\[Theta]", "1"], ",", 
   RowBox[{"x", " ", 
    SubscriptBox["\[Theta]", "1"]}]}], "}"}]], "Output",
 CellChangeTimes->{3.409054095867373*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PolynomialReduction", "[", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"theta", "[", "1", "]"}], "5"], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"theta", "[", "1", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"Tan", "[", "x", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"1", "+", 
      SuperscriptBox[
       RowBox[{"theta", "[", "1", "]"}], "2"]}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.385684600573875*^9, 3.38568463124575*^9}, {
  3.3856854020895*^9, 3.38568540237075*^9}, {3.3857947108671775`*^9, 
  3.385794711107523*^9}, {3.394423699639875*^9, 3.39442371512425*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      SubsuperscriptBox["\[Theta]", "1", "2"], "2"]}], "+", 
    FractionBox[
     SubsuperscriptBox["\[Theta]", "1", "4"], "4"]}], ",", 
   SubscriptBox["\[Theta]", "1"]}], "}"}]], "Output",
 CellChangeTimes->{3.409054100166327*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"PolynomialReduction", "[", 
   RowBox[{
    RowBox[{
     SuperscriptBox["x", "2"], "-", "x"}], ",", 
    RowBox[{"{", "x", "}"}], ",", 
    RowBox[{"{", "x", "}"}], ",", 
    RowBox[{"{", "1", "}"}]}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"integration", " ", "of", " ", "polynomials"}], " ", 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.387404228930375*^9, 3.3874042967585*^9}, {
  3.394423731327375*^9, 3.394423737733625*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Residue Reduce (Lazard-Rothstein-Trager-Rioboo Algorithm)", "Subsection",
 CellChangeTimes->{{3.385687578917625*^9, 3.38568759743325*^9}, {
  3.395190516812554*^9, 3.3951905191556463`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"CompleteFactor", "[", 
   RowBox[{"f_", ",", "x_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "res", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"RischTrace", "[", 
      RowBox[{"CompleteFactor", ",", 
       RowBox[{"{", 
        RowBox[{"f", ",", "x"}], "}"}], ",", "\"\<In\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{"Factor", "[", 
       RowBox[{"f", ",", 
        RowBox[{"Extension", "\[Rule]", 
         RowBox[{"Re", "[", 
          RowBox[{"x", "/.", 
           RowBox[{"Solve", "[", 
            RowBox[{
             RowBox[{"f", "\[Equal]", "0"}], ",", "x"}], "]"}]}], "]"}]}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"RischTrace", "[", 
      RowBox[{"CompleteFactor", ",", "res", ",", "\"\<Out\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", "res"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.3928512667018747`*^9, 3.3928513011237497`*^9}, {
  3.404959228633808*^9, 3.404959282859836*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PureLogPart", "[", 
   RowBox[{
    RowBox[{"a_", "+", "b_"}], ",", "theta_", ",", "tower_", ",", "Dtower_", 
    ",", "extend_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"PureLogPart", "[", 
    RowBox[{"a", ",", "theta", ",", "tower", ",", "Dtower", ",", "extend"}], 
    "]"}], "+", 
   RowBox[{"PureLogPart", "[", 
    RowBox[{"b", ",", "theta", ",", "tower", ",", "Dtower", ",", "extend"}], 
    "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.390279416732875*^9, 3.390279542389125*^9}, {
  3.3904519652487497`*^9, 3.3904519751706247`*^9}, {3.3904536068737497`*^9, 
  3.3904536096081247`*^9}, {3.395193984231044*^9, 3.3951939953495398`*^9}, {
  3.395572094914781*^9, 3.395572097485633*^9}, {3.404984509656313*^9, 
  3.4049845215035477`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PureLogPart", "::", "warning"}], "=", 
   "\"\<Integral not elementary -- roots of resultant polynomial are non \
constant.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.39085269943425*^9, 3.3908527903405*^9}, {
   3.390853523699875*^9, 3.3908535295905*^9}, {3.3908536333405*^9, 
   3.39085366043425*^9}, 3.410396795667338*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PureLogPart", "[", 
   RowBox[{
   "f_", ",", "intheta_", ",", "intower_", ",", "inDtower_", ",", "extend_"}],
    "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "theta", ",", "tower", ",", "Dtower", ",", "d", ",", "p", ",", "res", 
      ",", "r", ",", "R", ",", "n", ",", "s", ",", "kD", ",", "S", ",", "M", 
      ",", "A", ",", "w", ",", "EEA", ",", "newarg", ",", "sbar", ",", 
      "evals", ",", "remaining", ",", "naivepart", ",", 
      RowBox[{"Result", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"RischTrace", "[", 
      RowBox[{"PureLogPart", ",", 
       RowBox[{"{", 
        RowBox[{"f", ",", "intheta", ",", "intower", ",", "inDtower"}], "}"}],
        ",", "\"\<In\>\""}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Lazard", "-", "Rioboo", "-", "Rothstein", "-", 
       RowBox[{"Trager", " ", "resultant", " ", "algorithm", " ", 
        RowBox[{"(", 
         RowBox[{"squarefree", " ", "factorization", " ", "version"}], 
         ")"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "reduces", " ", "a", " ", "simple", " ", "rational", " ", "function", 
       " ", "with", " ", "no", " ", "polynomial", " ", "part", " ", "to", " ",
        "a", " ", "sum", " ", "of", " ", "logarithms"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Bronstein", " ", 
       RowBox[{"p", ".", " ", "153"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "update", " ", "the", " ", "extension", " ", "field", " ", "if", " ", 
       "required"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"theta", ",", "tower", ",", "Dtower"}], "}"}], "=", 
      RowBox[{"UpdateExtensionField", "[", 
       RowBox[{"f", ",", "intheta", ",", "intower", ",", "inDtower"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"d", "=", 
      RowBox[{"Denominator", "[", "f", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Exponent", "[", 
         RowBox[{
          RowBox[{"TotalDerivation", "[", 
           RowBox[{"d", ",", "theta", ",", "Dtower"}], "]"}], ",", 
          RowBox[{"Last", "[", "theta", "]"}]}], "]"}], "<=", 
        RowBox[{"Exponent", "[", 
         RowBox[{"d", ",", 
          RowBox[{"Last", "[", "theta", "]"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"res", "=", 
         RowBox[{"SubResultant", "[", 
          RowBox[{"d", ",", 
           RowBox[{"Expand", "[", 
            RowBox[{
             RowBox[{"Numerator", "[", "f", "]"}], "-", 
             RowBox[{"rischZ", " ", 
              RowBox[{"TotalDerivation", "[", 
               RowBox[{"d", ",", "theta", ",", "Dtower"}], "]"}]}]}], "]"}], 
           ",", 
           RowBox[{"Last", "[", "theta", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"r", "=", 
         RowBox[{"Cancel", "[", 
          RowBox[{"Together", "[", "\[IndentingNewLine]", 
           RowBox[{"Resultant", "[", 
            RowBox[{"d", ",", 
             RowBox[{"Expand", "[", 
              RowBox[{
               RowBox[{"Numerator", "[", "f", "]"}], "-", 
               RowBox[{"rischZ", " ", 
                RowBox[{"TotalDerivation", "[", 
                 RowBox[{"d", ",", "theta", ",", "Dtower"}], "]"}]}]}], "]"}],
              ",", 
             RowBox[{"Last", "[", "theta", "]"}]}], "]"}], 
           "\[IndentingNewLine]", "\t", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"(*", " ", 
         RowBox[{
         "allow", " ", "for", " ", "algebraic", " ", "numbers", " ", "to", 
          " ", "be", " ", "present"}], " ", "*)"}], "\[IndentingNewLine]", 
        "\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{"r", ",", 
             RowBox[{"xx_.", " ", 
              SuperscriptBox["cc_", 
               RowBox[{"n_", "?", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"!", 
                   RowBox[{"IntegerQ", "[", "#", "]"}]}], "&"}], ")"}]}]]}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "Infinity"}], "}"}]}], "]"}], "=!=", 
           RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", "\t\t", 
          RowBox[{"r", "=", 
           RowBox[{"Cancel", "[", 
            FractionBox[
             RowBox[{"Factor", "[", 
              RowBox[{
               RowBox[{"Numerator", "[", "r", "]"}], ",", 
               RowBox[{"Extension", "\[Rule]", "Automatic"}]}], "]"}], 
             RowBox[{"Factor", "[", 
              RowBox[{
               RowBox[{"Denominator", "[", "r", "]"}], ",", 
               RowBox[{"Extension", "\[Rule]", "Automatic"}]}], "]"}]], 
            "]"}]}]}], "\[IndentingNewLine]", "\t", "]"}]}], 
       "\[IndentingNewLine]", "\t", ",", "\[IndentingNewLine]", "True", ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"res", "=", 
         RowBox[{"SubResultant", "[", 
          RowBox[{
           RowBox[{"Expand", "[", 
            RowBox[{
             RowBox[{"Numerator", "[", "f", "]"}], "-", 
             RowBox[{"rischZ", " ", 
              RowBox[{"TotalDerivation", "[", 
               RowBox[{"d", ",", "theta", ",", "Dtower"}], "]"}]}]}], "]"}], 
           ",", "d", ",", 
           RowBox[{"Last", "[", "theta", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"r", "=", 
         RowBox[{"Cancel", "[", 
          RowBox[{"Together", "[", "\[IndentingNewLine]", 
           RowBox[{"Resultant", "[", 
            RowBox[{
             RowBox[{"Expand", "[", 
              RowBox[{
               RowBox[{"Numerator", "[", "f", "]"}], "-", 
               RowBox[{"rischZ", " ", 
                RowBox[{"TotalDerivation", "[", 
                 RowBox[{"d", ",", "theta", ",", "Dtower"}], "]"}]}]}], "]"}],
              ",", "d", ",", 
             RowBox[{"Last", "[", "theta", "]"}]}], "]"}], 
           "\[IndentingNewLine]", "\t", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"(*", " ", 
         RowBox[{
         "allow", " ", "for", " ", "algebraic", " ", "numbers", " ", "to", 
          " ", "be", " ", "present"}], " ", "*)"}], "\[IndentingNewLine]", 
        "\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{"r", ",", 
             RowBox[{"xx_.", " ", 
              SuperscriptBox["cc_", 
               RowBox[{"n_", "?", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"!", 
                   RowBox[{"IntegerQ", "[", "#", "]"}]}], "&"}], ")"}]}]]}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "Infinity"}], "}"}]}], "]"}], "=!=", 
           RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", "\t\t", 
          RowBox[{"r", "=", 
           RowBox[{"Cancel", "[", 
            FractionBox[
             RowBox[{"Factor", "[", 
              RowBox[{
               RowBox[{"Numerator", "[", "r", "]"}], ",", 
               RowBox[{"Extension", "\[Rule]", "Automatic"}]}], "]"}], 
             RowBox[{"Factor", "[", 
              RowBox[{
               RowBox[{"Denominator", "[", "r", "]"}], ",", 
               RowBox[{"Extension", "\[Rule]", "Automatic"}]}], "]"}]], 
            "]"}]}]}], "\[IndentingNewLine]", "\t", "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", 
     RowBox[{"(*", " ", 
      RowBox[{"end", " ", "if"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"kD", "=", 
      RowBox[{"kappaD", "[", 
       RowBox[{"r", ",", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"theta", ",", "rischZ"}], "}"}], "]"}], ",", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Dtower", ",", "1"}], "}"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"n", ",", "s"}], "}"}], "=", 
      RowBox[{"SplitSquarefreeFactor", "[", 
       RowBox[{"r", ",", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"theta", ",", "rischZ"}], "}"}], "]"}], ",", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Dtower", ",", "kD"}], "}"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"S", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Exponent", "[", 
            RowBox[{
             RowBox[{"Part", "[", 
              RowBox[{"s", ",", "i"}], "]"}], ",", "rischZ"}], "]"}], ">", 
           "0"}], ",", "\[IndentingNewLine]", "\t\t", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"i", "==", 
             RowBox[{"Exponent", "[", 
              RowBox[{"d", ",", 
               RowBox[{"Last", "[", "theta", "]"}]}], "]"}]}], ",", 
            "\[IndentingNewLine]", "\t\t\t", 
            RowBox[{"(*", " ", 
             RowBox[{"make", " ", "S", " ", "monic", " ", "wrt", " ", 
              RowBox[{"Last", "[", "theta", "]"}]}], " ", "*)"}], 
            "\[IndentingNewLine]", "\t\t\t", 
            RowBox[{
             RowBox[{"w", "=", 
              RowBox[{"lc", "[", 
               RowBox[{
                RowBox[{"Expand", "[", "d", "]"}], ",", 
                RowBox[{"Last", "[", "theta", "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", "\t\t\t", 
             RowBox[{"EEA", "=", 
              RowBox[{"ExtendedEuclidean", "[", 
               RowBox[{"w", ",", 
                RowBox[{"Part", "[", 
                 RowBox[{"s", ",", "i"}], "]"}], ",", "1", ",", "rischZ"}], 
               "]"}]}], ";", "\[IndentingNewLine]", "\t\t\t", 
             RowBox[{"newarg", "=", 
              RowBox[{"primitive", "[", 
               RowBox[{
                RowBox[{"Cancel", "[", 
                 RowBox[{"Together", "[", 
                  RowBox[{"PolynomialRemainder", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Part", "[", 
                    RowBox[{"EEA", ",", "1"}], "]"}], "d"}], ",", 
                    RowBox[{"Part", "[", 
                    RowBox[{"s", ",", "i"}], "]"}], ",", "rischZ"}], "]"}], 
                  "]"}], "]"}], ",", "theta", ",", 
                RowBox[{"Last", "[", "theta", "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", "\t\t\t", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"S", ",", "newarg"}], "]"}]}], "\[IndentingNewLine]", 
            "\t\t", ",", 
            RowBox[{"(*", " ", "else", " ", "*)"}], "\[IndentingNewLine]", 
            "\t\t\t", 
            RowBox[{
             RowBox[{"Do", "[", "\[IndentingNewLine]", "\t\t\t\t", 
              RowBox[{
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Exponent", "[", 
                    RowBox[{
                    RowBox[{"res", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", "theta", "]"}]}], "]"}], "==", "i"}],
                   ",", "\[IndentingNewLine]", "\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{"M", "=", "m"}], ";", "\[IndentingNewLine]", 
                   "\t\t\t\t\t", 
                   RowBox[{"sbar", "=", 
                    RowBox[{"Part", "[", 
                    RowBox[{"res", ",", "m"}], "]"}]}]}]}], 
                 "\[IndentingNewLine]", "\t\t\t\t", "]"}], ";"}], 
               RowBox[{"(*", " ", 
                RowBox[{"end", " ", "if"}], " ", "*)"}], 
               "\[IndentingNewLine]", "\t\t\t", ",", 
               RowBox[{"{", 
                RowBox[{"m", ",", "2", ",", 
                 RowBox[{
                  RowBox[{"Length", "[", "res", "]"}], "-", "1"}]}], "}"}]}], 
              "\[IndentingNewLine]", "\t\t\t", "]"}], ";", 
             RowBox[{"(*", " ", 
              RowBox[{"end", " ", "do"}], " ", "*)"}], "\[IndentingNewLine]", 
             "\t\t\t", 
             RowBox[{"A", "=", 
              RowBox[{"Power", "@@@", 
               RowBox[{"Squarefree", "[", 
                RowBox[{
                 RowBox[{"lc", "[", 
                  RowBox[{"sbar", ",", 
                   RowBox[{"Last", "[", "theta", "]"}]}], "]"}], ",", 
                 RowBox[{"Last", "[", "theta", "]"}]}], "]"}]}]}], ";", 
             "\[IndentingNewLine]", "\t\t\t", 
             RowBox[{"Do", "[", "\[IndentingNewLine]", "\t\t\t\t", 
              RowBox[{
               RowBox[{"sbar", "=", 
                RowBox[{"sbar", "/", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"PolynomialGCD", "[", 
                    RowBox[{
                    RowBox[{"Part", "[", 
                    RowBox[{"A", ",", "j"}], "]"}], ",", 
                    RowBox[{"Part", "[", 
                    RowBox[{"s", ",", "i"}], "]"}], ",", "rischZ", ",", 
                    RowBox[{"Extension", "\[Rule]", "Automatic"}]}], "]"}], 
                   "^", "j"}], ")"}]}]}], "\[IndentingNewLine]", "\t\t\t", 
               ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", "1", ",", 
                 RowBox[{"Length", "[", "A", "]"}]}], "}"}]}], 
              "\[IndentingNewLine]", "\t\t\t", "]"}], ";", 
             "\[IndentingNewLine]", "\t\t\t", 
             RowBox[{"(*", " ", 
              RowBox[{"make", " ", "S", " ", "monic", " ", "wrt", " ", 
               RowBox[{"Last", "[", "theta", "]"}]}], " ", "*)"}], 
             "\[IndentingNewLine]", "\t\t\t", 
             RowBox[{"w", "=", 
              RowBox[{"lc", "[", 
               RowBox[{
                RowBox[{"Cancel", "[", 
                 RowBox[{"Together", "[", "sbar", "]"}], "]"}], ",", 
                RowBox[{"Last", "[", "theta", "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", "\t\t\t", 
             RowBox[{"EEA", "=", 
              RowBox[{"ExtendedEuclidean", "[", 
               RowBox[{"w", ",", 
                RowBox[{"Part", "[", 
                 RowBox[{"s", ",", "i"}], "]"}], ",", "1", ",", "rischZ"}], 
               "]"}]}], ";", "\[IndentingNewLine]", "\t\t\t", 
             RowBox[{"sbar", "=", 
              RowBox[{"primitive", "[", 
               RowBox[{
                RowBox[{"Cancel", "[", 
                 RowBox[{"Together", "[", 
                  RowBox[{"PolynomialRemainder", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Part", "[", 
                    RowBox[{"EEA", ",", "1"}], "]"}], "sbar"}], ",", 
                    RowBox[{"Part", "[", 
                    RowBox[{"s", ",", "i"}], "]"}], ",", "rischZ"}], "]"}], 
                  "]"}], "]"}], ",", "theta", ",", 
                RowBox[{"Last", "[", "theta", "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", "\t\t\t", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"S", ",", "sbar"}], "]"}]}]}], "\[IndentingNewLine]", 
           "\t\t", "]"}]}], 
         RowBox[{"(*", " ", 
          RowBox[{"end", " ", "if"}], " ", "*)"}], "\[IndentingNewLine]", 
         "\t", "]"}], ";"}], 
       RowBox[{"(*", " ", 
        RowBox[{"end", " ", "if"}], " ", "*)"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "s", "]"}]}], "}"}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "remove", " ", "constant", " ", "polynomials", " ", "from", " ", 
       "RootSum", " ", "expression"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"evals", "=", 
      RowBox[{"Select", "[", 
       RowBox[{"s", ",", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"PossibleZeroQ", "[", 
           RowBox[{"D", "[", 
            RowBox[{"#", ",", "rischZ"}], "]"}], "]"}]}], "&"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"RootSum", " ", "exrpession", " ", "for", " ", "result"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", "\t\t", 
      RowBox[{
       RowBox[{
        RowBox[{"Head", "[", 
         RowBox[{"Last", "[", "tower", "]"}], "]"}], "===", "rischExp"}], ",",
        "\[IndentingNewLine]", "\t\t\t", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", "\t\t\t\t", 
        RowBox[{
         RowBox[{"Result", "=", 
          RowBox[{"Result", "+", 
           RowBox[{"rischLogPartE", "[", 
            RowBox[{
             RowBox[{"Part", "[", 
              RowBox[{"evals", ",", "i"}], "]"}], ",", 
             RowBox[{"Part", "[", 
              RowBox[{"S", ",", "i"}], "]"}], ",", 
             RowBox[{"Last", "[", "theta", "]"}], ",", 
             RowBox[{"Last", "[", "tower", "]"}]}], "]"}]}]}], 
         "\[IndentingNewLine]", "\t\t\t", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "evals", "]"}]}], "}"}]}], 
        "\[IndentingNewLine]", "\t\t\t", "]"}], ",", "\[IndentingNewLine]", 
       "\t\t", "True", 
       RowBox[{"(*", " ", 
        RowBox[{"log", " ", "theta", " ", "or", " ", "rational"}], " ", 
        "*)"}], ",", "\[IndentingNewLine]", "\t\t\t", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", "\t\t\t\t", 
        RowBox[{
         RowBox[{"Result", "=", 
          RowBox[{"Result", "+", 
           RowBox[{"rischLogPartL", "[", 
            RowBox[{
             RowBox[{"Part", "[", 
              RowBox[{"evals", ",", "i"}], "]"}], ",", 
             RowBox[{"Part", "[", 
              RowBox[{"S", ",", "i"}], "]"}], ",", 
             RowBox[{"Last", "[", "theta", "]"}], ",", 
             RowBox[{"Last", "[", "tower", "]"}]}], "]"}]}]}], 
         "\[IndentingNewLine]", "\t\t\t", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "evals", "]"}]}], "}"}]}], 
        "\[IndentingNewLine]", "\t\t\t", "]"}]}], "\[IndentingNewLine]", "\t",
       "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"FreeQ", "[", 
         RowBox[{"Result", ",", "NaiveSolution"}], "]"}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"remaining", "=", 
         RowBox[{"f", "-", 
          RowBox[{"TotalDerivation", "[", 
           RowBox[{
            RowBox[{"Result", "//.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"rischExp", "\[Rule]", "Exp"}], ",", 
               RowBox[{"rischLog", "\[Rule]", "Log"}]}], "}"}]}], ",", 
            "theta", ",", "Dtower"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        "\t", 
        RowBox[{"naivepart", "=", 
         RowBox[{"RischNaive", "[", 
          RowBox[{"remaining", ",", "theta", ",", "Dtower"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"Result", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Result", "+", "naivepart"}], ")"}], "//.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Exp", "\[Rule]", "rischExp"}], ",", 
            RowBox[{"Log", "\[Rule]", "rischLog"}], ",", 
            RowBox[{"NaiveSolution", "\[Rule]", "0"}]}], "}"}]}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Check", " ", "if", " ", "the", " ", "integral", " ", "is", " ", 
       RowBox[{"elementary", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"FreeQ", "[", 
         RowBox[{
          RowBox[{"Simplify", "[", 
           RowBox[{"Times", "@@", "n"}], "]"}], ",", 
          RowBox[{"Last", "[", "theta", "]"}]}], "]"}], "&&", 
        RowBox[{"FreeQ", "[", 
         RowBox[{
          RowBox[{"Simplify", "[", 
           RowBox[{"Times", "@@", "n"}], "]"}], ",", "rischZ"}], "]"}]}], ",",
        "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"integral", " ", "elementary"}], " ", "*)"}], 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"RischTrace", "[", 
         RowBox[{"PureLogPart", ",", "Result", ",", "\"\<Out\>\""}], "]"}], 
        ";", "\[IndentingNewLine]", "\t\t", "Result"}], "\[IndentingNewLine]",
        "\t", ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"integral", " ", "not", " ", "elementary"}], " ", "*)"}], 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"PureLogPart", "::", "warning"}], "]"}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"RischTrace", "[", 
         RowBox[{"PureLogPart", ",", "Result", ",", "\"\<Out\>\""}], "]"}], 
        ";", "\[IndentingNewLine]", "\t", "$Failed"}]}], 
      "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.38568759987075*^9, 3.385687626230125*^9}, {
   3.385687682855125*^9, 3.38568774599575*^9}, {3.38575184234175*^9, 
   3.38575205171675*^9}, {3.385752089763625*^9, 3.385752148513625*^9}, {
   3.38575218509175*^9, 3.385752203498*^9}, {3.38575231552925*^9, 
   3.385752406748*^9}, {3.3857525171855*^9, 3.385752542169875*^9}, {
   3.38575307346675*^9, 3.385753078701125*^9}, {3.385753165138625*^9, 
   3.38575317540425*^9}, {3.385753221544875*^9, 3.38575322571675*^9}, {
   3.385753305513625*^9, 3.38575332690425*^9}, {3.385753822138625*^9, 
   3.385753838544875*^9}, {3.385753948544875*^9, 3.3857540413105*^9}, {
   3.385754076388625*^9, 3.38575411609175*^9}, 3.385754159263625*^9, {
   3.385754298919875*^9, 3.38575433740425*^9}, {3.385754367857375*^9, 
   3.385754514998*^9}, {3.385754560201125*^9, 3.385754592263625*^9}, {
   3.385754668544875*^9, 3.3857547368105*^9}, {3.385754811013625*^9, 
   3.38575486915425*^9}, {3.3857549053105*^9, 3.38575498609175*^9}, {
   3.38575503052925*^9, 3.38575515877925*^9}, {3.385755258248*^9, 
   3.3857552753105*^9}, {3.385774580357375*^9, 3.385774589763625*^9}, {
   3.385774657201125*^9, 3.38577469259175*^9}, {3.38577656921675*^9, 
   3.38577665227925*^9}, {3.385776796919875*^9, 3.385776933482375*^9}, {
   3.38577708265425*^9, 3.3857770978105*^9}, {3.385780323138625*^9, 
   3.385780398888625*^9}, {3.385786185217896*^9, 3.385786313973037*^9}, {
   3.3857864706683536`*^9, 3.385786473502429*^9}, {3.3857868111279106`*^9, 
   3.385786830425659*^9}, {3.385786894357589*^9, 3.38578691020037*^9}, {
   3.3857870063386097`*^9, 3.3857870091726847`*^9}, {3.3857871809096303`*^9, 
   3.3857872036222897`*^9}, {3.3857873163343616`*^9, 3.385787366065872*^9}, {
   3.385787416568491*^9, 3.385787416848894*^9}, {3.385787564250848*^9, 
   3.3857875830278482`*^9}, {3.3857876442859325`*^9, 
   3.3857876613304415`*^9}, {3.3857877454714303`*^9, 3.385787760853549*^9}, {
   3.385789826784211*^9, 3.385789890445752*^9}, {3.3857900270421677`*^9, 
   3.3857900555731936`*^9}, {3.385790145312232*^9, 3.3857901497886686`*^9}, {
   3.3857906143166275`*^9, 3.385790646552981*^9}, {3.3857906880526543`*^9, 
   3.385790697235859*^9}, {3.3857910084633827`*^9, 3.3857910123489695`*^9}, {
   3.3857912335870943`*^9, 3.385791243821811*^9}, {3.3857914964450655`*^9, 
   3.385791534940419*^9}, {3.3857915717233105`*^9, 3.3857915850624914`*^9}, {
   3.38579186273176*^9, 3.3857918630422063`*^9}, {3.3857928412187552`*^9, 
   3.385792845114357*^9}, 3.3857938255241165`*^9, {3.385793862867814*^9, 
   3.3857938801126113`*^9}, {3.3862560760295*^9, 3.386256077217*^9}, {
   3.38625663037325*^9, 3.386256652982625*^9}, {3.386256719263875*^9, 
   3.386256727263875*^9}, {3.386256803545125*^9, 3.386256824670125*^9}, {
   3.387333515589875*^9, 3.387333546714875*^9}, {3.387342682308625*^9, 
   3.387342683996125*^9}, 3.38734271782425*^9, {3.38734281194925*^9, 
   3.387342911777375*^9}, {3.38734294238675*^9, 3.387342953668*^9}, 
   3.38734373638675*^9, {3.38734377632425*^9, 3.387343782621125*^9}, {
   3.387408201321*^9, 3.387408232211625*^9}, {3.38741081889825*^9, 
   3.38741085133575*^9}, {3.389044734513625*^9, 3.38904476909175*^9}, {
   3.389044855107375*^9, 3.389044861388625*^9}, {3.38904519365425*^9, 
   3.389045196623*^9}, {3.38904530021675*^9, 3.389045353669875*^9}, {
   3.38904569990425*^9, 3.389045707419875*^9}, {3.389045849857375*^9, 
   3.389045860998*^9}, {3.38904590821675*^9, 3.389045908826125*^9}, {
   3.389045964451125*^9, 3.389045971794875*^9}, {3.389046010513625*^9, 
   3.389046019857375*^9}, {3.38904636927925*^9, 3.389046378998*^9}, {
   3.389046425373*^9, 3.38904642602925*^9}, {3.38904646977925*^9, 
   3.389046469982375*^9}, {3.389046882451125*^9, 3.3890469223105*^9}, {
   3.38904700302925*^9, 3.389047005638625*^9}, {3.389047040607375*^9, 
   3.38904706340425*^9}, {3.389047119138625*^9, 3.389047130576125*^9}, {
   3.389047577419875*^9, 3.389047582123*^9}, {3.389047621732375*^9, 
   3.389047630748*^9}, {3.38906456234175*^9, 3.389064568138625*^9}, 
   3.38906516490425*^9, {3.389065664638625*^9, 3.38906567946675*^9}, {
   3.389066278794875*^9, 3.389066283607375*^9}, {3.38906632334175*^9, 
   3.389066447201125*^9}, {3.389067013482375*^9, 3.389067021513625*^9}, {
   3.3891088909206247`*^9, 3.3891089058737497`*^9}, {3.3901017424945*^9, 
   3.3901017494945*^9}, 3.39010282427575*^9, {3.39010347527575*^9, 
   3.390103489307*^9}, {3.390103610322625*^9, 3.390103615197625*^9}, {
   3.390104731666375*^9, 3.3901047357445*^9}, {3.390105813916375*^9, 
   3.390105816447625*^9}, {3.390106704041375*^9, 3.390106724635125*^9}, {
   3.390107092635125*^9, 3.390107126603875*^9}, {3.3901071818695*^9, 
   3.390107210166375*^9}, {3.390108180635125*^9, 3.39010818071325*^9}, {
   3.39010822427575*^9, 3.3901082244945*^9}, {3.39010863421325*^9, 
   3.3901086372445*^9}, {3.3901088728695*^9, 3.390108872947625*^9}, {
   3.3901104207445*^9, 3.390110481135125*^9}, {3.390110592603875*^9, 
   3.390110609666375*^9}, {3.39011068165075*^9, 3.39011068208825*^9}, {
   3.390110817728875*^9, 3.39011083096325*^9}, {3.3901109101195*^9, 
   3.390110910182*^9}, {3.390111008228875*^9, 3.390111008307*^9}, {
   3.390111062057*^9, 3.390111065791375*^9}, {3.39011134990075*^9, 
   3.39011135265075*^9}, {3.3901117302445*^9, 3.390111832478875*^9}, {
   3.39011224958825*^9, 3.390112282385125*^9}, {3.39014643053025*^9, 
   3.390146432702125*^9}, {3.39014714353025*^9, 3.390147195545875*^9}, {
   3.3901473153115*^9, 3.390147334639625*^9}, {3.390147437827125*^9, 
   3.390147440420875*^9}, {3.39014747271775*^9, 3.390147489170875*^9}, {
   3.390147565545875*^9, 3.390147606764625*^9}, {3.3902512910463753`*^9, 
   3.3902512950776253`*^9}, {3.3902520056557503`*^9, 
   3.3902520090151253`*^9}, {3.3902521298276253`*^9, 
   3.3902521325463753`*^9}, {3.3902522879370003`*^9, 
   3.3902522881557503`*^9}, {3.3902525782338753`*^9, 
   3.3902525814995003`*^9}, {3.3902621133588753`*^9, 
   3.3902621174995003`*^9}, {3.3902621575463753`*^9, 
   3.3902621727338753`*^9}, {3.3902622237807503`*^9, 
   3.3902622289995003`*^9}, {3.3902623458120003`*^9, 
   3.3902623511870003`*^9}, {3.3902624463276253`*^9, 
   3.3902624524213753`*^9}, {3.3902628073120003`*^9, 
   3.3902628100776253`*^9}, {3.3902634775307503`*^9, 3.3902635560932503`*^9}, 
   3.3902636307026253`*^9, {3.3902636864838753`*^9, 3.3902636962495003`*^9}, {
   3.3902637700151253`*^9, 3.3902637729370003`*^9}, {3.3902638104213753`*^9, 
   3.3902638708901253`*^9}, {3.3902639989370003`*^9, 
   3.3902640003120003`*^9}, {3.3902642961713753`*^9, 
   3.3902643077807503`*^9}, {3.3902643510463753`*^9, 
   3.3902643825307503`*^9}, {3.3904519880612497`*^9, 
   3.3904520640143747`*^9}, {3.3904523707018747`*^9, 
   3.3904523709206247`*^9}, {3.3904526381706247`*^9, 
   3.3904526567331247`*^9}, {3.3904528179518747`*^9, 
   3.3904528417331247`*^9}, {3.3904529407331247`*^9, 
   3.3904529472331247`*^9}, {3.3904530726393747`*^9, 
   3.3904531754831247`*^9}, {3.3904534636393747`*^9, 
   3.3904534691393747`*^9}, {3.3904536001237497`*^9, 
   3.3904536030924997`*^9}, {3.3904536519049997`*^9, 
   3.3904536529674997`*^9}, {3.3904537424987497`*^9, 
   3.3904537452799997`*^9}, {3.3905461464206247`*^9, 
   3.3905461702174997`*^9}, {3.3905462393893747`*^9, 
   3.3905463035612497`*^9}, {3.3905463599674997`*^9, 
   3.3905463858112497`*^9}, {3.3905464374518747`*^9, 
   3.3905464410924997`*^9}, {3.3905468288737497`*^9, 
   3.3905468382956247`*^9}, {3.3905481235924997`*^9, 
   3.3905481256862497`*^9}, {3.3905481805143747`*^9, 
   3.3905481918737497`*^9}, {3.3905482479049997`*^9, 
   3.3905482480143747`*^9}, {3.3905483735456247`*^9, 
   3.3905483760768747`*^9}, {3.3905485653424997`*^9, 
   3.3905486181081247`*^9}, {3.3905487097643747`*^9, 
   3.3905487291549997`*^9}, {3.3905487621549997`*^9, 
   3.3905487840612497`*^9}, {3.3905488251706247`*^9, 3.3905488262018747`*^9}, 
   3.3905488643112497`*^9, {3.3905489108893747`*^9, 3.3905489176393747`*^9}, {
   3.3905489712643747`*^9, 3.3905490119206247`*^9}, {3.3905490422643747`*^9, 
   3.3905490766706247`*^9}, {3.3905491255612497`*^9, 
   3.3905491650299997`*^9}, {3.3905492279674997`*^9, 
   3.3905492476862497`*^9}, {3.3905493448737497`*^9, 
   3.3905494237331247`*^9}, {3.3905495215143747`*^9, 
   3.3905495548581247`*^9}, {3.3905496485299997`*^9, 
   3.3905496588893747`*^9}, {3.3905496917331247`*^9, 
   3.3905497112174997`*^9}, {3.3905497595456247`*^9, 
   3.3905497776549997`*^9}, {3.3905498120456247`*^9, 
   3.3905498160924997`*^9}, {3.3905498492799997`*^9, 
   3.3905498692799997`*^9}, {3.3905498997331247`*^9, 
   3.3905499570299997`*^9}, {3.3905499971237497`*^9, 
   3.3905499992956247`*^9}, {3.3905500411237497`*^9, 
   3.3905500505924997`*^9}, {3.3905500983581247`*^9, 3.3905501279362497`*^9}, 
   3.3905503028268747`*^9, {3.3905503342018747`*^9, 3.3905504186549997`*^9}, {
   3.3905504936862497`*^9, 3.3905504963737497`*^9}, {3.3905505302018747`*^9, 
   3.3905505323893747`*^9}, {3.390582377139125*^9, 3.3905823976235*^9}, {
   3.3905824401235*^9, 3.39058246090475*^9}, {3.390582498670375*^9, 
   3.390582500936*^9}, {3.390582620201625*^9, 3.390582633076625*^9}, {
   3.390619396875*^9, 3.390619439921875*^9}, {3.390620702546875*^9, 
   3.3906207315*^9}, {3.390620806125*^9, 3.39062088284375*^9}, {
   3.390620942359375*^9, 3.390620942734375*^9}, {3.390620973125*^9, 
   3.390620993828125*^9}, {3.390621208734375*^9, 3.390621280734375*^9}, {
   3.390621439203125*^9, 3.39062144221875*^9}, {3.39062148390625*^9, 
   3.390621498546875*^9}, {3.39062156696875*^9, 3.390621569890625*^9}, {
   3.390621603078125*^9, 3.39062165990625*^9}, {3.39062171059375*^9, 
   3.390621765421875*^9}, {3.390621812859375*^9, 3.39062183521875*^9}, {
   3.39062191521875*^9, 3.39062194959375*^9}, {3.390622045921875*^9, 
   3.3906221540625*^9}, {3.390622322203125*^9, 3.390622374984375*^9}, {
   3.390622453921875*^9, 3.39062247653125*^9}, {3.390622531078125*^9, 
   3.39062257434375*^9}, {3.39062284640625*^9, 3.39062285796875*^9}, {
   3.390623119953125*^9, 3.390623132578125*^9}, {3.390623726171875*^9, 
   3.390623727125*^9}, {3.390623964734375*^9, 3.390624025328125*^9}, {
   3.39062408971875*^9, 3.390624165703125*^9}, {3.390624204734375*^9, 
   3.3906242375*^9}, {3.390624284203125*^9, 3.390624298421875*^9}, {
   3.390624393953125*^9, 3.390624477171875*^9}, {3.39062453240625*^9, 
   3.390624659828125*^9}, {3.390624789890625*^9, 3.39062482271875*^9}, {
   3.390624867375*^9, 3.390624867546875*^9}, {3.390625160046875*^9, 
   3.390625167265625*^9}, {3.390625234890625*^9, 3.39062526296875*^9}, {
   3.390625295390625*^9, 3.3906253610625*^9}, {3.3906253975625*^9, 
   3.3906254236875*^9}, {3.390625455125*^9, 3.39062545765625*^9}, {
   3.39062549303125*^9, 3.390625495421875*^9}, {3.3906255256875*^9, 
   3.390625565546875*^9}, {3.39062562721875*^9, 3.3906256299375*^9}, {
   3.39062574725*^9, 3.3906257531875*^9}, {3.390625795578125*^9, 
   3.390625795671875*^9}, 3.39062595653125*^9, {3.390626001859375*^9, 
   3.3906260264375*^9}, {3.39062608209375*^9, 3.390626096109375*^9}, {
   3.390626256046875*^9, 3.39062625621875*^9}, {3.3906263580625*^9, 
   3.39062636409375*^9}, {3.39062681178125*^9, 3.390626849609375*^9}, {
   3.39062690871875*^9, 3.390627018671875*^9}, {3.390627054140625*^9, 
   3.3906270958125*^9}, {3.390627190609375*^9, 3.39062724965625*^9}, {
   3.39062861903125*^9, 3.390628622046875*^9}, {3.390628755484375*^9, 
   3.390628762828125*^9}, {3.3906288621875*^9, 3.390628890171875*^9}, {
   3.39062960775*^9, 3.390629609875*^9}, {3.39067749549925*^9, 
   3.390677505546125*^9}, {3.390677562593*^9, 3.39067756793675*^9}, {
   3.39067793412425*^9, 3.390677973639875*^9}, {3.390678033639875*^9, 
   3.3906780400305*^9}, {3.390678089014875*^9, 3.390678090421125*^9}, {
   3.390678148718*^9, 3.390678194796125*^9}, {3.390678241468*^9, 
   3.390678244327375*^9}, {3.390678294733625*^9, 3.390678315593*^9}, {
   3.390679089514875*^9, 3.390679099546125*^9}, {3.390679432577375*^9, 
   3.39067944237425*^9}, {3.39067962893675*^9, 3.390679646389875*^9}, {
   3.390679725639875*^9, 3.390679725983625*^9}, {3.390680581843*^9, 
   3.39068058524925*^9}, {3.39068063812425*^9, 3.390680650343*^9}, {
   3.390680889468*^9, 3.3906808921555*^9}, {3.390692406077375*^9, 
   3.390692409796125*^9}, {3.390692544671125*^9, 3.390692564108625*^9}, {
   3.390693911093*^9, 3.3906940000305*^9}, {3.39069409237425*^9, 
   3.39069411906175*^9}, {3.39069429162425*^9, 3.39069429781175*^9}, {
   3.39069434181175*^9, 3.390694371827375*^9}, {3.39069441699925*^9, 
   3.39069475681175*^9}, {3.390694787343*^9, 3.390694793843*^9}, {
   3.390694844514875*^9, 3.390694890702375*^9}, {3.3906957887805*^9, 
   3.390695898046125*^9}, {3.3906959456555*^9, 3.390695993077375*^9}, {
   3.390696038046125*^9, 3.390696054452375*^9}, {3.3906961099055*^9, 
   3.390696155108625*^9}, {3.39069621193675*^9, 3.3906962225305*^9}, {
   3.39069634518675*^9, 3.39069634743675*^9}, {3.390696444014875*^9, 
   3.390696493858625*^9}, {3.3906966120305*^9, 3.39069673912425*^9}, {
   3.390696807577375*^9, 3.390696847593*^9}, 3.390697130827375*^9, {
   3.3906973044055*^9, 3.390697305796125*^9}, {3.390697338421125*^9, 
   3.390697347343*^9}, {3.390698246952375*^9, 3.390698283796125*^9}, {
   3.390698428796125*^9, 3.39069844187425*^9}, {3.390698474968*^9, 
   3.390698552983625*^9}, {3.390699518702375*^9, 3.39069953793675*^9}, {
   3.390699753889875*^9, 3.390699809014875*^9}, {3.390701372889875*^9, 
   3.390701397952375*^9}, {3.390701451858625*^9, 3.390701510421125*^9}, {
   3.390703085827375*^9, 3.3907031209055*^9}, 3.390703233577375*^9, {
   3.390703363546125*^9, 3.390703363952375*^9}, {3.390852166793625*^9, 
   3.390852194074875*^9}, {3.3908522570905*^9, 3.390852279653*^9}, {
   3.3908523135905*^9, 3.39085256705925*^9}, {3.390852599918625*^9, 
   3.390852655074875*^9}, {3.390852825012375*^9, 3.39085283718425*^9}, {
   3.3908528738405*^9, 3.390852874887375*^9}, {3.39085292574675*^9, 
   3.39085293162175*^9}, {3.39085321805925*^9, 3.3908532917155*^9}, {
   3.390853359106125*^9, 3.390853359449875*^9}, {3.390853639356125*^9, 
   3.390853640387375*^9}, {3.3928493811237497`*^9, 3.3928494529362497`*^9}, {
   3.3928505086237497`*^9, 3.3928505289362497`*^9}, {3.3928509025924997`*^9, 
   3.3928509668581247`*^9}, {3.392931093577125*^9, 3.3929311920615*^9}, {
   3.392932151764625*^9, 3.39293219359275*^9}, {3.39293332409275*^9, 
   3.392933349483375*^9}, {3.39293406065525*^9, 3.392934060999*^9}, 
   3.392934265420875*^9, {3.39293440965525*^9, 3.392934410295875*^9}, {
   3.3935206020435*^9, 3.3935206262935*^9}, {3.393523178590375*^9, 
   3.393523232996625*^9}, {3.393524260527875*^9, 3.3935243084185*^9}, {
   3.393526477166625*^9, 3.39352650455725*^9}, {3.393526686776*^9, 
   3.393526758854125*^9}, {3.393537438604125*^9, 3.393537438885375*^9}, {
   3.393542767526*^9, 3.393542786572875*^9}, {3.39354283355725*^9, 
   3.393542878854125*^9}, {3.393543126885375*^9, 3.39354314799475*^9}, {
   3.39354319293225*^9, 3.393543203416625*^9}, {3.39354390480725*^9, 
   3.393543914229125*^9}, {3.393543944541625*^9, 3.393543946885375*^9}, {
   3.393544355604125*^9, 3.393544424791625*^9}, {3.393544513916625*^9, 
   3.393544518854125*^9}, {3.393544632604125*^9, 3.39354463705725*^9}, {
   3.393545830979125*^9, 3.393545836229125*^9}, {3.393546912260375*^9, 
   3.393546912479125*^9}, {3.393637512279875*^9, 3.39363751601425*^9}, {
   3.393637789092375*^9, 3.3936377894205*^9}, {3.3944041111555*^9, 
   3.3944041149055*^9}, {3.394404222968*^9, 3.3944042240305*^9}, {
   3.394424264108625*^9, 3.394424278421125*^9}, {3.394424811702375*^9, 
   3.39442484018675*^9}, {3.394424870327375*^9, 3.3944248714055*^9}, {
   3.3944262564049997`*^9, 3.3944263180924997`*^9}, {3.3944263695456247`*^9, 
   3.3944263729049997`*^9}, {3.395190677612719*^9, 3.395190680666377*^9}, {
   3.395190905297909*^9, 3.395191019263568*^9}, {3.395191078502206*^9, 
   3.395191089021315*^9}, {3.395194035355846*^9, 3.395194125572341*^9}, {
   3.395194177339932*^9, 3.395194276232861*^9}, {3.3951945034436073`*^9, 
   3.395194513903639*^9}, {3.395194811683281*^9, 3.3951948241236362`*^9}, {
   3.3951948793259897`*^9, 3.39519491166689*^9}, {3.3951950017920837`*^9, 
   3.39519500437148*^9}, {3.395195342382141*^9, 3.395195343497828*^9}, {
   3.395195376700961*^9, 3.395195425473775*^9}, {3.3951955034217243`*^9, 
   3.395195560645279*^9}, {3.395195595766747*^9, 3.3951956405404367`*^9}, {
   3.395195684532444*^9, 3.395195714595573*^9}, {3.395195765548996*^9, 
   3.395195948746572*^9}, {3.395195995549247*^9, 3.395195996038114*^9}, {
   3.395200420878237*^9, 3.395200421442782*^9}, {3.395298831139139*^9, 
   3.395298831241357*^9}, {3.395299952316415*^9, 3.3952999645323353`*^9}, {
   3.395300627162359*^9, 3.395300639878656*^9}, {3.39530073637739*^9, 
   3.3953007734855824`*^9}, {3.3953009544736547`*^9, 
   3.3953009679758453`*^9}, {3.3953010571426086`*^9, 3.395301079738158*^9}, {
   3.395301143655006*^9, 3.395301158535034*^9}, {3.395301209053689*^9, 
   3.395301209389617*^9}, {3.3953015170392027`*^9, 3.3953015361382647`*^9}, {
   3.395301736805677*^9, 3.39530173716698*^9}, {3.3953024499661694`*^9, 
   3.395302456035761*^9}, {3.3953123217214622`*^9, 3.395312351375802*^9}, {
   3.395312417889099*^9, 3.3953124626794033`*^9}, {3.395313042645176*^9, 
   3.395313068576137*^9}, {3.395313108541522*^9, 3.395313123594262*^9}, {
   3.39531346421465*^9, 3.395313466363145*^9}, {3.395314528715129*^9, 
   3.3953145371127367`*^9}, {3.3953150759095297`*^9, 3.395315077947679*^9}, {
   3.395315394963933*^9, 3.395315411481234*^9}, {3.3954925260466747`*^9, 
   3.395492529948654*^9}, {3.3954926713812838`*^9, 3.3954926734648457`*^9}, {
   3.395497282915934*^9, 3.395497286199958*^9}, {3.395497824862033*^9, 
   3.395497826739821*^9}, {3.395554944402306*^9, 3.395554987736986*^9}, {
   3.395555082123818*^9, 3.3955550902807503`*^9}, {3.3955554790370398`*^9, 
   3.395555498841572*^9}, {3.3955555529435587`*^9, 3.395555565975626*^9}, {
   3.395555921115129*^9, 3.3955559282839403`*^9}, {3.3956611917403717`*^9, 
   3.395661225183608*^9}, {3.395661390989558*^9, 3.395661394801752*^9}, {
   3.395661478069668*^9, 3.3956614923802958`*^9}, {3.3956615571866837`*^9, 
   3.3956616186062403`*^9}, {3.395661792768118*^9, 3.395661800262865*^9}, {
   3.395661939373212*^9, 3.3956619580987453`*^9}, {3.3956620337700377`*^9, 
   3.3956620631118317`*^9}, {3.3956622961484423`*^9, 3.395662302841386*^9}, {
   3.395662357340337*^9, 3.395662362451206*^9}, {3.3956624790511227`*^9, 
   3.395662480168398*^9}, {3.3956630623134336`*^9, 3.395663070122921*^9}, {
   3.395725982483075*^9, 3.3957260092420473`*^9}, {3.39572614110979*^9, 
   3.3957261499712887`*^9}, {3.395726612901134*^9, 3.3957266159787807`*^9}, {
   3.395726909172624*^9, 3.395726921757248*^9}, {3.3957270294577847`*^9, 
   3.395727034166739*^9}, {3.395727620545835*^9, 3.395727623313489*^9}, {
   3.395727656264401*^9, 3.395727679482277*^9}, {3.395727712296101*^9, 
   3.39572773265336*^9}, {3.395728403026444*^9, 3.395728433203539*^9}, {
   3.395728494574987*^9, 3.395728522794896*^9}, {3.395728733471793*^9, 
   3.3957287471903687`*^9}, {3.3957288773212833`*^9, 
   3.3957288861522493`*^9}, {3.395728962784127*^9, 3.395728967974375*^9}, {
   3.395729035513955*^9, 3.3957290727760572`*^9}, 3.395729382194854*^9, {
   3.3957294413950853`*^9, 3.395729455777843*^9}, {3.3957300923236113`*^9, 
   3.3957301054164333`*^9}, {3.3957302227059517`*^9, 
   3.3957302351514463`*^9}, {3.395730361435451*^9, 3.3957303617700243`*^9}, {
   3.395730395619316*^9, 3.395730446310038*^9}, {3.395730480971299*^9, 
   3.395730498018051*^9}, {3.395730630703621*^9, 3.395730691867594*^9}, {
   3.3957309269085417`*^9, 3.395730934174582*^9}, {3.395731577382976*^9, 
   3.395731625528325*^9}, {3.395732548749969*^9, 3.395732561316658*^9}, {
   3.395732615065299*^9, 3.395732619302552*^9}, {3.39573265302917*^9, 
   3.3957326559941607`*^9}, {3.395733062922024*^9, 3.395733071693616*^9}, {
   3.3957331075530987`*^9, 3.395733131368885*^9}, {3.395733197388135*^9, 
   3.3957331998374357`*^9}, {3.395733251257292*^9, 3.39573327204572*^9}, {
   3.395733442447048*^9, 3.3957334830625753`*^9}, {3.39573353739463*^9, 
   3.395733574303912*^9}, {3.395733608759858*^9, 3.3957336190587187`*^9}, {
   3.3957337217657623`*^9, 3.395733742611043*^9}, {3.395735072476907*^9, 
   3.395735105291717*^9}, {3.395735219415511*^9, 3.395735228598222*^9}, {
   3.395735295993814*^9, 3.3957353216032467`*^9}, {3.397877064152585*^9, 
   3.397877071414749*^9}, {3.397877115286109*^9, 3.3978771286077433`*^9}, {
   3.397877184003105*^9, 3.397877247810637*^9}, {3.397877320629881*^9, 
   3.397877361538279*^9}, {3.397877610350336*^9, 3.397877625252095*^9}, {
   3.39787773119623*^9, 3.397877845378179*^9}, {3.397877990942834*^9, 
   3.397877993820848*^9}, {3.397878336680182*^9, 3.397878342276864*^9}, {
   3.397878400494739*^9, 3.3978784152206783`*^9}, {3.397878471232938*^9, 
   3.397878480703265*^9}, {3.397878550020166*^9, 3.397878578029114*^9}, {
   3.397878750586165*^9, 3.397878754348158*^9}, {3.3978787974750967`*^9, 
   3.3978788115332937`*^9}, {3.39787889398895*^9, 3.397878985461053*^9}, {
   3.397879104625342*^9, 3.3978791199443417`*^9}, {3.3978793212872753`*^9, 
   3.3978793615101967`*^9}, {3.397879400961204*^9, 3.397879472670828*^9}, {
   3.3978795382641907`*^9, 3.397879585271214*^9}, {3.3978796285682697`*^9, 
   3.3978797253821163`*^9}, {3.397879759153179*^9, 3.397879790584025*^9}, {
   3.397879951443468*^9, 3.397879952481756*^9}, {3.397880220899411*^9, 
   3.397880221521431*^9}, {3.397890477818379*^9, 3.397890481362761*^9}, {
   3.3978908083839006`*^9, 3.3978908243168097`*^9}, {3.3978909288300123`*^9, 
   3.3978909414497423`*^9}, {3.397891075282606*^9, 3.397891085927877*^9}, {
   3.397891574365337*^9, 3.39789158059227*^9}, {3.3978920976629133`*^9, 
   3.397892101260507*^9}, {3.397892148166243*^9, 3.397892287524087*^9}, {
   3.397892410778852*^9, 3.397892487024642*^9}, {3.397892518774932*^9, 
   3.397892524450267*^9}, {3.397892855496347*^9, 3.3978928712074614`*^9}, {
   3.3978935726621523`*^9, 3.397893584550497*^9}, {3.397894011265674*^9, 
   3.397894022201745*^9}, {3.397894052545588*^9, 3.397894059578085*^9}, {
   3.397894101040164*^9, 3.397894144789617*^9}, {3.397940541479721*^9, 
   3.397940609664321*^9}, {3.397940688201343*^9, 3.3979406938471193`*^9}, {
   3.397940741598896*^9, 3.397940763413134*^9}, {3.397940813762951*^9, 
   3.3979409531996727`*^9}, {3.397941740443294*^9, 3.397941756640106*^9}, {
   3.397942940609494*^9, 3.39794294819359*^9}, {3.3979430026508904`*^9, 
   3.397943098290938*^9}, {3.397943709693554*^9, 3.397943720927772*^9}, {
   3.397957931840571*^9, 3.397957935121151*^9}, {3.397958304364558*^9, 
   3.397958324258731*^9}, {3.397958356657681*^9, 3.397958436832292*^9}, {
   3.397960813998046*^9, 3.397960832715262*^9}, {3.397961509699387*^9, 
   3.3979615131185226`*^9}, {3.3979616629968147`*^9, 3.397961663188957*^9}, {
   3.397991609400325*^9, 3.397991609880109*^9}, {3.397991795343141*^9, 
   3.3979917974880247`*^9}, {3.397992800366927*^9, 3.397992806829522*^9}, {
   3.397992928677191*^9, 3.3979929289574423`*^9}, {3.397993002695374*^9, 
   3.3979930047662897`*^9}, {3.398140725692924*^9, 3.398140771550027*^9}, {
   3.3981408076125593`*^9, 3.398140873936515*^9}, 3.398140929634976*^9, {
   3.398593748216683*^9, 3.398593784360765*^9}, 3.398593823286639*^9, {
   3.398653135393084*^9, 3.398653163785413*^9}, {3.3986532081218147`*^9, 
   3.398653234278788*^9}, {3.398653312012032*^9, 3.398653453126074*^9}, {
   3.398653724055956*^9, 3.398653726718747*^9}, {3.398654028873109*^9, 
   3.39865403330991*^9}, {3.39865432578601*^9, 3.398654332823522*^9}, {
   3.398654505048388*^9, 3.398654511333515*^9}, {3.398654573657187*^9, 
   3.398654601436648*^9}, {3.398654653373839*^9, 3.3986546556539907`*^9}, {
   3.398654797904553*^9, 3.398654800455566*^9}, {3.398654877561328*^9, 
   3.398654908088831*^9}, {3.398654939604224*^9, 3.398654942214423*^9}, {
   3.3986549802892857`*^9, 3.3986549877768908`*^9}, {3.398655018607486*^9, 
   3.398655077450781*^9}, {3.398655132374742*^9, 3.398655136280285*^9}, {
   3.398655192349625*^9, 3.398655192475156*^9}, {3.398660695104149*^9, 
   3.398660705634124*^9}, {3.399284378814313*^9, 3.399284384179799*^9}, {
   3.399284620561142*^9, 3.399284625775902*^9}, {3.399284724490282*^9, 
   3.399284730808456*^9}, {3.399286051775612*^9, 3.399286082602456*^9}, {
   3.3992861571729927`*^9, 3.399286180041369*^9}, {3.39928623635282*^9, 
   3.399286238247673*^9}, {3.399286294223804*^9, 3.399286294417577*^9}, {
   3.399286579176181*^9, 3.3992865794578733`*^9}, {3.3992874173281*^9, 
   3.399287417758568*^9}, {3.4047142435461903`*^9, 3.4047142446119833`*^9}, {
   3.404959326305462*^9, 3.404959363610031*^9}, {3.4049593981369457`*^9, 
   3.4049594427927227`*^9}, {3.404984449943963*^9, 3.404984452378776*^9}, {
   3.404984498934947*^9, 3.404984500901594*^9}, {3.409908909969056*^9, 
   3.4099089115281076`*^9}, {3.4103933589451323`*^9, 
   3.4103933624775343`*^9}, {3.410393473068728*^9, 3.410393483842655*^9}, {
   3.410393588211154*^9, 3.4103936130966797`*^9}, {3.410395797607983*^9, 
   3.4103958588070507`*^9}, {3.410395949382049*^9, 3.4103959496233377`*^9}, {
   3.410397959213513*^9, 3.410397967056209*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"PureLogPart", "[", 
   RowBox[{
    FractionBox["x", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SubscriptBox["\[Theta]", "1"]}]], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", 
      SubscriptBox["\[Theta]", "1"]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", 
      RowBox[{"rischExp", "[", "x", "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", 
      SubscriptBox["\[Theta]", "1"]}], "}"}], ",", "True"}], "]"}], 
  RowBox[{"(*", " ", "bug", " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.4103933222345448`*^9, 3.410393335126093*^9}, {
  3.410397972169746*^9, 3.4103979739025383`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   SuperscriptBox["x", "2"]}], "+", 
  RowBox[{"x", " ", 
   RowBox[{"rischLog", "[", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     SubscriptBox["\[Theta]", "1"]}], "]"}]}]}]], "Output",
 CellChangeTimes->{{3.410393337240226*^9, 3.410393365242612*^9}, 
   3.410393593841172*^9, {3.410393662623989*^9, 3.4103936832074213`*^9}, 
   3.410395837125235*^9, {3.410395945189416*^9, 3.410395950994732*^9}, 
   3.410397968652433*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"RischNaive", "[", 
   RowBox[{"int_", ",", "theta_", ",", "Dtower_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"expr", "=", 
       RowBox[{"Together", "[", "int", "]"}]}], ",", "numf", ",", "denf", ",",
       "Ddenf", ",", "z", ",", "res"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"RischTrace", "[", 
      RowBox[{"RischNaive", ",", 
       RowBox[{"{", 
        RowBox[{"int", ",", "theta", ",", "Dtower"}], "}"}], ",", 
       "\"\<In\>\""}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"return", " ", "naive", " ", "result"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Ddenf", "=", 
      RowBox[{"TotalDerivation", "[", 
       RowBox[{
        RowBox[{"Denominator", "[", "expr", "]"}], ",", "theta", ",", 
        "Dtower"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"numf", ",", "denf", ",", "Ddenf"}], "}"}], "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Numerator", "[", "expr", "]"}], ",", 
         RowBox[{"Denominator", "[", "expr", "]"}], ",", "Ddenf"}], "}"}], "//.", 
       RowBox[{
        RowBox[{"Last", "[", "theta", "]"}], "\[Rule]", "z"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"RootSum", "[", 
         RowBox[{
          RowBox[{"Function", "[", 
           RowBox[{"#1", ",", "#2"}], "]"}], ",", 
          RowBox[{"Function", "[", 
           RowBox[{"#1", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"#3", "/", "#4"}], ")"}], 
             RowBox[{"Log", "[", 
              RowBox[{"#5", "-", "z"}], "]"}]}]}], "]"}]}], "]"}], "&"}], "[", 
       RowBox[{"z", ",", "denf", ",", "numf", ",", "Ddenf", ",", 
        RowBox[{"Last", "[", "theta", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"RischTrace", "[", 
      RowBox[{"RischNaive", ",", "res", ",", "\"\<Out\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", "res"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.398652432222649*^9, 3.398652468139081*^9}, {
   3.398652502678175*^9, 3.398652702750358*^9}, {3.398652825905468*^9, 
   3.3986530173449993`*^9}, {3.398653051494603*^9, 3.398653085713462*^9}, {
   3.398653739730933*^9, 3.39865374471379*^9}, {3.398653863452303*^9, 
   3.39865386357944*^9}, {3.398654932258259*^9, 3.3986549526576853`*^9}, {
   3.404714271905347*^9, 3.404714289216663*^9}, {3.404959477410693*^9, 
   3.404959536040715*^9}, 3.405406960701393*^9, {3.4054075815989313`*^9, 
   3.405407614125255*^9}, {3.405408327858371*^9, 3.405408359880165*^9}, {
   3.4054084717766447`*^9, 3.405408474549958*^9}, {3.405408519742078*^9, 
   3.4054085202063*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RischNaive", "[", 
  RowBox[{
   RowBox[{"1", "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"x", "^", "5"}], "+", 
      RowBox[{"11", " ", "x"}], "+", "1"}], ")"}]}], ",", 
   RowBox[{"{", "x", "}"}], ",", 
   RowBox[{"{", "1", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.40540763787875*^9, 3.405407643294248*^9}}],

Cell[BoxData[
 RowBox[{"RootSum", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"1", "+", 
     RowBox[{"11", " ", "#1"}], "+", 
     SuperscriptBox["#1", "5"]}], "&"}], ",", 
   RowBox[{
    FractionBox[
     RowBox[{"Log", "[", 
      RowBox[{"x", "-", "#1"}], "]"}], 
     RowBox[{"11", "+", 
      RowBox[{"5", " ", 
       SuperscriptBox["#1", "4"]}]}]], "&"}]}], "]"}]], "Output",
 CellChangeTimes->{
  3.405407495259704*^9, 3.405407569589738*^9, {3.405407628220315*^9, 
   3.405407646348768*^9}, 3.405408295682455*^9, {3.405408361237*^9, 
   3.405408373243177*^9}, 3.405408411156444*^9, 3.405408476304801*^9, 
   3.405408522227291*^9, 3.40540894410646*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"RischNaive", "[", 
   RowBox[{
    FractionBox["1", 
     RowBox[{
      SuperscriptBox["x", "8"], "+", "x", "+", "1"}]], ",", 
    RowBox[{"{", "x", "}"}], ",", 
    RowBox[{"{", "1", "}"}]}], "]"}], "//", "Timing"}]], "Input",
 CellChangeTimes->{{3.405406972737357*^9, 3.4054069933737793`*^9}, {
  3.405407247015731*^9, 3.405407249095665*^9}, {3.4054083825613403`*^9, 
  3.405408388793289*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.001132000000000133`", ",", 
   RowBox[{"RootSum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"1", "+", "#1", "+", 
       SuperscriptBox["#1", "8"]}], "&"}], ",", 
     RowBox[{
      FractionBox[
       RowBox[{"Log", "[", 
        RowBox[{"x", "-", "#1"}], "]"}], 
       RowBox[{"1", "+", 
        RowBox[{"8", " ", 
         SuperscriptBox["#1", "7"]}]}]], "&"}]}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.405406994615891*^9, 3.405407002416114*^9}, {
   3.405407244261417*^9, 3.405407249558441*^9}, 3.405407630312118*^9, {
   3.405408364415563*^9, 3.4054084121231956`*^9}, 3.4054084917490063`*^9, 
   3.40540852750593*^9, 3.40540894453222*^9, 3.4099089164474983`*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Construction of Logarithmic Terms", "Subsection",
 CellChangeTimes->{{3.397989128017992*^9, 3.3979891348815517`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"rischLogPartE", "[", 
   RowBox[{"r_", ",", "v_", ",", "theta_", ",", "tower_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "extension", ",", "rfac", ",", "exparg", ",", "result", ",", "e", ",", 
      "term", ",", "root", ",", "roots"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"RischTrace", "[", 
      RowBox[{"rischLogPartE", ",", 
       RowBox[{"{", 
        RowBox[{"r", ",", "v", ",", "theta", ",", "tower"}], "}"}], ",", 
       "\"\<In\>\""}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"extension", "=", 
      RowBox[{"Quiet", "[", 
       RowBox[{"Re", "[", 
        RowBox[{"rischZ", "/.", 
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{"r", "==", "0"}], ",", "rischZ"}], "]"}]}], "]"}], "]"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"And", "@@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"FreeQ", "[", 
            RowBox[{"extension", ",", "#"}], "]"}], "&"}], "/@", 
          RowBox[{"{", 
           RowBox[{"Re", ",", "Log"}], "}"}]}], ")"}]}], 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"may", " ", "need", " ", "more", " ", "here"}], "..."}], " ",
         "*)"}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"rfac", "=", 
        RowBox[{"TimeConstrained", "[", "\[IndentingNewLine]", "\t\t\t", 
         RowBox[{
          RowBox[{"Power", "@@@", 
           RowBox[{"Quiet", "[", 
            RowBox[{"FactorList", "[", 
             RowBox[{"r", ",", 
              RowBox[{"Extension", "\[Rule]", "extension"}]}], "]"}], "]"}]}],
           ",", "\[IndentingNewLine]", "\t\t\t", "0.5", ",", 
          "\[IndentingNewLine]", "\t\t\t", 
          RowBox[{"Power", "@@@", 
           RowBox[{"Quiet", "[", 
            RowBox[{"FactorList", "[", 
             RowBox[{"r", ",", 
              RowBox[{"Extension", "\[Rule]", "Automatic"}]}], "]"}], 
            "]"}]}]}], "\[IndentingNewLine]", "\t", "]"}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"rfac", "=", 
        RowBox[{"Power", "@@@", 
         RowBox[{"Quiet", "[", 
          RowBox[{"FactorList", "[", 
           RowBox[{"r", ",", 
            RowBox[{"Extension", "\[Rule]", "Automatic"}]}], "]"}], 
          "]"}]}]}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Or", "@@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"!", 
             RowBox[{"FreeQ", "[", 
              RowBox[{"rfac", ",", "#"}], "]"}]}], "&"}], "/@", 
           RowBox[{"{", 
            RowBox[{
            "Sin", ",", "Cos", ",", "Tan", ",", "Pi", ",", "Root", ",", 
             "RootSum"}], "}"}]}], ")"}]}], "||", 
        RowBox[{"!", 
         RowBox[{"FreeQ", "[", 
          RowBox[{"rfac", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"-", "1"}], ")"}], "^", "n_Rational"}]}], "]"}]}]}], ",",
        "\[IndentingNewLine]", "\t", 
       RowBox[{"rfac", "=", 
        RowBox[{"Power", "@@@", 
         RowBox[{"Quiet", "[", 
          RowBox[{"FactorList", "[", 
           RowBox[{"r", ",", 
            RowBox[{"Extension", "\[Rule]", "Automatic"}]}], "]"}], 
          "]"}]}]}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"!", 
         RowBox[{"FreeQ", "[", 
          RowBox[{"rfac", ",", "Root"}], "]"}]}], "||", 
        RowBox[{"!", 
         RowBox[{"FreeQ", "[", 
          RowBox[{"rfac", ",", "RootSum"}], "]"}]}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"rfac", "=", 
        RowBox[{"{", "r", "}"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rfac", "=", 
      RowBox[{"rfac", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"rischLog", "\[Rule]", "Log"}], ",", 
         RowBox[{"rischExp", "\[Rule]", "Exp"}]}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"exparg", "=", 
      RowBox[{"tower", "/.", "\[InvisibleSpace]", 
       RowBox[{
        RowBox[{"rischExp", "[", "arg_", "]"}], "\[RuleDelayed]", "arg"}]}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"result", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{
        RowBox[{"e", "=", 
         RowBox[{"Exponent", "[", 
          RowBox[{
           RowBox[{
           "rfac", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
           ",", "rischZ"}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"Which", "[", "\[IndentingNewLine]", "\t\t", 
         RowBox[{
          RowBox[{"e", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
          "\t\t\t", 
          RowBox[{"term", "=", "0"}], ",", "\[IndentingNewLine]", "\t\t", 
          RowBox[{"e", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
          "\t\t\t", 
          RowBox[{
           RowBox[{"root", "=", 
            RowBox[{"First", "[", 
             RowBox[{"rischZ", "/.", "\[InvisibleSpace]", 
              RowBox[{"Solve", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                 "rfac", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}], "\[Equal]", "0"}], ",", 
                "rischZ"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           "\t\t\t", 
           RowBox[{"term", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "root"}], " ", 
              RowBox[{"Exponent", "[", 
               RowBox[{"v", ",", "theta"}], "]"}], "exparg"}], "+", 
             RowBox[{"root", " ", 
              RowBox[{"rischLog", "[", 
               RowBox[{"primitive", "[", 
                RowBox[{
                 RowBox[{"v", "/.", "\[InvisibleSpace]", 
                  RowBox[{"rischZ", "\[RuleDelayed]", "root"}]}], ",", 
                 "theta"}], "]"}], "]"}]}]}]}]}], ",", "\[IndentingNewLine]", 
          "\t\t", 
          RowBox[{"e", "\[Equal]", "2"}], ",", "\[IndentingNewLine]", 
          "\t\t\t", 
          RowBox[{
           RowBox[{"roots", "=", 
            RowBox[{"rischZ", "/.", "\[InvisibleSpace]", 
             RowBox[{"Solve", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                "rfac", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}], "\[Equal]", "0"}], ",", 
               "rischZ"}], "]"}]}]}], ";", "\[IndentingNewLine]", "\t\t\t", 
           RowBox[{"term", "=", 
            RowBox[{
             RowBox[{"rischQuadraticExpTerm", "[", 
              RowBox[{"v", ",", "roots", ",", "exparg", ",", "theta"}], "]"}],
              "+", "\[IndentingNewLine]", "\t\t\t", 
             RowBox[{"rischQuadraticLog", "[", 
              RowBox[{
               RowBox[{
               "rfac", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
                ",", "roots", ",", "v", ",", "theta"}], "]"}]}]}]}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"e", ">", "2"}], ",", "\[IndentingNewLine]", "\t\t\t", 
          RowBox[{"term", "=", "NaiveSolution"}]}], "\[IndentingNewLine]", 
         "\t", "]"}], ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"result", "=", 
         RowBox[{"result", "+", "term"}]}]}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "rfac", "]"}]}], "}"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"RischTrace", "[", 
      RowBox[{"rischLogPartE", ",", "result", ",", "\"\<Out\>\""}], "]"}], 
     ";", "\[IndentingNewLine]", "result"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.39796004745714*^9, 3.39796017616038*^9}, {
   3.3979608451466217`*^9, 3.3979609128084393`*^9}, {3.397960955513709*^9, 
   3.397960962088578*^9}, {3.3979614241862383`*^9, 3.397961424952971*^9}, {
   3.397961460929928*^9, 3.397961465143441*^9}, {3.397961530708181*^9, 
   3.3979615331452017`*^9}, {3.397961610729471*^9, 3.3979616158404303`*^9}, {
   3.397978728591373*^9, 3.397978735237954*^9}, {3.397991681308276*^9, 
   3.3979917384096317`*^9}, 3.397992983724169*^9, {3.398066635633217*^9, 
   3.398066641001051*^9}, {3.398066679044428*^9, 3.398066686372119*^9}, {
   3.398066734706565*^9, 3.398066779472831*^9}, {3.398066812010041*^9, 
   3.3980668123122463`*^9}, {3.398069229828989*^9, 3.398069264405888*^9}, {
   3.398069945542877*^9, 3.3980699459044743`*^9}, {3.398235829991763*^9, 
   3.3982358310943823`*^9}, {3.398593449288834*^9, 3.398593471105227*^9}, {
   3.3986531797454243`*^9, 3.398653182793138*^9}, {3.3986540614216747`*^9, 
   3.398654103475019*^9}, {3.39903315935385*^9, 3.399033168505477*^9}, {
   3.399284198915916*^9, 3.3992842047304993`*^9}, {3.399284633698547*^9, 
   3.3992846358427773`*^9}, {3.3992847980005713`*^9, 3.399284877362734*^9}, {
   3.399284918421906*^9, 3.399284947485023*^9}, {3.399284979169993*^9, 
   3.39928502118899*^9}, {3.399285330169614*^9, 3.399285330575906*^9}, {
   3.399285569351841*^9, 3.399285574444399*^9}, {3.399285802009851*^9, 
   3.399285811193296*^9}, {3.399285878319586*^9, 3.399285946316474*^9}, {
   3.39928612292984*^9, 3.39928612723326*^9}, {3.399286261955113*^9, 
   3.399286274532464*^9}, {3.3992863530199413`*^9, 3.399286355012484*^9}, {
   3.399286414553248*^9, 3.39928641736992*^9}, {3.3992864570129538`*^9, 
   3.399286460430306*^9}, {3.399286503378228*^9, 3.399286510145151*^9}, 
   3.399286864344481*^9, {3.399287347223446*^9, 3.399287347590867*^9}, {
   3.399287398634572*^9, 3.399287407620083*^9}, {3.399353034789431*^9, 
   3.399353035618223*^9}, {3.399353393188205*^9, 3.399353402615129*^9}, {
   3.400487413273385*^9, 3.4004874813041773`*^9}, {3.400487545881001*^9, 
   3.400487546241473*^9}, {3.4049595682915783`*^9, 3.404959614907859*^9}, {
   3.410081040338389*^9, 3.410081082290669*^9}, {3.410081130954831*^9, 
   3.410081218391011*^9}, {3.41008131826054*^9, 3.410081318786188*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FactorBiQuadratic", "[", 
   RowBox[{"poly_", ",", "var_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "a", ",", "b", ",", "c", ",", "root1", ",", "root2", ",", "poly1", ",", 
      "poly2"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"RischTrace", "[", 
      RowBox[{"FactorBiQuadratic", ",", 
       RowBox[{"{", 
        RowBox[{"poly", ",", "var"}], "}"}], ",", "\"\<In\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a", ",", "b", ",", "c"}], "}"}], "=", 
      RowBox[{"Reverse", "[", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"CoefficientList", "[", 
          RowBox[{"poly", ",", "var"}], "]"}], ",", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"SameQ", "[", 
            RowBox[{"#", ",", "0"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"root1", "=", 
      RowBox[{"Simplify", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "b"}], "+", 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            RowBox[{"b", "^", "2"}], "-", 
            RowBox[{"4", " ", "a", " ", "c"}]}], "]"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"2", "a"}], ")"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"root2", "=", 
      RowBox[{"Simplify", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "b"}], "-", 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            RowBox[{"b", "^", "2"}], "-", 
            RowBox[{"4", " ", "a", " ", "c"}]}], "]"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"2", "a"}], ")"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Im", "[", "root1", "]"}], "!=", "0"}], "||", 
        RowBox[{
         RowBox[{"Im", "[", "root2", "]"}], "!=", "0"}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"RischTrace", "[", 
         RowBox[{"FactorBiQuadratic", ",", "poly", ",", "\"\<Out\>\""}], 
         "]"}], ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"Return", "[", 
         RowBox[{"{", "poly", "}"}], "]"}]}]}], "\[IndentingNewLine]", "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"poly1", "=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"var", "^", "2"}], "-", "root1"}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"poly2", "=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"var", "^", "2"}], "-", "root2"}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"RischTrace", "[", 
      RowBox[{"FactorBiQuadratic", ",", 
       RowBox[{"{", 
        RowBox[{"poly1", ",", "poly2"}], "}"}], ",", "\"\<Out\>\""}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"poly1", ",", "poly2"}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.398223033167294*^9, 3.3982231698644342`*^9}, {
   3.398223382344789*^9, 3.398223388637744*^9}, 3.398223520894958*^9, {
   3.39823298898625*^9, 3.3982329916176643`*^9}, {3.398233070165092*^9, 
   3.398233082763586*^9}, {3.398233571284967*^9, 3.3982336249293203`*^9}, {
   3.398233708469407*^9, 3.398233751987904*^9}, {3.398233868425466*^9, 
   3.398233958901023*^9}, {3.39823402203379*^9, 3.398234141149148*^9}, {
   3.398234402057535*^9, 3.398234410967967*^9}, {3.3982346011300993`*^9, 
   3.398234624534951*^9}, {3.398234678209572*^9, 3.398234685584594*^9}, {
   3.39823472958772*^9, 3.398234755472828*^9}, {3.398235232571898*^9, 
   3.398235291963088*^9}, {3.398235395624651*^9, 3.39823539763909*^9}, {
   3.404959659167885*^9, 3.404959749525958*^9}, {3.404959780254939*^9, 
   3.404959803854808*^9}}],

Cell[BoxData[
 RowBox[{"FactorBiQuadratic", "[", 
  RowBox[{
   RowBox[{"1", "-", 
    RowBox[{"144", " ", 
     SuperscriptBox["x", "2"]}], "+", 
    RowBox[{"20736", " ", 
     SuperscriptBox["x", "4"]}]}], ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.398223532331394*^9, 3.39822354248498*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"BiQuadraticQ", "[", 
   RowBox[{"poly_", ",", "var_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"SameQ", "[", 
    RowBox[{
     RowBox[{"Exponent", "[", 
      RowBox[{"poly", ",", "var"}], "]"}], ",", "4"}], "]"}], "&&", 
   RowBox[{"And", "@@", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"SameQ", "[", 
        RowBox[{
         RowBox[{"Coefficient", "[", 
          RowBox[{"poly", ",", "var", ",", "#"}], "]"}], ",", "0"}], "]"}], 
       "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "3"}], "}"}]}], "]"}]}], "&&", 
   RowBox[{"!", 
    RowBox[{"SameQ", "[", 
     RowBox[{
      RowBox[{"Coefficient", "[", 
       RowBox[{"poly", ",", "var", ",", "2"}], "]"}], ",", "0"}], 
     "]"}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.398223172560305*^9, 3.39822334207479*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"BiQuadraticQ", "[", 
  RowBox[{
   RowBox[{"1", "-", 
    RowBox[{"144", " ", 
     SuperscriptBox["x", "2"]}], "+", 
    RowBox[{"20736", " ", 
     SuperscriptBox["x", "4"]}]}], ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.398223232582774*^9, 3.398223250764202*^9}, {
  3.398223352015359*^9, 3.39822336735678*^9}, {3.398223526639036*^9, 
  3.398223530054316*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.398223368121608*^9, 3.398223429026873*^9, 
  3.398223564824551*^9, 3.3982351549390793`*^9, 3.405406574522324*^9, 
  3.4098064438979607`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"rischLogPartL", "[", 
   RowBox[{"r_", ",", "v_", ",", "theta_", ",", "tower_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "rfac", ",", "extension", ",", "exparg", ",", "result", ",", "e", ",", 
      "term", ",", "root", ",", "roots"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"RischTrace", "[", 
      RowBox[{"rischLogPartL", ",", 
       RowBox[{"{", 
        RowBox[{"r", ",", "v", ",", "theta", ",", "tower"}], "}"}], ",", 
       "\"\<In\>\""}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "construct", " ", "elegant", " ", "form", " ", "of", " ", "logarithms", 
       " ", "for", " ", "LRTR"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"extension", "=", 
      RowBox[{"ComplexExpand", "[", 
       RowBox[{"Re", "[", 
        RowBox[{"rischZ", "/.", 
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{"r", "==", "0"}], ",", "rischZ"}], "]"}]}], "]"}], "]"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"BiQuadraticQ", "[", 
        RowBox[{"r", ",", "rischZ"}], "]"}], ",", "\[IndentingNewLine]", 
       "\t\t", 
       RowBox[{"rfac", "=", 
        RowBox[{"FactorBiQuadratic", "[", 
         RowBox[{"r", ",", "rischZ"}], "]"}]}], ",", "\[IndentingNewLine]", 
       "\t", 
       RowBox[{
        RowBox[{"Or", "@@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"!", 
             RowBox[{"FreeQ", "[", 
              RowBox[{"extension", ",", "#"}], "]"}]}], "&"}], "/@", 
           RowBox[{"{", 
            RowBox[{"Root", ",", "Sin", ",", "Cos"}], "}"}]}], ")"}]}], "||", 
        RowBox[{
         RowBox[{"PureVariables", "[", "extension", "]"}], "=!=", 
         RowBox[{"{", "}"}]}]}], ",", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"rfac", "=", 
        RowBox[{"Power", "@@@", 
         RowBox[{"Quiet", "[", 
          RowBox[{"FactorList", "[", 
           RowBox[{"r", ",", 
            RowBox[{"Extension", "\[Rule]", "Automatic"}]}], "]"}], "]"}]}]}],
        ",", "\[IndentingNewLine]", "\t", "True", ",", "\[IndentingNewLine]", 
       "\t\t", 
       RowBox[{"rfac", "=", 
        RowBox[{"TimeConstrained", "[", "\[IndentingNewLine]", "\t\t\t", 
         RowBox[{
          RowBox[{"Power", "@@@", 
           RowBox[{"Quiet", "[", 
            RowBox[{"FactorList", "[", 
             RowBox[{"r", ",", 
              RowBox[{"Extension", "\[Rule]", "extension"}]}], "]"}], "]"}]}],
           ",", "\[IndentingNewLine]", "\t\t\t", "0.5", ",", 
          "\[IndentingNewLine]", "\t\t\t", 
          RowBox[{"Power", "@@@", 
           RowBox[{"Quiet", "[", 
            RowBox[{"FactorList", "[", 
             RowBox[{"r", ",", 
              RowBox[{"Extension", "\[Rule]", "Automatic"}]}], "]"}], 
            "]"}]}]}], "\[IndentingNewLine]", "\t\t\t", "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Or", "@@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"!", 
             RowBox[{"FreeQ", "[", 
              RowBox[{"rfac", ",", "#"}], "]"}]}], "&"}], "/@", 
           RowBox[{"{", 
            RowBox[{"Sin", ",", "Cos", ",", "Tan", ",", "Pi", ",", "Root"}], 
            "}"}]}], ")"}]}], "||", 
        RowBox[{"!", 
         RowBox[{"FreeQ", "[", 
          RowBox[{"rfac", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"-", "1"}], ")"}], "^", "n_Rational"}]}], "]"}]}]}], ",",
        "\[IndentingNewLine]", "\t", 
       RowBox[{"rfac", "=", 
        RowBox[{"Power", "@@@", 
         RowBox[{"Quiet", "[", 
          RowBox[{"FactorList", "[", 
           RowBox[{"r", ",", 
            RowBox[{"Extension", "\[Rule]", "Automatic"}]}], "]"}], 
          "]"}]}]}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"!", 
         RowBox[{"FreeQ", "[", 
          RowBox[{"rfac", ",", "Root"}], "]"}]}], "||", 
        RowBox[{"!", 
         RowBox[{"FreeQ", "[", 
          RowBox[{"rfac", ",", "RootSum"}], "]"}]}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"rfac", "=", 
        RowBox[{"{", "r", "}"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"exparg", "=", 
      RowBox[{"tower", "/.", 
       RowBox[{
        RowBox[{"rischExp", "[", "arg_", "]"}], "\[RuleDelayed]", "arg"}]}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"result", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{
        RowBox[{"e", "=", 
         RowBox[{"Exponent", "[", 
          RowBox[{
           RowBox[{"rfac", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", " ", "rischZ"}], "]"}]}], 
        ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"Which", "[", "\[IndentingNewLine]", "\t\t\t", 
         RowBox[{
          RowBox[{"e", "==", "0"}], ",", "\[IndentingNewLine]", "\t\t\t\t", 
          RowBox[{"term", "=", "0"}], ",", "\[IndentingNewLine]", "\t\t\t", 
          RowBox[{"e", "==", "1"}], ",", "\[IndentingNewLine]", "\t\t\t\t", 
          RowBox[{
           RowBox[{"root", "=", 
            RowBox[{"First", "[", 
             RowBox[{"rischZ", "/.", 
              RowBox[{"Solve", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"rfac", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "0"}], ",", 
                "rischZ"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           "\t\t\t\t", 
           RowBox[{"term", "=", 
            RowBox[{"root", "*", 
             RowBox[{"rischLog", "[", 
              RowBox[{"Simplify", "[", 
               RowBox[{"primitive", "[", 
                RowBox[{
                 RowBox[{"v", "/.", 
                  RowBox[{"rischZ", "\[RuleDelayed]", "root"}]}], ",", 
                 "theta"}], "]"}], "]"}], "]"}]}]}]}], ",", 
          "\[IndentingNewLine]", "\t\t\t", 
          RowBox[{"e", "==", "2"}], ",", "\[IndentingNewLine]", "\t\t\t\t", 
          RowBox[{
           RowBox[{"roots", "=", 
            RowBox[{"rischZ", "/.", 
             RowBox[{"Solve", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"rfac", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "0"}], ",", 
               "rischZ"}], "]"}]}]}], ";", "\[IndentingNewLine]", "\t\t\t\t", 
           RowBox[{"term", "=", 
            RowBox[{"rischQuadraticLog", "[", 
             RowBox[{
              RowBox[{"rfac", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", "roots", ",", "v", ",", 
              "theta"}], "]"}]}]}], ",", "\[IndentingNewLine]", "\t\t\t", 
          RowBox[{"e", ">", "2"}], ",", "\[IndentingNewLine]", "\t\t\t\t", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{
            "Here", " ", "is", " ", "it", " ", "probably", " ", "better", " ",
              "to", " ", "return", " ", "naive", " ", "term", " ", "if", " ", 
             "no", " ", "other", "\[IndentingNewLine]", "\t\t\t\t", "terms", 
             " ", "in", " ", "the", " ", "solution"}], ",", " ", 
            RowBox[{
            "or", " ", "if", " ", "there", " ", "are", " ", "other", " ", 
             "terms", " ", "then", " ", "return", "\[IndentingNewLine]", 
             "\t\t\t\t", 
             RowBox[{"Risch", "[", 
              RowBox[{
               RowBox[{"integrand", " ", "-", " ", 
                RowBox[{"D", "[", "partialsolution", "]"}]}], ",", "x"}], 
              "]"}]}]}], " ", "*)"}], "\[IndentingNewLine]", "\t\t\t\t", 
          RowBox[{"term", "=", "NaiveSolution"}]}], "\[IndentingNewLine]", 
         "\t\t", "]"}], ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"result", "=", 
         RowBox[{"result", "+", "term"}]}]}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "rfac", "]"}]}], "}"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"RischTrace", "[", 
      RowBox[{"rischLogPartL", ",", "result", ",", "\"\<Out\>\""}], "]"}], 
     ";", "\[IndentingNewLine]", "result"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.3979409892199717`*^9, 3.397941054248518*^9}, {
   3.3979412483594*^9, 3.397941268830459*^9}, {3.397941471996909*^9, 
   3.3979415985401897`*^9}, {3.397941659903452*^9, 3.3979416954937487`*^9}, {
   3.397941769675907*^9, 3.397941811063093*^9}, {3.397941880273509*^9, 
   3.397942143899434*^9}, {3.39794223345427*^9, 3.397942439433543*^9}, {
   3.397942485579596*^9, 3.39794248985086*^9}, {3.3979425421457443`*^9, 
   3.3979425830954237`*^9}, {3.397942661065824*^9, 3.397942670957363*^9}, {
   3.3979428466495667`*^9, 3.397942858428092*^9}, {3.397942914419558*^9, 
   3.397942914809389*^9}, {3.3979431240857477`*^9, 3.397943201017023*^9}, {
   3.397943249644051*^9, 3.397943409979383*^9}, {3.39794346161307*^9, 
   3.397943533744391*^9}, {3.397943580303214*^9, 3.3979436138282003`*^9}, {
   3.3979436516388607`*^9, 3.397943653670307*^9}, {3.397943742065547*^9, 
   3.397943838395669*^9}, {3.397944551182352*^9, 3.3979447249408484`*^9}, {
   3.3979562124053707`*^9, 3.397956259265717*^9}, {3.397957857628457*^9, 
   3.397957901063847*^9}, {3.3979618467637033`*^9, 3.397961855536632*^9}, {
   3.397978544650606*^9, 3.397978595310934*^9}, {3.3979786365143967`*^9, 
   3.397978637279064*^9}, {3.397978674323162*^9, 3.397978718360021*^9}, {
   3.397978749995837*^9, 3.3979788044788647`*^9}, {3.397989141925036*^9, 
   3.397989180250411*^9}, {3.397989244241365*^9, 3.397989248264921*^9}, {
   3.397989290116167*^9, 3.39798942448488*^9}, {3.397989641005704*^9, 
   3.3979896449486628`*^9}, {3.397989735354755*^9, 3.397989744397517*^9}, {
   3.397989799323946*^9, 3.3979898397947683`*^9}, {3.397989996006962*^9, 
   3.397989999630229*^9}, {3.3979903813233013`*^9, 3.397990410336521*^9}, {
   3.397990466617626*^9, 3.3979904717119293`*^9}, {3.397990505252269*^9, 
   3.397990593125451*^9}, {3.397990776213923*^9, 3.397990872313785*^9}, {
   3.3979909725451517`*^9, 3.3979909731706543`*^9}, {3.397991047644367*^9, 
   3.397991048059222*^9}, {3.3979910862633133`*^9, 3.3979910945046577`*^9}, {
   3.397991149183079*^9, 3.397991181645746*^9}, {3.397991393332841*^9, 
   3.397991465493079*^9}, {3.397991530990651*^9, 3.397991555226246*^9}, {
   3.397991618126774*^9, 3.397991623445713*^9}, {3.397991743270235*^9, 
   3.3979917611008797`*^9}, {3.3979918325884933`*^9, 3.397991972637267*^9}, 
   3.3979929919340754`*^9, {3.398066399905529*^9, 3.3980664032063828`*^9}, 
   3.3980664426841*^9, {3.398066563673435*^9, 3.398066569435264*^9}, {
   3.39806665921015*^9, 3.398066662033698*^9}, {3.398158762233387*^9, 
   3.3981588398057137`*^9}, {3.398159678226577*^9, 3.398159683153957*^9}, {
   3.3981597336769753`*^9, 3.3981597417689867`*^9}, {3.398159884595221*^9, 
   3.398159891233753*^9}, {3.398223449770689*^9, 3.3982235060666656`*^9}, {
   3.3982235712584963`*^9, 3.3982235967788477`*^9}, {3.3982236873299837`*^9, 
   3.398223709743785*^9}, {3.398223748663805*^9, 3.398223753414444*^9}, {
   3.3982237864259233`*^9, 3.398223976163871*^9}, {3.398224011364601*^9, 
   3.398224014164205*^9}, {3.3982327175264797`*^9, 3.3982327215414963`*^9}, {
   3.398232816794079*^9, 3.398232897455227*^9}, {3.398233208674984*^9, 
   3.398233244669792*^9}, {3.3982341564849873`*^9, 3.398234161299775*^9}, {
   3.39823424863529*^9, 3.398234323608873*^9}, {3.398234504258148*^9, 
   3.398234537953405*^9}, {3.398234801148472*^9, 3.398234830012671*^9}, {
   3.398235466032847*^9, 3.398235471546179*^9}, {3.3982357828982964`*^9, 
   3.398235787723035*^9}, {3.398235818619334*^9, 3.3982358202737503`*^9}, {
   3.3982359368013678`*^9, 3.3982359428393087`*^9}, {3.39823599644032*^9, 
   3.398236018625531*^9}, {3.398236073801978*^9, 3.398236090094388*^9}, {
   3.398236142536292*^9, 3.39823615333747*^9}, {3.398236358966816*^9, 
   3.398236362862265*^9}, {3.398236647874559*^9, 3.3982366615518436`*^9}, {
   3.398237134201042*^9, 3.3982371494079857`*^9}, {3.398237262446121*^9, 
   3.3982372665971317`*^9}, {3.3985934849531193`*^9, 
   3.3985935024093924`*^9}, {3.398593578306609*^9, 3.3985935806820173`*^9}, {
   3.398593618321089*^9, 3.398593618497003*^9}, {3.398653191206712*^9, 
   3.398653192920659*^9}, {3.398653971275139*^9, 3.398653977994237*^9}, {
   3.398654108779889*^9, 3.398654190186008*^9}, {3.398654224944416*^9, 
   3.3986542274292088`*^9}, {3.3986542675128117`*^9, 
   3.3986543072326813`*^9}, {3.3986543984355097`*^9, 3.398654403728077*^9}, {
   3.3987406219172163`*^9, 3.3987406794052258`*^9}, {3.398740726951716*^9, 
   3.398740833228623*^9}, {3.398741132091659*^9, 3.3987411558056192`*^9}, {
   3.398741480982876*^9, 3.3987415189789124`*^9}, {3.3987415637689133`*^9, 
   3.3987415827705097`*^9}, {3.398741703095879*^9, 3.398741718549403*^9}, {
   3.39874178225121*^9, 3.3987417838673763`*^9}, {3.3988519612465353`*^9, 
   3.398852016871409*^9}, {3.398852054517228*^9, 3.398852054788414*^9}, {
   3.398852122247504*^9, 3.398852129382533*^9}, {3.3988522155442038`*^9, 
   3.398852265146161*^9}, {3.3988522995039043`*^9, 3.398852307387868*^9}, {
   3.39891194489354*^9, 3.398911993631325*^9}, {3.398912101225401*^9, 
   3.3989122178476963`*^9}, {3.398912248272236*^9, 3.398912260064027*^9}, 
   3.399033175607134*^9, 3.399033215837948*^9, {3.39928415863015*^9, 
   3.3992841704927197`*^9}, {3.399284213638205*^9, 3.399284214158187*^9}, {
   3.399286317867382*^9, 3.399286344338612*^9}, {3.399353057602672*^9, 
   3.399353078614039*^9}, {3.399353120245193*^9, 3.399353238241802*^9}, {
   3.401349263241593*^9, 3.401349271111907*^9}, {3.401349310507975*^9, 
   3.401349339051996*^9}, {3.401350208120185*^9, 3.401350208373691*^9}, {
   3.404959832387237*^9, 3.404959913453315*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"a", "/:", 
   RowBox[{"Sign", "[", "a", "]"}], "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"rischLogPartL", "[", 
  RowBox[{
   RowBox[{"1", "-", 
    RowBox[{"256", " ", 
     SuperscriptBox["a", "12"], " ", 
     SuperscriptBox["rischZ", "4"]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "4"}], " ", 
     SuperscriptBox["a", "4"], " ", "rischZ"}], "+", "x"}], ",", "x", ",", 
   "x"}], "]"}]}], "Input",
 CellChangeTimes->{{3.401349216414407*^9, 3.40134921728691*^9}, {
  3.4049599261117764`*^9, 3.404959932105392*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{"ArcTan", "[", 
     FractionBox["x", "a"], "]"}], 
    RowBox[{"2", " ", 
     SuperscriptBox["a", "3"]}]]}], "+", 
  FractionBox[
   RowBox[{"rischLog", "[", 
    RowBox[{
     RowBox[{"-", "a"}], "+", "x"}], "]"}], 
   RowBox[{"4", " ", 
    SuperscriptBox["a", "3"]}]], "-", 
  FractionBox[
   RowBox[{"rischLog", "[", 
    RowBox[{"a", "+", "x"}], "]"}], 
   RowBox[{"4", " ", 
    SuperscriptBox["a", "3"]}]]}]], "Output",
 CellChangeTimes->{
  3.401349218699314*^9, {3.401349254167745*^9, 3.4013492726316357`*^9}, {
   3.401349326791472*^9, 3.401349340741469*^9}, 3.401350213126786*^9, {
   3.404545853398632*^9, 3.4045458671816387`*^9}, {3.404959916190339*^9, 
   3.404959932602116*^9}, 3.4054065781955013`*^9, 3.4098064478596888`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"rischQuadraticExpTerm", "[", 
   RowBox[{"v_", ",", "roots_", ",", "exparg_", ",", "theta_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "roots", "]"}], "\[Equal]", "1"}], ",", 
    "\[IndentingNewLine]", "\t\t", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"First", "[", "roots", "]"}]}], 
     RowBox[{"Exponent", "[", 
      RowBox[{"v", ",", "theta"}], "]"}], " ", "exparg"}], ",", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"Length", "[", "roots", "]"}], "\[Equal]", "2"}], ",", 
    "\[IndentingNewLine]", "\t\t", 
    RowBox[{"Expand", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"First", "[", "roots", "]"}]}], 
       RowBox[{"Exponent", "[", 
        RowBox[{"v", ",", "theta"}], "]"}], " ", "exparg"}], "-", 
      RowBox[{
       RowBox[{"Last", "[", "roots", "]"}], 
       RowBox[{"Exponent", "[", 
        RowBox[{"v", ",", "theta"}], "]"}], "exparg"}]}], "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.39794473291861*^9, 3.3979447666231422`*^9}, {
  3.397944813045506*^9, 3.3979449083661127`*^9}, {3.397960756413172*^9, 
  3.397960756716865*^9}, {3.3980664595461493`*^9, 3.398066464464366*^9}, {
  3.410081227916388*^9, 3.410081261463274*^9}, {3.4100813495493193`*^9, 
  3.410081366157228*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"rischQuadraticLog", "[", 
   RowBox[{"r_", ",", "rts_", ",", "v_", ",", "theta_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "a", ",", "b", ",", "c", ",", "del", ",", "roots", ",", "result", ",", 
      "S1", ",", "S2"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"RischTrace", "[", 
      RowBox[{"rischQuadraticLog", ",", 
       RowBox[{"{", 
        RowBox[{"r", ",", "roots", ",", "v", ",", "theta"}], "}"}], ",", 
       "\"\<In\>\""}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"r", " ", "=", " ", 
       RowBox[{
        RowBox[{"a", " ", 
         RowBox[{"z", "^", "2"}]}], " ", "+", " ", 
        RowBox[{"b", " ", "z"}], " ", "+", " ", "c"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"roots", "=", 
      RowBox[{"FullSimplify", "/@", "rts"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"a", "=", 
      RowBox[{"Coefficient", "[", 
       RowBox[{"r", ",", "rischZ", ",", "2"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"b", "=", 
      RowBox[{"Coefficient", "[", 
       RowBox[{"r", ",", "rischZ", ",", "1"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"c", "=", 
      RowBox[{"Coefficient", "[", 
       RowBox[{"r", ",", "rischZ", ",", "0"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"del", "=", 
      RowBox[{
       RowBox[{"b", "^", "2"}], "-", 
       RowBox[{"4", "*", "a", "*", "c"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{"(*", " ", 
       RowBox[{"del", " ", "=", " ", 
        RowBox[{
         RowBox[{"0", ":", " ", 
          RowBox[{"1", " ", "root"}]}], " ", "=", 
         RowBox[{">", " ", 
          RowBox[{"single", " ", "log", " ", "term"}]}]}]}], " ", "*)"}], 
      "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"del", " ", "===", " ", "0"}], ",", "\[IndentingNewLine]", 
       "\t\t", 
       RowBox[{"result", " ", "=", 
        RowBox[{
         RowBox[{"First", "[", "roots", "]"}], " ", 
         RowBox[{"rischLog", "[", 
          RowBox[{"Simplify", "[", 
           RowBox[{"primitive", "[", 
            RowBox[{
             RowBox[{"v", "/.", 
              RowBox[{"rischZ", "->", 
               RowBox[{"First", "[", "roots", "]"}]}]}], ",", "theta"}], 
            "]"}], "]"}], "]"}]}]}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"SameQ", "[", 
         RowBox[{
          RowBox[{"Sign", "[", "del", "]"}], ",", "1"}], "]"}], "||", 
        RowBox[{
         RowBox[{"ComplexExpand", "[", 
          RowBox[{"Im", "[", "del", "]"}], "]"}], "=!=", "0"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "the", " ", "second", " ", "condition", " ", "above", " ", "fixes", 
         " ", 
         RowBox[{"Risch", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Tan", "[", "x", "]"}], " ", 
            RowBox[{"Tan", "[", 
             RowBox[{"x", "+", "1"}], "]"}]}], ",", "x"}], "]"}]}], " ", 
        "*)"}], "\[IndentingNewLine]", "\t\t", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"del", " ", ">", " ", "0"}], ":", " ", 
          RowBox[{"2", " ", "real", " ", "roots"}]}], " ", "=", 
         RowBox[{">", " ", 
          RowBox[{"2", " ", "log", " ", "terms"}]}]}], "*)"}], 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"result", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"First", "[", "roots", "]"}], 
          RowBox[{"rischLog", "[", 
           RowBox[{"Simplify", "[", 
            RowBox[{"primitive", "[", 
             RowBox[{
              RowBox[{"v", "/.", 
               RowBox[{"rischZ", "->", 
                RowBox[{"First", "[", "roots", "]"}]}]}], ",", "theta"}], 
             "]"}], "]"}], "]"}]}], "+", "\[IndentingNewLine]", "\t\t\t\t", 
         RowBox[{
          RowBox[{"Last", "[", "roots", "]"}], " ", 
          RowBox[{"rischLog", "[", 
           RowBox[{"Simplify", "[", 
            RowBox[{"primitive", "[", 
             RowBox[{
              RowBox[{"v", "/.", 
               RowBox[{"rischZ", "->", 
                RowBox[{"Last", "[", "roots", "]"}]}]}], ",", "theta"}], 
             "]"}], "]"}], "]"}]}]}]}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"SameQ", "[", 
        RowBox[{
         RowBox[{"Sign", "[", "del", "]"}], ",", 
         RowBox[{"-", "1"}]}], "]"}], ",", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"del", " ", "<", " ", "0"}], ":", " ", 
         RowBox[{"logs", " ", "+", " ", "atans"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"result", "=", 
        RowBox[{"LogToReal", "[", 
         RowBox[{"r", ",", "v", ",", "theta"}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"RischTrace", "[", 
      RowBox[{"rischQuadraticLog", ",", "result", ",", "\"\<Out\>\""}], "]"}],
      ";", "\[IndentingNewLine]", "result"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJwdyV1IU2EAh/FjmOWQ2mbOhbbcalFui2LqwMnqhKXGcVJBGqFiKUocGn2p
GbZWOKbmgghLEoVgqSWxjc0+lT7AQIZZNyleOF2uDmhU5ko6Ue//vXj4XTzq
E7bDNasYhskkwTtZv2PSQwJb99LIyIiBZE4F5QctRTC0I3WNnLjnuola9l2e
B//dW6J2a00c7NyXUAKHZ7+UQl1nPg8r3nZcgh8etjlgAnfuBbwQbxyGc+Yj
GcnEriJODUc9OVp44FWVEe59b5emEHezJ2Uwyj9XKohJu5ap7gmnARo80Z0w
e7YkJZWoanumgCHfz1z4OLzWDBVcfh2U2IupVtuYS0m86xineo+n1fYQHzSX
n4JXxJ6LUG9/fRk2XV28BmO/9C0wvXLLIPQPGqjbqsX2XmJjTYEbts80bL5R
KrCRP/UaGHC0ZsJ5U5wOJv5VZsHouoJs2KjfmgtVkdNmOKpVWKEY3E89v7La
DofclhZYbzvT3FcusJsmP1FNlRYnPLo80gqDTb45eOz2xnlYXKYU4PquqQUo
8a+kna0Q2EeFLg0c4Qbue2sFdiI92AdD1ndPYd5i0huozmCmYaGOD8MNN70L
9KvGqBrP0jcYdYnUcT4Qg5+7BREajENxPqL3a5UEih1OKXzysV8Gf9yqDvuJ
23kmAv8DPsdBwQ==
  "]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rischQuadraticLog", "[", 
  RowBox[{
   RowBox[{"1", "+", 
    RowBox[{"2", " ", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"2", " ", "\[ImaginaryI]"}]]}], "+", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"4", " ", "\[ImaginaryI]"}]], "+", 
    SuperscriptBox["rischZ", "2"], "-", 
    RowBox[{"2", " ", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"2", " ", "\[ImaginaryI]"}]], " ", 
     SuperscriptBox["rischZ", "2"]}], "+", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"4", " ", "\[ImaginaryI]"}]], " ", 
     SuperscriptBox["rischZ", "2"]}]}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       SqrtBox[
        RowBox[{
         RowBox[{"-", "1"}], "-", 
         RowBox[{"2", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"2", " ", "\[ImaginaryI]"}]]}], "-", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"4", " ", "\[ImaginaryI]"}]]}]], 
       SqrtBox[
        RowBox[{"1", "-", 
         RowBox[{"2", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"2", " ", "\[ImaginaryI]"}]]}], "+", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"4", " ", "\[ImaginaryI]"}]]}]]]}], ",", 
     FractionBox[
      SqrtBox[
       RowBox[{
        RowBox[{"-", "1"}], "-", 
        RowBox[{"2", " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"2", " ", "\[ImaginaryI]"}]]}], "-", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"4", " ", "\[ImaginaryI]"}]]}]], 
      SqrtBox[
       RowBox[{"1", "-", 
        RowBox[{"2", " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"2", " ", "\[ImaginaryI]"}]]}], "+", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"4", " ", "\[ImaginaryI]"}]]}]]]}], "}"}], ",", 
   FractionBox[
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "2"}], " ", "\[ImaginaryI]"}]], " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"2", " ", "\[ImaginaryI]"}]]}], "+", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"4", " ", "\[ImaginaryI]"}]], "-", 
       RowBox[{"\[ImaginaryI]", " ", "rischZ"}], "+", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"2", " ", "\[ImaginaryI]"}]], " ", "rischZ"}], "-", 
       RowBox[{"\[ImaginaryI]", " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"4", " ", "\[ImaginaryI]"}]], " ", "rischZ"}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"2", " ", "\[ImaginaryI]"}]], " ", 
        SubsuperscriptBox["\[Theta]", "1", "2"]}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"4", " ", "\[ImaginaryI]"}]], " ", 
        SubsuperscriptBox["\[Theta]", "1", "2"]}]}], ")"}]}], 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"2", " ", "\[ImaginaryI]"}]]}], ")"}]}]], ",", 
   SubscriptBox["\[Theta]", "1"]}], "]"}]], "Input",
 CellChangeTimes->{{3.409806748488471*^9, 3.409806779697033*^9}, 
   3.409807417008081*^9, {3.4098111833205357`*^9, 3.4098111855194407`*^9}, {
   3.409811229713894*^9, 3.40981123043151*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Cot", "[", "1", "]"}], " ", 
   RowBox[{"rischLog", "[", 
    RowBox[{"1", "+", 
     SubsuperscriptBox["\[Theta]", "1", "2"]}], "]"}]}], "-", 
  RowBox[{
   RowBox[{"Cot", "[", "1", "]"}], " ", 
   RowBox[{"rischLog", "[", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "2"}], " ", "\[ImaginaryI]"}]], "+", 
     SubsuperscriptBox["\[Theta]", "1", "2"]}], "]"}]}]}]], "Output",
 CellChangeTimes->{
  3.409807026979391*^9, {3.409807096506339*^9, 3.409807108270577*^9}, 
   3.4098072084533243`*^9, 3.409807241022687*^9, 3.409807288099124*^9, 
   3.4098073182900133`*^9, {3.409807411475244*^9, 3.409807444816428*^9}, {
   3.409807485398024*^9, 3.4098075031181097`*^9}, 3.409811185866753*^9, {
   3.409811226450918*^9, 3.409811230730998*^9}, 3.409813487029353*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"a", "/:", 
   RowBox[{"Sign", "[", "a", "]"}], "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rischQuadraticLog", "[", 
   RowBox[{
    RowBox[{"1", "+", 
     RowBox[{"16", " ", 
      SuperscriptBox["a", "6"], " ", 
      SuperscriptBox["rischZ", "2"]}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", 
        RowBox[{"4", " ", 
         SuperscriptBox["a", "3"]}]]}], ",", 
      FractionBox["\[ImaginaryI]", 
       RowBox[{"4", " ", 
        SuperscriptBox["a", "3"]}]]}], "}"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "4"}], " ", 
      SuperscriptBox["a", "4"], " ", "rischZ"}], "+", "x"}], ",", "x"}], 
   "]"}], 
  RowBox[{"(*", " ", "BUG", " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", "a", "]"}]}], "Input",
 CellChangeTimes->{{3.404545122296084*^9, 3.404545126013144*^9}, {
  3.405406600955345*^9, 3.4054066020002832`*^9}, {3.409806474134036*^9, 
  3.409806476357677*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"ArcTan", "[", 
    FractionBox["x", "a"], "]"}], 
   RowBox[{"2", " ", 
    SuperscriptBox["a", "3"]}]]}]], "Output",
 CellChangeTimes->{{3.404544994932866*^9, 3.404545008871581*^9}, {
   3.404545076173443*^9, 3.404545117901169*^9}, 3.404545408707863*^9, {
   3.404545769544766*^9, 3.4045457868123493`*^9}, 3.4045458358053217`*^9, {
   3.404545871869576*^9, 3.404545887371848*^9}, 3.404960023623568*^9, {
   3.405406589648839*^9, 3.405406603315776*^9}, {3.409806457428775*^9, 
   3.4098064771843653`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rischQuadraticLog", "[", 
  RowBox[{
   RowBox[{"1", "+", 
    RowBox[{"4", " ", 
     SuperscriptBox["rischZ", "2"]}]}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["\[ImaginaryI]", "2"]}], ",", 
     FractionBox["\[ImaginaryI]", "2"]}], "}"}], ",", 
   RowBox[{
    RowBox[{"-", "1"}], "-", 
    RowBox[{"12", " ", "rischZ"}], "+", "x"}], ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.397955706143832*^9, 3.397955765867353*^9}, {
  3.397955801271837*^9, 3.397955804227675*^9}, {3.3979579708484287`*^9, 
  3.397957971220389*^9}}],

Cell[BoxData[
 RowBox[{"ArcTan", "[", 
  FractionBox[
   RowBox[{"1", "-", "x"}], "6"], "]"}]], "Output",
 CellChangeTimes->{{3.397955766825214*^9, 3.397955805113648*^9}, 
   3.3979558603046207`*^9, {3.397955962318756*^9, 3.397955970825945*^9}, 
   3.397956005117333*^9, 3.3979563688697357`*^9, {3.3979565290308228`*^9, 
   3.3979565529717216`*^9}, 3.397956779642074*^9, {3.397957501447382*^9, 
   3.397957502850046*^9}, {3.3979576967685747`*^9, 3.3979577338831244`*^9}, 
   3.3979577933489647`*^9, 3.397957938543907*^9, 3.397957971940927*^9, {
   3.39795800713118*^9, 3.397958026771946*^9}, {3.397958449061124*^9, 
   3.39795849966532*^9}, 3.397958790933769*^9, 3.397959131562174*^9, 
   3.3979616466212482`*^9, 3.3979617042957287`*^9, 3.398912323867847*^9, 
   3.404544984214079*^9, 3.405406621700981*^9, 3.409806461141567*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Risch", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Log", "[", 
        RowBox[{
         SuperscriptBox["x", "2"], "+", "x", "+", "1"}], "]"}], "+", 
       RowBox[{"ArcTan", "[", 
        FractionBox[
         RowBox[{"1", "-", "x"}], "6"], "]"}]}], ",", "x"}], "]"}], "//", 
    "Together"}], ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.397957749030817*^9, 3.397957756906989*^9}, {
  3.397958128269801*^9, 3.397958129186957*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ArcTan", "[", 
   FractionBox[
    RowBox[{"1", "-", "x"}], "6"], "]"}], "+", 
  RowBox[{"Log", "[", 
   RowBox[{"1", "+", "x", "+", 
    SuperscriptBox["x", "2"]}], "]"}]}]], "Output",
 CellChangeTimes->{
  3.397957757795245*^9, {3.397957817380541*^9, 3.39795781836381*^9}, {
   3.3979579131268663`*^9, 3.397957941961708*^9}, {3.397958079273326*^9, 
   3.397958081103409*^9}, {3.397958124743877*^9, 3.397958142328479*^9}, {
   3.3979582146555758`*^9, 3.397958219657734*^9}, 3.397958387081827*^9, 
   3.397958456008952*^9, {3.397958486526132*^9, 3.397958495039344*^9}, 
   3.397958673533265*^9, 3.397958794047353*^9, 3.397958897109006*^9, 
   3.397959145846696*^9, {3.397961648329144*^9, 3.397961670339345*^9}, 
   3.397961705912698*^9, 3.3989123261579523`*^9, 3.404544985222913*^9, 
   3.405406627984185*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Risch", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"ArcTan", "[", 
        RowBox[{"x", "+", "1"}], "]"}], "+", 
       RowBox[{"ArcTan", "[", 
        RowBox[{"1", "-", 
         RowBox[{"x", "^", "5"}]}], "]"}]}], ",", "x"}], "]"}], "//", 
    "Together"}], ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.397958517298712*^9, 3.39795856805877*^9}, {
  3.397958614609565*^9, 3.397958615539175*^9}, {3.397958802555052*^9, 
  3.397958802930834*^9}, {3.3979588450352297`*^9, 3.397958846602674*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ArcTan", "[", 
   RowBox[{"1", "+", "x"}], "]"}], "-", 
  RowBox[{"ArcTan", "[", 
   RowBox[{"1", "+", 
    RowBox[{"5", " ", "x"}], "+", 
    SuperscriptBox["x", "5"]}], "]"}], "+", 
  RowBox[{"ArcTan", "[", 
   RowBox[{
    FractionBox["1", "25"], " ", 
    RowBox[{"(", 
     RowBox[{"17", "+", 
      RowBox[{"88", " ", "x"}], "-", 
      RowBox[{"84", " ", 
       SuperscriptBox["x", "2"]}], "+", 
      RowBox[{"40", " ", 
       SuperscriptBox["x", "3"]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["x", "4"]}], "-", 
      RowBox[{"5", " ", 
       SuperscriptBox["x", "5"]}], "-", 
      RowBox[{"16", " ", 
       SuperscriptBox["x", "6"]}], "+", 
      RowBox[{"6", " ", 
       SuperscriptBox["x", "7"]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["x", "8"]}], "-", 
      RowBox[{"5", " ", 
       SuperscriptBox["x", "9"]}]}], ")"}]}], "]"}], "+", 
  RowBox[{"ArcTan", "[", 
   RowBox[{
    FractionBox["1", "34"], " ", 
    RowBox[{"(", 
     RowBox[{"50", "+", 
      RowBox[{"10", " ", "x"}], "-", 
      RowBox[{"50", " ", 
       SuperscriptBox["x", "5"]}], "-", 
      RowBox[{"10", " ", 
       SuperscriptBox["x", "6"]}], "+", 
      RowBox[{"8", " ", 
       SuperscriptBox["x", "10"]}], "+", 
      RowBox[{"5", " ", 
       SuperscriptBox["x", "11"]}]}], ")"}]}], "]"}]}]], "Output",
 CellChangeTimes->{
  3.3979586756389914`*^9, {3.3979587958843822`*^9, 3.3979588101573553`*^9}, {
   3.397958847376943*^9, 3.397958849536669*^9}, 3.397958898718665*^9, 
   3.39795914807902*^9, 3.3979616713679657`*^9, 3.3979617081593857`*^9, 
   3.398912331938183*^9, 3.404544986433496*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Examples", "Subsubsection",
 CellChangeTimes->{{3.39011203252575*^9, 3.39011203390075*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PureLogPart", "[", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"2", 
       SuperscriptBox["t", "2"]}], "-", "t", "-", 
      SuperscriptBox["x", "2"]}], 
     RowBox[{
      SuperscriptBox["t", "3"], "-", 
      RowBox[{
       SuperscriptBox["x", "2"], "t"}]}]], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "t"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", 
      RowBox[{"1", "/", "x"}]}], "}"}]}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"example", " ", "from", " ", "Bronstein"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.385787395758568*^9, 3.3857874630653505`*^9}, {
   3.385787536681205*^9, 3.385787537392227*^9}, {3.390102904541375*^9, 
   3.39010290527575*^9}, {3.390110663541375*^9, 3.39011067408825*^9}, {
   3.3904532450456247`*^9, 3.3904532547018747`*^9}, 3.3904536186706247`*^9, {
   3.390854094028*^9, 3.39085409887175*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"2", " ", 
      SuperscriptBox[
       RowBox[{"Log", "[", "x", "]"}], "2"]}], "-", 
     RowBox[{"Log", "[", "x", "]"}], "-", 
     SuperscriptBox["x", "2"]}], 
    RowBox[{
     SuperscriptBox[
      RowBox[{"Log", "[", "x", "]"}], "3"], "-", 
     RowBox[{
      SuperscriptBox["x", "2"], " ", 
      RowBox[{"Log", "[", "x", "]"}]}]}]], "-", 
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"First", "[", "%", "]"}], "/.", 
      RowBox[{"t", "\[Rule]", 
       RowBox[{"Log", "[", "x", "]"}]}]}], ",", "x"}], "]"}]}], "//", 
  "FullSimplify", 
  RowBox[{"(*", " ", 
   RowBox[{"Agrees", " ", "with", " ", 
    RowBox[{"Bronstein", "!!"}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.390102220041375*^9, 3.3901022639945*^9}, {
   3.390102307557*^9, 3.39010231858825*^9}, {3.390110851260125*^9, 
   3.390110851478875*^9}, 3.390112039807*^9, {3.3908533208405*^9, 
   3.39085332312175*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PureLogPart", "[", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"-", "45"}], "+", 
      RowBox[{"15", " ", "x"}], "+", 
      RowBox[{"45", " ", 
       SuperscriptBox["x", "3"]}], "-", 
      RowBox[{"135", " ", 
       SuperscriptBox["x", "6"]}], "+", 
      RowBox[{"33", " ", 
       SuperscriptBox["x", "10"]}], "-", 
      RowBox[{"31", " ", 
       SuperscriptBox["x", "11"]}], "+", 
      RowBox[{"27", " ", 
       SuperscriptBox["x", "13"]}], "-", 
      RowBox[{"21", " ", 
       SuperscriptBox["x", "16"]}]}], 
     RowBox[{"x", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "x", "-", 
        SuperscriptBox["x", "3"], "+", 
        SuperscriptBox["x", "6"]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "15"}], "+", 
        SuperscriptBox["x", "10"]}], ")"}]}]], ",", 
    RowBox[{"{", "x", "}"}], ",", 
    RowBox[{"{", "1", "}"}]}], "]"}], "//", "Timing"}]], "Input",
 CellChangeTimes->{{3.39010790515075*^9, 3.3901079126195*^9}, {
   3.390108025197625*^9, 3.390108029228875*^9}, {3.39010808065075*^9, 
   3.390108090635125*^9}, 3.390110711603875*^9, {3.390146446999*^9, 
   3.390146459077125*^9}, {3.3904535202331247`*^9, 3.3904535256862497`*^9}, 
   3.3904536213112497`*^9, 3.390679328046125*^9, {3.390854103074875*^9, 
   3.390854104512375*^9}}],

Cell[BoxData[
 RowBox[{"PureLogPart", "[", 
  RowBox[{
   FractionBox[
    RowBox[{"b", "+", 
     RowBox[{"2", " ", "a", " ", "x"}]}], 
    RowBox[{"c", "+", 
     RowBox[{"b", " ", "x"}], "+", 
     RowBox[{"a", " ", 
      SuperscriptBox["x", "2"]}]}]], ",", 
   RowBox[{"{", "x", "}"}], ",", 
   RowBox[{"{", "1", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.390108124322625*^9, 3.390108137978875*^9}, 
   3.39011098615075*^9, {3.3904535368268747`*^9, 3.3904535412487497`*^9}, 
   3.3904536278424997`*^9}],

Cell[BoxData[
 RowBox[{"PureLogPart", "[", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"6", 
      SuperscriptBox["x", "5"]}], "+", 
     RowBox[{"6", 
      SuperscriptBox["x", "4"]}], "-", 
     RowBox[{"8", 
      SuperscriptBox["x", "3"]}], "-", 
     RowBox[{"18", 
      SuperscriptBox["x", "2"]}], "+", 
     RowBox[{"8", "x"}], "+", "8"}], 
    RowBox[{
     SuperscriptBox["x", "6"], "-", 
     RowBox[{"5", 
      SuperscriptBox["x", "4"]}], "-", 
     RowBox[{"8", 
      SuperscriptBox["x", "3"]}], "-", 
     RowBox[{"2", 
      SuperscriptBox["x", "2"]}], "+", 
     RowBox[{"2", "x"}], "+", "1"}]], ",", 
   RowBox[{"{", "x", "}"}], ",", 
   RowBox[{"{", "1", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.3901107223695*^9, 3.390110738322625*^9}, {
   3.390146484139625*^9, 3.39014648971775*^9}, 3.3902639636245003`*^9, {
   3.3904535452487497`*^9, 3.3904535496862497`*^9}, 3.3904536296862497`*^9, {
   3.390854154543625*^9, 3.390854159543625*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"D", "[", 
   RowBox[{"%", ",", "x"}], "]"}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.390110754135125*^9, 3.39011075933825*^9}, {
  3.3905496698424997`*^9, 3.3905496806862497`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"Log", "[", 
     RowBox[{
      SuperscriptBox["x", "2"], "+", 
      RowBox[{"Log", "[", 
       RowBox[{
        SuperscriptBox["x", "7"], "-", 
        RowBox[{"4", 
         SuperscriptBox["x", "8"]}], "+", "2"}], "]"}]}], "]"}], ",", "x"}], 
   "]"}], "//", "Together"}]], "Input",
 CellChangeTimes->{{3.39014682084275*^9, 3.390146858264625*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PureLogPart", "[", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{
       RowBox[{"-", "4"}], " ", "x"}], "-", 
      RowBox[{"7", " ", 
       SuperscriptBox["x", "6"]}], "+", 
      RowBox[{"32", " ", 
       SuperscriptBox["x", "7"]}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["x", "8"]}], "+", 
      RowBox[{"8", " ", 
       SuperscriptBox["x", "9"]}]}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"t", "+", 
        SuperscriptBox["x", "2"]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "2"}], "-", 
        SuperscriptBox["x", "7"], "+", 
        RowBox[{"4", " ", 
         SuperscriptBox["x", "8"]}]}], ")"}]}]], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "t"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", 
      FractionBox[
       RowBox[{
        RowBox[{"7", " ", 
         SuperscriptBox["x", "6"]}], "-", 
        RowBox[{"32", " ", 
         SuperscriptBox["x", "7"]}]}], 
       RowBox[{"2", "+", 
        SuperscriptBox["x", "7"], "-", 
        RowBox[{"4", " ", 
         SuperscriptBox["x", "8"]}]}]]}], "}"}]}], "]"}], "/.", 
  RowBox[{"t", "->", 
   RowBox[{"Log", "[", 
    RowBox[{
     SuperscriptBox["x", "7"], "-", 
     RowBox[{"4", 
      SuperscriptBox["x", "8"]}], "+", "2"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.390146876874*^9, 3.390146938264625*^9}, {
   3.3901469778115*^9, 3.390146997889625*^9}, 3.390147035795875*^9, {
   3.390147750577125*^9, 3.3901477566865*^9}, {3.3904535734987497`*^9, 
   3.3904535840143747`*^9}, 3.3904536401393747`*^9, {3.39085417118425*^9, 
   3.3908541762155*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Integrate", "[", 
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{
       SqrtBox["2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"2", " ", "x"}]}], ")"}]}], 
      RowBox[{
       SqrtBox["3"], "-", "x", "+", 
       SuperscriptBox["x", "2"]}]], "+", 
     FractionBox[
      RowBox[{
       SqrtBox["3"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"3", " ", 
          SuperscriptBox["x", "2"]}]}], ")"}]}], 
      RowBox[{
       SqrtBox["2"], "+", "x", "+", 
       SuperscriptBox["x", "3"]}]]}], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"Integration", " ", "over", " ", "algebraic", " ", "numbers"}], 
   " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PureLogPart", "[", 
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{
       SqrtBox["2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"2", " ", "x"}]}], ")"}]}], 
      RowBox[{
       SqrtBox["3"], "-", "x", "+", 
       SuperscriptBox["x", "2"]}]], "+", 
     FractionBox[
      RowBox[{
       SqrtBox["3"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"3", " ", 
          SuperscriptBox["x", "2"]}]}], ")"}]}], 
      RowBox[{
       SqrtBox["2"], "+", "x", "+", 
       SuperscriptBox["x", "3"]}]]}], ",", 
    RowBox[{"{", "x", "}"}], ",", 
    RowBox[{"{", "x", "}"}], ",", 
    RowBox[{"{", "1", "}"}]}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"Integration", " ", "over", " ", "algebraic", " ", "numbers"}], 
   " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.390279375076625*^9, 3.390279406264125*^9}, {
   3.39027946740475*^9, 3.390279472389125*^9}, 3.3902796878735*^9, {
   3.3904535909049997`*^9, 3.3904535929362497`*^9}, 3.3904536430612497`*^9, {
   3.3906274085625*^9, 3.390627409421875*^9}, {3.390854180699875*^9, 
   3.39085420555925*^9}, {3.397891353680605*^9, 3.3978913553744383`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"integrand", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"Log", "[", 
        FractionBox[
         RowBox[{
          RowBox[{
           SqrtBox["2"], 
           SuperscriptBox["x", "5"]}], "-", 
          SqrtBox["3"]}], 
         RowBox[{
          RowBox[{
           SqrtBox["7"], 
           SuperscriptBox["x", "3"]}], "+", "x", "+", "1"}]], "]"}], ",", 
       "x"}], "]"}], "//", "Simplify"}], "//", "Apart"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"PureLogPart", "[", 
  RowBox[{"integrand", ",", 
   RowBox[{"{", "x", "}"}], ",", 
   RowBox[{"{", "x", "}"}], ",", 
   RowBox[{"{", "1", "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"illustrates", " ", "bad", " ", "mathematica", " ", "result"}], 
   " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.3905458334987497`*^9, 3.3905458872799997`*^9}, {
  3.3906272983125*^9, 3.390627325046875*^9}, {3.39062735534375*^9, 
  3.39062737528125*^9}, {3.390854213903*^9, 3.390854240153*^9}, {
  3.395190784359509*^9, 3.3951907846790743`*^9}, {3.3978918570815163`*^9, 
  3.3978918581374807`*^9}, {3.397891896732856*^9, 3.397891906089424*^9}}],

Cell[BoxData[{
 RowBox[{"PureLogPart", "[", 
  RowBox[{
   FractionBox["1", 
    RowBox[{
     SuperscriptBox["x", "3"], "+", "1"}]], ",", 
   RowBox[{"{", "x", "}"}], ",", 
   RowBox[{"{", "1", "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"PureLogPart", "[", 
  RowBox[{
   RowBox[{"Apart", "[", 
    FractionBox["1", 
     RowBox[{
      SuperscriptBox["x", "3"], "+", "1"}]], "]"}], ",", 
   RowBox[{"{", "x", "}"}], ",", 
   RowBox[{"{", "1", "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "This", " ", "illustrates", " ", "that", " ", "taking", " ", "a", " ", 
    "partial", " ", "fraction", " ", "expansion", " ", "is", " ", "a", " ", 
    "good", " ", "thing", " ", "is", " ", "some", " ", 
    RowBox[{"cases", "!!"}]}], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.3904550133893747`*^9, 3.3904550460768747`*^9}}],

Cell[BoxData[
 RowBox[{"integrandold", "=", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"Log", "[", 
      FractionBox[
       RowBox[{"x", "+", 
        RowBox[{"Log", "[", 
         RowBox[{"1", "+", 
          RowBox[{"Exp", "[", "x", "]"}]}], "]"}]}], 
       RowBox[{"x", "-", 
        RowBox[{"Log", "[", "x", "]"}]}]], "]"}], ",", "x"}], "]"}], "//", 
   "Together", 
   RowBox[{"(*", " ", 
    RowBox[{"a", " ", "difficult", " ", "example"}], " ", "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.390628378390625*^9, 3.39062844378125*^9}, {
   3.390628648296875*^9, 3.3906286525625*^9}, {3.39062917409375*^9, 
   3.39062917590625*^9}, {3.39062926540625*^9, 3.390629265515625*^9}, {
   3.390629379546875*^9, 3.39062937965625*^9}, {3.39067735962425*^9, 
   3.39067736149925*^9}, {3.390678702764875*^9, 3.390678766843*^9}, {
   3.390697395593*^9, 3.39069741212425*^9}, {3.390697639139875*^9, 
   3.3906976550305*^9}, 3.390697752968*^9, {3.39069802074925*^9, 
   3.390698036452375*^9}, {3.390698096171125*^9, 3.390698143358625*^9}, {
   3.390698212671125*^9, 3.390698220952375*^9}, {3.390698985514875*^9, 
   3.390698986718*^9}, {3.39070123481175*^9, 3.390701240171125*^9}, {
   3.390703299639875*^9, 3.390703319343*^9}}],

Cell[BoxData[
 RowBox[{"integrand", "=", 
  RowBox[{
   RowBox[{"integrandold", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Exp", "[", "x", "]"}], "\[Rule]", "t1"}], ",", 
      RowBox[{
       RowBox[{"Log", "[", "x", "]"}], "\[Rule]", "t2"}], ",", 
      RowBox[{
       RowBox[{"Log", "[", 
        RowBox[{"1", "+", 
         RowBox[{"Exp", "[", "x", "]"}]}], "]"}], "\[Rule]", "t3"}]}], 
     "}"}]}], "//", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.390628445671875*^9, 3.39062845409375*^9}, {
   3.390628504703125*^9, 3.390628560609375*^9}, {3.390628655484375*^9, 
   3.390628656234375*^9}, {3.390628797875*^9, 3.390628802671875*^9}, {
   3.39062924471875*^9, 3.390629283453125*^9}, 3.39067872137425*^9, {
   3.39067878656175*^9, 3.390678818843*^9}, {3.390697442889875*^9, 
   3.39069747362425*^9}, {3.39069750924925*^9, 3.390697514218*^9}, {
   3.390697544843*^9, 3.390697545593*^9}, {3.390697661108625*^9, 
   3.390697672983625*^9}, {3.390698129593*^9, 3.390698161671125*^9}, {
   3.3906989977805*^9, 3.39069900374925*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PureLogPart", "[", 
    RowBox[{"integrand", ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "t1", ",", "t2", ",", "t3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "t1", ",", 
       RowBox[{"1", "/", "x"}], ",", 
       FractionBox["t1", 
        RowBox[{"1", "+", "t1"}]]}], "}"}]}], "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"t1", "->", 
      RowBox[{"Exp", "[", "x", "]"}]}], ",", 
     RowBox[{"t2", "->", 
      RowBox[{"Log", "[", "x", "]"}]}], ",", 
     RowBox[{"t3", "->", 
      RowBox[{"Log", "[", 
       RowBox[{"1", "+", 
        RowBox[{"Exp", "[", "x", "]"}]}], "]"}]}]}], "}"}]}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.390700322608625*^9, 3.390700323546125*^9}, {
  3.3907028630305*^9, 3.39070288624925*^9}, {3.3907032567805*^9, 
  3.39070325868675*^9}}],

Cell[BoxData[
 RowBox[{"integrand", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"Log", "[", 
       RowBox[{
        RowBox[{"Exp", "[", 
         RowBox[{"2", "x"}], "]"}], "+", 
        RowBox[{
         SqrtBox["3"], 
         SuperscriptBox[
          RowBox[{"Log", "[", 
           RowBox[{"x", "-", "1"}], "]"}], "3"]}]}], "]"}], ",", "x"}], "]"}],
     "//", "Expand"}], "//", "Together", 
   RowBox[{"(*", " ", 
    RowBox[{"thesis", " ", "example"}], " ", "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.391146808619375*^9, 3.39114687385375*^9}, 
   3.39114696804125*^9, {3.391147208400625*^9, 3.391147210119375*^9}, {
   3.391290923309875*^9, 3.39129093616925*^9}, {3.391298091183625*^9, 
   3.391298095589875*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PureLogPart", "[", 
    RowBox[{
     RowBox[{"integrand", "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{"2", "x"}], "]"}], "\[Rule]", "t1"}], ",", 
        RowBox[{
         RowBox[{"Log", "[", 
          RowBox[{"x", "-", "1"}], "]"}], "\[Rule]", "t2"}]}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "t1", ",", "t2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"2", " ", "t1"}], ",", 
       RowBox[{"1", "/", 
        RowBox[{"(", 
         RowBox[{"x", "-", "1"}], ")"}]}]}], "}"}]}], "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"t1", "\[Rule]", 
      RowBox[{"Exp", "[", 
       RowBox[{"2", "x"}], "]"}]}], ",", 
     RowBox[{"t2", "\[Rule]", 
      RowBox[{"Log", "[", 
       RowBox[{"x", "-", "1"}], "]"}]}]}], "}"}]}], "//", "Timing", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"thesis", " ", "example"}], ",", " ", 
    RowBox[{"Mathematica", " ", "fails"}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.391147200885*^9, 3.39114726854125*^9}, {
  3.391298098183625*^9, 3.39129813163675*^9}, {3.39250318729525*^9, 
  3.392503188279625*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PureLogPart", "[", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"-", "11"}], "+", 
      RowBox[{"4", " ", "x"}]}], 
     RowBox[{"6", " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", "x", "+", 
        SuperscriptBox["x", "2"]}], ")"}]}]], ",", 
    RowBox[{"{", "x", "}"}], ",", 
    RowBox[{"{", "1", "}"}]}], "]"}], "//", "Timing"}]], "Input",
 CellChangeTimes->{{3.39352058088725*^9, 3.393520590090375*^9}, {
  3.39352431438725*^9, 3.39352431807475*^9}}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Integration of Logarithmic Polynomials", "Subsection",
 CellChangeTimes->{{3.394314792013875*^9, 3.394314799826375*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RischLogarithmicPolynomial", "::", "warning"}], "=", 
   "\"\<Integral not elementary -- non-elementary recursive integration or \
introduction of new logarithms.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4103966411012297`*^9, 3.410396758226994*^9}, 
   3.410396789005948*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RischLogarithmicPolynomial", "[", 
   RowBox[{
   "0", ",", "theta_", ",", "tower_", ",", "Dtower_", ",", "extendtheta_"}], 
   "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{"0", ",", "True"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.410344567178604*^9, 3.410344576232535*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RischLogarithmicPolynomial", "[", 
   RowBox[{
   "logpoly_", ",", "theta_", ",", "tower_", ",", "Dtower_", ",", 
    "extendtheta_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "A0", ",", "p0", ",", "infield", ",", "b", ",", "c", ",", "m", ",", "q0",
       ",", "q", ",", "beta", ",", "res"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"RischTrace", "[", 
      RowBox[{
      "RischLogarithmicPolynomial", ",", "logpoly", ",", "\"\<In\>\""}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"FreeQ", "[", 
        RowBox[{"logpoly", ",", 
         RowBox[{"Last", "[", "theta", "]"}]}], "]"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"A0", "=", 
         RowBox[{"RischInternal", "[", 
          RowBox[{"logpoly", ",", "theta", ",", "tower", ",", "Dtower", ",", 
           RowBox[{"\"\<ExtendThetas\>\"", "\[Rule]", "True"}], ",", 
           RowBox[{"\"\<RecursiveCall\>\"", "\[Rule]", "True"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"A0", "===", "$Failed"}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"{", 
            RowBox[{"0", ",", "False"}], "}"}], "]"}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"First", "[", "A0", "]"}], ",", "True"}], "}"}], "]"}]}],
          "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"infield", "=", 
      RowBox[{"LimitedIntegrate", "[", 
       RowBox[{
        RowBox[{"Simplify", "@", 
         RowBox[{"lc", "[", 
          RowBox[{"logpoly", ",", 
           RowBox[{"Last", "[", "theta", "]"}]}], "]"}]}], ",", "theta", ",", 
        "tower", ",", "Dtower"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"infield", "===", "$Failed"}], ",", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", "False"}], "}"}], "]"}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"b", ",", "c"}], "}"}], "=", "infield"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"m", "=", 
      RowBox[{"Exponent", "[", 
       RowBox[{"logpoly", ",", 
        RowBox[{"Last", "[", "theta", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"q0", "=", 
      RowBox[{
       RowBox[{"c", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Last", "[", "theta", "]"}], "^", 
          RowBox[{"(", 
           RowBox[{"m", "+", "1"}], ")"}]}], "/", 
         RowBox[{"(", 
          RowBox[{"m", "+", "1"}], ")"}]}]}], "+", 
       RowBox[{"b", " ", 
        RowBox[{
         RowBox[{"Last", "[", "theta", "]"}], "^", "m"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "we", " ", "do", " ", "need", " ", "to", " ", "use", " ", "Simplify", 
        " ", "below"}], ",", " ", 
       RowBox[{"try", " ", 
        RowBox[{"Risch", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Log", "[", "x", "]"}], " ", 
           RowBox[{"Log", "[", 
            RowBox[{"2", " ", "x"}], "]"}], " ", 
           RowBox[{"Log", "[", 
            RowBox[{"3", " ", "x"}], "]"}]}], ",", " ", "x"}], "]"}]}]}], " ",
       "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"q", ",", "beta"}], "}"}], "=", 
      RowBox[{"RischLogarithmicPolynomial", "[", 
       RowBox[{
        RowBox[{"Simplify", "[", 
         RowBox[{"Together", "[", 
          RowBox[{"logpoly", "-", 
           RowBox[{"TotalDerivation", "[", 
            RowBox[{"q0", ",", "theta", ",", "Dtower"}], "]"}]}], "]"}], 
         "]"}], ",", "theta", ",", "tower", ",", "Dtower", ",", 
        "extendtheta"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Expand", "[", 
         RowBox[{"q", "+", "q0"}], "]"}], ",", "beta"}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"RischTrace", "[", 
      RowBox[{"RischLogarithmicPolynomial", ",", "res", ",", "\"\<Out\>\""}], 
      "]"}], ";", "\[IndentingNewLine]", "res"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.410163853624741*^9, 3.410164398071435*^9}, {
   3.410164553502741*^9, 3.4101645828451157`*^9}, 3.4101647284469957`*^9, {
   3.410165043592787*^9, 3.410165049102469*^9}, {3.410167891954109*^9, 
   3.410167919662798*^9}, {3.410167971217546*^9, 3.410167981031962*^9}, {
   3.410168391941345*^9, 3.410168455864291*^9}, {3.41019660218143*^9, 
   3.410196611068033*^9}, {3.410196707910543*^9, 3.4101967151482153`*^9}, {
   3.4101969107027884`*^9, 3.410196916772745*^9}, {3.4101970085595903`*^9, 
   3.410197017124976*^9}, {3.4101971425355387`*^9, 3.410197152862649*^9}, {
   3.4101974197579117`*^9, 3.410197427670101*^9}, {3.410201003397131*^9, 
   3.410201015412093*^9}, {3.4102012856570168`*^9, 3.410201285758007*^9}, {
   3.410201453021534*^9, 3.410201456102269*^9}, {3.410202022743272*^9, 
   3.410202029142727*^9}, 3.410203559604413*^9, 3.410203606047269*^9, {
   3.410203845205523*^9, 3.41020384550237*^9}, {3.4102039091174917`*^9, 
   3.410203939708913*^9}, {3.410336778048564*^9, 3.410336799206016*^9}, {
   3.41033691013379*^9, 3.4103369430142384`*^9}, {3.4103371486772003`*^9, 
   3.410337152759644*^9}, {3.4103374498617353`*^9, 3.410337520683495*^9}, {
   3.4103430249728193`*^9, 3.410343043965129*^9}, {3.410343122565247*^9, 
   3.410343127060101*^9}, {3.410343299618239*^9, 3.4103433017618437`*^9}, {
   3.4103447212636223`*^9, 3.410344725156527*^9}, {3.410344777493244*^9, 
   3.4103448242922297`*^9}, {3.410344864574275*^9, 3.4103448653902063`*^9}, {
   3.410386477399413*^9, 3.410386564858923*^9}, {3.41038666469799*^9, 
   3.4103866714797773`*^9}, 3.41302230817562*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"LimitedIntegrate", "[", 
   RowBox[{"expr_", ",", "theta_", ",", "tower_", ",", "Dtower_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"iexpr", ",", 
      RowBox[{"t", "=", 
       RowBox[{"Last", "[", "theta", "]"}]}], ",", "a", ",", "c", ",", "res", 
      ",", "result"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"RischTrace", "[", 
      RowBox[{"LimitedIntegrate", ",", "expr", ",", "\"\<In\>\""}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Limited", " ", 
       RowBox[{"integrate", " ", "--"}], " ", "recursive", " ", "integration",
        " ", 
       RowBox[{"version", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"iexpr", "=", 
      RowBox[{"RischInternal", "[", 
       RowBox[{"expr", ",", "theta", ",", "tower", ",", "Dtower", ",", 
        RowBox[{"\"\<ExtendThetas\>\"", "\[Rule]", "False"}], ",", 
        RowBox[{"\"\<RecursiveCall\>\"", "\[Rule]", "True"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "We", " ", "use", " ", "structure", " ", "theorems", " ", "on", " ", 
       RowBox[{"result", ".", " ", "e", ".", "g", ".", " ", 
        RowBox[{"Risch", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"x", "^", "2"}], " ", 
           RowBox[{
            RowBox[{"Log", "[", 
             RowBox[{"1", "-", "x"}], "]"}], "^", "2"}]}], ",", " ", "x"}], 
         "]"}]}], " ", "fails", " ", 
       RowBox[{"without", "!"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"iexpr", "===", "$Failed"}], ",", 
       RowBox[{"Return", "[", "$Failed", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{"MatchLogs", "[", 
       RowBox[{
        RowBox[{"First", "[", "iexpr", "]"}], ",", "theta", ",", "tower", ",",
         "Dtower"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"FreeQ", "[", 
         RowBox[{"res", ",", 
          RowBox[{"rischLog", "|", "rischExp", "|", "ArcTan"}]}], "]"}]}], 
       ",", 
       RowBox[{"Return", "[", "$Failed", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"result", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Simplify", "[", 
         RowBox[{"res", "-", 
          RowBox[{
           RowBox[{"Coefficient", "[", 
            RowBox[{"res", ",", "t"}], "]"}], "t"}]}], "]"}], ",", 
        RowBox[{"Coefficient", "[", 
         RowBox[{"res", ",", "t"}], "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"RischTrace", "[", 
      RowBox[{"LimitedIntegrate", ",", "result", ",", "\"\<Out\>\""}], "]"}], 
     ";", "\[IndentingNewLine]", "result"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJwd0F1Ik2EABeCRXzkMJNILEabsxo1BhCaFsuE32YRKyRTkEwcjmTmXMHWO
UtHMtAkThxK6omabMEWTadK8KP/QRFxsiUMvtJUaOn+QIWkq/vSe9+LwXBzO
zREW6nOKLvF4PAkJ5AQxBrV2Sy6oDBhhaPT8OWy9b2uFun8n7XDX02mH2dXH
vfC7X9YPJ3Ssj/adoiUolDX8gXPfIoPw1XVr1COi+GCCuuy78lhP3A++pI4Z
jp7AQJqgDLIqth6qFaJGuBcf1QKbn72lnl2+2QXv/uX6ofRBswueCsxU7YvU
MfhQy85BsabWC03qw58wRbQqLyPabuenw22DPRcmNTmpfj9/DTorRFTH8kJB
OfGdJEsFWaNbA2fDTUXU+SY9TKi1UG3iuBq43sOZoduUaIX+lJw3UKacPPpE
1JR4j2HIdXIBk7N2mWHilGGTD72/HBGwkBkdhKpZ2RAM5Z5OwXtXq2bg3o7F
B4vNmT9gy8BMAK4wwg048Hoo7zN+5to4OJj5tB5+PDRRgweLXW5ih875AZY6
FC64HpNNlbSnjkCrMnIcJtwpnoaxVZMeyH9vP4OVt6LP4e8b5rARYrlUyUBX
Up4cGr+GK6BU1a2BHUwftS0j7IsHu+g6qmO8cQVeS7dQ/wOqTWHH
  "]],

Cell[BoxData[
 RowBox[{
  RowBox[{"MatchLogs", "[", 
   RowBox[{"0", ",", "theta_", ",", "tower_", ",", "Dtower_"}], "]"}], ":=", 
  "0"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.410344115673172*^9, 3.41034412152917*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"MatchLogs", "[", 
   RowBox[{"expr_", ",", "theta_", ",", "tower_", ",", "Dtower_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "logs", ",", "res", ",", "reps", ",", "rreps", ",", "str", ",", "new"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"RischTrace", "[", 
      RowBox[{"MatchLogs", ",", "expr", ",", "\"\<In\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "use", " ", "log", " ", "structure", " ", "theorem", " ", "to", " ", 
       "remove", " ", "algebraic", " ", 
       RowBox[{"dependencies", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"reps", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", 
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "&"}], "/@", 
       RowBox[{"Thread", "[", 
        RowBox[{"{", 
         RowBox[{"theta", ",", "tower"}], "}"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{"expr", "//.", "reps"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"logs", "=", 
      RowBox[{"Cases", "[", 
       RowBox[{"res", ",", 
        RowBox[{"rischLog", "[", "a_", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "Infinity"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"logs", "===", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"Return", "[", "expr", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{
        RowBox[{"str", "=", 
         RowBox[{"LogStructure", "[", 
          RowBox[{
           RowBox[{"logs", "[", 
            RowBox[{"[", "n", "]"}], "]"}], ",", "theta", ",", "tower", ",", 
           "Dtower", ",", 
           RowBox[{"{", "}"}], ",", "reps"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"First", "[", "str", "]"}], "===", "True"}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{
           RowBox[{"new", "=", 
            RowBox[{
             RowBox[{"Expand", "[", " ", 
              RowBox[{"str", "[", 
               RowBox[{"[", "2", "]"}], "]"}], " ", "]"}], "/.", 
             RowBox[{
              RowBox[{"a_.", "+", "b_"}], "\[RuleDelayed]", 
              RowBox[{"b", "/;", 
               RowBox[{"And", "@@", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"FreeQ", "[", 
                    RowBox[{"a", ",", "#"}], "]"}], "&"}], "/@", "theta"}], 
                 ")"}]}]}]}]}]}], ";", "\[IndentingNewLine]", "\t\t", 
           RowBox[{"res", "=", 
            RowBox[{"res", "/.", 
             RowBox[{
              RowBox[{"logs", "[", 
               RowBox[{"[", "n", "]"}], "]"}], "\[Rule]", "new"}]}]}]}]}], 
         "\[IndentingNewLine]", "\t", "]"}]}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "1", ",", 
         RowBox[{"Length", "[", "logs", "]"}]}], "}"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"rreps", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", 
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "&"}], "/@", 
       RowBox[{"Thread", "[", 
        RowBox[{"{", 
         RowBox[{"tower", ",", "theta"}], "}"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{"res", "//.", "rreps"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"RischTrace", "[", 
      RowBox[{"MatchLogs", ",", "res", ",", "\"\<Out\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", "res"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.410198262554777*^9, 3.41019830398939*^9}, {
   3.410198340692451*^9, 3.410198341174944*^9}, {3.41019839979881*^9, 
   3.410198470646241*^9}, {3.410198840112125*^9, 3.4101989888324738`*^9}, {
   3.410199046226758*^9, 3.410199048873457*^9}, {3.410199080626377*^9, 
   3.4101991850176477`*^9}, {3.4101992257084303`*^9, 
   3.4101994075700073`*^9}, {3.4101994397143393`*^9, 3.410199442331311*^9}, {
   3.41019953832483*^9, 3.410199563122314*^9}, 3.410199636874798*^9, {
   3.410200146247525*^9, 3.4102001818387117`*^9}, {3.41020025418696*^9, 
   3.410200492554627*^9}, {3.410200540036985*^9, 3.410200571446259*^9}, {
   3.410200616694944*^9, 3.410200619761166*^9}, {3.410200653333983*^9, 
   3.410200738084484*^9}, {3.4102008540774117`*^9, 3.410200884549203*^9}, {
   3.410200942102353*^9, 3.410200987725935*^9}, {3.41020110168804*^9, 
   3.4102011043416224`*^9}, {3.410337417274858*^9, 3.410337436514357*^9}, {
   3.4103376197482967`*^9, 3.4103376509871492`*^9}, {3.410340708429047*^9, 
   3.410340712003023*^9}, {3.41034075311685*^9, 3.4103407573795757`*^9}, {
   3.410340788869383*^9, 3.4103408587960997`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"RischLogarithmicPolynomial", "[", 
   RowBox[{
    SubscriptBox["\[Theta]", "2"], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", 
      SubscriptBox["\[Theta]", "1"], ",", 
      SubscriptBox["\[Theta]", "2"]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", 
      RowBox[{"rischExp", "[", "x", "]"}], ",", 
      RowBox[{"rischLog", "[", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SubscriptBox["\[Theta]", "1"]}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", 
      SubscriptBox["\[Theta]", "1"], ",", 
      FractionBox[
       SubscriptBox["\[Theta]", "1"], 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SubscriptBox["\[Theta]", "1"]}]]}], "}"}], ",", "True"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{
   "bug", " ", "is", " ", "in", " ", "the", " ", "final", " ", "integration", 
    " ", 
    RowBox[{"Risch", "[", 
     RowBox[{
      RowBox[{"x", " ", 
       RowBox[{
        RowBox[{"Exp", "[", "x", "]"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Exp", "[", "x", "]"}], "-", "1"}], ")"}]}]}], ",", " ", 
      "x"}], "]"}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.410386371782569*^9, 3.4103863783908243`*^9}, {
  3.410386613505315*^9, 3.410386633550103*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    SuperscriptBox["x", "2"], "2"], ",", "True"}], "}"}]], "Output",
 CellChangeTimes->{{3.410386380374956*^9, 3.410386405322076*^9}, 
   3.4103864372612677`*^9, 3.410386483031942*^9, {3.410386523792922*^9, 
   3.410386566982082*^9}, 3.410386673494466*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RischLogarithmicPolynomial", "[", 
  RowBox[{
   RowBox[{
    SubscriptBox["\[Theta]", "1"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Log", "[", "3", "]"}], "+", 
      SubscriptBox["\[Theta]", "1"]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Log", "[", "6", "]"}], "+", 
      SubscriptBox["\[Theta]", "1"]}], ")"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     SubscriptBox["\[Theta]", "1"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"rischLog", "[", "x", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     FractionBox["1", "x"]}], "}"}], ",", "True"}], "]"}]], "Input",
 CellChangeTimes->{{3.41034300703421*^9, 3.4103430155524807`*^9}, {
  3.410343134656872*^9, 3.410343138889689*^9}, {3.410343182258226*^9, 
  3.410343188600027*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"-", "6"}], " ", "x"}], "-", 
    RowBox[{"x", " ", 
     RowBox[{"Log", "[", "3", "]"}], " ", 
     RowBox[{"Log", "[", "6", "]"}]}], "+", 
    RowBox[{"x", " ", 
     RowBox[{"Log", "[", "324", "]"}]}], "+", 
    RowBox[{"6", " ", "x", " ", 
     SubscriptBox["\[Theta]", "1"]}], "+", 
    RowBox[{"x", " ", 
     RowBox[{"Log", "[", "3", "]"}], " ", 
     RowBox[{"Log", "[", "6", "]"}], " ", 
     SubscriptBox["\[Theta]", "1"]}], "-", 
    RowBox[{"2", " ", "x", " ", 
     RowBox[{"Log", "[", "18", "]"}], " ", 
     SubscriptBox["\[Theta]", "1"]}], "-", 
    RowBox[{"3", " ", "x", " ", 
     SubsuperscriptBox["\[Theta]", "1", "2"]}], "+", 
    RowBox[{"x", " ", 
     RowBox[{"Log", "[", "18", "]"}], " ", 
     SubsuperscriptBox["\[Theta]", "1", "2"]}], "+", 
    RowBox[{"x", " ", 
     SubsuperscriptBox["\[Theta]", "1", "3"]}]}], ",", "True"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.4103433067452583`*^9, {3.410343370513644*^9, 3.410343391237805*^9}, 
   3.410343922616374*^9, 3.410343971806006*^9, 3.410344125696566*^9, 
   3.410344318729089*^9, 3.41034448865208*^9, 3.410344584918003*^9, {
   3.410344751736793*^9, 3.410344781458856*^9}, 3.410344829382354*^9, 
   3.4103448691158657`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RischLogarithmicPolynomial", "[", 
  RowBox[{
   SubsuperscriptBox["\[Theta]", "1", "3"], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     SubscriptBox["\[Theta]", "1"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"rischLog", "[", 
      FractionBox["1", 
       RowBox[{"1", "-", "x"}]], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     FractionBox["1", 
      RowBox[{"1", "-", "x"}]]}], "}"}], ",", "True"}], "]"}]], "Input",
 CellChangeTimes->{{3.410340417224638*^9, 3.410340424946946*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"6", " ", "x"}], "+", 
    RowBox[{"6", " ", 
     RowBox[{"rischLog", "[", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "x"}], "]"}]}], "+", 
    RowBox[{"6", " ", "x", " ", 
     SubscriptBox["\[Theta]", "1"]}], "-", 
    RowBox[{"3", " ", 
     SubsuperscriptBox["\[Theta]", "1", "2"]}], "+", 
    RowBox[{"3", " ", "x", " ", 
     SubsuperscriptBox["\[Theta]", "1", "2"]}], "-", 
    SubsuperscriptBox["\[Theta]", "1", "3"], "+", 
    RowBox[{"x", " ", 
     SubsuperscriptBox["\[Theta]", "1", "3"]}]}], ",", "True"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.410340433761982*^9, 3.410340507814478*^9, 3.410340550281495*^9, 
   3.4103406324979477`*^9, 3.410340722978222*^9, 3.410340767700089*^9, {
   3.410340797894763*^9, 3.410340869967403*^9}, {3.410343895705961*^9, 
   3.410343924652727*^9}, 3.4103442023274384`*^9, 3.410344830688449*^9, 
   3.410344870073415*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RischLogarithmicPolynomial", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"theta", "[", "1", "]"}], "/", "x"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"theta", "[", "1", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"rischLog", "[", "x", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"1", "/", "x"}]}], "}"}], ",", "True"}], "]"}]], "Input",
 CellChangeTimes->{{3.410336288185441*^9, 3.410336317380664*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    SubsuperscriptBox["\[Theta]", "1", "2"], "2"], ",", "True"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.410336318205652*^9, 3.410336324187153*^9}, {
   3.4103368907698812`*^9, 3.410336916026885*^9}, 3.410336946569416*^9, 
   3.410337023786894*^9, 3.410337163691104*^9, {3.4103373019754353`*^9, 
   3.410337334867408*^9}, {3.410337411917568*^9, 3.410337437556085*^9}, 
   3.410337652460022*^9, 3.41034087105867*^9, {3.4103438969799213`*^9, 
   3.410343925202127*^9}, 3.410344203281557*^9, 3.4103448328086653`*^9, 
   3.410344870783814*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RischInternal", "[", 
  RowBox[{
   RowBox[{"1", "/", "x"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"theta", "[", "1", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"rischLog", "[", "x", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"1", "/", "x"}]}], "}"}], ",", 
   RowBox[{"\"\<ExtendThetas\>\"", "\[Rule]", "False"}], ",", 
   RowBox[{"\"\<RecursiveCall\>\"", "\[Rule]", "True"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.410337025663146*^9, 3.4103370656797647`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   SubscriptBox["\[Theta]", "1"], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     SubscriptBox["\[Theta]", "1"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"rischLog", "[", "x", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     FractionBox["1", "x"]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.4103370680855513`*^9, 3.410337653694703*^9, 3.410340871864214*^9, {
   3.410343897702285*^9, 3.410343925771624*^9}, 3.410344203655595*^9, 
   3.410344833535564*^9, 3.41034487138957*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"RischLogarithmicPolynomial", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"3", "x"}], "+", "1"}], ")"}], 
     SuperscriptBox[
      RowBox[{"theta", "[", "1", "]"}], "5"]}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", 
      RowBox[{"theta", "[", "1", "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", 
      RowBox[{"rischLog", "[", 
       RowBox[{
        SuperscriptBox["x", "2"], "+", "1"}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", 
      FractionBox[
       RowBox[{"2", "x"}], 
       RowBox[{
        SuperscriptBox["x", "2"], "+", "1"}]]}], "}"}], ",", "True"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"result", " ", "NOT", " ", "elementary"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.410335450261128*^9, 3.410335497031438*^9}, {
  3.410335858777568*^9, 3.410335864625875*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"x", " ", 
     SubsuperscriptBox["\[Theta]", "1", "5"]}], "+", 
    RowBox[{
     FractionBox["3", "2"], " ", 
     SuperscriptBox["x", "2"], " ", 
     SubsuperscriptBox["\[Theta]", "1", "5"]}]}], ",", "False"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.410335703218004*^9, {3.410335838965948*^9, 3.41033586701691*^9}, 
   3.41033765422399*^9, {3.410343902186842*^9, 3.410343926344597*^9}, 
   3.410344204359354*^9, 3.410344834293131*^9, 3.410344872161779*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RischLogarithmicPolynomial", "[", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"theta", "[", "1", "]"}], "3"], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"theta", "[", "1", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"rischLog", "[", "x", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     FractionBox["1", "x"]}], "}"}], ",", "True"}], "]"}]], "Input",
 CellChangeTimes->{{3.410167822939514*^9, 3.410167824297368*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"-", "6"}], " ", "x"}], "+", 
    RowBox[{"6", " ", "x", " ", 
     SubscriptBox["\[Theta]", "1"]}], "-", 
    RowBox[{"3", " ", "x", " ", 
     SubsuperscriptBox["\[Theta]", "1", "2"]}], "+", 
    RowBox[{"x", " ", 
     SubsuperscriptBox["\[Theta]", "1", "3"]}]}], ",", "True"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.410167828207447*^9, {3.4101678825239897`*^9, 3.410167921978508*^9}, {
   3.410167968694168*^9, 3.410168002774786*^9}, 3.410168055326559*^9, {
   3.410168091006262*^9, 3.410168103401368*^9}, 3.410168346774032*^9, {
   3.410168458963756*^9, 3.410168469360512*^9}, 3.410196587468886*^9, 
   3.410196617973359*^9, {3.410196692866405*^9, 3.4101967229665213`*^9}, {
   3.4101968628945227`*^9, 3.410196883903336*^9}, 3.4101969222366543`*^9, 
   3.4101970190008707`*^9, {3.410197087771595*^9, 3.4101970925219517`*^9}, {
   3.410197432485752*^9, 3.4101974491991177`*^9}, 3.410197553758703*^9, {
   3.4102017396209307`*^9, 3.410201748238681*^9}, {3.410201975620647*^9, 
   3.410201981974011*^9}, 3.4102237069326973`*^9, 3.410335429580469*^9, 
   3.410337655076336*^9, 3.4103442050786533`*^9, 3.410344835097028*^9, 
   3.410344872897318*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RischLogarithmicPolynomial", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", "x"}], "+", "1"}], ")"}], 
    SuperscriptBox[
     RowBox[{"theta", "[", "1", "]"}], "2"]}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"theta", "[", "1", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"rischLog", "[", 
      RowBox[{
       SuperscriptBox["x", "2"], "+", "x", "-", "1"}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     FractionBox[
      RowBox[{
       RowBox[{"2", " ", "x"}], "+", "1"}], 
      RowBox[{
       SuperscriptBox["x", "2"], "+", "x", "-", "1"}]]}], "}"}], ",", 
   "True"}], "]"}]], "Input",
 CellChangeTimes->{{3.3932874249554157`*^9, 3.3932874279897795`*^9}, {
   3.393287477170498*^9, 3.3932875223354416`*^9}, {3.3932875881100206`*^9, 
   3.3932875892015905`*^9}, {3.393293110100253*^9, 3.393293110911419*^9}, {
   3.3933009670379744`*^9, 3.3933009686703215`*^9}, {3.3933012920953836`*^9, 
   3.393301301158416*^9}, {3.393301591455843*^9, 3.393301629280232*^9}, {
   3.3933019167335696`*^9, 3.393301918105542*^9}, {3.393373020904125*^9, 
   3.39337302623225*^9}, {3.393373074201*^9, 3.393373080154125*^9}, {
   3.393373123966625*^9, 3.3933731318885*^9}, {3.393373273872875*^9, 
   3.393373279279125*^9}, {3.39347413313925*^9, 3.393474146592375*^9}, {
   3.393474228436125*^9, 3.39347425713925*^9}, {3.393474290373625*^9, 
   3.393474290498625*^9}, {3.39347432095175*^9, 3.393474323561125*^9}, {
   3.393475817248625*^9, 3.393475833936125*^9}, 3.393475987842375*^9, {
   3.39347603851425*^9, 3.39347605663925*^9}, {3.393476708435625*^9, 
   3.39347673388875*^9}, {3.393476799810625*^9, 3.393476841545*^9}, {
   3.393477102060625*^9, 3.393477104716875*^9}, {3.39347743942*^9, 
   3.393477476060625*^9}, {3.39347755817*^9, 3.393477558310625*^9}, {
   3.39347836717*^9, 3.39347837388875*^9}, {3.393478556248125*^9, 
   3.393478557795*^9}, {3.393478893310625*^9, 3.39347889438875*^9}, {
   3.3935180504035*^9, 3.393518050606625*^9}, {3.395311635606811*^9, 
   3.3953116360124807`*^9}, {3.408853671170133*^9, 3.408853684097209*^9}, {
   3.410168085812612*^9, 3.410168087098262*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"2", " ", "x"}], "+", 
    RowBox[{"2", " ", 
     SuperscriptBox["x", "2"]}], "+", 
    RowBox[{"2", " ", 
     SubscriptBox["\[Theta]", "1"]}], "-", 
    RowBox[{"2", " ", "x", " ", 
     SubscriptBox["\[Theta]", "1"]}], "-", 
    RowBox[{"2", " ", 
     SuperscriptBox["x", "2"], " ", 
     SubscriptBox["\[Theta]", "1"]}], "-", 
    SubsuperscriptBox["\[Theta]", "1", "2"], "+", 
    RowBox[{"x", " ", 
     SubsuperscriptBox["\[Theta]", "1", "2"]}], "+", 
    RowBox[{
     SuperscriptBox["x", "2"], " ", 
     SubsuperscriptBox["\[Theta]", "1", "2"]}]}], ",", "True"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.410196693643021*^9, 3.410196732630722*^9, {3.4101968640449944`*^9, 
   3.410196892072321*^9}, 3.4101969370663633`*^9, 3.410197022252144*^9, 
   3.410197109200428*^9, 3.4101971658767653`*^9, 3.4101973848239317`*^9, 
   3.410197449895467*^9, 3.410197554189514*^9, 3.41020175842832*^9, 
   3.410201982962413*^9, 3.410223707288827*^9, 3.410337655834611*^9, 
   3.410344873945469*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RischLogarithmicPolynomial", "[", 
  RowBox[{
   RowBox[{"theta", "[", "1", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"theta", "[", "1", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"rischLog", "[", 
      RowBox[{"1", "-", 
       SuperscriptBox["x", "4"]}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     FractionBox[
      RowBox[{"4", " ", 
       SuperscriptBox["x", "3"]}], 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SuperscriptBox["x", "4"]}]]}], "}"}], ",", "True"}], "]"}]], "Input",
 CellChangeTimes->{{3.394344828044375*^9, 3.394344836263125*^9}, {
   3.395311641148095*^9, 3.39531164160384*^9}, {3.408853692712805*^9, 
   3.408853709526347*^9}, 3.410168089002227*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"-", "4"}], " ", "x"}], "+", 
    RowBox[{"2", " ", 
     RowBox[{"ArcTan", "[", "x", "]"}]}], "-", 
    RowBox[{"rischLog", "[", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "x"}], "]"}], "+", 
    RowBox[{"rischLog", "[", 
     RowBox[{"1", "+", "x"}], "]"}], "+", 
    RowBox[{"x", " ", 
     SubscriptBox["\[Theta]", "1"]}]}], ",", "True"}], "}"}]], "Output",
 CellChangeTimes->{
  3.40885369443169*^9, 3.4088548507235394`*^9, 3.4088550013782253`*^9, {
   3.408855055538352*^9, 3.4088550760910378`*^9}, 3.410163116993678*^9, {
   3.4101680622342253`*^9, 3.410168069032168*^9}, 3.410197389107059*^9, 
   3.410197450328142*^9, 3.410197554421143*^9, 3.41020198504839*^9, 
   3.410223707550458*^9, 3.410337656667633*^9, 3.410344874819261*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Integration of Exponential Polynomials", "Subsection",
 CellChangeTimes->{{3.3959162174787903`*^9, 3.395916224386549*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RischExponentialPolynomial", "[", 
   RowBox[{
   "p_", ",", "theta_", ",", "tower_", ",", "Dtower_", ",", "extendtheta_"}], 
   "]"}], ":=", 
  RowBox[{"Catch", "[", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"poly", "=", "p"}], ",", "degMax", ",", "degMin", ",", "coeff",
        ",", "A0", ",", "nonthetaterm", ",", "result", ",", "rde", ",", 
       "intA0"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"RischTrace", "[", 
       RowBox[{"RischExponentialPolynomial", ",", 
        RowBox[{"{", 
         RowBox[{"p", ",", "theta", ",", "tower", ",", "Dtower"}], "}"}], 
        ",", "\"\<In\>\""}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"Integration", " ", "of", " ", "exponential", " ", 
          RowBox[{"polynomials", ".", " ", "Given"}], "\[IndentingNewLine]", 
          "\[IndentingNewLine]", "\t", "P"}], " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"a_n", " ", 
              RowBox[{"Theta", "^", "n"}]}], " ", "+", " ", 
             RowBox[{"a_", 
              RowBox[{"{", 
               RowBox[{"n", "-", "1"}], "}"}], " ", 
              RowBox[{"Theta", "^", 
               RowBox[{"{", 
                RowBox[{"n", "-", "1"}], "}"}]}]}], " ", "+"}], " ", "..."}], 
           " ", "+", " ", 
           RowBox[{
           "a_", "0", "\[IndentingNewLine]", "\[IndentingNewLine]", "where", 
            " ", "a_", 
            RowBox[{"{", "i", "}"}], " ", "are", " ", "in", " ", "k", " ", 
            "and", " ", 
            RowBox[{"Theta", "'"}]}]}], " ", "=", " ", 
          RowBox[{
           RowBox[{"f", "'"}], " ", "Theta"}]}]}], ",", " ", 
        RowBox[{
         RowBox[{
         "then", " ", "differentiating", " ", "gives", " ", "us", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
          RowBox[{"P", "'"}]}], " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"a_", 
                RowBox[{
                 RowBox[{"{", "n", "}"}], "'"}]}], " ", "+", " ", 
               RowBox[{"n", " ", 
                RowBox[{"f", "'"}], " ", "a_n"}]}], ")"}], " ", 
             RowBox[{"Theta", "^", "n"}]}], " ", "+", " ", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"a_", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"n", "-", "1"}], "}"}], "'"}]}], " ", "+", " ", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"n", "-", "1"}], ")"}], " ", 
                RowBox[{"f", "'"}], " ", "a_", 
                RowBox[{"{", 
                 RowBox[{"n", "-", "1"}], "}"}]}]}], ")"}], " ", 
             RowBox[{"Theta", "^", 
              RowBox[{"{", 
               RowBox[{"n", "-", "1"}], "}"}]}]}], " ", "+"}], 
           "\[IndentingNewLine]", "\t\t\t", "..."}], " ", "+", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"a_", 
              RowBox[{
               RowBox[{"{", "1", "}"}], "'"}]}], " ", "+", " ", 
             RowBox[{
              RowBox[{"f", "'"}], " ", "a_", 
              RowBox[{"{", "1", "}"}]}]}], ")"}], " ", "Theta"}], " ", "+", 
          " ", 
          RowBox[{"a_", 
           RowBox[{
            RowBox[{"{", "0", "}"}], ".", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", "The"}], " ", "following", " ", 
           "algorithm", " ", "is", " ", "based", " ", "on", " ", "how", " ", 
           "P", " ", "acts", " ", "under", " ", 
           RowBox[{"differentiation", "."}]}]}]}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"max", " ", "and", " ", "min", " ", "degrees"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"degMax", "=", 
       RowBox[{"Exponent", "[", 
        RowBox[{"poly", ",", 
         RowBox[{"Last", "[", "theta", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"degMin", "=", 
       RowBox[{"Exponent", "[", 
        RowBox[{"poly", ",", 
         RowBox[{"Last", "[", "theta", "]"}], ",", "Min"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"nonthetaterm", "=", "0"}], ";", 
      RowBox[{"result", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "solve", " ", "a", " ", "Risch", " ", "DE", " ", "for", " ", "each", 
        " ", 
        RowBox[{"power", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{
         RowBox[{"coeff", "=", 
          RowBox[{"Coefficient", "[", 
           RowBox[{"poly", ",", 
            RowBox[{"Last", "[", "theta", "]"}], ",", "n"}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"SameQ", "[", 
             RowBox[{"n", ",", "0"}], "]"}], "||", 
            RowBox[{"SameQ", "[", 
             RowBox[{"coeff", ",", "0"}], "]"}]}], ",", 
           RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{"rde", "=", 
          RowBox[{"RischDE", "[", 
           RowBox[{
            RowBox[{"n", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Last", "[", "Dtower", "]"}], "/", 
               RowBox[{"Last", "[", "theta", "]"}]}], ")"}]}], ",", 
            RowBox[{"Cancel", "[", "coeff", "]"}], ",", "theta", ",", "tower",
             ",", "Dtower"}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"SameQ", "[", 
            RowBox[{"rde", ",", "$Failed"}], "]"}], ",", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{
            RowBox[{"RischTrace", "[", 
             RowBox[{
             "RischExponentialPolynomial", ",", "$Failed", ",", 
              "\"\<Out\>\""}], "]"}], ";", "\[IndentingNewLine]", "\t\t", 
            RowBox[{"Throw", "[", "$Failed", "]"}]}], ",", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{
            RowBox[{"nonthetaterm", "=", 
             RowBox[{"nonthetaterm", "+", 
              RowBox[{"coeff", " ", 
               RowBox[{
                RowBox[{"Last", "[", "theta", "]"}], "^", "n"}]}]}]}], ";", 
            "\[IndentingNewLine]", "\t\t", 
            RowBox[{"result", "=", 
             RowBox[{"result", "+", 
              RowBox[{"rde", "*", 
               RowBox[{
                RowBox[{"Last", "[", "theta", "]"}], "^", "n"}]}]}]}]}]}], 
          "\[IndentingNewLine]", "\t", "]"}]}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", "degMin", ",", "degMax"}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Integration", " ", "of", " ", "the", " ", 
        RowBox[{"theta", "^", "0"}], " ", 
        RowBox[{"term", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"A0", "=", 
       RowBox[{"Together", "[", 
        RowBox[{"Cancel", "[", 
         RowBox[{"Expand", "[", 
          RowBox[{"poly", "-", "nonthetaterm"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"SameQ", "[", 
          RowBox[{"A0", ",", "0"}], "]"}]}], ",", "\[IndentingNewLine]", "\t", 
        RowBox[{"(*", " ", 
         RowBox[{"new", " ", "logarithms", " ", "are", " ", "permitted"}], 
         " ", "*)"}], "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"intA0", "=", 
          RowBox[{"RischInternal", "[", 
           RowBox[{"A0", ",", "theta", ",", "tower", ",", "Dtower", ",", 
            RowBox[{"\"\<ExtendThetas\>\"", "\[Rule]", "extendtheta"}], ",", 
            RowBox[{"\"\<RecursiveCall\>\"", "\[Rule]", "True"}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", "\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"SameQ", "[", 
            RowBox[{"intA0", ",", "$Failed"}], "]"}], ",", 
           RowBox[{"Throw", "[", "$Failed", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{"result", "=", 
          RowBox[{"result", "+", 
           RowBox[{"First", "[", "intA0", "]"}]}]}]}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"RischTrace", "[", 
       RowBox[{
       "RischExponentialPolynomial", ",", "result", ",", "\"\<Out\>\""}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Throw", "[", "result", "]"}]}]}], "\[IndentingNewLine]", "]"}],
    "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.3951928705034723`*^9, 3.395192889064303*^9}, {
   3.395986640080394*^9, 3.395986656357074*^9}, {3.3959867300109053`*^9, 
   3.395986917468807*^9}, {3.395986953727433*^9, 3.3959870114155283`*^9}, {
   3.3959870549494267`*^9, 3.39598716187449*^9}, {3.395987334622643*^9, 
   3.3959873395623827`*^9}, {3.395988312129849*^9, 3.395988359631399*^9}, {
   3.395988403258299*^9, 3.3959884940484743`*^9}, {3.395988530408917*^9, 
   3.395988540611969*^9}, {3.395988772645568*^9, 3.395988773621122*^9}, {
   3.395988875142898*^9, 3.395988922723728*^9}, {3.395988980338216*^9, 
   3.395989082847258*^9}, {3.395989609276457*^9, 3.3959896102738047`*^9}, {
   3.395989838003821*^9, 3.395989858186798*^9}, {3.395990112275049*^9, 
   3.395990126875306*^9}, {3.3959901971049633`*^9, 3.395990385380517*^9}, {
   3.395990518893099*^9, 3.3959905197323236`*^9}, {3.395990565164344*^9, 
   3.39599057367019*^9}, {3.395990641906559*^9, 3.395990644925807*^9}, 
   3.395990678868906*^9, {3.395990713006456*^9, 3.395990735132003*^9}, {
   3.395990861167523*^9, 3.395990866974222*^9}, {3.395990923078834*^9, 
   3.395990923471998*^9}, {3.395990966361815*^9, 3.3959909722435102`*^9}, {
   3.3959910304179277`*^9, 3.395991100190164*^9}, {3.395991154150386*^9, 
   3.39599116009505*^9}, {3.3959913360237083`*^9, 3.395991345407805*^9}, {
   3.395991510244114*^9, 3.395991517252943*^9}, {3.39599163406056*^9, 
   3.395991676595222*^9}, 3.39599171471074*^9, {3.3959917554821253`*^9, 
   3.3959917580579576`*^9}, {3.396000925228282*^9, 3.3960009274596233`*^9}, {
   3.3960010027259417`*^9, 3.396001025210248*^9}, {3.396002323663766*^9, 
   3.3960023299970512`*^9}, {3.396091178747899*^9, 3.396091190048609*^9}, {
   3.396091359999317*^9, 3.396091364534626*^9}, {3.3960918230758457`*^9, 
   3.396091836640356*^9}, {3.396091889086796*^9, 3.396091940992971*^9}, {
   3.396092923191951*^9, 3.3960929273209887`*^9}, {3.396320131250143*^9, 
   3.396320158583329*^9}, {3.3963253334184523`*^9, 3.3963253437732353`*^9}, {
   3.396325547551158*^9, 3.396325548009077*^9}, {3.3963296559857473`*^9, 
   3.396329660721219*^9}, {3.396329720207193*^9, 3.396329751639682*^9}, {
   3.396329818658206*^9, 3.39632991695583*^9}, {3.396330620027729*^9, 
   3.396330623914442*^9}, 3.396331274866764*^9, {3.396336370649012*^9, 
   3.396336398735203*^9}, {3.396336448211213*^9, 3.396336451886478*^9}, {
   3.39633653976919*^9, 3.39633655570389*^9}, {3.3963365946830072`*^9, 
   3.3963366254166594`*^9}, {3.39633674045846*^9, 3.396336750902788*^9}, {
   3.396336953613112*^9, 3.3963369571406717`*^9}, {3.396337170383307*^9, 
   3.396337172046844*^9}, {3.3963372927689257`*^9, 3.396337356679199*^9}, 
   3.3963373940389*^9, {3.3963376246389*^9, 3.3963376275279512`*^9}, {
   3.3963377748163967`*^9, 3.396337784363345*^9}, {3.396337872592476*^9, 
   3.396337897183177*^9}, {3.396337985296055*^9, 3.396337985438596*^9}, {
   3.396345267384392*^9, 3.3963452712199497`*^9}, {3.39634679674789*^9, 
   3.396346797883779*^9}, {3.396754801177526*^9, 3.396754805664667*^9}, {
   3.3967552775622396`*^9, 3.396755280184922*^9}, {3.396755315034873*^9, 
   3.3967553183531933`*^9}, {3.396756111259207*^9, 3.396756111401266*^9}, 
   3.396756739938301*^9, {3.3970173373606977`*^9, 3.397017352911374*^9}, {
   3.397018283736594*^9, 3.39701829130264*^9}, {3.3970183236921673`*^9, 
   3.397018339672818*^9}, {3.397018441402432*^9, 3.3970184428012953`*^9}, {
   3.3970185642198887`*^9, 3.397018599817733*^9}, {3.3970188193112707`*^9, 
   3.3970190235366783`*^9}, {3.3970190699059267`*^9, 3.397019071064419*^9}, {
   3.3970191553447857`*^9, 3.397019187846815*^9}, {3.397019869694439*^9, 
   3.397019882883236*^9}, {3.397021189275406*^9, 3.3970211895312653`*^9}, {
   3.397021309003611*^9, 3.397021394889407*^9}, {3.3970214592287703`*^9, 
   3.397021480860734*^9}, {3.397021516517366*^9, 3.397021543369213*^9}, {
   3.397021886736258*^9, 3.3970218947763367`*^9}, {3.397021956866618*^9, 
   3.397021957659234*^9}, {3.397022252980216*^9, 3.3970223986957197`*^9}, {
   3.397022864868135*^9, 3.397022875450828*^9}, {3.397023466408369*^9, 
   3.3970234737178383`*^9}, {3.397023530726385*^9, 3.3970235310213947`*^9}, 
   3.397572562076294*^9, {3.397792598100017*^9, 3.397792629138129*^9}, {
   3.397792903741805*^9, 3.397792905691107*^9}, {3.404029616685948*^9, 
   3.4040297405549297`*^9}, {3.404029770765595*^9, 3.4040297935100193`*^9}, {
   3.404029942565632*^9, 3.4040301084505*^9}, {3.404030168693955*^9, 
   3.4040302039579477`*^9}, {3.404030236998868*^9, 3.404030284638694*^9}, {
   3.4040303168627243`*^9, 3.4040303239007177`*^9}, {3.404030355691077*^9, 
   3.404030441623147*^9}, {3.404030477939719*^9, 3.404030486188382*^9}, {
   3.4040305231572037`*^9, 3.404030525515973*^9}, {3.404030562738912*^9, 
   3.4040306344194*^9}, {3.404030702070174*^9, 3.404030776693521*^9}, {
   3.4040310360977573`*^9, 3.404031071123865*^9}, {3.40471361595263*^9, 
   3.4047137136978407`*^9}, {3.4047138706632423`*^9, 
   3.4047138911647243`*^9}, {3.404960166593*^9, 3.4049602369561853`*^9}, {
   3.405148721036415*^9, 3.405148723812429*^9}, {3.4051487646484413`*^9, 
   3.405148784183077*^9}, {3.4051488281300297`*^9, 3.405148915790711*^9}, {
   3.407989938213126*^9, 3.4079900084423103`*^9}, {3.407990046890319*^9, 
   3.40799009525485*^9}, {3.4091251144836197`*^9, 3.409125119437291*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"RischExponentialPolynomial", "[", 
   RowBox[{
    FractionBox[
     SubscriptBox["\[Theta]", "1"], 
     RowBox[{"1", "+", 
      SubsuperscriptBox["\[Theta]", "1", "2"]}]], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", 
      RowBox[{"theta", "[", "1", "]"}], ",", 
      RowBox[{"theta", "[", "2", "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", 
      RowBox[{"rischExp", "[", 
       RowBox[{"x", " ", 
        RowBox[{"rischLog", "[", "2", "]"}]}], "]"}], ",", 
      RowBox[{"rischExp", "[", 
       RowBox[{"x", " ", 
        RowBox[{"rischLog", "[", "3", "]"}]}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", 
      RowBox[{
       RowBox[{"Log", "[", "2", "]"}], " ", 
       RowBox[{"theta", "[", "1", "]"}]}], ",", 
      RowBox[{
       RowBox[{"Log", "[", "3", "]"}], " ", 
       RowBox[{"theta", "[", "2", "]"}]}]}], "}"}], ",", "True"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"note", ":", " ", 
    RowBox[{"this", " ", "is", " ", "a", " ", "polynomial", " ", "wrt", " ", 
     RowBox[{"theta", "[", "2", "]"}], " ", "so", " ", 
     RowBox[{"it", "'"}], "s", " ", "calculated", " ", "using", " ", 
     "recursion"}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.409122300634618*^9, 3.409122387762477*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"ArcTan", "[", 
   SubscriptBox["\[Theta]", "1"], "]"}], 
  RowBox[{"Log", "[", "2", "]"}]]], "Output",
 CellChangeTimes->{3.409122310150378*^9, 3.4091223435276117`*^9, 
  3.4098229053888187`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RischExponentialPolynomial", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", 
       SuperscriptBox["x", "101"]], "-", 
      FractionBox["1", 
       RowBox[{"100", " ", "x"}]]}], ")"}], " ", 
    SubscriptBox["\[Theta]", "1"]}], "\[InvisibleSpace]", ",", 
   RowBox[{"{", "\[InvisibleSpace]", 
    RowBox[{"x", ",", 
     RowBox[{"theta", "[", "1", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"rischExp", "[", 
      RowBox[{
       RowBox[{"x", "^", "100"}], "/", "100"}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{
      RowBox[{"x", "^", "99"}], " ", 
      RowBox[{"theta", "[", "1", "]"}]}]}], "}"}], ",", "True"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.407988956006275*^9, 3.407989028980838*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   SubscriptBox["\[Theta]", "1"], 
   RowBox[{"100", " ", 
    SuperscriptBox["x", "100"]}]]}]], "Output",
 CellChangeTimes->{{3.407989012108005*^9, 3.407989030784651*^9}, {
   3.407989943138117*^9, 3.407990009884865*^9}, {3.40799005150471*^9, 
   3.407990096784588*^9}, 3.409054203892681*^9, 3.409822907106942*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"RischExponentialPolynomial", "[", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"4", " ", "x"}], "+", 
        RowBox[{"4", " ", 
         SuperscriptBox["x", "2"]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SubsuperscriptBox["\"\<\[Theta]\>\"", "1", "2"]}], ")"}]}], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", "x"}], ")"}], "2"]], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", 
      SubscriptBox["\"\<\[Theta]\>\"", "1"]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", 
      RowBox[{"rischExp", "[", 
       SuperscriptBox["x", "2"], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", 
      RowBox[{"2", " ", "x", " ", 
       SubscriptBox["\"\<\[Theta]\>\"", "1"]}]}], "}"}], ",", "True"}], "]"}], 
  RowBox[{"(*", " ", "fixed", " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.397018178652562*^9, 3.397018185637321*^9}, {
  3.39701908129692*^9, 3.3970190840318537`*^9}, {3.407990020055656*^9, 
  3.407990020685214*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "3"}], " ", "x"}], "-", 
  RowBox[{"4", " ", 
   RowBox[{"rischLog", "[", "x", "]"}]}], "+", 
  FractionBox[
   SubsuperscriptBox["\<\"\[Theta]\"\>", "1", "2"], 
   RowBox[{"1", "+", "x"}]]}]], "Output",
 CellChangeTimes->{
  3.4040304877484217`*^9, 3.404030527003025*^9, {3.4040305848692102`*^9, 
   3.404030636344658*^9}, {3.4040307636672497`*^9, 3.404030778084594*^9}, {
   3.404030833384699*^9, 3.404030847758613*^9}, 3.4040309753448877`*^9, 
   3.4040310388781652`*^9, 3.404031073555887*^9, {3.407990013716378*^9, 
   3.407990021152151*^9}, {3.407990053213019*^9, 3.407990097270903*^9}, 
   3.409054204779554*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RischExponentialPolynomial", "[", 
  RowBox[{
   RowBox[{
    FractionBox["\[ImaginaryI]", 
     RowBox[{"4", " ", 
      SubscriptBox["\"\<\[Theta]\>\"", "1"], " ", 
      SubscriptBox["\"\<\[Theta]\>\"", "2"]}]], "-", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", 
      SubscriptBox["\"\<\[Theta]\>\"", "1"]}], 
     RowBox[{"4", " ", 
      SubscriptBox["\"\<\[Theta]\>\"", "2"]}]], "+", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", 
      SubscriptBox["\"\<\[Theta]\>\"", "2"]}], 
     RowBox[{"4", " ", 
      SubscriptBox["\"\<\[Theta]\>\"", "1"]}]], "-", 
    RowBox[{
     FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
     SubscriptBox["\"\<\[Theta]\>\"", "1"], " ", 
     SubscriptBox["\"\<\[Theta]\>\"", "2"]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     SubscriptBox["\"\<\[Theta]\>\"", "1"], ",", 
     SubscriptBox["\"\<\[Theta]\>\"", "2"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"rischExp", "[", 
      RowBox[{"\[ImaginaryI]", " ", "x"}], "]"}], ",", 
     RowBox[{"rischExp", "[", 
      RowBox[{
       FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", 
          SubscriptBox["\"\<\[Theta]\>\"", "1"]], "+", 
         SubscriptBox["\"\<\[Theta]\>\"", "1"]}], ")"}]}], "]"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"\[ImaginaryI]", " ", 
      SubscriptBox["\"\<\[Theta]\>\"", "1"]}], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SubsuperscriptBox["\"\<\[Theta]\>\"", "1", "2"]}], ")"}], " ", 
        SubscriptBox["\"\<\[Theta]\>\"", "2"]}], 
       RowBox[{"2", " ", 
        SubscriptBox["\"\<\[Theta]\>\"", "1"]}]]}]}], "}"}], ",", "True"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.396754778740965*^9, 3.396754781819469*^9}, {
  3.4079901018391953`*^9, 3.407990102390955*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox["\[ImaginaryI]", 
    RowBox[{"2", " ", 
     SubscriptBox["\<\"\[Theta]\"\>", "2"]}]]}], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    SubscriptBox["\<\"\[Theta]\"\>", "2"]}], "2"]}]], "Output",
 CellChangeTimes->{3.40403107434402*^9, 3.407990102841236*^9, 
  3.4090542053169928`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RischExponentialPolynomial", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     FractionBox["5", "16"]}], "+", 
    FractionBox["1", 
     RowBox[{"64", " ", 
      SuperscriptBox[
       RowBox[{"theta", "[", "1", "]"}], "6"]}]], "-", 
    FractionBox["3", 
     RowBox[{"32", " ", 
      SuperscriptBox[
       RowBox[{"theta", "[", "1", "]"}], "4"]}]], "+", 
    FractionBox["15", 
     RowBox[{"64", " ", 
      SuperscriptBox[
       RowBox[{"theta", "[", "1", "]"}], "2"]}]], "+", 
    FractionBox[
     RowBox[{"15", " ", 
      SuperscriptBox[
       RowBox[{"theta", "[", "1", "]"}], "2"]}], "64"], "-", 
    FractionBox[
     RowBox[{"3", " ", 
      SuperscriptBox[
       RowBox[{"theta", "[", "1", "]"}], "4"]}], "32"], "+", 
    FractionBox[
     SuperscriptBox[
      RowBox[{"theta", "[", "1", "]"}], "6"], "64"]}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"theta", "[", "1", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"rischExp", "[", 
      RowBox[{"-", "x"}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"-", 
      RowBox[{"theta", "[", "1", "]"}]}]}], "}"}], ",", "True"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.39632538494687*^9, 3.396325512853594*^9}, {
  3.407990107263996*^9, 3.40799010786198*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{"5", " ", "x"}], "16"]}], "+", 
  FractionBox["1", 
   RowBox[{"384", " ", 
    SubsuperscriptBox["\[Theta]", "1", "6"]}]], "-", 
  FractionBox["3", 
   RowBox[{"128", " ", 
    SubsuperscriptBox["\[Theta]", "1", "4"]}]], "+", 
  FractionBox["15", 
   RowBox[{"128", " ", 
    SubsuperscriptBox["\[Theta]", "1", "2"]}]], "-", 
  FractionBox[
   RowBox[{"15", " ", 
    SubsuperscriptBox["\[Theta]", "1", "2"]}], "128"], "+", 
  FractionBox[
   RowBox[{"3", " ", 
    SubsuperscriptBox["\[Theta]", "1", "4"]}], "128"], "-", 
  FractionBox[
   SubsuperscriptBox["\[Theta]", "1", "6"], "384"]}]], "Output",
 CellChangeTimes->{
  3.3963253961539583`*^9, 3.396325487972063*^9, 3.396325539277165*^9, 
   3.396326316974753*^9, 3.396329754998808*^9, 3.396329821098709*^9, {
   3.396329918369396*^9, 3.39632995036403*^9}, {3.3963365461056423`*^9, 
   3.396336564673705*^9}, {3.396336627737424*^9, 3.3963366518380737`*^9}, 
   3.396336688941545*^9, 3.396336760389572*^9, 3.396336959417123*^9, 
   3.396337144728959*^9, 3.396337174963673*^9, 3.396337312184285*^9, 
   3.396337359536193*^9, 3.3963373961886787`*^9, 3.396337601910512*^9, 
   3.396337989144815*^9, 3.396754674661518*^9, 3.404031078554101*^9, 
   3.4079901083988953`*^9, 3.409054205859333*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RischExponentialPolynomial", "[", 
  RowBox[{"1", ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"theta", "[", "1", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"rischExp", "[", "x", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"theta", "[", "1", "]"}]}], "}"}], ",", "True"}], "]"}]], "Input",
 CellChangeTimes->{{3.395990534527212*^9, 3.3959905553254423`*^9}, {
  3.3959917447166986`*^9, 3.3959917494977427`*^9}, {3.4079901133185873`*^9, 
  3.407990113876087*^9}}],

Cell[BoxData["x"], "Output",
 CellChangeTimes->{{3.396337361700439*^9, 3.3963373662194347`*^9}, 
   3.396337396955826*^9, 3.396337603182764*^9, 3.396337989999907*^9, 
   3.404031079380425*^9, {3.40799011106144*^9, 3.4079901142423058`*^9}, 
   3.409054206722186*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RischExponentialPolynomial", "[", 
  RowBox[{
   FractionBox[
    RowBox[{"3", " ", 
     SuperscriptBox[
      RowBox[{"theta", "[", "1", "]"}], "4"]}], "32"], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"theta", "[", "1", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"rischExp", "[", "x", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"theta", "[", "1", "]"}]}], "}"}], ",", "True"}], "]"}]], "Input",
 CellChangeTimes->{{3.3963200358168364`*^9, 3.396320067055094*^9}, {
  3.40799012822042*^9, 3.407990128772667*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"3", " ", 
   SubsuperscriptBox["\[Theta]", "1", "4"]}], "128"]], "Output",
 CellChangeTimes->{
  3.396320068345068*^9, 3.396320137059667*^9, 3.3963201923233852`*^9, 
   3.396326318340105*^9, {3.396336931107369*^9, 3.396336937027918*^9}, {
   3.396337382004779*^9, 3.396337397647203*^9}, 3.396337990502968*^9, 
   3.404031080112645*^9, 3.407990129254511*^9, 3.409054207272441*^9}]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["The Risch Differential Equation", "Section",
 CellChangeTimes->{{3.39129836226175*^9, 3.391298367058625*^9}}],

Cell[CellGroupData[{

Cell["Main Algorithm", "Subsection",
 CellChangeTimes->{{3.395192863079492*^9, 3.395192865510021*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RischDE", "::", "warning"}], " ", "=", " ", 
   "\"\<Integral not elementary - Risch DE: y' + `1` y = `2` has no solution.\
\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.391300704246125*^9, 3.39130072944925*^9}, {
   3.391300771089875*^9, 3.391300847168*^9}, 3.391303089121125*^9, {
   3.391303838418*^9, 3.391303839621125*^9}, {3.39583612011675*^9, 
   3.395836150549473*^9}, {3.3960035300487823`*^9, 3.3960035372002487`*^9}, {
   3.396003619224928*^9, 3.396003642544252*^9}, {3.3976093051325073`*^9, 
   3.3976093080619173`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RischDE", "[", 
   RowBox[{
   "f_", ",", "g_", ",", "inTheta_", ",", "inTower_", ",", "inDtower_"}], 
   "]"}], ":=", 
  RowBox[{"Catch", "[", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "theta", ",", "tower", ",", "Dtower", ",", "q", ",", "fbar", ",", 
       "gbar", ",", "rischden", ",", "a", ",", "b", ",", "c", ",", "den", ",",
        "n", ",", "beta", ",", "num", ",", "result"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"RischTrace", "[", 
       RowBox[{"RischDE", ",", 
        RowBox[{"{", 
         RowBox[{
         "f", ",", "g", ",", "inTheta", ",", "inTower", ",", "inDtower"}], 
         "}"}], ",", "\"\<In\>\""}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "Solve", " ", "the", " ", "Risch", " ", "differential", " ", 
         "equation", " ", "using", " ", 
         RowBox[{"Davenport", "'"}], "s", " ", "weak", " ", "normalisation"}],
         ",", " ", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Bronstein", "'"}], "s", " ", "fast", " ", "reduction", " ", 
         "for", " ", "computing", " ", "the", " ", "denominator", " ", "and", 
         " ", 
         RowBox[{"Rothstein", "'"}], "s", "\[IndentingNewLine]", "special", 
         " ", "polynomial", " ", "differential", " ", "equation", " ", 
         RowBox[{"algorithm", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"update", " ", "the", " ", "extension", " ", "field"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"theta", ",", "tower", ",", "Dtower"}], "}"}], "=", 
       RowBox[{"UpdateExtensionField", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"f", ",", "g"}], "}"}], ",", "inTheta", ",", "inTower", ",",
          "inDtower"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "Test", " ", "if", " ", "f", " ", "is", " ", "weakly", " ", 
         "normalised", " ", "wrt", " ", "x"}], ",", " ", 
        RowBox[{
        "otherwise", " ", "adding", " ", "an", " ", "appropriate", " ", 
         "\[IndentingNewLine]", "logarithmic", " ", "derivative", " ", "to", 
         " ", "f", " ", "makes", " ", "it", " ", "weakly", " ", 
         RowBox[{"normalised", "."}]}]}], "  ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"q", "=", 
       RowBox[{"WeakNormalizer", "[", 
        RowBox[{
         RowBox[{"Together", "[", "f", "]"}], ",", "theta", ",", "Dtower"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"fbar", "=", 
       RowBox[{"Cancel", "[", 
        RowBox[{"Together", "[", 
         RowBox[{"f", "-", 
          RowBox[{
           RowBox[{"TotalDerivation", "[", 
            RowBox[{"q", ",", "theta", ",", "Dtower"}], "]"}], "/", "q"}]}], 
         "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gbar", "=", 
       RowBox[{"Cancel", "[", 
        RowBox[{"Together", "[", 
         RowBox[{"q", "*", "g"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "If", " ", "fbar", " ", "and", " ", "gbar", " ", "are", " ", 
        "constant", " ", "then", " ", "trivial", " ", "solution"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Which", "[", "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"MatchQ", "[", 
          RowBox[{"gbar", ",", "0"}], "]"}], "&&", 
         RowBox[{"And", "@@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"FreeQ", "[", 
              RowBox[{"fbar", ",", "#"}], "]"}], "&"}], "/@", "theta"}], 
           ")"}]}]}], ",", "\[IndentingNewLine]", "\t\t\t", 
        RowBox[{"Throw", "[", "0", "]"}], ",", "\[IndentingNewLine]", "\t\t", 
        RowBox[{
         RowBox[{"And", "@@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"FreeQ", "[", 
              RowBox[{"fbar", ",", "#"}], "]"}], "&"}], "/@", "theta"}], 
           ")"}]}], "&&", 
         RowBox[{"And", "@@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"FreeQ", "[", 
              RowBox[{"gbar", ",", "#"}], "]"}], "&"}], "/@", "theta"}], 
           ")"}]}]}], ",", "\[IndentingNewLine]", "\t\t\t", 
        RowBox[{"Throw", "[", 
         RowBox[{"g", "/", "f"}], "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Compute", " ", "the", " ", "denominator", " ", "of", " ", "the", " ", 
        RowBox[{"solution", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"rischden", "=", 
       RowBox[{"RDENormalDenominator", "[", 
        RowBox[{"fbar", ",", "gbar", ",", "theta", ",", "Dtower"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"rischden", " ", "===", " ", "$Failed"}], ",", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"RischDE", "::", "warning"}], ",", "f", ",", "g"}], "]"}], 
         ";", "\[IndentingNewLine]", "\t\t", 
         RowBox[{"RischTrace", "[", 
          RowBox[{"RischDE", ",", "$Failed", ",", "\"\<Out\>\""}], "]"}], ";",
          "\[IndentingNewLine]", "\t\t", 
         RowBox[{"Throw", "[", "$Failed", "]"}]}], ",", "\[IndentingNewLine]",
         "\t\t", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"a", ",", "b", ",", "c", ",", "den"}], "}"}], "=", 
          "rischden"}], ";", "\[IndentingNewLine]", "\t\t", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"We", " ", "need", " ", "this", " ", "cancellation"}], ",",
            " ", 
           RowBox[{"try", " ", 
            RowBox[{"Risch", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Exp", "[", 
                RowBox[{"1", "/", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"x", "^", "2"}], "-", "1"}], ")"}]}], "]"}], "/", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"x", "-", "1"}], ")"}], "^", "2"}]}], ",", " ", 
              "x"}], "]"}]}]}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"a", ",", "b", ",", "c"}], "}"}], "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Cancel", "[", "a", "]"}], ",", 
            RowBox[{"Cancel", "[", "b", "]"}], ",", 
            RowBox[{"Cancel", "[", "c", "]"}]}], "}"}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Bound", " ", "the", " ", "degree", " ", "of", " ", "the", " ", 
        RowBox[{"solution", "'"}], "s", " ", 
        RowBox[{"numerator", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Which", "[", "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"Head", "[", 
          RowBox[{"Last", "[", "tower", "]"}], "]"}], "===", "rischLog"}], 
        ",", "\[IndentingNewLine]", "\t\t\t", 
        RowBox[{"n", "=", 
         RowBox[{"PolyDEPrimitiveCase", "[", 
          RowBox[{
          "a", ",", "b", ",", "c", ",", "theta", ",", "tower", ",", 
           "Dtower"}], "]"}]}], ",", "\[IndentingNewLine]", "\t\t", 
        RowBox[{
         RowBox[{"Head", "[", 
          RowBox[{"Last", "[", "tower", "]"}], "]"}], "===", "rischExp"}], 
        ",", "\[IndentingNewLine]", "\t\t\t", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a", ",", "b", ",", "c", ",", "n", ",", "beta"}], "}"}], 
         "=", 
         RowBox[{"PolyDEExponentialCase", "[", 
          RowBox[{
          "a", ",", "b", ",", "c", ",", "theta", ",", "tower", ",", 
           "Dtower"}], "]"}]}], ",", "\[IndentingNewLine]", "\t\t", "True", 
        ",", "\[IndentingNewLine]", "\t\t\t", 
        RowBox[{"n", "=", 
         RowBox[{"PolyDEBaseCase", "[", 
          RowBox[{"a", ",", "b", ",", "c", ",", "theta"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"SameQ", "[", 
         RowBox[{"n", ",", "0"}], "]"}], ",", 
        RowBox[{"n", "=", "1"}]}], "]"}], ";", 
      RowBox[{"(*", " ", 
       RowBox[{"HACK", " ", "HACK", " ", "HACK"}], " ", "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"n", "<", "0"}], ",", "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"RischDE", "::", "warning"}], ",", "f", ",", "g"}], "]"}], 
         ";", "\[IndentingNewLine]", "\t", 
         RowBox[{"RischTrace", "[", 
          RowBox[{"RischDE", ",", "$Failed", ",", "\"\<Out\>\""}], "]"}], ";",
          "\[IndentingNewLine]", "\t", 
         RowBox[{"Throw", "[", "$Failed", "]"}]}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Solve", " ", "the", " ", "polynomial", " ", "form", " ", "of", " ", 
        "the", " ", "DE"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"num", "=", 
       RowBox[{"SPDE", "[", 
        RowBox[{
        "a", ",", "b", ",", "c", ",", "n", ",", "theta", ",", "tower", ",", 
         "Dtower"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"return", " ", "solution"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"num", "===", "$Failed"}], ",", " ", "\[IndentingNewLine]", 
        "\t\t", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"RischDE", "::", "warning"}], ",", "f", ",", "g"}], "]"}], 
         ";", "\[IndentingNewLine]", "\t\t", 
         RowBox[{"result", "=", "$Failed"}]}], ",", "\[IndentingNewLine]", 
        "\t", 
        RowBox[{
         RowBox[{"Head", "[", 
          RowBox[{"Last", "[", "tower", "]"}], "]"}], "===", "rischLog"}], 
        ",", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"result", "=", 
         RowBox[{
          RowBox[{"num", "/", 
           RowBox[{"(", 
            RowBox[{"den", " ", "q"}], ")"}]}], "//", "Cancel"}]}], ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"Head", "[", 
          RowBox[{"Last", "[", "tower", "]"}], "]"}], "===", "rischExp"}], 
        ",", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"result", "=", 
         RowBox[{
          RowBox[{"Expand", "[", 
           RowBox[{"Cancel", "[", 
            RowBox[{"(", 
             RowBox[{"num", "/", 
              RowBox[{"(", 
               RowBox[{"den", "*", "q"}], ")"}]}], ")"}], "]"}], "]"}], "*", 
          SuperscriptBox[
           RowBox[{"Last", "[", "theta", "]"}], "beta"]}]}], ",", 
        "\[IndentingNewLine]", "\t", "True", ",", "\[IndentingNewLine]", 
        "\t\t", 
        RowBox[{"result", "=", 
         RowBox[{"num", "/", 
          RowBox[{"(", 
           RowBox[{"den", " ", "q"}], ")"}]}]}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"RischTrace", "[", 
       RowBox[{"RischDE", ",", "result", ",", "\"\<Out\>\""}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Throw", "[", "result", "]"}]}]}], "\[IndentingNewLine]", "]"}],
    "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.3945949738594313`*^9, 3.394595051782463*^9}, {
   3.394595085550652*^9, 3.394595248225998*^9}, {3.394595292716661*^9, 
   3.394595506781992*^9}, {3.3945962810094*^9, 3.394596287054534*^9}, {
   3.394596516803521*^9, 3.394596546729219*^9}, {3.3945965843387947`*^9, 
   3.394596593626191*^9}, {3.394596704884308*^9, 3.3945967065305443`*^9}, {
   3.394596761939785*^9, 3.394596764610138*^9}, {3.394597408853004*^9, 
   3.3945974550087557`*^9}, {3.394598293798337*^9, 3.394598312261528*^9}, {
   3.394598346392394*^9, 3.394598392918358*^9}, {3.3945985883728867`*^9, 
   3.394598596603153*^9}, {3.394600011197341*^9, 3.3946000206212254`*^9}, {
   3.3946005516397743`*^9, 3.3946005543563643`*^9}, {3.394600595023368*^9, 
   3.394600628158318*^9}, {3.394612134290251*^9, 3.394612166017872*^9}, {
   3.394612201201457*^9, 3.39461224547243*^9}, {3.394612285679694*^9, 
   3.394612350716303*^9}, {3.39461238280541*^9, 3.394612461007112*^9}, {
   3.394612510448392*^9, 3.394612620904867*^9}, {3.394612660652514*^9, 
   3.3946127053463593`*^9}, {3.3946128077385187`*^9, 3.394612818784246*^9}, {
   3.394613224965119*^9, 3.3946132300840673`*^9}, {3.394613814463663*^9, 
   3.394613816671116*^9}, {3.394613897789628*^9, 3.3946139019163847`*^9}, {
   3.394613938836967*^9, 3.394613941804736*^9}, {3.394859934404395*^9, 
   3.394859976667035*^9}, {3.3948601981583557`*^9, 3.3948601996614943`*^9}, {
   3.3948607383501577`*^9, 3.39486073879812*^9}, {3.394860866824781*^9, 
   3.394860880480201*^9}, {3.39486150342997*^9, 3.394861507820816*^9}, {
   3.394862147050831*^9, 3.394862154455717*^9}, {3.394862243095076*^9, 
   3.39486224395645*^9}, {3.3948642112671537`*^9, 3.394864216193962*^9}, {
   3.394868265933174*^9, 3.394868273155756*^9}, {3.3948796394024353`*^9, 
   3.39487964215978*^9}, 3.3949752003143*^9, {3.394975237975048*^9, 
   3.394975268470283*^9}, {3.3949752988110847`*^9, 3.394975307424988*^9}, {
   3.3949753891164093`*^9, 3.39497540609765*^9}, {3.394975566889411*^9, 
   3.3949755712141*^9}, {3.394975720010419*^9, 3.39497573180191*^9}, {
   3.3949761647584248`*^9, 3.394976323264599*^9}, {3.3949764071526613`*^9, 
   3.394976407854241*^9}, {3.3958340953350487`*^9, 3.395834123760395*^9}, {
   3.395834191868949*^9, 3.3958342386068163`*^9}, {3.395834338328558*^9, 
   3.3958343757264223`*^9}, {3.395834433453677*^9, 3.3958344877178802`*^9}, {
   3.395834712530941*^9, 3.395834716746681*^9}, {3.395834822529582*^9, 
   3.395834841162442*^9}, {3.395834914074832*^9, 3.395834958329653*^9}, {
   3.3958349984727488`*^9, 3.395835003047477*^9}, {3.395835046534565*^9, 
   3.3958351171397963`*^9}, {3.395835337687274*^9, 3.395835348951192*^9}, {
   3.395835528428076*^9, 3.395835532058485*^9}, {3.39583557435804*^9, 
   3.395835581336731*^9}, 3.3958356689551992`*^9, {3.395836305613399*^9, 
   3.395836319825095*^9}, {3.395836361637652*^9, 3.3958364056355133`*^9}, {
   3.395836857314399*^9, 3.3958369046133738`*^9}, {3.3958369417897873`*^9, 
   3.3958369423011847`*^9}, {3.3958372815898247`*^9, 3.395837301686314*^9}, {
   3.395837378276567*^9, 3.395837397092371*^9}, {3.3958386847845793`*^9, 
   3.3958387016216087`*^9}, {3.395838800813754*^9, 3.3958388185096684`*^9}, {
   3.3958388566924343`*^9, 3.3958389277731457`*^9}, {3.395839133441498*^9, 
   3.39583913616696*^9}, {3.395839344980647*^9, 3.395839398315271*^9}, {
   3.395839636686277*^9, 3.39583965044913*^9}, {3.395894407675684*^9, 
   3.395894451026202*^9}, {3.3958945254056387`*^9, 3.395894565977826*^9}, {
   3.395894626062051*^9, 3.395894673900675*^9}, {3.39591617166918*^9, 
   3.395916188604393*^9}, {3.395916355643631*^9, 3.395916383664007*^9}, {
   3.395916425179799*^9, 3.395916476160046*^9}, {3.395916807480795*^9, 
   3.395916807807806*^9}, 3.395917224906537*^9, {3.3959176278785477`*^9, 
   3.395917679275667*^9}, {3.395918271484352*^9, 3.395918289091748*^9}, {
   3.395994048790373*^9, 3.395994063160707*^9}, {3.3959970232575703`*^9, 
   3.3959970364392967`*^9}, {3.395997350476076*^9, 3.395997439976403*^9}, {
   3.395997684914804*^9, 3.3959977548285627`*^9}, {3.3959999027258377`*^9, 
   3.395999908413638*^9}, {3.3960000744998627`*^9, 3.3960001061316347`*^9}, {
   3.396000316543405*^9, 3.3960003261025867`*^9}, {3.3960035419668903`*^9, 
   3.396003549220462*^9}, {3.3960036496650352`*^9, 3.396003655044095*^9}, {
   3.396092020868037*^9, 3.396092097069385*^9}, {3.396092211171248*^9, 
   3.396092217971713*^9}, {3.396097198583456*^9, 3.396097277230712*^9}, {
   3.3960973158795652`*^9, 3.396097342694962*^9}, {3.396097381647484*^9, 
   3.396097438275771*^9}, {3.396097523833577*^9, 3.396097551257041*^9}, {
   3.39609764494179*^9, 3.396097665621975*^9}, {3.396097767946459*^9, 
   3.396097804539558*^9}, {3.3961755928537817`*^9, 3.396175594123164*^9}, 
   3.3961811858066683`*^9, {3.396181502256049*^9, 3.396181505130824*^9}, 
   3.396182016285199*^9, {3.396267083349053*^9, 3.396267085835966*^9}, {
   3.396267176624816*^9, 3.396267204136044*^9}, {3.396268086905652*^9, 
   3.396268091345009*^9}, {3.396416354505344*^9, 3.396416354606223*^9}, {
   3.3965892094294243`*^9, 3.396589213500787*^9}, {3.396614222272152*^9, 
   3.396614223327297*^9}, {3.397727162935753*^9, 3.397727165351883*^9}, {
   3.399381708007268*^9, 3.399381716235414*^9}, {3.401090343829851*^9, 
   3.40109034593855*^9}, {3.401090435779269*^9, 3.401090437280274*^9}, {
   3.401090640548452*^9, 3.401090676500173*^9}, {3.401091352525004*^9, 
   3.401091377802939*^9}, {3.401872702033308*^9, 3.4018727066084967`*^9}, {
   3.4018730501244373`*^9, 3.401873055459077*^9}, {3.401956487783359*^9, 
   3.401956523888585*^9}, 3.404546995263762*^9, {3.4045481163944187`*^9, 
   3.4045481166928062`*^9}, {3.4047146117970543`*^9, 
   3.4047146405012197`*^9}, {3.404714681068922*^9, 3.4047147091058607`*^9}, {
   3.404714754445077*^9, 3.404714754788803*^9}, {3.4047147965519457`*^9, 
   3.404714841316614*^9}, {3.404715000558977*^9, 3.404715182083453*^9}, {
   3.404960380651504*^9, 3.4049605733876047`*^9}, {3.4080020358750887`*^9, 
   3.408002036962076*^9}, {3.408867420651271*^9, 3.4088674252092323`*^9}, {
   3.409015198963955*^9, 3.409015213644185*^9}, {3.409015249766603*^9, 
   3.409015263816588*^9}, {3.4090153112220173`*^9, 3.4090153159716988`*^9}, {
   3.4090153495563993`*^9, 3.409015372942733*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RischDE", "[", 
  RowBox[{
   RowBox[{"-", 
    FractionBox["1", 
     RowBox[{"x", " ", 
      SubsuperscriptBox["\[Theta]", "1", "2"]}]]}], ",", 
   FractionBox["1", 
    RowBox[{"x", " ", 
     SubsuperscriptBox["\[Theta]", "1", "3"]}]], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"theta", "[", "1", "]"}], ",", 
     RowBox[{"theta", "[", "2", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"rischLog", "[", "x", "]"}], ",", 
     RowBox[{"rischExp", "[", 
      RowBox[{"1", "/", 
       RowBox[{"theta", "[", "1", "]"}]}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"1", "/", "x"}], ",", 
     RowBox[{"-", 
      FractionBox[
       SubscriptBox["\[Theta]", "2"], 
       RowBox[{"x", " ", 
        SubsuperscriptBox["\[Theta]", "1", "2"]}]]}]}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.409200018002911*^9, 3.409200070569264*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"-", "1"}], "+", 
   SubscriptBox["\[Theta]", "1"]}], 
  SubscriptBox["\[Theta]", "1"]]], "Output",
 CellChangeTimes->{
  3.409200073204739*^9, {3.4092015498992987`*^9, 3.409201569155752*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RischDE", "[", 
  RowBox[{
   FractionBox[
    RowBox[{"1", "-", "x"}], 
    RowBox[{"1", "+", "x"}]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{"-", "x"}], "-", 
     SuperscriptBox["x", "2"], "-", 
     RowBox[{"4", " ", 
      SuperscriptBox["x", "3"]}], "-", 
     RowBox[{"3", " ", 
      SuperscriptBox["x", "4"]}], "-", 
     SuperscriptBox["x", "5"]}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", "x"}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", "x", "+", 
        SuperscriptBox["x", "4"]}], ")"}], "2"]}]], ",", 
   RowBox[{"{", "x", "}"}], ",", 
   RowBox[{"{", "x", "}"}], ",", 
   RowBox[{"{", "1", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.3959161936805162`*^9, 3.395916193797023*^9}, {
  3.39591623857929*^9, 3.395916240557123*^9}, {3.3959163122313757`*^9, 
  3.3959163447894983`*^9}, {3.39591737410929*^9, 3.3959174018525867`*^9}, {
  3.395917444118744*^9, 3.395917444829761*^9}, {3.395917520534552*^9, 
  3.395917522632901*^9}, {3.395979523883052*^9, 3.395979550808103*^9}, {
  3.409127018310861*^9, 3.409127018910163*^9}}],

Cell[BoxData[
 FractionBox["1", 
  RowBox[{"1", "+", "x", "+", 
   SuperscriptBox["x", "4"]}]]], "Output",
 CellChangeTimes->{
  3.401880070570105*^9, 3.401956544418523*^9, 3.40454698656602*^9, 
   3.404985113886403*^9, 3.4079878309702806`*^9, {3.409015278325468*^9, 
   3.40901529070529*^9}, 3.409015321307457*^9, 3.4090153776798973`*^9, 
   3.4090438693967323`*^9, {3.409127012562409*^9, 3.409127019803288*^9}, 
   3.409199685040353*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"RischDE", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "1"}], "/", 
     SuperscriptBox["x", "2"]}], ",", 
    FractionBox[
     RowBox[{"x", "+", "1"}], 
     SuperscriptBox["x", "4"]], ",", 
    RowBox[{"{", "x", "}"}], ",", 
    RowBox[{"{", "x", "}"}], ",", 
    RowBox[{"{", "1", "}"}]}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"problem", " ", "from", " ", "project"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.394859832686552*^9, 3.394859850731655*^9}, {
  3.394864367643054*^9, 3.394864374305667*^9}, {3.3950034199460497`*^9, 
  3.395003422895132*^9}, {3.395979589435113*^9, 3.395979591911409*^9}, {
  3.3959796644289722`*^9, 3.395979668709114*^9}, {3.4091270226643744`*^9, 
  3.409127023293635*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"-", "1"}], "+", "x", "-", 
   SuperscriptBox["x", "2"]}], 
  SuperscriptBox["x", "2"]]], "Output",
 CellChangeTimes->{
  3.40901538552592*^9, 3.409043869845903*^9, {3.409127013378148*^9, 
   3.4091270239789343`*^9}, 3.4091996855037003`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"RischDE", "[", 
   RowBox[{
    RowBox[{"1", "+", 
     RowBox[{"5", "/", "x"}]}], ",", "1", ",", 
    RowBox[{"{", "x", "}"}], ",", 
    RowBox[{"{", "x", "}"}], ",", 
    RowBox[{"{", "1", "}"}]}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"bug", ":", " ", 
    RowBox[{
    "I", " ", "think", " ", "there", " ", "is", " ", "a", " ", "problem", " ",
      "with", " ", "the", " ", "weak", " ", "normalisation", " ", "of", " ", 
     "this", " ", "one", " ", "as", " ", "the", " ", "solution", " ", 
     "should", " ", "be", " ", "the", " ", "same", " ", "as", " ", 
     RowBox[{"(", 
      RowBox[{"1", "/", 
       RowBox[{"x", "^", "5"}]}], ")"}], 
     RowBox[{
      RowBox[{"RischDE", "[", 
       RowBox[{"1", ",", 
        SuperscriptBox["x", "5"], ",", 
        RowBox[{"{", "x", "}"}], ",", 
        RowBox[{"{", "x", "}"}], ",", 
        RowBox[{"{", "1", "}"}]}], "]"}], ".", " ", "FIXED"}], " ", "with", 
     " ", "changes", " ", "to", " ", "WeakNormalizer"}]}], " ", 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.397725117225532*^9, 3.397725129753747*^9}, {
  3.397725635499811*^9, 3.3977256373466167`*^9}, {3.3977257924114847`*^9, 
  3.3977258280654593`*^9}, {3.397727208013879*^9, 3.397727216580162*^9}, {
  3.4079878500630293`*^9, 3.407987850868885*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"-", "120"}], "+", 
   RowBox[{"120", " ", "x"}], "-", 
   RowBox[{"60", " ", 
    SuperscriptBox["x", "2"]}], "+", 
   RowBox[{"20", " ", 
    SuperscriptBox["x", "3"]}], "-", 
   RowBox[{"5", " ", 
    SuperscriptBox["x", "4"]}], "+", 
   SuperscriptBox["x", "5"]}], 
  SuperscriptBox["x", "5"]]], "Output",
 CellChangeTimes->{
  3.397725131234779*^9, 3.397725833876288*^9, 3.397727190813794*^9, 
   3.40188007416916*^9, 3.401956545976267*^9, {3.404715205680441*^9, 
   3.404715220145615*^9}, 3.404985134582111*^9, 3.407987842846591*^9, 
   3.4090153924075603`*^9, 3.4090154246123343`*^9, 3.409043870327217*^9, 
   3.409127031133231*^9, 3.409199686236061*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Weak Normalisation", "Subsection",
 CellChangeTimes->{{3.3912985932305*^9, 3.391298601527375*^9}, {
  3.391299896058625*^9, 3.391299899621125*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"WeakNormalizer", "[", 
   RowBox[{"f_", ",", "theta_", ",", "Dtower_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "dn", ",", "ds", ",", "g", ",", "dstar", ",", "d1", ",", "Dd1", ",", "a",
       ",", "b", " ", ",", "res", ",", "roots", ",", "PIR", ",", "result", 
      ",", "Risch`z"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"RischTrace", "[", 
      RowBox[{"WeakNormalizer", ",", 
       RowBox[{"{", 
        RowBox[{"f", ",", "theta", ",", "Dtower"}], "}"}], ",", 
       "\"\<In\>\""}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Weak", " ", "normalisation"}], ",", " ", 
       RowBox[{"reference", ":", " ", 
        RowBox[{"Symbolic", " ", "Integration", " ", "1"}]}], ",", " ", 
       RowBox[{"Bronstein", " ", "p", ".183"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Given", " ", "a", " ", "derivation", " ", "D", " ", "on", " ", 
        RowBox[{"k", "[", "t", "]"}], " ", "and", " ", "f", " ", "in", " ", 
        "k", 
        RowBox[{"(", "t", ")"}]}], ",", " ", 
       RowBox[{
        RowBox[{"return", " ", "q", " ", "in", " ", 
         RowBox[{"k", "[", "t", "]"}], " ", "such", " ", "that", 
         "\[IndentingNewLine]", "f"}], " ", "-", " ", 
        RowBox[{
         RowBox[{"Dq", "/", "q"}], " ", "is", " ", "weakly", " ", 
         "normalised", " ", "with", " ", "respect", " ", "to", " ", 
         RowBox[{"t", "."}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"dn", ",", "ds"}], "}"}], "=", 
      RowBox[{"SplitFactor", "[", 
       RowBox[{
        RowBox[{"Denominator", "[", "f", "]"}], ",", "theta", ",", "Dtower"}],
        "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"g", "=", 
      RowBox[{"PolynomialGCD", "[", 
       RowBox[{"dn", ",", 
        RowBox[{"D", "[", 
         RowBox[{"dn", ",", 
          RowBox[{"Last", "[", "theta", "]"}]}], "]"}]}], " ", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dstar", "=", 
      RowBox[{"Cancel", "[", 
       RowBox[{"dn", "/", "g"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"d1", "=", 
      RowBox[{"Cancel", "[", 
       RowBox[{"dstar", "/", 
        RowBox[{"PolynomialGCD", "[", 
         RowBox[{"dstar", ",", "g"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Dd1", "=", 
      RowBox[{"TotalDerivation", "[", 
       RowBox[{"d1", ",", "theta", ",", "Dtower"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a", ",", "b"}], "}"}], "=", 
      RowBox[{"ExtendedEuclidean", "[", 
       RowBox[{
        RowBox[{"Cancel", "[", 
         RowBox[{
          RowBox[{"Denominator", "[", "f", "]"}], "/", "d1"}], "]"}], ",", 
        "d1", ",", 
        RowBox[{"Numerator", "[", "f", "]"}], ",", 
        RowBox[{"Last", "[", "theta", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{"Resultant", "[", 
       RowBox[{
        RowBox[{"a", "-", 
         RowBox[{"Risch`z", " ", "Dd1"}]}], ",", "d1", ",", 
        RowBox[{"Last", "[", "theta", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"roots", "=", 
      RowBox[{"Risch`z", "/.", 
       RowBox[{"Solve", "[", 
        RowBox[{
         RowBox[{"res", "\[Equal]", "0"}], ",", "Risch`z"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"PIR", "=", 
      RowBox[{"Select", "[", 
       RowBox[{"roots", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"IntegerQ", "[", "#", "]"}], "&&", 
          RowBox[{
           RowBox[{"Sign", "[", "#", "]"}], "==", "1"}]}], "&"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"result", "=", 
      RowBox[{"Product", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"PolynomialGCD", "[", 
          RowBox[{
           RowBox[{"a", "-", 
            RowBox[{
             RowBox[{"PIR", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "*", "Dd1"}]}], ",", "d1"}], 
          "]"}], "^", 
         RowBox[{"PIR", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "PIR", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"RischTrace", "[", 
      RowBox[{"WeakNormalizer", ",", "result", ",", "\"\<Out\>\""}], "]"}], 
     ";", "\[IndentingNewLine]", "result"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.391298628621125*^9, 3.391298824371125*^9}, {
   3.391298909308625*^9, 3.39129920113675*^9}, {3.3912992694805*^9, 
   3.391299490308625*^9}, {3.391299813777375*^9, 3.39129983226175*^9}, {
   3.3913001704805*^9, 3.391300173543*^9}, {3.393181984658142*^9, 
   3.393182010925914*^9}, {3.3945993740136347`*^9, 3.394599402537616*^9}, {
   3.394599649083868*^9, 3.3945996767684402`*^9}, {3.394599845521484*^9, 
   3.3945998460231743`*^9}, {3.394599890910632*^9, 3.394599897359229*^9}, {
   3.395835474640848*^9, 3.39583548504809*^9}, {3.395916499362369*^9, 
   3.3959165863483353`*^9}, {3.3959173361464567`*^9, 3.395917338091164*^9}, {
   3.397726661939989*^9, 3.397726681904854*^9}, {3.397726767652432*^9, 
   3.3977267801932707`*^9}, {3.3977269094850397`*^9, 
   3.3977269337615633`*^9}, {3.397726981740127*^9, 3.397726983745311*^9}, {
   3.397728713492312*^9, 3.397728718130293*^9}, {3.40454325574123*^9, 
   3.404543283842667*^9}, 3.404715312009544*^9, {3.404960649474165*^9, 
   3.404960705956056*^9}, {3.407615258704185*^9, 3.4076152679412527`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"WeakNormalizer", "[", 
  RowBox[{
   FractionBox[
    RowBox[{"x", "+", "5"}], "x"], ",", 
   RowBox[{"{", "x", "}"}], ",", 
   RowBox[{"{", "1", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.397726101721434*^9, 3.397726114313932*^9}, {
  3.397726955317127*^9, 3.3977269747199507`*^9}}],

Cell[BoxData[
 SuperscriptBox["x", "5"]], "Output",
 CellChangeTimes->{
  3.397726115199051*^9, {3.3977266696360617`*^9, 3.397726683048152*^9}, {
   3.397726774003478*^9, 3.397726782496622*^9}, 3.397726829098884*^9, {
   3.397726921985086*^9, 3.397726936368424*^9}, {3.397726974907199*^9, 
   3.3977269896784267`*^9}, 3.40252497002789*^9, {3.40454327610119*^9, 
   3.404543285314373*^9}, 3.4049607154194403`*^9, 3.4076152746728277`*^9, 
   3.407987788235154*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["The Normal Part of the Denominator", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RDENormalDenominator", "[", 
   RowBox[{"f_", ",", "g_", ",", "theta_", ",", "Dtower_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "dn", ",", "ds", ",", "en", ",", "es", ",", "p", ",", "num", ",", "den", 
      ",", "h", ",", "result"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"RischTrace", "[", 
      RowBox[{"RDENormalDenominator", ",", 
       RowBox[{"{", 
        RowBox[{"f", ",", "g", ",", "theta", ",", "Dtower"}], "}"}], ",", 
       "\"\<In\>\""}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "Normal", " ", "part", " ", "of", " ", "the", " ", "denominator"}], 
       ",", " ", 
       RowBox[{"reference", ":", " ", 
        RowBox[{"Symbolic", " ", "Integration", " ", "1"}]}], ",", " ", 
       RowBox[{"Bronstein", " ", "p", ".185"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Given", " ", "a", " ", "derivation", " ", "D", " ", "on", " ", 
        RowBox[{"k", "[", "t", "]"}], " ", "and", " ", "f"}], ",", 
       RowBox[{"g", " ", "in", " ", "k", 
        RowBox[{"(", "t", ")"}], " ", "with", " ", "f", " ", "weakly", " ", 
        "normalised", " ", "wrt", " ", "t"}], ",", " ", 
       RowBox[{
       "return", " ", "either", "\[IndentingNewLine]", "no", " ", 
        "solution"}], ",", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
         "in", " ", "which", " ", "case", " ", "the", " ", "equation", " ", 
          "Dy"}], " ", "+", " ", 
         RowBox[{"f", "*", "y"}]}], " ", "==", " ", 
        RowBox[{
        "g", " ", "has", " ", "no", " ", "solution", " ", "in", " ", "k", 
         RowBox[{"(", "t", ")"}]}]}], ",", " ", 
       RowBox[{
       "or", " ", "the", " ", "\[IndentingNewLine]", "quadruplet", " ", 
        RowBox[{"(", 
         RowBox[{"a", ",", "b", ",", "c", ",", "h"}], ")"}], " ", "such", " ",
         "that", " ", "a"}], ",", 
       RowBox[{"h", " ", "in", " ", 
        RowBox[{"k", "[", "t", "]"}]}], ",", " ", "b", ",", 
       RowBox[{
        RowBox[{"c", " ", "in", " ", "k"}], "<", "t", ">"}], ",", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
         "and", " ", "for", " ", "any", " ", "solution", " ", "y", " ", "in", 
          " ", "k", 
          RowBox[{"(", "t", ")"}], " ", "of", "\[IndentingNewLine]", "Dy"}], 
         " ", "+", " ", 
         RowBox[{"f", "*", "y"}]}], " ", "==", " ", "g"}], ",", " ", 
       RowBox[{"q", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"y", "*", "h", " ", "in", " ", "k"}], "<", "t", ">", " ", 
          RowBox[{
           RowBox[{"satisfies", " ", "a", "*", "Dq"}], " ", "+", " ", 
           RowBox[{"b", "*", "q"}]}]}], " ", "=", " ", 
         RowBox[{"c", "."}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"dn", ",", "ds"}], "}"}], "=", 
      RowBox[{"SplitFactor", "[", 
       RowBox[{
        RowBox[{"Denominator", "[", "f", "]"}], ",", "theta", ",", "Dtower"}],
        "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"en", ",", "es"}], "}"}], "=", 
      RowBox[{"SplitFactor", "[", 
       RowBox[{
        RowBox[{"Denominator", "[", "g", "]"}], ",", "theta", ",", "Dtower"}],
        "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"p", "=", 
      RowBox[{"PolynomialGCD", "[", 
       RowBox[{"dn", ",", "en"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"num", "=", 
      RowBox[{"PolynomialGCD", "[", 
       RowBox[{"en", ",", 
        RowBox[{"D", "[", 
         RowBox[{"en", ",", 
          RowBox[{"Last", "[", "theta", "]"}]}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"den", "=", 
      RowBox[{"PolynomialGCD", "[", 
       RowBox[{"p", ",", 
        RowBox[{"D", "[", 
         RowBox[{"p", ",", 
          RowBox[{"Last", "[", "theta", "]"}]}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"h", "=", 
      RowBox[{"Cancel", "[", 
       RowBox[{"num", "/", "den"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"PolynomialRemainder", "[", 
         RowBox[{
          RowBox[{"dn", "*", 
           SuperscriptBox["h", "2"]}], ",", "en", ",", 
          RowBox[{"Last", "[", "theta", "]"}]}], "]"}], "=!=", "0"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"Risch", " ", "DE", " ", "has", " ", "no", " ", "solutions"}],
         " ", "*)"}], "\[IndentingNewLine]", "\t", 
       RowBox[{"result", "=", "$Failed"}], "\[IndentingNewLine]", "\t", ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{
        "return", " ", "normal", " ", "part", " ", "of", " ", "the", " ", 
         "denominator"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
       RowBox[{"result", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"dn", "*", "h"}], ",", 
          RowBox[{
           RowBox[{"dn", "*", "h", "*", "f"}], "-", 
           RowBox[{"dn", "*", 
            RowBox[{"TotalDerivation", "[", 
             RowBox[{"h", ",", "theta", ",", "Dtower"}], "]"}]}]}], ",", 
          RowBox[{"dn", "*", 
           RowBox[{"h", "^", "2"}], "*", "g"}], ",", "h"}], "}"}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"RischTrace", "[", 
      RowBox[{"RDENormalDenominator", ",", "result", ",", "\"\<Out\>\""}], 
      "]"}], ";", "\[IndentingNewLine]", "result"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.391299926918*^9, 3.39130016294925*^9}, {
   3.391300247746125*^9, 3.39130025919925*^9}, {3.391300402418*^9, 
   3.3913005347305*^9}, {3.391300583871125*^9, 3.391300678527375*^9}, {
   3.391300779589875*^9, 3.391300793058625*^9}, {3.39130083769925*^9, 
   3.391300964089875*^9}, {3.391301135668*^9, 3.391301155371125*^9}, {
   3.3913014046055*^9, 3.391301409777375*^9}, {3.391301443418*^9, 
   3.391301448621125*^9}, {3.391301553668*^9, 3.3913016618555*^9}, {
   3.391301764433625*^9, 3.391301814293*^9}, {3.39130189351175*^9, 
   3.391301894339875*^9}, {3.391302228496125*^9, 3.391302274277375*^9}, {
   3.3913023054805*^9, 3.391302305668*^9}, {3.391302663714875*^9, 
   3.391302687839875*^9}, {3.3913027336055*^9, 3.391302751871125*^9}, {
   3.391302830058625*^9, 3.391302843277375*^9}, {3.391302897277375*^9, 
   3.3913029022305*^9}, {3.39130293882425*^9, 3.3913029766055*^9}, {
   3.391303110839875*^9, 3.391303123589875*^9}, {3.391303225683625*^9, 
   3.391303239558625*^9}, {3.3957383469272633`*^9, 3.395738353294519*^9}, {
   3.395835640016705*^9, 3.39583565722412*^9}, 3.395836329220573*^9, {
   3.3959166027563353`*^9, 3.3959167091572533`*^9}, {3.396174325444599*^9, 
   3.396174335460526*^9}, {3.396174434393408*^9, 3.39617446531723*^9}, {
   3.397871483472559*^9, 3.397871495583824*^9}, {3.397872383485138*^9, 
   3.397872387226541*^9}, {3.404960745151864*^9, 3.404960817061346*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"RDENormalDenominator", "[", 
   RowBox[{"1", ",", 
    RowBox[{"1", "/", "x"}], ",", 
    RowBox[{"{", "x", "}"}], ",", 
    RowBox[{"{", "1", "}"}]}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"agrees", " ", "with", " ", "Bronstein"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.39130108613675*^9, 3.391301126043*^9}, {
  3.3913022317305*^9, 3.39130223538675*^9}, {3.391302282027375*^9, 
  3.3913022864805*^9}, {3.391303082652375*^9, 3.39130308288675*^9}, {
  3.391303259964875*^9, 3.391303267746125*^9}}],

Cell[BoxData["$Failed"], "Output",
 CellChangeTimes->{3.404960820705185*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"RDENormalDenominator", "[", 
   RowBox[{
    RowBox[{"1", "+", 
     SuperscriptBox["t", "2"]}], ",", 
    RowBox[{"1", "/", 
     SuperscriptBox["t", "2"]}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "t"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", 
      RowBox[{"1", "+", 
       SuperscriptBox["t", "2"]}]}], "}"}]}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"agrees", " ", "with", " ", "Bronstein"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.39130108613675*^9, 3.391301126043*^9}, {
  3.3913022317305*^9, 3.39130223538675*^9}, {3.391302282027375*^9, 
  3.3913022864805*^9}, {3.391303082652375*^9, 3.39130308288675*^9}, {
  3.391303138793*^9, 3.391303184668*^9}, {3.391303269902375*^9, 
  3.391303274339875*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"t", ",", 
   RowBox[{
    RowBox[{"-", "1"}], "-", 
    SuperscriptBox["t", "2"], "+", 
    RowBox[{"t", " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       SuperscriptBox["t", "2"]}], ")"}]}]}], ",", "1", ",", "t"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.404960829256598*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RDENormalDenominator", "[", 
  RowBox[{
   FractionBox[
    RowBox[{"1", "+", 
     SubsuperscriptBox["\[Theta]", "1", "2"]}], 
    RowBox[{"2", " ", 
     SubscriptBox["\[Theta]", "1"]}]], ",", 
   FractionBox[
    RowBox[{"\[ImaginaryI]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SubsuperscriptBox["\[Theta]", "1", "4"]}], ")"}]}], 
    RowBox[{"4", " ", 
     SubsuperscriptBox["\[Theta]", "1", "2"]}]], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     SubscriptBox["\[Theta]", "1"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{
      RowBox[{"-", "\[ImaginaryI]"}], " ", 
      SubscriptBox["\[Theta]", "1"]}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.396584779678606*^9, 3.396584805618235*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"4", ",", 
   FractionBox[
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       SubsuperscriptBox["\[Theta]", "1", "2"]}], ")"}]}], 
    SubscriptBox["\[Theta]", "1"]], ",", 
   FractionBox[
    RowBox[{"2", " ", "\[ImaginaryI]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SubsuperscriptBox["\[Theta]", "1", "4"]}], ")"}]}], 
    SubsuperscriptBox["\[Theta]", "1", "2"]], ",", "2"}], "}"}]], "Output",
 CellChangeTimes->{3.3965848065958767`*^9, 3.404960834290045*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Polynomial Differential Equation - base case", "Subsection",
 CellChangeTimes->{{3.3941539732625*^9, 3.39415399891875*^9}, {
   3.394159798090625*^9, 3.394159802715625*^9}, {3.396088317189653*^9, 
   3.396088321782075*^9}, {3.396088906683942*^9, 3.3960889081637506`*^9}, {
   3.4079878189024553`*^9, 3.40798782398671*^9}, 3.4090152222732267`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PolyDEBaseCase", "[", 
   RowBox[{"A_", ",", "B_", ",", "C_", ",", "theta_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "degA", ",", " ", "degB", ",", " ", "degC", ",", " ", "a", ",", " ", "b",
       ",", " ", "r", ",", "res"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"RischTrace", "[", 
      RowBox[{"PolyDEBaseCase", ",", 
       RowBox[{"{", 
        RowBox[{"A", ",", "B", ",", "C", ",", "theta"}], "}"}], ",", 
       "\"\<In\>\""}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Given", " ", "A"}], ",", "B", ",", 
       RowBox[{"C", " ", "in", " ", 
        RowBox[{"K", "[", "x", "]"}]}], ",", 
       RowBox[{
        RowBox[{"return", " ", "n", " ", "such", " ", "that", " ", "deg", 
         RowBox[{"(", "Q", ")"}]}], "\[LessEqual]", 
        RowBox[{
         RowBox[{"n", " ", "and", " ", "Q", " ", "satisfies", " ", "A", " ", 
          RowBox[{"Q", "'"}]}], "+", 
         RowBox[{"B", " ", "Q"}]}], "\[Equal]", 
        RowBox[{"C", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "bound", " ", "the", " ", "degree", " ", "of", " ", "the", " ", 
       "solution", " ", "in", " ", 
       RowBox[{"k", "[", "theta", "]"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"degA", "=", 
      RowBox[{"Exponent", "[", 
       RowBox[{"A", ",", 
        RowBox[{"Last", "[", "theta", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"degB", "=", 
      RowBox[{"Exponent", "[", 
       RowBox[{"B", ",", 
        RowBox[{"Last", "[", "theta", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"degC", "=", 
      RowBox[{"Exponent", "[", 
       RowBox[{"C", ",", 
        RowBox[{"Last", "[", "theta", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", "\t\t", 
      RowBox[{
       RowBox[{"degA", "<", 
        RowBox[{"degB", "+", "1"}]}], ",", "\[IndentingNewLine]", "\t\t\t", 
       RowBox[{"res", "=", 
        RowBox[{"degC", "-", "degB"}]}], ",", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"degA", ">", 
        RowBox[{"degB", "+", "1"}]}], ",", "\[IndentingNewLine]", "\t\t\t", 
       RowBox[{"res", "=", 
        RowBox[{"Max", "[", 
         RowBox[{"0", ",", 
          RowBox[{"degC", "-", "degA", "+", "1"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"degA", "==", 
        RowBox[{"degB", "+", "1"}]}], ",", "\[IndentingNewLine]", "\t\t\t", 
       RowBox[{
        RowBox[{"a", "=", 
         RowBox[{"lc", "[", 
          RowBox[{"A", ",", 
           RowBox[{"Last", "[", "theta", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t\t\t", 
        RowBox[{"b", "=", 
         RowBox[{"lc", "[", 
          RowBox[{"B", ",", 
           RowBox[{"Last", "[", "theta", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t\t\t", 
        RowBox[{"r", "=", 
         RowBox[{"Cancel", "[", 
          RowBox[{
           RowBox[{"-", "b"}], "/", "a"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t\t\t", 
        RowBox[{"If", "[", "\[IndentingNewLine]", "\t\t\t\t", 
         RowBox[{
          RowBox[{"IntegerQ", "[", "r", "]"}], ",", "\[IndentingNewLine]", 
          "\t\t\t\t\t", 
          RowBox[{"res", "=", 
           RowBox[{"Max", "[", 
            RowBox[{"r", ",", 
             RowBox[{"degC", "-", "degB"}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", "\t\t\t\t\t", 
          RowBox[{"res", "=", 
           RowBox[{"degC", "-", "degB"}]}]}], "\[IndentingNewLine]", "\t\t\t",
          "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"RischTrace", "[", 
      RowBox[{"PolyDEBaseCase", ",", "res", ",", "\"\<Out\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", "res"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.39415400054375*^9, 3.394154154215625*^9}, {
   3.394154231559375*^9, 3.39415427954375*^9}, {3.3941544200125*^9, 
   3.39415442173125*^9}, {3.394154555809375*^9, 3.39415458229375*^9}, {
   3.39415464829375*^9, 3.3941546640125*^9}, {3.39415470404375*^9, 
   3.394154829621875*^9}, {3.3941548702625*^9, 3.394155129215625*^9}, {
   3.39415518548125*^9, 3.394155248825*^9}, 3.394155382621875*^9, {
   3.39487977627112*^9, 3.394879791868367*^9}, {3.3958364923259287`*^9, 
   3.395836560459724*^9}, {3.395836829737348*^9, 3.395836830665092*^9}, {
   3.395836992854206*^9, 3.395836997044621*^9}, {3.3959167375910187`*^9, 
   3.395916798979143*^9}, {3.395980314238059*^9, 3.3959803151808567`*^9}, {
   3.395982436945538*^9, 3.3959824402490177`*^9}, {3.3959998743105307`*^9, 
   3.395999877854179*^9}, 3.397609735619884*^9, {3.397817732536852*^9, 
   3.397817741958027*^9}, {3.3978208274250307`*^9, 3.397820827542495*^9}, {
   3.404960852186257*^9, 3.404960976786744*^9}}],

Cell[BoxData[
 RowBox[{"PolyDEBaseCase", "[", 
  RowBox[{
   SuperscriptBox["x", "4"], ",", 
   RowBox[{
    RowBox[{"-", 
     SuperscriptBox["x", "2"]}], "-", 
    RowBox[{"2", " ", 
     SuperscriptBox["x", "3"]}]}], ",", 
   RowBox[{
    SuperscriptBox["x", "2"], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "x"}], ")"}]}], ",", 
   RowBox[{"{", "x", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.3959801326716633`*^9, 3.395980155189237*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Polynomial Differential Equation - primitive case", "Subsection",
 CellChangeTimes->{{3.3942286135446253`*^9, 3.3942286264352503`*^9}, {
  3.396088339365589*^9, 3.396088347734035*^9}, {3.3960889028222303`*^9, 
  3.396088903995974*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PolyDEPrimitiveCase", "[", 
   RowBox[{
   "A_", ",", "B_", ",", "C_", ",", "theta_", ",", "tower_", ",", "Dtower_"}],
    "]"}], ":=", 
  RowBox[{"Catch", "[", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "degA", ",", " ", "degB", ",", " ", "degC", ",", " ", "a", ",", " ", 
       "b", ",", " ", "int", ",", " ", "alpha", ",", " ", "struct", ",", "J", 
       ",", " ", "H", ",", "n", ",", "r"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"RischTrace", "[", 
       RowBox[{"PolyDEPrimitiveCase", ",", 
        RowBox[{"{", 
         RowBox[{
         "A", ",", "B", ",", "C", ",", "theta", ",", "tower", ",", "Dtower"}],
          "}"}], ",", "\"\<In\>\""}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"Given", " ", "A"}], ",", "B", ",", 
        RowBox[{"C", " ", "in", " ", 
         RowBox[{"k", "[", "theta", "]"}]}], ",", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"with", " ", "A"}], "\[NotEqual]", 
          RowBox[{
           RowBox[{"0", " ", "safisfying", " ", "A", " ", 
            RowBox[{"Q", "'"}]}], " ", "+", " ", 
           RowBox[{"B", " ", "Q"}]}]}], " ", "=", " ", "C"}], ",", " ", 
        RowBox[{"where", " ", "theta", " ", "is", " ", 
         RowBox[{"primitive", ".", " ", "Return"}], " ", "Q", " ", "in", " ", 
         RowBox[{"k", "[", "theta", "]"}], " ", "satisfying", " ", "the", " ",
          "above", " ", 
         RowBox[{"DE", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"degA", "=", 
       RowBox[{"Exponent", "[", 
        RowBox[{"A", ",", 
         RowBox[{"Last", "[", "theta", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"degB", "=", 
       RowBox[{"Exponent", "[", 
        RowBox[{"B", ",", 
         RowBox[{"Last", "[", "theta", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"degC", "=", 
       RowBox[{"Exponent", "[", 
        RowBox[{"C", ",", 
         RowBox[{"Last", "[", "theta", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{
         RowBox[{"degA", "==", "degB"}], "&&", 
         RowBox[{"degB", "!=", "0"}]}], ",", "\[IndentingNewLine]", "\t\t", 
        RowBox[{
         RowBox[{"a", "=", 
          RowBox[{"lc", "[", 
           RowBox[{"A", ",", 
            RowBox[{"Last", "[", "theta", "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\t\t", 
         RowBox[{"b", "=", 
          RowBox[{"lc", "[", 
           RowBox[{"B", ",", 
            RowBox[{"Last", "[", "theta", "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\t\t", 
         RowBox[{"int", "=", 
          RowBox[{"RischInternal", "[", 
           RowBox[{
            RowBox[{"b", "/", "a"}], ",", "theta", ",", "tower", ",", 
            "Dtower", ",", 
            RowBox[{"\"\<ExtendThetas\>\"", "->", "True"}], ",", 
            RowBox[{"\"\<RecursiveCall\>\"", "->", "True"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\t\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"int", "===", "$Failed"}], ",", "\[IndentingNewLine]", 
           "\t\t\t", 
           RowBox[{
            RowBox[{"RischTrace", "[", 
             RowBox[{
             "PolyDEPrimitiveCase", ",", "$Failed", ",", "\"\<Out\>\""}], 
             "]"}], ";", "\[IndentingNewLine]", "\t\t\t", 
            RowBox[{"Throw", "[", "$Failed", "]"}]}]}], "\[IndentingNewLine]",
           "\t\t", "]"}], ";", "\[IndentingNewLine]", "\t\t", 
         RowBox[{"struct", "=", 
          RowBox[{"IsStructureExtended", "[", 
           RowBox[{
            RowBox[{"rischExp", "[", 
             RowBox[{"-", "int"}], "]"}], ",", "theta", ",", "tower"}], 
           "]"}]}], ";", 
         RowBox[{"(*", " ", 
          RowBox[{"simple", " ", "cancellation", " ", "cases"}], " ", "*)"}], 
         "\[IndentingNewLine]", "\t\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"First", "[", "struct", "]"}]}], ",", 
           "\[IndentingNewLine]", "\t\t\t", 
           RowBox[{
            RowBox[{"alpha", "=", 
             RowBox[{"Last", "[", "struct", "]"}]}], ";", 
            "\[IndentingNewLine]", "\t\t\t", 
            RowBox[{"H", "=", 
             RowBox[{"PolyDEPrimitiveCase", "[", 
              RowBox[{
               RowBox[{"alpha", "*", "A"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"TotalDerivation", "[", 
                  RowBox[{"alpha", ",", "theta", ",", "Dtower"}], "]"}], "*", 
                 "A"}], "+", 
                RowBox[{"alpha", "*", "B"}]}], ",", "C", ",", "theta", ",", 
               "tower"}], "]"}]}], ";", "\[IndentingNewLine]", "\t\t\t", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"H", "===", "$Failed"}], ",", "\[IndentingNewLine]", 
              "\t\t\t\t", 
              RowBox[{
               RowBox[{"RischTrace", "[", 
                RowBox[{
                "PolyDEPrimitiveCase", ",", "$Failed", ",", "\"\<Out\>\""}], 
                "]"}], ";", "\[IndentingNewLine]", "\t\t\t\t", 
               RowBox[{"Throw", "[", "$Failed", "]"}]}]}], 
             "\[IndentingNewLine]", "\t\t\t", "]"}], ";", 
            "\[IndentingNewLine]", "\t\t\t", 
            RowBox[{"RischTrace", "[", 
             RowBox[{"PolyDEPrimitiveCase", ",", 
              RowBox[{"alpha", " ", "H"}], ",", "\"\<Out\>\""}], "]"}], ";", 
            "\[IndentingNewLine]", "\t\t\t", 
            RowBox[{"Throw", "[", 
             RowBox[{"alpha", "*", "H"}], "]"}]}]}], "\[IndentingNewLine]", 
          "\t\t", "]"}], ";", "\[IndentingNewLine]", "\t\t", 
         RowBox[{"RischTrace", "[", 
          RowBox[{"PolyDEPrimitiveCase", ",", 
           RowBox[{"degC", "-", "degB"}], ",", "\"\<Out\>\""}], "]"}], ";", 
         "\[IndentingNewLine]", "\t\t", 
         RowBox[{"Throw", "[", 
          RowBox[{"degC", "-", "degB"}], "]"}]}], ",", "\[IndentingNewLine]", 
        "\t", 
        RowBox[{"degA", "<", "degB"}], ",", "\[IndentingNewLine]", "\t\t", 
        RowBox[{
         RowBox[{"RischTrace", "[", 
          RowBox[{"PolyDEPrimitiveCase", ",", 
           RowBox[{"degC", "-", "degB"}], ",", "\"\<Out\>\""}], "]"}], ";", 
         "\[IndentingNewLine]", "\t\t", 
         RowBox[{"Throw", "[", 
          RowBox[{"degC", "-", "degB"}], "]"}]}], ",", "\[IndentingNewLine]", 
        "\t", 
        RowBox[{"degA", ">", 
         RowBox[{"degB", "+", "1"}]}], ",", "\[IndentingNewLine]", "\t\t", 
        RowBox[{
         RowBox[{"RischTrace", "[", 
          RowBox[{"PolyDEPrimitiveCase", ",", 
           RowBox[{"Max", "[", 
            RowBox[{"0", ",", 
             RowBox[{"degC", "-", "degA", "+", "1"}]}], "]"}], ",", 
           "\"\<Out\>\""}], "]"}], ";", "\[IndentingNewLine]", "\t\t", 
         RowBox[{"Throw", "[", 
          RowBox[{"Max", "[", 
           RowBox[{"0", ",", 
            RowBox[{"degC", "-", "degA", "+", "1"}]}], "]"}], "]"}]}], ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"degA", "==", 
         RowBox[{"degB", "+", "1"}]}], ",", "\[IndentingNewLine]", "\t\t", 
        RowBox[{
         RowBox[{"a", "=", 
          RowBox[{"lc", "[", 
           RowBox[{"A", ",", 
            RowBox[{"Last", "[", "theta", "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\t\t", 
         RowBox[{"b", "=", 
          RowBox[{"lc", "[", 
           RowBox[{"B", ",", 
            RowBox[{"Last", "[", "theta", "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\t\t", 
         RowBox[{"J", "=", 
          RowBox[{"RischInternal", "[", 
           RowBox[{
            RowBox[{"b", "/", "a"}], ",", "theta", ",", "tower", ",", 
            "Dtower", ",", 
            RowBox[{"\"\<ExtendThetas\>\"", "->", "True"}], ",", 
            RowBox[{"\"\<RecursiveCall\>\"", "\[Rule]", "True"}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", "\t\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"J", "===", "$Failed"}], ",", "\[IndentingNewLine]", 
           "\t\t\t", 
           RowBox[{
            RowBox[{"RischTrace", "[", 
             RowBox[{
             "PolyDEPrimitiveCase", ",", "$Failed", ",", "\"\<Out\>\""}], 
             "]"}], ";", "\[IndentingNewLine]", "\t\t\t", 
            RowBox[{"Throw", "[", "$Failed", "]"}]}], ",", 
           "\[IndentingNewLine]", "\t\t\t", 
           RowBox[{"J", "=", 
            RowBox[{"First", "[", "J", "]"}]}]}], "\[IndentingNewLine]", 
          "\t\t", "]"}], ";", "\[IndentingNewLine]", "\t\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"!", 
             RowBox[{"FreeQ", "[", 
              RowBox[{"J", ",", 
               RowBox[{"Last", "[", "theta", "]"}]}], "]"}]}], "&&", 
            RowBox[{"FreeQ", "[", 
             RowBox[{
              RowBox[{"Denominator", "[", "J", "]"}], ",", 
              RowBox[{"Last", "[", "theta", "]"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", "\t\t\t", 
           RowBox[{
            RowBox[{"J", "=", 
             RowBox[{"-", "J"}]}], ";", "\[IndentingNewLine]", "\t\t\t", 
            RowBox[{"r", "=", 
             RowBox[{"Coefficient", "[", 
              RowBox[{"J", ",", 
               RowBox[{"Last", "[", "theta", "]"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", "\t\t\t", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"IntegerQ", "[", "r", "]"}], ",", "\[IndentingNewLine]",
               "\t\t\t\t", 
              RowBox[{
               RowBox[{"RischTrace", "[", 
                RowBox[{"PolyDEPrimitiveCase", ",", 
                 RowBox[{"Max", "[", 
                  RowBox[{"r", ",", 
                   RowBox[{"degC", "-", "degB"}]}], "]"}], ",", 
                 "\"\<Out\>\""}], "]"}], ";", "\[IndentingNewLine]", 
               "\t\t\t\t", 
               RowBox[{"Throw", "[", 
                RowBox[{"Max", "[", 
                 RowBox[{"r", ",", 
                  RowBox[{"degC", "-", "degB"}]}], "]"}], "]"}]}], ",", 
              "\[IndentingNewLine]", "\t\t\t\t", 
              RowBox[{
               RowBox[{"RischTrace", "[", 
                RowBox[{"PolyDEPrimitiveCase", ",", 
                 RowBox[{"degC", "-", "degB"}], ",", "\"\<Out\>\""}], "]"}], 
               ";", "\[IndentingNewLine]", "\t\t\t\t", 
               RowBox[{"Throw", "[", 
                RowBox[{"degC", "-", "degB"}], "]"}]}]}], 
             "\[IndentingNewLine]", "\t\t\t", "]"}]}], ",", 
           "\[IndentingNewLine]", "\t\t\t", 
           RowBox[{
            RowBox[{"RischTrace", "[", 
             RowBox[{"PolyDEPrimitiveCase", ",", 
              RowBox[{"degC", "-", "degB"}], ",", "\"\<Out\>\""}], "]"}], ";",
             "\[IndentingNewLine]", "\t\t\t", 
            RowBox[{"Throw", "[", 
             RowBox[{"degC", "-", "degB"}], "]"}]}]}], "\[IndentingNewLine]", 
          "\t\t", "]"}]}]}], "\[IndentingNewLine]", "\t", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.3942286373883753`*^9, 3.3942286819508753`*^9}, {
   3.3942288415602503`*^9, 3.3942288923102503`*^9}, {3.3942289303415003`*^9, 
   3.3942289610602503`*^9}, {3.3942289924665003`*^9, 
   3.3942290379665003`*^9}, {3.3942292214508753`*^9, 
   3.3942292685446253`*^9}, {3.3942293501540003`*^9, 
   3.3942293997477503`*^9}, {3.394313890701375*^9, 3.39431390812325*^9}, {
   3.394314877717*^9, 3.394314952920125*^9}, {3.394315134217*^9, 
   3.394315157701375*^9}, {3.3943151911545*^9, 3.394315191920125*^9}, {
   3.394315319342*^9, 3.394315396826375*^9}, {3.394315444388875*^9, 
   3.3943154726545*^9}, {3.394401178296125*^9, 3.394401282233625*^9}, {
   3.394401327858625*^9, 3.394401591702375*^9}, {3.394401625171125*^9, 
   3.39440164449925*^9}, {3.39440167812425*^9, 3.3944017770305*^9}, {
   3.3944024151555*^9, 3.394402417639875*^9}, {3.394402485108625*^9, 
   3.39440248637425*^9}, {3.394402532593*^9, 3.39440269756175*^9}, {
   3.3944284872331247`*^9, 3.3944284950456247`*^9}, {3.395132391080429*^9, 
   3.395132424432461*^9}, {3.3951456617400103`*^9, 3.395145669018332*^9}, {
   3.3951474787721024`*^9, 3.3951474802597*^9}, {3.3951494687120256`*^9, 
   3.3951494692311707`*^9}, {3.395395550372219*^9, 3.395395638272655*^9}, {
   3.395395687026984*^9, 3.395395711329853*^9}, {3.395837032763768*^9, 
   3.395837095059532*^9}, {3.3959168727206917`*^9, 3.395916924073559*^9}, {
   3.3959817257579317`*^9, 3.395981727939579*^9}, {3.39598298765942*^9, 
   3.395982998898181*^9}, {3.3959856370680847`*^9, 3.395985666803705*^9}, {
   3.395985706443686*^9, 3.395985713262992*^9}, {3.395986022090004*^9, 
   3.3959860225270567`*^9}, {3.3960883605173903`*^9, 3.39608836087117*^9}, {
   3.396088582008436*^9, 3.3960886071276007`*^9}, {3.3960886395675488`*^9, 
   3.396088641773362*^9}, {3.396088697781425*^9, 3.396088701339884*^9}, {
   3.3960888356609163`*^9, 3.396088873800548*^9}, {3.396171930789966*^9, 
   3.396171941629026*^9}, {3.396172012233029*^9, 3.39617205880072*^9}, {
   3.396172230119404*^9, 3.396172231726544*^9}, {3.396253335062581*^9, 
   3.396253340205407*^9}, {3.3976097942536373`*^9, 3.3976097977501097`*^9}, {
   3.4047174568690042`*^9, 3.404717491122726*^9}, {3.4047175282481213`*^9, 
   3.404717545048064*^9}, {3.4049610418176947`*^9, 3.40496126622036*^9}, {
   3.404961303357444*^9, 3.404961345510853*^9}, 3.4079877560737123`*^9, {
   3.408002161744828*^9, 3.408002188056143*^9}, {3.4088634048877907`*^9, 
   3.4088634104501047`*^9}, {3.4088665464662046`*^9, 3.408866589577238*^9}, {
   3.408866642009199*^9, 3.408866659049218*^9}, {3.408866700048465*^9, 
   3.40886670134615*^9}, {3.40886689573276*^9, 3.408866902318136*^9}, {
   3.409201261425089*^9, 3.409201322585288*^9}, {3.409201528767251*^9, 
   3.4092015328610973`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PolyDEPrimitiveCase", "[", 
  RowBox[{
   RowBox[{"x", " ", 
    SubsuperscriptBox["\[Theta]", "1", "3"]}], "\[InvisibleSpace]", ",", 
   RowBox[{
    RowBox[{"-", 
     SubscriptBox["\[Theta]", "1"]}], "-", 
    SubsuperscriptBox["\[Theta]", "1", "2"]}], ",", 
   RowBox[{"theta", "[", "1", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"theta", "[", "1", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"rischLog", "[", "x", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"1", "/", "x"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.409201195942573*^9, 3.409201233909463*^9}}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{3.409201564121648*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"PolyDEPrimitiveCase", "[", 
   RowBox[{
    RowBox[{
     SuperscriptBox[
      RowBox[{"theta", "[", "1", "]"}], "3"], " ", "x"}], ",", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"theta", "[", "1", "]"}]}], "-", 
     SuperscriptBox[
      RowBox[{"theta", "[", "1", "]"}], "2"]}], ",", 
    RowBox[{"theta", "[", "1", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", 
      RowBox[{"theta", "[", "1", "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", 
      RowBox[{"rischLog", "[", "x", "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", 
      FractionBox["1", "x"]}], "}"}]}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"cancellation", " ", "case"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.397872403084222*^9, 3.3978724184302893`*^9}, {
  3.397873290816798*^9, 3.3978732954875317`*^9}, {3.4088632075280113`*^9, 
  3.408863229879896*^9}}],

Cell[BoxData[
 RowBox[{"-", "1"}]], "Output",
 CellChangeTimes->{
  3.4088632324607077`*^9, {3.408866663575272*^9, 3.408866665785817*^9}}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Polynomial Differential Equation - exponential case", "Subsection",
 CellChangeTimes->{{3.39441441037425*^9, 3.394414423952375*^9}, {
  3.396088098458727*^9, 3.3960881025305843`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PolyDEExponentialCase", "[", 
   RowBox[{
   "C1_", ",", "C2_", ",", "C3_", ",", "theta_", ",", "tower_", ",", 
    "Dtower_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"A", "=", "C1"}], ",", 
      RowBox[{"B", "=", "C2"}], ",", 
      RowBox[{"C", "=", "C3"}], ",", "nb", ",", "nc", ",", "rem", ",", "n", 
      ",", "b", ",", "m", ",", "eta", ",", "degA", ",", "degB", ",", "degC", 
      ",", "a", ",", "H", ",", "alpha", ",", "beta", ",", "res"}], "}"}], ",",
     "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"RischTrace", "[", 
      RowBox[{"PolyDEExponentialCase", ",", 
       RowBox[{"{", 
        RowBox[{
        "C1", ",", "C2", ",", "C3", ",", "theta", ",", "tower", ",", 
         "Dtower"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{"Given", " ", "A", " ", "in", " ", 
         RowBox[{"k", "[", "theta", "]"}], " ", "aith", " ", "A", 
         RowBox[{"(", "0", ")"}]}], "\[NotEqual]", "0"}], ",", "B", ",", 
       RowBox[{"C", " ", "in", " ", 
        RowBox[{"k", "[", 
         RowBox[{"theta", ",", 
          RowBox[{"theta", "^", 
           RowBox[{"-", "1"}]}]}], "]"}]}], ",", 
       RowBox[{
       "where", " ", "theta", " ", "is", " ", "exponential", " ", "and", " ", 
        "A"}], ",", "B", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"C", " ", "satisfy", " ", "A", " ", 
          RowBox[{"Q", "'"}]}], "+", 
         RowBox[{"B", " ", "Q"}]}], " ", "=", " ", 
        RowBox[{
         RowBox[{"C", ".", " ", "Return"}], " ", "either", " ", "$Failed", 
         " ", "in", " ", "which", " ", "case", " ", "there", " ", "is", " ", 
         "no", " ", "solution", " ", "in", " ", 
         RowBox[{"k", "[", "theta", "]"}]}]}], ",", 
       RowBox[{"or", " ", 
        RowBox[{"{", 
         RowBox[{"m", ",", "b"}], "}"}], " ", "such", " ", "that", " ", "m", 
        " ", "is", " ", "a", " ", "bound", " ", "on", " ", "the", " ", 
        "degree", " ", "of", " ", "Q", " ", 
        RowBox[{"and", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Find", " ", "a", " ", "lower", " ", "bound", " ", "on", " ", "the", 
       " ", "order", " ", "of", " ", "0", " ", "at", " ", "Q"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"nb", "=", 
      RowBox[{"OrderFunction", "[", 
       RowBox[{"B", ",", 
        RowBox[{"Last", "[", "theta", "]"}], ",", 
        RowBox[{"Last", "[", "theta", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nc", "=", 
      RowBox[{"OrderFunction", "[", 
       RowBox[{"C", ",", 
        RowBox[{"Last", "[", "theta", "]"}], ",", 
        RowBox[{"Last", "[", "theta", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MatchQ", "[", 
        RowBox[{"nb", ",", "0"}], "]"}], ",", "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"rem", "=", 
         RowBox[{"Remainder", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "B"}], "/", "A"}], ",", 
           RowBox[{"Last", "[", "theta", "]"}], ",", 
           RowBox[{"Last", "[", "theta", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"n", "=", 
         RowBox[{"ParametricLogarithmicDerivative", "[", 
          RowBox[{"rem", ",", "theta", ",", "tower", ",", "Dtower"}], "]"}]}],
         ";", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"n", "===", "$Failed"}], ",", "\[IndentingNewLine]", 
          "\t\t\t", 
          RowBox[{"b", "=", 
           RowBox[{"Min", "[", 
            RowBox[{"0", ",", "nc"}], "]"}]}], ",", "\[IndentingNewLine]", 
          "\t\t\t", 
          RowBox[{"b", "=", 
           RowBox[{"Min", "[", 
            RowBox[{"0", ",", 
             RowBox[{"First", "[", "n", "]"}], ",", "nc"}], "]"}]}]}], 
         "\[IndentingNewLine]", "\t\t", "]"}]}], ",", "\[IndentingNewLine]", 
       "\t\t", 
       RowBox[{"b", "=", 
        RowBox[{"Min", "[", 
         RowBox[{"0", ",", 
          RowBox[{"nc", "-", 
           RowBox[{"Min", "[", 
            RowBox[{"0", ",", "nb"}], "]"}]}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"m", "=", 
      RowBox[{"Max", "[", 
       RowBox[{"0", ",", 
        RowBox[{"-", "nb"}], ",", 
        RowBox[{"b", "-", "nc"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Convert", " ", "equation", " ", "to", " ", "one", " ", "in", " ", 
       RowBox[{"k", "[", "theta", "]"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"eta", "=", 
      RowBox[{
       RowBox[{"Last", "[", "tower", "]"}], "/.", 
       RowBox[{
        RowBox[{"rischExp", "[", "arg_", "]"}], "\[RuleDelayed]", "arg"}]}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"B", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"b", "*", 
          RowBox[{"TotalDerivation", "[", 
           RowBox[{"eta", ",", "theta", ",", "Dtower"}], "]"}], "*", "A"}], 
         "+", "B"}], ")"}], "*", 
       RowBox[{
        RowBox[{"Last", "[", "theta", "]"}], "^", "m"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"A", "=", 
      RowBox[{"A", "*", 
       RowBox[{
        RowBox[{"Last", "[", "theta", "]"}], "^", "m"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"C", "=", 
      RowBox[{"C", "*", 
       RowBox[{
        RowBox[{"Last", "[", "theta", "]"}], "^", 
        RowBox[{"(", 
         RowBox[{"m", "-", "b"}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"At", " ", "this", " ", "point", " ", "A"}], ",", "B", ",", 
       RowBox[{"C", " ", "in", " ", 
        RowBox[{"k", "[", "theta", "]"}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"and", " ", "if", " ", "H", " ", "in", " ", 
          RowBox[{"k", "[", "theta", "]"}], " ", "satisfies", " ", "A", " ", 
          RowBox[{"H", "'"}]}], "+", 
         RowBox[{"B", " ", "H"}]}], "=", "C"}], ",", 
       RowBox[{
        RowBox[{"then", " ", "Q"}], "=", 
        RowBox[{"H", "*", 
         RowBox[{"theta", "^", "b"}], " ", "is", " ", "a", " ", "solution", 
         " ", "to", " ", "the", " ", "original", " ", "DE"}]}]}], "*)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Find", " ", "a", " ", "bound", " ", "on", " ", "deg", 
       RowBox[{"(", "H", ")"}], " ", "and", " ", "solve", " ", "the", " ", 
       "polynomial", " ", "equation"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"degA", "=", 
      RowBox[{"Exponent", "[", 
       RowBox[{"A", ",", 
        RowBox[{"Last", "[", "theta", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"degB", "=", 
      RowBox[{"Exponent", "[", 
       RowBox[{"B", ",", 
        RowBox[{"Last", "[", "theta", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"degC", "=", 
      RowBox[{"Exponent", "[", 
       RowBox[{"C", ",", 
        RowBox[{"Last", "[", "theta", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", "\t\t", 
      RowBox[{
       RowBox[{"degA", "<", "degB"}], ",", "\[IndentingNewLine]", "\t\t\t", 
       RowBox[{"m", "=", 
        RowBox[{"degC", "-", "degB"}]}], ",", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"degA", ">", "degB"}], ",", "\[IndentingNewLine]", "\t\t\t", 
       RowBox[{"m", "=", 
        RowBox[{"Max", "[", 
         RowBox[{"0", ",", 
          RowBox[{"degC", "-", "degA"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"degA", "\[Equal]", "degB"}], ",", "\[IndentingNewLine]", 
       "\t\t\t", 
       RowBox[{
        RowBox[{"alpha", "=", 
         RowBox[{"lc", "[", 
          RowBox[{"A", ",", 
           RowBox[{"Last", "[", "theta", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t\t\t", 
        RowBox[{"beta", "=", 
         RowBox[{"lc", "[", 
          RowBox[{"B", ",", 
           RowBox[{"Last", "[", "theta", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t\t\t", 
        RowBox[{"n", "=", 
         RowBox[{"ParametricLogarithmicDerivative", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "beta"}], "/", "alpha"}], ",", "theta", ",", "tower",
            ",", "Dtower"}], "]"}]}], ";", "\[IndentingNewLine]", "\t\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"n", "===", "$Failed"}], ",", "\[IndentingNewLine]", 
          "\t\t\t\t", 
          RowBox[{"m", "=", 
           RowBox[{"degC", "-", "degB"}]}], ",", "\[IndentingNewLine]", 
          "\t\t\t\t", 
          RowBox[{"m", "=", 
           RowBox[{"Max", "[", 
            RowBox[{"0", ",", 
             RowBox[{"First", "[", "n", "]"}], ",", 
             RowBox[{"degC", "-", "degB"}]}], "]"}]}]}], 
         "\[IndentingNewLine]", "\t\t\t", "]"}]}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{"{", 
       RowBox[{"A", ",", 
        RowBox[{"Expand", "[", "B", "]"}], ",", 
        RowBox[{"Expand", "[", "C", "]"}], ",", "m", ",", "b"}], "}"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"RischTrace", "[", 
      RowBox[{"PolyDEExponentialCase", ",", "res", ",", "\"\<Out\>\""}], 
      "]"}], ";", "\[IndentingNewLine]", "res"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.396585686785788*^9, 3.3965858138948917`*^9}, {
   3.396586102467938*^9, 3.396586185058053*^9}, {3.3965862650673*^9, 
   3.396586265914863*^9}, {3.39658631027005*^9, 3.3965863640788193`*^9}, {
   3.396586589725182*^9, 3.396586630521721*^9}, {3.3965878131859837`*^9, 
   3.3965878135654097`*^9}, {3.396587851378317*^9, 3.3965878538102694`*^9}, {
   3.396587894363147*^9, 3.3965879423872623`*^9}, {3.396588004818709*^9, 
   3.396588005228323*^9}, {3.396588661843875*^9, 3.396588671682716*^9}, {
   3.3965959824431143`*^9, 3.396595987657284*^9}, {3.396596602634351*^9, 
   3.396596613193783*^9}, {3.396600741223085*^9, 3.3966007439522867`*^9}, {
   3.39660078660935*^9, 3.396600806679324*^9}, {3.404961392427702*^9, 
   3.404961486554471*^9}, 3.407987667258999*^9, {3.40798770340674*^9, 
   3.40798772327431*^9}, 3.408863543046821*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PolyDEExponentialCase", "[", 
  RowBox[{"4", ",", 
   FractionBox[
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       SubsuperscriptBox["\[Theta]", "1", "2"]}], ")"}]}], 
    SubscriptBox["\[Theta]", "1"]], ",", 
   FractionBox[
    RowBox[{"2", " ", "\[ImaginaryI]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SubsuperscriptBox["\[Theta]", "1", "4"]}], ")"}]}], 
    SubsuperscriptBox["\[Theta]", "1", "2"]], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     SubscriptBox["\[Theta]", "1"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"rischExp", "[", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", "x"}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{
      RowBox[{"-", "\[ImaginaryI]"}], " ", 
      SubscriptBox["\[Theta]", "1"]}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.396585042911283*^9, 3.3965851020851603`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"4", " ", 
    SubscriptBox["\[Theta]", "1"]}], ",", 
   RowBox[{"2", "+", 
    RowBox[{"4", " ", "\[ImaginaryI]", " ", 
     SubscriptBox["\[Theta]", "1"]}], "+", 
    RowBox[{"2", " ", 
     SubsuperscriptBox["\[Theta]", "1", "2"]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "2"}], " ", "\[ImaginaryI]"}], "+", 
    RowBox[{"2", " ", "\[ImaginaryI]", " ", 
     SubsuperscriptBox["\[Theta]", "1", "4"]}]}], ",", "2", ",", 
   RowBox[{"-", "1"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.3965850475191193`*^9, 3.3965850721646767`*^9}, {
   3.396585424012644*^9, 3.3965854312121553`*^9}, 3.3965855057246227`*^9, 
   3.396585815715242*^9, {3.396586111990981*^9, 3.3965861862540894`*^9}, 
   3.396586226231285*^9, 3.396586267745126*^9, {3.396586349438672*^9, 
   3.39658636550301*^9}, 3.396586632048147*^9, 3.3965868045688763`*^9, {
   3.396587815098997*^9, 3.396587823480887*^9}, {3.39658788616228*^9, 
   3.396587943504945*^9}, {3.396588674679365*^9, 3.396588677276825*^9}, 
   3.396600693451722*^9, 3.404961488126328*^9, 3.407987670003935*^9, {
   3.407987706369934*^9, 3.4079877314242163`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PolyDEExponentialCase", "[", 
  RowBox[{
   RowBox[{"39916800", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "+", 
       SubscriptBox["\[Theta]", "1"]}], ")"}], "3"]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "39916800"}], " ", 
     SubscriptBox["\[Theta]", "1"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SubscriptBox["\[Theta]", "1"]}], ")"}], "2"]}], "+", 
    RowBox[{"39916800", " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       SubscriptBox["\[Theta]", "1"]}], ")"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "10"}], "-", 
       RowBox[{"21", " ", 
        SubscriptBox["\[Theta]", "1"]}], "-", 
       RowBox[{"10", " ", 
        SubsuperscriptBox["\[Theta]", "1", "2"]}]}], ")"}]}]}], ",", 
   RowBox[{"39916800", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      SubscriptBox["\[Theta]", "1"]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"1757211400", "+", 
      RowBox[{"2581284541", " ", 
       SubscriptBox["\[Theta]", "1"]}]}], ")"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", 
     SubscriptBox["\[Theta]", "1"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", 
     RowBox[{"rischExp", "[", "t", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     SubscriptBox["\[Theta]", "1"]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.396251994337142*^9, 3.396252002410349*^9}, {
  3.3962520439844837`*^9, 3.396252102690619*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"39916800", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "+", 
       SubscriptBox["\[Theta]", "1"]}], ")"}], "3"]}], ",", 
   RowBox[{
    RowBox[{"-", "399168000"}], "-", 
    RowBox[{"1277337600", " ", 
     SubscriptBox["\[Theta]", "1"]}], "-", 
    RowBox[{"1317254400", " ", 
     SubsuperscriptBox["\[Theta]", "1", "2"]}], "-", 
    RowBox[{"439084800", " ", 
     SubsuperscriptBox["\[Theta]", "1", "3"]}]}], ",", 
   RowBox[{"70142256011520000", "+", 
    RowBox[{"173178874777708800", " ", 
     SubscriptBox["\[Theta]", "1"]}], "+", 
    RowBox[{"103036618766188800", " ", 
     SubsuperscriptBox["\[Theta]", "1", "2"]}]}], ",", "11", ",", "0"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.396585436074417*^9, {3.407987671909546*^9, 3.407987732591696*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PolyDEExponentialCase", "[", 
  RowBox[{
   RowBox[{
    SuperscriptBox["x", "2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"x", "+", 
       SubscriptBox["\[Theta]", "1"]}], ")"}], "2"]}], ",", 
   RowBox[{
    SuperscriptBox["x", "4"], "+", 
    RowBox[{"2", " ", "x", " ", 
     SubscriptBox["\[Theta]", "1"]}], "-", 
    RowBox[{
     SuperscriptBox["x", "2"], " ", 
     SubscriptBox["\[Theta]", "1"]}], "+", 
    RowBox[{"2", " ", 
     SuperscriptBox["x", "3"], " ", 
     SubscriptBox["\[Theta]", "1"]}], "+", 
    SubsuperscriptBox["\[Theta]", "1", "2"], "+", 
    RowBox[{
     SuperscriptBox["x", "2"], " ", 
     SubsuperscriptBox["\[Theta]", "1", "2"]}]}], ",", 
   RowBox[{
    RowBox[{"2", " ", "x"}], "-", 
    SuperscriptBox["x", "2"], "+", 
    SubscriptBox["\[Theta]", "1"]}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     SubscriptBox["\[Theta]", "1"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"rischExp", "[", "x", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     SubscriptBox["\[Theta]", "1"]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.39618109484735*^9, 3.396181126381523*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SuperscriptBox["x", "2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"x", "+", 
       SubscriptBox["\[Theta]", "1"]}], ")"}], "2"]}], ",", 
   RowBox[{
    RowBox[{"2", " ", "x", " ", 
     SubscriptBox["\[Theta]", "1"]}], "-", 
    RowBox[{
     SuperscriptBox["x", "2"], " ", 
     SubscriptBox["\[Theta]", "1"]}], "+", 
    SubsuperscriptBox["\[Theta]", "1", "2"]}], ",", 
   RowBox[{
    RowBox[{"2", " ", "x", " ", 
     SubscriptBox["\[Theta]", "1"]}], "-", 
    RowBox[{
     SuperscriptBox["x", "2"], " ", 
     SubscriptBox["\[Theta]", "1"]}], "+", 
    SubsuperscriptBox["\[Theta]", "1", "2"]}], ",", "0", ",", 
   RowBox[{"-", "1"}]}], "}"}]], "Output",
 CellChangeTimes->{3.396585437836187*^9, 3.4079877334283524`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PolyDEExponentialCase", "[", 
  RowBox[{
   SuperscriptBox["x", "2"], ",", 
   RowBox[{"2", "+", 
    RowBox[{"x", " ", 
     SubscriptBox["\"\<\[Theta]\>\"", "1"]}], "+", 
    RowBox[{
     SuperscriptBox["x", "2"], " ", 
     SubscriptBox["\"\<\[Theta]\>\"", "1"]}]}], ",", 
   RowBox[{
    SuperscriptBox["x", "2"], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "x"}], ")"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     SubscriptBox["\"\<\[Theta]\>\"", "1"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"rischExp", "[", 
      RowBox[{"-", 
       FractionBox["1", "x"]}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     FractionBox[
      SubscriptBox["\"\<\[Theta]\>\"", "1"], 
      SuperscriptBox["x", "2"]]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.3961726656613483`*^9, 3.3961726734272223`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   SuperscriptBox["x", "2"], ",", 
   RowBox[{
    RowBox[{"x", " ", 
     SubscriptBox["\<\"\[Theta]\"\>", "1"]}], "+", 
    RowBox[{
     SuperscriptBox["x", "2"], " ", 
     SubscriptBox["\<\"\[Theta]\"\>", "1"]}]}], ",", 
   RowBox[{
    RowBox[{
     SuperscriptBox["x", "2"], " ", 
     SubsuperscriptBox["\<\"\[Theta]\"\>", "1", "2"]}], "+", 
    RowBox[{
     SuperscriptBox["x", "3"], " ", 
     SubsuperscriptBox["\<\"\[Theta]\"\>", "1", "2"]}]}], ",", "1", ",", 
   RowBox[{"-", "2"}]}], "}"}]], "Output",
 CellChangeTimes->{3.396585439643941*^9, 3.407987734132557*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PolyDEExponentialCase", "[", 
  RowBox[{
   RowBox[{
    SuperscriptBox["x", "2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"x", "+", 
       SubscriptBox["\"\<\[Theta]\>\"", "1"]}], ")"}], "2"]}], ",", 
   RowBox[{
    SuperscriptBox["x", "4"], "+", 
    RowBox[{"2", " ", "x", " ", 
     SubscriptBox["\"\<\[Theta]\>\"", "1"]}], "-", 
    RowBox[{
     SuperscriptBox["x", "2"], " ", 
     SubscriptBox["\"\<\[Theta]\>\"", "1"]}], "+", 
    RowBox[{"2", " ", 
     SuperscriptBox["x", "3"], " ", 
     SubscriptBox["\"\<\[Theta]\>\"", "1"]}], "+", 
    SubsuperscriptBox["\"\<\[Theta]\>\"", "1", "2"], "+", 
    RowBox[{
     SuperscriptBox["x", "2"], " ", 
     SubsuperscriptBox["\"\<\[Theta]\>\"", "1", "2"]}]}], ",", 
   RowBox[{
    RowBox[{"2", " ", "x"}], "-", 
    SuperscriptBox["x", "2"], "+", 
    SubscriptBox["\"\<\[Theta]\>\"", "1"]}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     SubscriptBox["\"\<\[Theta]\>\"", "1"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"rischExp", "[", "x", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     SubscriptBox["\"\<\[Theta]\>\"", "1"]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.3960752403229628`*^9, 3.396075261291566*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SuperscriptBox["x", "2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"x", "+", 
       SubscriptBox["\<\"\[Theta]\"\>", "1"]}], ")"}], "2"]}], ",", 
   RowBox[{
    RowBox[{"2", " ", "x", " ", 
     SubscriptBox["\<\"\[Theta]\"\>", "1"]}], "-", 
    RowBox[{
     SuperscriptBox["x", "2"], " ", 
     SubscriptBox["\<\"\[Theta]\"\>", "1"]}], "+", 
    SubsuperscriptBox["\<\"\[Theta]\"\>", "1", "2"]}], ",", 
   RowBox[{
    RowBox[{"2", " ", "x", " ", 
     SubscriptBox["\<\"\[Theta]\"\>", "1"]}], "-", 
    RowBox[{
     SuperscriptBox["x", "2"], " ", 
     SubscriptBox["\<\"\[Theta]\"\>", "1"]}], "+", 
    SubsuperscriptBox["\<\"\[Theta]\"\>", "1", "2"]}], ",", "0", ",", 
   RowBox[{"-", "1"}]}], "}"}]], "Output",
 CellChangeTimes->{3.396585441101935*^9, 3.4079877355908003`*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Rothstein's Special Polynomial Differential Equation", "Subsection",
 CellChangeTimes->{{3.3941555063875*^9, 3.394155515340625*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SPDE", "[", 
   RowBox[{
   "c1_", ",", "c2_", ",", "c3_", ",", "n_", ",", "theta_", ",", "tower_", 
    ",", "Dtower_"}], "]"}], ":=", 
  RowBox[{"Catch", "[", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"A", "=", "c1"}], ",", " ", 
       RowBox[{"B", "=", "c2"}], ",", " ", 
       RowBox[{"C", "=", "c3"}], ",", "G", ",", " ", "res1", ",", " ", "Q", 
       ",", " ", "etheta", ",", " ", "etower", ",", "H", ",", " ", "m", ",", 
       " ", "\[IndentingNewLine]", "b", ",", " ", "c", ",", " ", "derivation",
        ",", " ", "solution", ",", "qr", ",", "r", ",", "bc", ",", "Z", ",", 
       "res"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"RischTrace", "[", 
       RowBox[{"SPDE", ",", 
        RowBox[{"{", 
         RowBox[{
         "c1", ",", "c2", ",", "c3", ",", "n", ",", "theta", ",", "tower", 
          ",", "Dtower"}], "}"}], ",", "\"\<In\>\""}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Rothstein", "'"}], "s", " ", "special", " ", "polynomial",
            " ", "differential", " ", "equation", " ", "algorithm", " ", 
           "for", " ", "solving", " ", "A", " ", 
           RowBox[{"Q", "'"}]}], " ", "+", " ", 
          RowBox[{"B", " ", "Q"}]}], " ", "=", " ", "C"}], ",", " ", 
        RowBox[{
        "with", " ", "a", " ", "degree", " ", "bound", " ", "n", " ", "on", 
         " ", "the", " ", "solution", " ", "Q", " ", "in", " ", 
         RowBox[{"k", "[", "theta", "]"}], " ", "and", " ", "A"}], ",", "B", 
        ",", 
        RowBox[{"C", " ", "in", " ", 
         RowBox[{"k", "[", "theta", "]"}]}]}], " ", "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"C", "==", "0"}], ",", "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"RischTrace", "[", 
          RowBox[{"SPDE", ",", "0", ",", "\"\<Out\>\""}], "]"}], ";", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{"Throw", "[", "0", "]"}]}]}], "\[IndentingNewLine]", "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"G", "=", 
       RowBox[{"PolynomialGCD", "[", 
        RowBox[{"A", ",", "B"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"PolynomialRemainder", "[", 
          RowBox[{"C", ",", "G", ",", 
           RowBox[{"Last", "[", "theta", "]"}]}], "]"}], "=!=", "0"}], ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"RischTrace", "[", 
          RowBox[{"SPDE", ",", "$Failed", ",", "\"\<Out\>\""}], "]"}], ";", 
         "\t", "\[IndentingNewLine]", "\t", 
         RowBox[{"Throw", "[", "$Failed", "]"}]}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"A", "=", 
       RowBox[{"Cancel", "[", 
        RowBox[{"A", "/", "G"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"B", "=", 
       RowBox[{"Cancel", "[", 
        RowBox[{"B", "/", "G"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"C", "=", 
       RowBox[{"Cancel", "[", 
        RowBox[{"C", "/", "G"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Which", "[", "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"MatchQ", "[", 
         RowBox[{"B", ",", "0"}], "]"}], ",", "\[IndentingNewLine]", "\t\t\t", 
        RowBox[{
         RowBox[{"res1", "=", 
          RowBox[{"RischInternal", "[", 
           RowBox[{"C", ",", "theta", ",", "tower", ",", "Dtower", ",", 
            RowBox[{"\"\<ExtendThetas\>\"", "->", "True"}], ",", 
            RowBox[{"\"\<RecursiveCall\>\"", "\[Rule]", "True"}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", "\t\t\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"res1", "==", "$Failed"}], ",", 
           RowBox[{
            RowBox[{"RischTrace", "[", 
             RowBox[{"SPDE", ",", "$Failed", ",", "\"\<Out\>\""}], "]"}], ";", 
            RowBox[{"Throw", "[", "$Failed", "]"}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\t\t\t", 
         RowBox[{"Q", "=", 
          RowBox[{"First", "[", "res1", "]"}]}], ";", "\[IndentingNewLine]", 
         "\t\t\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Exponent", "[", 
             RowBox[{"Q", ",", 
              RowBox[{"Last", "[", "theta", "]"}]}], "]"}], "<=", "n"}], ",", 
           "\[IndentingNewLine]", "\t\t\t\t", 
           RowBox[{
            RowBox[{"RischTrace", "[", 
             RowBox[{"SPDE", ",", "Q", ",", "\"\<Out\>\""}], "]"}], ";", 
            "\[IndentingNewLine]", "\t\t\t\t", 
            RowBox[{"Throw", "[", "Q", "]"}]}], ",", "\[IndentingNewLine]", 
           "\t\t\t\t", 
           RowBox[{
            RowBox[{"RischTrace", "[", 
             RowBox[{"SPDE", ",", "$Failed", ",", "\"\<Out\>\""}], "]"}], ";",
             "\[IndentingNewLine]", "\t\t\t\t", 
            RowBox[{"Throw", "[", "$Failed", "]"}]}]}], "\[IndentingNewLine]",
           "\t\t\t", "]"}]}], ",", "\[IndentingNewLine]", "\t\t", 
        RowBox[{
         RowBox[{"Exponent", "[", 
          RowBox[{"A", ",", 
           RowBox[{"Last", "[", "theta", "]"}]}], "]"}], ">", "0"}], ",", 
        "\[IndentingNewLine]", "\t\t\t", 
        RowBox[{
         RowBox[{"bc", "=", 
          RowBox[{"ExtendedEuclidean", "[", 
           RowBox[{"B", ",", "A", ",", "C", ",", 
            RowBox[{"Last", "[", "theta", "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\t\t\t", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"qr", ",", "r"}], "}"}], "=", 
          RowBox[{"PolynomialQuotientRemainder", "[", 
           RowBox[{
            RowBox[{"First", "[", "bc", "]"}], ",", "A", ",", 
            RowBox[{"Last", "[", "theta", "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\t\t\t", 
         RowBox[{"Z", "=", 
          RowBox[{
           RowBox[{"B", "*", "qr"}], "+", 
           RowBox[{"Last", "[", "bc", "]"}]}]}], ";", "\[IndentingNewLine]", 
         "\t\t\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Exponent", "[", 
             RowBox[{"r", ",", 
              RowBox[{"Last", "[", "theta", "]"}]}], "]"}], ">", "n"}], ",", 
           RowBox[{
            RowBox[{"RischTrace", "[", 
             RowBox[{"SPDE", ",", "$Failed", ",", "\"\<Out\>\""}], "]"}], ";", 
            RowBox[{"Throw", "[", "$Failed", "]"}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\t\t\t", 
         RowBox[{"H", "=", 
          RowBox[{"SPDE", "[", 
           RowBox[{"A", ",", 
            RowBox[{"B", "+", 
             RowBox[{"TotalDerivation", "[", 
              RowBox[{"A", ",", "theta", ",", "Dtower"}], "]"}]}], ",", 
            "\[IndentingNewLine]", "\t\t\t\t\t", 
            RowBox[{"Simplify", "[", 
             RowBox[{"Z", "-", 
              RowBox[{"TotalDerivation", "[", 
               RowBox[{"r", ",", "theta", ",", "Dtower"}], "]"}]}], "]"}], 
            ",", "\[IndentingNewLine]", "\t\t\t\t\t", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
              "I", " ", "am", " ", "not", " ", "sure", " ", "how", " ", "one",
                " ", "can", " ", "avoid", " ", "using", " ", "Simplify", " ", 
               "here"}], ",", " ", "\[IndentingNewLine]", "\t\t\t\t\t", 
              RowBox[{
               RowBox[{
               "given", " ", "that", " ", "we", " ", "are", " ", "only", " ", 
                "simplifying", " ", "rational", " ", "expressions", " ", 
                "\[IndentingNewLine]", "\t\t\t\t\t", "it", " ", "should", " ",
                 "be", " ", "fairly", " ", "fast"}], "..."}]}], " ", "*)"}], 
            "\[IndentingNewLine]", "\t\t\t\t\t", 
            RowBox[{"n", "-", 
             RowBox[{"Exponent", "[", 
              RowBox[{"A", ",", 
               RowBox[{"Last", "[", "theta", "]"}]}], "]"}]}], ",", "theta", 
            ",", "tower", ",", "Dtower"}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\t\t\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"H", "===", "$Failed"}], ",", 
           RowBox[{
            RowBox[{"RischTrace", "[", 
             RowBox[{"SPDE", ",", "$Failed", ",", "\"\<Out\>\""}], "]"}], ";", 
            RowBox[{"Throw", "[", "$Failed", "]"}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\t\t\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Exponent", "[", 
             RowBox[{"H", ",", 
              RowBox[{"Last", "[", "theta", "]"}]}], "]"}], ">", "n"}], ",", 
           "\[IndentingNewLine]", "\t\t\t\t", 
           RowBox[{
            RowBox[{"RischTrace", "[", 
             RowBox[{"SPDE", ",", "$Failed", ",", "\"\<Out\>\""}], "]"}], ";",
             "\[IndentingNewLine]", "\t\t\t\t", 
            RowBox[{"Throw", "[", "$Failed", "]"}]}]}], " ", 
          "\[IndentingNewLine]", "\t\t\t", "]"}], ";", 
         RowBox[{"(*", " ", 
          RowBox[{"may", " ", "be", " ", "a", " ", "problem", " ", 
           RowBox[{"here", "!"}]}], " ", "*)"}], "\[IndentingNewLine]", 
         "\t\t\t", 
         RowBox[{"Throw", "[", 
          RowBox[{"Simplify", "[", 
           RowBox[{
            RowBox[{"A", "*", "H"}], "+", "r"}], "]"}], "]"}]}], ",", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{
         RowBox[{
          RowBox[{"Exponent", "[", 
           RowBox[{"A", ",", 
            RowBox[{"Last", "[", "theta", "]"}]}], "]"}], "==", "0"}], " ", "&&",
          " ", 
         RowBox[{
          RowBox[{"Exponent", "[", 
           RowBox[{"B", ",", 
            RowBox[{"Last", "[", "theta", "]"}]}], "]"}], ">", "0"}]}], ",", 
        "\[IndentingNewLine]", "\t\t\t", 
        RowBox[{
         RowBox[{"m", "=", 
          RowBox[{
           RowBox[{"Exponent", "[", 
            RowBox[{"C", ",", 
             RowBox[{"Last", "[", "theta", "]"}]}], "]"}], "-", 
           RowBox[{"Exponent", "[", 
            RowBox[{"B", ",", 
             RowBox[{"Last", "[", "theta", "]"}]}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", "\t\t\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"m", "<", "0"}], " ", "||", " ", 
            RowBox[{"m", ">", "n"}]}], ",", 
           RowBox[{
            RowBox[{"RischTrace", "[", 
             RowBox[{"SPDE", ",", "$Failed", ",", "\"\<Out\>\""}], "]"}], ";", 
            RowBox[{"Throw", "[", "$Failed", "]"}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\t\t\t", 
         RowBox[{"b", "=", 
          RowBox[{"lc", "[", 
           RowBox[{"B", ",", 
            RowBox[{"Last", "[", "theta", "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\t\t\t", 
         RowBox[{"c", "=", 
          RowBox[{"lc", "[", 
           RowBox[{"C", ",", 
            RowBox[{"Last", "[", "theta", "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\t\t\t", 
         RowBox[{"H", "=", 
          RowBox[{"SPDE", "[", 
           RowBox[{"A", ",", "B", ",", "\[IndentingNewLine]", "\t\t\t", 
            RowBox[{"Simplify", "[", 
             RowBox[{"C", "-", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"c", "/", "b"}], ")"}], "*", "B", "*", 
               SuperscriptBox[
                RowBox[{"Last", "[", "theta", "]"}], "m"]}], "-", 
              RowBox[{"A", "*", 
               RowBox[{"TotalDerivation", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"c", "/", "b"}], ")"}], 
                  SuperscriptBox[
                   RowBox[{"Last", "[", "theta", "]"}], "m"]}], ",", "theta", 
                 ",", "Dtower"}], "]"}]}]}], "]"}], ",", 
            "\[IndentingNewLine]", "\t\t\t", 
            RowBox[{"m", "-", "1"}], ",", "theta", ",", "tower", ",", 
            "Dtower"}], "]"}]}], ";", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"MUST", " ", "use", " ", "Simplify"}], ",", " ", 
           RowBox[{"try", " ", "example", " ", "in", " ", 
            RowBox[{"Davenport", "."}]}]}], " ", "*)"}], 
         "\[IndentingNewLine]", "\t\t\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"H", "===", "$Failed"}], ",", 
           RowBox[{
            RowBox[{"RischTrace", "[", 
             RowBox[{"SPDE", ",", "$Failed", ",", "\"\<Out\>\""}], "]"}], ";", 
            RowBox[{"Throw", "[", "$Failed", "]"}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\t\t\t", 
         RowBox[{"res", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"c", "/", "b"}], ")"}], 
            SuperscriptBox[
             RowBox[{"Last", "[", "theta", "]"}], "m"]}], "+", 
           RowBox[{"Simplify", "[", "H", "]"}]}]}], ";", 
         "\[IndentingNewLine]", "\t\t\t", 
         RowBox[{"RischTrace", "[", 
          RowBox[{"SPDE", ",", "res", ",", "\"\<Out\>\""}], "]"}], ";", 
         "\[IndentingNewLine]", "\t\t\t", 
         RowBox[{"Throw", "[", "res", "]"}]}], ",", "\[IndentingNewLine]", 
        "\t\t", 
        RowBox[{
         RowBox[{
          RowBox[{"Exponent", "[", 
           RowBox[{"A", ",", 
            RowBox[{"Last", "[", "theta", "]"}]}], "]"}], "==", "0"}], " ", "&&",
          " ", 
         RowBox[{
          RowBox[{"Exponent", "[", 
           RowBox[{"B", ",", 
            RowBox[{"Last", "[", "theta", "]"}]}], "]"}], "==", "0"}]}], ",", 
        "\[IndentingNewLine]", "\t\t\t", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "ParametricDE", " ", "is", " ", "only", " ", "required", " ", "for",
            " ", "the", " ", "exponential", " ", "and", " ", "non"}], "-", 
          RowBox[{"trivial", " ", "primitive", " ", "cases"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", "\t\t\t", 
        RowBox[{
         RowBox[{"res", "=", 
          RowBox[{"CancelPolyDE", "[", 
           RowBox[{
           "A", ",", "B", ",", "C", ",", "n", ",", "theta", ",", "tower", ",",
             "Dtower"}], "]"}]}], ";", "\[IndentingNewLine]", "\t\t\t", 
         RowBox[{"RischTrace", "[", 
          RowBox[{"SPDE", ",", "res", ",", "\"\<Out\>\""}], "]"}], ";", 
         "\[IndentingNewLine]", "\t\t\t", 
         RowBox[{"Throw", "[", "res", "]"}]}]}], "\[IndentingNewLine]", 
       "]"}]}]}], "\[IndentingNewLine]", "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.394155605934375*^9, 3.394155699028125*^9}, {
   3.394155782496875*^9, 3.394155798840625*^9}, {3.39415599545*^9, 
   3.394156057715625*^9}, {3.394156245871875*^9, 3.39415628945*^9}, {
   3.39415641004375*^9, 3.394156435590625*^9}, {3.394156494278125*^9, 
   3.394156712965625*^9}, {3.3941567588875*^9, 3.394156768871875*^9}, {
   3.394156802340625*^9, 3.394156829559375*^9}, {3.394156902075*^9, 
   3.3941569173875*^9}, {3.3941569752*^9, 3.394156976746875*^9}, {
   3.39415702073125*^9, 3.394157241809375*^9}, {3.394157696590625*^9, 
   3.394157722465625*^9}, {3.394158951684375*^9, 3.394159067075*^9}, {
   3.39415910454375*^9, 3.394159200621875*^9}, {3.394159408309375*^9, 
   3.394159424840625*^9}, {3.394159461621875*^9, 3.394159643621875*^9}, {
   3.394159681465625*^9, 3.39415977473125*^9}, {3.394159809778125*^9, 
   3.394159810778125*^9}, {3.394160407215625*^9, 3.3941605438875*^9}, {
   3.394160575965625*^9, 3.39416057891875*^9}, {3.39431357137325*^9, 
   3.39431357374825*^9}, {3.394314103342*^9, 3.39431413162325*^9}, {
   3.394314190482625*^9, 3.394314216295125*^9}, {3.394314389826375*^9, 
   3.394314545357625*^9}, {3.39431457999825*^9, 3.394314603638875*^9}, {
   3.3943146372795*^9, 3.394314767607625*^9}, {3.394314962670125*^9, 
   3.3943149959045*^9}, {3.3951321539083567`*^9, 3.395132314534833*^9}, {
   3.3951506695858707`*^9, 3.395150673846545*^9}, {3.395395791382483*^9, 
   3.39539579785996*^9}, {3.39591710395676*^9, 3.395917136526741*^9}, {
   3.395917794726164*^9, 3.3959177959503717`*^9}, {3.395918129981744*^9, 
   3.395918144573173*^9}, {3.395918610639168*^9, 3.3959186177755938`*^9}, {
   3.3959186578149776`*^9, 3.395918673936295*^9}, {3.3959188029876537`*^9, 
   3.395918844288612*^9}, {3.395919232550542*^9, 3.395919238748567*^9}, {
   3.395969045123461*^9, 3.39596909052777*^9}, {3.395969127221322*^9, 
   3.395969151523576*^9}, {3.395969223278916*^9, 3.39596929350107*^9}, {
   3.395969327876305*^9, 3.395969337769785*^9}, {3.395978529509082*^9, 
   3.395978597428989*^9}, {3.395978934780675*^9, 3.3959789415246077`*^9}, {
   3.3959790098862143`*^9, 3.395979030575488*^9}, {3.395979453672893*^9, 
   3.395979506261471*^9}, {3.395992718104479*^9, 3.3959927226379347`*^9}, {
   3.3959935592949553`*^9, 3.3959935624280567`*^9}, {3.396256054961459*^9, 
   3.3962560757678947`*^9}, {3.396256122875334*^9, 3.396256131294031*^9}, {
   3.396256161391561*^9, 3.3962562249017057`*^9}, {3.3962563033870573`*^9, 
   3.396256304450585*^9}, {3.396256536655532*^9, 3.396256551125675*^9}, {
   3.3962575533819647`*^9, 3.396257559612666*^9}, {3.396257941668784*^9, 
   3.396257952180015*^9}, {3.396259161607554*^9, 3.396259189261387*^9}, {
   3.396259674570816*^9, 3.396259681785844*^9}, {3.396259721528111*^9, 
   3.396259766323086*^9}, {3.3962600358527937`*^9, 3.396260039826064*^9}, {
   3.396260076607222*^9, 3.396260080900419*^9}, 3.396260532124506*^9, {
   3.396260757390888*^9, 3.396260871589734*^9}, {3.396260916311129*^9, 
   3.396260920498987*^9}, {3.396261029161306*^9, 3.3962610548790283`*^9}, {
   3.396262612209771*^9, 3.3962626195452967`*^9}, {3.396262703019096*^9, 
   3.396262714746381*^9}, {3.396262794841175*^9, 3.396262795961733*^9}, {
   3.396262873199589*^9, 3.396262873391123*^9}, {3.396262918077279*^9, 
   3.396262964029374*^9}, {3.396265971919018*^9, 3.3962659988387403`*^9}, {
   3.396266032446652*^9, 3.396266033989295*^9}, {3.396266081000742*^9, 
   3.396266104255022*^9}, {3.3962662407546387`*^9, 3.3962662644978848`*^9}, {
   3.396266298008025*^9, 3.396266404193179*^9}, {3.39626646337087*^9, 
   3.396266486247356*^9}, {3.3962675832441463`*^9, 3.3962675836201067`*^9}, {
   3.396397607996024*^9, 3.3963976128189096`*^9}, {3.396569665788857*^9, 
   3.3965697220862637`*^9}, {3.3965697915242558`*^9, 3.396569798524166*^9}, {
   3.3965698589080257`*^9, 3.396569866739553*^9}, {3.396570247963457*^9, 
   3.396570314322206*^9}, {3.396570769256473*^9, 3.396570789365896*^9}, {
   3.39658873935653*^9, 3.396588762766109*^9}, {3.3974476140078583`*^9, 
   3.397447760354063*^9}, {3.397447928004051*^9, 3.3974479359452333`*^9}, {
   3.397448268382996*^9, 3.397448270852715*^9}, {3.397448501413486*^9, 
   3.3974485530389223`*^9}, {3.397449881493626*^9, 3.397449933244361*^9}, {
   3.3974500038730087`*^9, 3.3974500040539093`*^9}, {3.397450090971903*^9, 
   3.397450117032551*^9}, {3.397450166756033*^9, 3.397450290642798*^9}, {
   3.397450414684708*^9, 3.3974504293836937`*^9}, {3.397450703389268*^9, 
   3.397450718221813*^9}, {3.397450869352889*^9, 3.397450870944426*^9}, {
   3.397450920925371*^9, 3.39745092287703*^9}, {3.39745116066331*^9, 
   3.397451256355734*^9}, {3.397451305598486*^9, 3.39745130690702*^9}, {
   3.3974517135495787`*^9, 3.397451823383028*^9}, {3.397452052528364*^9, 
   3.397452094745859*^9}, {3.3974521694898787`*^9, 3.397452195833475*^9}, {
   3.39745234114165*^9, 3.397452406356599*^9}, {3.397452446738307*^9, 
   3.397452451162347*^9}, {3.3974525092256527`*^9, 3.3974526324638*^9}, {
   3.397452668444222*^9, 3.397452705922637*^9}, {3.397452796060474*^9, 
   3.397452927307374*^9}, 3.3976104381415367`*^9, {3.3978733979291*^9, 
   3.3978734050076027`*^9}, {3.397873489104332*^9, 3.397873522918676*^9}, {
   3.397873635521277*^9, 3.39787364392203*^9}, {3.39787443330405*^9, 
   3.397874440736713*^9}, {3.3978745725043917`*^9, 3.397874577175243*^9}, {
   3.397874809352682*^9, 3.397874815737156*^9}, {3.39787590497862*^9, 
   3.397875939087625*^9}, {3.404717598738646*^9, 3.404717617580173*^9}, {
   3.4049615432963877`*^9, 3.4049615697563353`*^9}, {3.404961600947741*^9, 
   3.4049616464334927`*^9}, {3.404961718704576*^9, 3.404961798321637*^9}, {
   3.4049618393147993`*^9, 3.40496191327887*^9}, 3.407987624416869*^9, {
   3.409820086173761*^9, 3.4098200892066383`*^9}, {3.409820197382311*^9, 
   3.409820199825445*^9}, {3.409820255172863*^9, 3.4098202595645447`*^9}, {
   3.409820324598014*^9, 3.409820338857044*^9}, {3.409820453683741*^9, 
   3.409820453852126*^9}, {3.409822123481134*^9, 3.409822123633759*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SPDE", "[", 
   RowBox[{
    RowBox[{"8", " ", 
     SubsuperscriptBox["\[Theta]", "1", "2"]}], ",", 
    RowBox[{
     RowBox[{"-", "16"}], " ", "\[ImaginaryI]", " ", 
     SubsuperscriptBox["\[Theta]", "1", "2"]}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "8"}], " ", "\[ImaginaryI]", " ", 
      SubsuperscriptBox["\[Theta]", "1", "2"], " ", 
      SubsuperscriptBox["\[Theta]", "2", "2"]}], "+", 
     RowBox[{"8", " ", "\[ImaginaryI]", " ", 
      SubsuperscriptBox["\[Theta]", "1", "6"], " ", 
      SubsuperscriptBox["\[Theta]", "2", "2"]}]}], ",", "2", ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", 
      SubscriptBox["\[Theta]", "1"], ",", 
      SubscriptBox["\[Theta]", "2"]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", 
      RowBox[{"rischExp", "[", 
       RowBox[{"\[ImaginaryI]", " ", "x"}], "]"}], ",", 
      RowBox[{"rischExp", "[", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           FractionBox["1", 
            SubscriptBox["\[Theta]", "1"]]}], "+", 
          SubscriptBox["\[Theta]", "1"]}], ")"}]}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", 
      RowBox[{"\[ImaginaryI]", " ", 
       SubscriptBox["\[Theta]", "1"]}], ",", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SubsuperscriptBox["\[Theta]", "1", "2"]}], ")"}], " ", 
        SubscriptBox["\[Theta]", "3"]}], 
       RowBox[{"2", " ", 
        SubscriptBox["\[Theta]", "1"]}]]}], "}"}]}], "]"}], 
  RowBox[{"(*", " ", "bug", " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.409820131299124*^9, 3.40982013794261*^9}, {
  3.409822258016779*^9, 3.409822259670622*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SPDE", "[", 
  RowBox[{
   RowBox[{
    SuperscriptBox["t1", "3"], " ", "x"}], ",", 
   RowBox[{
    RowBox[{"-", "t1"}], "-", 
    SuperscriptBox["t1", "2"]}], ",", "t1", ",", "1", ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "t1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"rischLog", "[", "x", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     FractionBox["1", "x"]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.397873379895138*^9, 3.397873382294293*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "1"}], "+", "t1"}]], "Output",
 CellChangeTimes->{{3.3978733845123587`*^9, 3.397873406691276*^9}, {
   3.397873504012775*^9, 3.397873525257429*^9}, 3.3978736457024727`*^9, 
   3.397874442131884*^9, 3.3978745787246037`*^9, 3.3978748177358837`*^9, {
   3.397875929943993*^9, 3.397875940809799*^9}, 3.404961916176448*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SPDE", "[", 
  RowBox[{
   RowBox[{
    SuperscriptBox["x", "2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"x", "+", 
       SubscriptBox["\[Theta]", "1"]}], ")"}], "2"]}], ",", 
   RowBox[{
    RowBox[{"2", " ", "x", " ", 
     SubscriptBox["\[Theta]", "1"]}], "-", 
    RowBox[{
     SuperscriptBox["x", "2"], " ", 
     SubscriptBox["\[Theta]", "1"]}], "+", 
    SubsuperscriptBox["\[Theta]", "1", "2"]}], ",", 
   RowBox[{
    RowBox[{"2", " ", "x", " ", 
     SubscriptBox["\[Theta]", "1"]}], "-", 
    RowBox[{
     SuperscriptBox["x", "2"], " ", 
     SubscriptBox["\[Theta]", "1"]}], "+", 
    SubsuperscriptBox["\[Theta]", "1", "2"]}], ",", "0", ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     SubscriptBox["\[Theta]", "1"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"rischExp", "[", "x", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     SubscriptBox["\[Theta]", "1"]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.397451099383176*^9, 3.39745112357551*^9}}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{
  3.397451124689584*^9, 3.397451166426798*^9, {3.397451207575601*^9, 
   3.397451258350569*^9}, {3.3974518095387983`*^9, 3.397451824655663*^9}, 
   3.397452061536878*^9, 3.39745209581073*^9, 3.3974522031769037`*^9, 
   3.3974522642456827`*^9, 3.397452407595787*^9, 3.397452452434783*^9, {
   3.3974525551221743`*^9, 3.397452617214244*^9}, {3.3974526599052057`*^9, 
   3.397452708164157*^9}, 3.3974527981918097`*^9, {3.397452844940496*^9, 
   3.397452858975*^9}, 3.397452929081567*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SPDE", "[", 
  RowBox[{
   RowBox[{"x", " ", 
    SubsuperscriptBox["\"\<\[Theta]\>\"", "1", "2"]}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"x", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SubsuperscriptBox["\"\<\[Theta]\>\"", "1", "2"]}], ")"}]}], ",", "1", 
   ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     SubscriptBox["\"\<\[Theta]\>\"", "1"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"rischLog", "[", "x", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     FractionBox["1", "x"]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.397447586196639*^9, 3.3974476039146843`*^9}}],

Cell[BoxData["x"], "Output",
 CellChangeTimes->{{3.397447604615879*^9, 3.3974477614758253`*^9}, 
   3.397447937154381*^9, 3.397450198322249*^9, {3.3974502346748962`*^9, 
   3.397450291955473*^9}, 3.3974510058500433`*^9, {3.397451222539546*^9, 
   3.397451259992045*^9}, 3.397451826567194*^9, {3.397452408500861*^9, 
   3.397452453774748*^9}, 3.397452556764621*^9, 3.397452930104694*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SPDE", "[", 
  RowBox[{"4", ",", 
   FractionBox[
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       SubsuperscriptBox["\[Theta]", "1", "2"]}], ")"}]}], 
    SubscriptBox["\[Theta]", "1"]], ",", 
   FractionBox[
    RowBox[{"2", " ", "\[ImaginaryI]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SubsuperscriptBox["\[Theta]", "1", "4"]}], ")"}]}], 
    SubsuperscriptBox["\[Theta]", "1", "2"]], ",", "1", ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     SubscriptBox["\[Theta]", "1"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"rischExp", "[", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", "x"}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{
      RowBox[{"-", "\[ImaginaryI]"}], " ", 
      SubscriptBox["\[Theta]", "1"]}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.396569600909514*^9, 3.396569623071163*^9}}],

Cell[BoxData["$Failed"], "Output",
 CellChangeTimes->{
  3.3965696243869123`*^9, {3.3965696695593777`*^9, 3.3965696872834997`*^9}, 
   3.3965698003488617`*^9, 3.396569869149688*^9, 3.396570223104928*^9, {
   3.396570257412725*^9, 3.39657031606754*^9}, 3.396570527578874*^9, {
   3.396570777505887*^9, 3.396570790887158*^9}, 3.396583884306326*^9, 
   3.396584413263118*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"SPDE", "[", 
   RowBox[{
    SuperscriptBox["x", "2"], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "x"}], " ", 
      SubscriptBox["\[Theta]", "1"]}], "+", 
     RowBox[{
      SuperscriptBox["x", "2"], " ", 
      SubscriptBox["\[Theta]", "1"]}]}], ",", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "x"}], ")"}], " ", 
     SuperscriptBox["x", "2"], " ", 
     SuperscriptBox[
      SubscriptBox["\[Theta]", "1"], "2"]}], ",", "1", ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", 
      SubscriptBox["\[Theta]", "1"]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", 
      RowBox[{"rischExp", "[", 
       FractionBox["1", "x"], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", 
      RowBox[{"-", 
       FractionBox[
        SubscriptBox["\[Theta]", "1"], 
        SuperscriptBox["x", "2"]]}]}], "}"}]}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Davenport", " ", "example"}], "..."}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.3962559803919086`*^9, 3.396256010846431*^9}, {
  3.396256111757147*^9, 3.396256112308465*^9}, {3.396266500937306*^9, 
  3.396266506703602*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "1"}], "+", 
  RowBox[{"x", " ", 
   SubscriptBox["\[Theta]", "1"]}]}]], "Output",
 CellChangeTimes->{3.396569597560809*^9, 3.396570223743754*^9, 
  3.396570794644742*^9, 3.3965838633936033`*^9}]
}, Closed]],

Cell[BoxData[
 RowBox[{
  RowBox[{"SPDE", "[", 
   RowBox[{
    RowBox[{"1", "+", "x", "+", 
     SuperscriptBox["x", "4"]}], ",", 
    RowBox[{
     RowBox[{"-", "2"}], "-", "x", "-", 
     RowBox[{"4", " ", 
      SuperscriptBox["x", "3"]}], "-", 
     SuperscriptBox["x", "4"]}], ",", 
    RowBox[{
     RowBox[{"-", "x"}], " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", "x"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", "x", "+", 
       RowBox[{"4", " ", 
        SuperscriptBox["x", "2"]}], "+", 
       RowBox[{"3", " ", 
        SuperscriptBox["x", "3"]}], "+", 
       SuperscriptBox["x", "4"]}], ")"}]}], ",", "2", ",", 
    RowBox[{"{", "x", "}"}], ",", 
    RowBox[{"{", "x", "}"}], ",", 
    RowBox[{"{", "1", "}"}]}], "]"}], "//", "Timing"}]], "Input",
 CellChangeTimes->{{3.395917729591391*^9, 3.395917749125536*^9}, {
   3.39591780355435*^9, 3.395917812404119*^9}, 3.3959180388798018`*^9, 
   3.39591806921268*^9, {3.395918137772091*^9, 3.395918149163107*^9}, {
   3.395918634589229*^9, 3.3959186358363457`*^9}, {3.395918667236486*^9, 
   3.395918668283478*^9}, {3.3959791191130743`*^9, 3.395979120213064*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"SPDE", "[", 
   RowBox[{"1", ",", "1", ",", "x", ",", "1", ",", 
    RowBox[{"{", "x", "}"}], ",", 
    RowBox[{"{", "x", "}"}], ",", 
    RowBox[{"{", "1", "}"}]}], "]"}], 
  RowBox[{"(*", " ", "bug", " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.395992773854677*^9, 3.3959927766695766`*^9}, {
  3.3965837173785963`*^9, 3.396583724535511*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "1"}], "+", "x"}]], "Output",
 CellChangeTimes->{3.396583851670184*^9}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Base Case Solution to Polynomial DE", "Subsection",
 CellChangeTimes->{{3.3959973183343267`*^9, 3.3959973291035624`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PolyDE", "[", 
   RowBox[{"a_", ",", "b_", ",", "c_", ",", "x_"}], "]"}], ":=", 
  RowBox[{"Catch", "[", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "alpha", ",", "beta", ",", "gamma", ",", "pi", ",", "ypi", ",", "new", 
       ",", "res"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
         "a", " ", "fast", " ", "algorithm", " ", "to", " ", "solve", " ", 
          "a", " ", 
          RowBox[{
           RowBox[{"y", "'"}], "[", "x", "]"}]}], " ", "+", " ", 
         RowBox[{"b", " ", 
          RowBox[{"y", "[", "x", "]"}]}]}], " ", "=", " ", "c"}], ",", " ", 
       RowBox[{"where", " ", "a"}], ",", "b", ",", 
       RowBox[{"c", " ", "are", " ", 
        RowBox[{"polynomials", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "Depending", " ", "on", " ", "the", " ", "degrees", " ", "of", " ", 
        "a"}], ",", "b", ",", 
       RowBox[{
        RowBox[{
        "c", " ", "we", " ", "reduce", " ", "the", " ", "RHS", " ", "of", " ",
          "the", " ", "DE", " ", "until", " ", "c"}], " ", "=", " ", 
        RowBox[{"0", " ", "\[IndentingNewLine]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"or", " ", "a"}], "=", 
           RowBox[{
            RowBox[{"0", " ", "or", " ", "b"}], "=", 
            RowBox[{
            "0", " ", "in", " ", "which", " ", "case", " ", "the", " ", 
             "solution", " ", "is", " ", "trivial"}]}]}], ")"}]}]}]}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"RischTrace", "[", 
       RowBox[{"PolyDE", ",", 
        RowBox[{"{", 
         RowBox[{"a", ",", "b", ",", "c"}], "}"}], ",", "\"\<In\>\""}], "]"}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"a", "===", "0"}], ",", "\[IndentingNewLine]", "\t", 
        RowBox[{"Throw", "[", 
         RowBox[{"c", "/", "b"}], "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"b", "===", "0"}], ",", "\[IndentingNewLine]", "\t", 
        RowBox[{"Throw", "[", 
         RowBox[{"First", "[", 
          RowBox[{"RischInternal", "[", 
           RowBox[{
            RowBox[{"c", "/", "a"}], ",", 
            RowBox[{"{", "x", "}"}], ",", 
            RowBox[{"{", "x", "}"}], ",", 
            RowBox[{"{", "1", "}"}], ",", 
            RowBox[{"\"\<RecursiveCall\>\"", "\[Rule]", "True"}], ",", 
            RowBox[{"\"\<ExtendThetas\>\"", "\[Rule]", "False"}]}], "]"}], 
          "]"}], "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"c", "===", "0"}], ",", "\[IndentingNewLine]", "\t", 
        RowBox[{"Throw", "[", "0", "]"}]}], "\[IndentingNewLine]", "]"}], ";",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"alpha", ",", "beta", ",", "gamma"}], "}"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Exponent", "[", 
          RowBox[{"#", ",", "x"}], "]"}], "&"}], "/@", 
        RowBox[{"{", 
         RowBox[{"a", ",", "b", ",", "c"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{
         RowBox[{"alpha", "-", "1"}], ">", "beta"}], ",", 
        "\[IndentingNewLine]", "\t\t\t", 
        RowBox[{
         RowBox[{"pi", "=", 
          RowBox[{"Max", "[", 
           RowBox[{
            RowBox[{"gamma", "-", "alpha", "+", "1"}], ",", "0"}], "]"}]}], 
         ";", "\[IndentingNewLine]", "\t\t\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"pi", "<", "0"}], ",", 
           RowBox[{"Throw", "[", "$Failed", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\t\t\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"alpha", "===", "0"}], ",", "\[IndentingNewLine]", 
           "\t\t\t", 
           RowBox[{"ypi", "=", 
            RowBox[{
             RowBox[{"lc", "[", 
              RowBox[{"c", ",", "x"}], "]"}], "/", 
             RowBox[{"lc", "[", 
              RowBox[{"b", ",", "x"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
           "\t\t\t", 
           RowBox[{"ypi", "=", 
            RowBox[{
             RowBox[{"lc", "[", 
              RowBox[{"c", ",", "x"}], "]"}], "/", 
             RowBox[{"(", 
              RowBox[{"pi", " ", 
               RowBox[{"lc", "[", 
                RowBox[{"a", ",", "x"}], "]"}]}], ")"}]}]}]}], 
          "\[IndentingNewLine]", "\t\t\t", "]"}]}], ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"alpha", "-", "1"}], "===", "beta"}], ",", 
        "\[IndentingNewLine]", "\t\t\t", 
        RowBox[{"(*", " ", 
         RowBox[{
         "there", " ", "are", " ", "problems", " ", "with", " ", "this", " ", 
          RowBox[{"case", ":", " ", 
           RowBox[{"Try", "\[IndentingNewLine]", "\t\t\t ", 
            RowBox[{"PDE", "[", 
             RowBox[{
              SuperscriptBox["x", "4"], ",", 
              RowBox[{
               RowBox[{"-", 
                SuperscriptBox["x", "2"]}], "-", 
               RowBox[{"2", 
                SuperscriptBox["x", "3"]}]}], ",", 
              RowBox[{
               SuperscriptBox["x", "2"], "+", 
               SuperscriptBox["x", "3"]}], ",", "x"}], "]"}]}]}]}], "*)"}], 
        "\[IndentingNewLine]", "\t\t\t", 
        RowBox[{
         RowBox[{"pi", "=", 
          RowBox[{"gamma", "-", "beta"}]}], ";", "\[IndentingNewLine]", 
         "\t\t\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"pi", "<", "0"}], "||", 
            RowBox[{
             RowBox[{
              RowBox[{"pi", " ", 
               RowBox[{"lc", "[", 
                RowBox[{"a", ",", "x"}], "]"}]}], "+", 
              RowBox[{"lc", "[", 
               RowBox[{"b", ",", "x"}], "]"}]}], "==", "0"}]}], ",", 
           RowBox[{"Throw", "[", "$Failed", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\t\t\t", 
         RowBox[{"ypi", "=", 
          RowBox[{
           RowBox[{"lc", "[", 
            RowBox[{"c", ",", "x"}], "]"}], "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"pi", " ", 
              RowBox[{"lc", "[", 
               RowBox[{"a", ",", "x"}], "]"}]}], "+", 
             RowBox[{"lc", "[", 
              RowBox[{"b", ",", "x"}], "]"}]}], ")"}]}]}]}], ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"alpha", "-", "1"}], "<", "beta"}], ",", 
        "\[IndentingNewLine]", "\t\t\t", 
        RowBox[{
         RowBox[{"pi", "=", 
          RowBox[{"gamma", "-", "beta"}]}], ";", "\[IndentingNewLine]", 
         "\t\t\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"pi", "<", "0"}], ",", 
           RowBox[{"Throw", "[", "$Failed", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\t\t\t", 
         RowBox[{"ypi", "=", 
          RowBox[{
           RowBox[{"lc", "[", 
            RowBox[{"c", ",", "x"}], "]"}], "/", 
           RowBox[{"lc", "[", 
            RowBox[{"b", ",", "x"}], "]"}]}]}]}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"new", "=", 
       RowBox[{"ypi", " ", 
        RowBox[{"x", "^", "pi"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"res", "=", 
       RowBox[{"new", "+", 
        RowBox[{"PolyDE", "[", 
         RowBox[{"a", ",", "b", ",", 
          RowBox[{"Expand", "[", 
           RowBox[{"c", "-", 
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{"new", ",", "x"}], "]"}], "a"}], "-", 
            RowBox[{"new", " ", "b"}]}], "]"}], ",", "x"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"RischTrace", "[", 
       RowBox[{"PolyDE", ",", "res", ",", "\"\<Out\>\""}], "]"}], ";", 
      "\[IndentingNewLine]", "res"}]}], "\[IndentingNewLine]", "]"}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJwdzT1IAmEAxvFLhCgsrJAQTj0pKPwaaomWMiwkHPogwkZLkTAjx2hwkGjR
IKcsg8APSDqoaBOShlwiQrFEKEwvzQgRh0SuoXve4eHHM/3Vtu0lu4iiKLkw
6N5TBbSOmnFdIr6AjvMKC3ln9Yr8r6db+K0eTsKqP/cAbUH6DdLZCAeDtLQG
O6PhBvT2+JpQwsV+YeTZ2oIK8+QfPG15xDpBhlvrgsrQgAwaMidy6GI8Q7CS
zn3C+XjqB1rKY916ODJFDKwM9sGSgu2HGm1cDzd2vQZYOFPNwMvr5By0fxQX
YX7Hsgz9owtuGBu/IyZ9hSM4MR07hkaqnYBSmfIGFmf306S/2X6EvQeNDFx1
ibLQ+p54hSmGzUNTyVmGuuY9T7ov5g6DYMgUJNb5LTUMH0Y18B+Cvr0b
  "]],

Cell[BoxData[
 RowBox[{
  RowBox[{"PolyDE", "[", 
   RowBox[{
    SuperscriptBox["x", "4"], ",", 
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox["x", "2"]}], "-", 
     RowBox[{"2", 
      SuperscriptBox["x", "3"]}]}], ",", 
    RowBox[{
     SuperscriptBox["x", "2"], 
     RowBox[{"(", 
      RowBox[{"1", "+", "x"}], ")"}]}], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"bug", "!!"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.408935776581406*^9, 3.408935797480797*^9}, {
  3.408935964819437*^9, 3.4089359697781897`*^9}, {3.409015145369567*^9, 
  3.4090151510814962`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"PolyDE", "[", 
   RowBox[{
    SuperscriptBox["x", "2"], ",", 
    RowBox[{"-", "1"}], ",", 
    SuperscriptBox["x", "5"], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"GOOD", ",", " ", 
    RowBox[{
    "here", " ", "we", " ", "actually", " ", "get", " ", "the", " ", 
     "elementary", " ", 
     RowBox[{
      RowBox[{"part", "!!"}], "!"}], " ", "This", " ", "will", " ", "be", " ",
      "useful", " ", "for", " ", "Cherry", " ", "code"}]}], " ", 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.404716702316175*^9, 3.40471671612017*^9}, {
  3.404717662645752*^9, 3.40471768415053*^9}, {3.409013466338585*^9, 
  3.40901347224149*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["x", "24"], "+", 
  FractionBox[
   SuperscriptBox["x", "2"], "24"], "+", 
  FractionBox[
   SuperscriptBox["x", "3"], "12"], "+", 
  FractionBox[
   SuperscriptBox["x", "4"], "4"], "+", "$Failed"}]], "Output",
 CellChangeTimes->{
  3.404716717385336*^9, {3.40471691911674*^9, 3.404716922428227*^9}, {
   3.404716961507612*^9, 3.404716967453755*^9}, {3.404717004012381*^9, 
   3.404717060415889*^9}, 3.404717122728093*^9, 3.404717234295231*^9, 
   3.404717660314725*^9, 3.404961945928527*^9, 3.4049621046642447`*^9, 
   3.407987571785561*^9, 3.408866749624593*^9, 3.4089360429322243`*^9, {
   3.409013467546933*^9, 3.409013473901787*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"PolyDE", "[", 
   RowBox[{
    RowBox[{"2", " ", "x"}], ",", 
    RowBox[{
     RowBox[{"-", "2"}], " ", "\[ImaginaryI]"}], ",", 
    RowBox[{"2", " ", "\[ImaginaryI]", " ", "x"}], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"now", " ", "gives", " ", "correct", " ", "result"}], " ", 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.404667593699333*^9, 3.404667601839576*^9}, {
  3.404673386442856*^9, 3.404673392757658*^9}, {3.4090134530346937`*^9, 
  3.409013457672904*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["1", "2"]}], "+", 
    FractionBox["\[ImaginaryI]", "2"]}], ")"}], " ", "x"}]], "Output",
 CellChangeTimes->{
  3.404672930479272*^9, 3.404672995769758*^9, {3.404673275371887*^9, 
   3.404673295311637*^9}, {3.4046733931337137`*^9, 3.4046734039209557`*^9}, 
   3.404673476648383*^9, {3.404716963330398*^9, 3.404716974971939*^9}, 
   3.404717007193571*^9, 3.404717125455826*^9, 3.4047172349307833`*^9, 
   3.407987572619165*^9, 3.4088667502238493`*^9, {3.4089359408060417`*^9, 
   3.408935952034616*^9}, 3.4090134540804443`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PolyDE", "[", 
  RowBox[{"1", ",", 
   RowBox[{"1", "+", "x"}], ",", 
   RowBox[{
    RowBox[{"3", 
     SuperscriptBox["x", "3"]}], "+", 
    RowBox[{"5", 
     SuperscriptBox["x", "2"]}], "+", 
    RowBox[{"9", "x"}], "+", "3"}], ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.4046734159035273`*^9, 3.404673416019829*^9}}],

Cell[BoxData[
 RowBox[{"1", "+", 
  RowBox[{"2", " ", "x"}], "+", 
  RowBox[{"3", " ", 
   SuperscriptBox["x", "2"]}]}]], "Output",
 CellChangeTimes->{
  3.404095521653449*^9, {3.404096236826769*^9, 3.404096241341062*^9}, 
   3.404096289063839*^9, 3.4040965957319593`*^9, 3.404096644881921*^9, {
   3.404096718308878*^9, 3.404096741362258*^9}, 3.4040968115540943`*^9, {
   3.4040968825499773`*^9, 3.404096887009713*^9}, {3.4046734097547407`*^9, 
   3.404673416426354*^9}, {3.404716970016263*^9, 3.404716976535289*^9}, 
   3.404717008490219*^9, {3.404717113202528*^9, 3.404717128526293*^9}, 
   3.404717235422049*^9, 3.407987573119096*^9, 3.4088667508310003`*^9, 
   3.408935955534573*^9, 3.4089364070376177`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PolyDE", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"15", "+", 
      RowBox[{"3", " ", "x"}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "x", "+", 
      SuperscriptBox["x", "2"]}], ")"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"2", " ", "x"}]}], ")"}]}], " ", 
     RowBox[{"(", 
      RowBox[{"15", "+", 
       RowBox[{"3", " ", "x"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", 
       SuperscriptBox["x", "2"]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "x", "+", 
       SuperscriptBox["x", "2"]}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{"-", "16"}], "-", 
    RowBox[{"2", " ", "x"}], "-", 
    RowBox[{"14", " ", 
     SuperscriptBox["x", "2"]}], "-", 
    RowBox[{"3", " ", 
     SuperscriptBox["x", "3"]}], "+", 
    SuperscriptBox["x", "4"], "-", 
    SuperscriptBox["x", "5"], "-", 
    SuperscriptBox["x", "6"]}], ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.3945935562275763`*^9, 3.394593565975761*^9}, {
   3.394593701103725*^9, 3.394593717153113*^9}, {3.394594463737365*^9, 
   3.39459446516496*^9}, {3.3945947564684553`*^9, 3.394594761034964*^9}, 
   3.3945975667203493`*^9, {3.399181643578197*^9, 3.399181645766631*^9}, {
   3.399181784913424*^9, 3.399181787700885*^9}, {3.3991819343590603`*^9, 
   3.399181953892117*^9}, {3.399182397169492*^9, 3.3991824380652857`*^9}, {
   3.399182536539645*^9, 3.399182554296865*^9}, {3.4040966583845863`*^9, 
   3.404096674029011*^9}, {3.404717139442769*^9, 3.4047171437467422`*^9}, {
   3.409013433813755*^9, 3.409013443778956*^9}}],

Cell[BoxData[
 RowBox[{"1", "-", 
  SuperscriptBox["x", "2"]}]], "Output",
 CellChangeTimes->{3.404717144231737*^9, 3.4047172425162973`*^9, 
  3.407987574251473*^9, 3.408866760130928*^9, 3.409013434997154*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"PolyDE", "[", 
  RowBox[{"1", ",", "0", ",", 
   RowBox[{"2", "x"}], ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.394975437921214*^9, 3.394975445168644*^9}, {
  3.404717156583831*^9, 3.4047171607281723`*^9}, {3.409013360935238*^9, 
  3.409013381264471*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Polynomial Cancellation DE Algorithm", "Subsection",
 CellChangeTimes->{{3.3951506916303997`*^9, 3.395150709023363*^9}, {
  3.396397575924629*^9, 3.3963975818642883`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"CancelPolyDE", "[", 
   RowBox[{
   "A_", ",", "B_", ",", "C_", ",", "n_", ",", "theta_", ",", "tower_", ",", 
    "Dtower_"}], "]"}], ":=", 
  RowBox[{"Catch", "[", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{
        RowBox[{"Head", "[", 
         RowBox[{"Last", "[", "tower", "]"}], "]"}], "===", "rischLog"}], ",",
        "\[IndentingNewLine]", "\t\t", 
       RowBox[{"Throw", "[", 
        RowBox[{"CancelPolyDEPrimitiveCase", "[", 
         RowBox[{
         "A", ",", "B", ",", "C", ",", "n", ",", "theta", ",", "tower", ",", 
          "Dtower"}], "]"}], " ", "]"}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"Head", "[", 
         RowBox[{"Last", "[", "tower", "]"}], "]"}], "===", "rischExp"}], ",",
        "\[IndentingNewLine]", "\t\t", 
       RowBox[{"Throw", "[", " ", 
        RowBox[{"CancelPolyDEExponentialCase", "[", 
         RowBox[{
         "A", ",", "B", ",", "C", ",", "n", ",", "theta", ",", "tower", ",", 
          "Dtower"}], "]"}], " ", "]"}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"Length", "[", "theta", "]"}], "==", "1"}], ",", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"Throw", "[", 
        RowBox[{"PolyDE", "[", 
         RowBox[{"A", ",", "B", ",", "C", ",", 
          RowBox[{"First", "[", "theta", "]"}]}], "]"}], "]"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.3951507113555927`*^9, 3.3951508014361897`*^9}, {
  3.395150839707324*^9, 3.3951508930309067`*^9}, {3.39639761957865*^9, 
  3.3963976292420692`*^9}, {3.396415724364965*^9, 3.396415725057729*^9}, {
  3.39658378789297*^9, 3.3965838390458317`*^9}, {3.4010904597550383`*^9, 
  3.4010904624505463`*^9}, {3.401090495861655*^9, 3.401090497386551*^9}, {
  3.404096758941663*^9, 3.404096761770287*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Polynomial Cancellation DE Algorithm - primitive case", "Subsection",
 CellChangeTimes->{{3.394160603340625*^9, 3.39416061666875*^9}, {
   3.395150682472526*^9, 3.395150687495728*^9}, {3.395151145863793*^9, 
   3.395151146580167*^9}, 3.396397590212144*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"CancelPolyDEPrimitiveCase", "[", 
   RowBox[{
   "a_", ",", "b_", ",", "C_", ",", "n_", ",", "theta_", ",", "tower_", ",", 
    "Dtower_"}], "]"}], ":=", 
  RowBox[{"Catch", "[", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "int", ",", "alpha", ",", "struct", ",", "q", ",", "Q", ",", "m", ",", 
       "c", ",", "r", ",", "H"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"RischTrace", "[", 
       RowBox[{"CancelPolyDEPrimitiveCase", ",", 
        RowBox[{"{", 
         RowBox[{
         "a", ",", "b", ",", "C", ",", "n", ",", "theta", ",", "tower", ",", 
          "Dtower"}], "}"}], ",", "\"\<In\>\""}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Given", " ", "a"}], ",", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"b", " ", "in", " ", "k", " ", "with", " ", "a"}], 
          "\[NotEqual]", 
          RowBox[{
           RowBox[{"0", " ", "C", " ", "in", " ", 
            RowBox[{"k", "[", "theta", "]"}], " ", "and", " ", "n", " ", "in",
             " ", 
            RowBox[{"Z", ".", " ", "Return"}], " ", "either", " ", "no", " ", 
            "solution", " ", "of", " ", "Q", " ", "in", " ", 
            RowBox[{"k", "[", "theta", "]"}], " ", "such", " ", "that", " ", 
            "deg", 
            RowBox[{"(", "Q", ")"}], " ", "n", " ", "and", " ", "a", "*", 
            RowBox[{"Q", "'"}]}], "+", 
           RowBox[{"b", "*", "Q"}]}]}], "=", 
         RowBox[{"C", "."}]}]}], "\[IndentingNewLine]", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"n", "<", "0"}], ",", 
        RowBox[{
         RowBox[{"RischTrace", "[", 
          RowBox[{
          "CancelPolyDEPrimitiveCase", ",", "$Failed", ",", "\"\<Out\>\""}], 
          "]"}], ";", 
         RowBox[{"Throw", "[", "$Failed", "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"C", "\[Equal]", "0"}], ",", 
        RowBox[{
         RowBox[{"RischTrace", "[", 
          RowBox[{"CancelPolyDEPrimitiveCase", ",", "0", ",", "\"\<Out\>\""}],
           "]"}], ";", 
         RowBox[{"Throw", "[", "0", "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"int", "=", 
       RowBox[{"RischInternal", "[", 
        RowBox[{
         RowBox[{"b", "/", "a"}], ",", "theta", ",", "tower", ",", "Dtower", 
         ",", 
         RowBox[{"\"\<ExtendThetas\>\"", "\[Rule]", "True"}], ",", 
         RowBox[{"\"\<RecursiveCall\>\"", "\[Rule]", "True"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"int", "===", "$Failed"}], ",", "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"RischTrace", "[", 
          RowBox[{
          "CancelPolyDEPrimitiveCase", ",", "$Failed", ",", "\"\<Out\>\""}], 
          "]"}], ";", "\[IndentingNewLine]", "\t", 
         RowBox[{"Throw", "[", "$Failed", "]"}]}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"struct", "=", 
       RowBox[{"IsStructureExtended", "[", 
        RowBox[{
         RowBox[{"rischExp", "[", 
          RowBox[{"-", "int"}], "]"}], ",", 
         RowBox[{"Most", "[", "theta", "]"}], ",", 
         RowBox[{"Most", "[", "tower", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"First", "[", "struct", "]"}], ",", "\[IndentingNewLine]", 
        "\t", 
        RowBox[{
         RowBox[{"alpha", "=", 
          RowBox[{"Last", "[", "struct", "]"}]}], ";", "\[IndentingNewLine]", 
         "\t", 
         RowBox[{"(*", 
          RowBox[{"alpha", " ", "not", " ", "in", " ", "k"}], "*)"}], 
         "\[IndentingNewLine]", "\t", 
         RowBox[{"RischTrace", "[", 
          RowBox[{
          "CancelPolyDEPrimitiveCase", ",", "$Failed", ",", "\"\<Out\>\""}], 
          "]"}], ";", "\[IndentingNewLine]", "\t", 
         RowBox[{"Throw", "[", "$Failed", "]"}]}], ",", "\[IndentingNewLine]",
         "\t", 
        RowBox[{
         RowBox[{"q", "=", 
          RowBox[{"RischInternal", "[", 
           RowBox[{
            RowBox[{"C", "/", 
             RowBox[{"(", 
              RowBox[{"a", "*", "alpha"}], ")"}]}], ",", "theta", ",", 
            "tower", ",", "Dtower", ",", 
            RowBox[{"\"\<ExtendThetas\>\"", "\[Rule]", "False"}], ",", 
            RowBox[{"\"\<RecursiveCall\>\"", "\[Rule]", "True"}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", "\t", 
         RowBox[{"Q", "=", 
          RowBox[{"Cancel", "[", 
           RowBox[{"alpha", "*", "q"}], "]"}]}], ";", "\[IndentingNewLine]", 
         "\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"q", "===", "$Failed"}], ",", 
           RowBox[{
            RowBox[{"RischTrace", "[", 
             RowBox[{
             "CancelPolyDEPrimitiveCase", ",", "$Failed", ",", 
              "\"\<Out\>\""}], "]"}], ";", 
            RowBox[{"Throw", "[", "$Failed", "]"}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{"(*", 
          RowBox[{"q", " ", "not", " ", "in", " ", 
           RowBox[{"k", "[", "theta", "]"}]}], "*)"}], "\[IndentingNewLine]", 
         "\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Exponent", "[", 
             RowBox[{"Q", ",", 
              RowBox[{"Last", "[", "theta", "]"}]}], "]"}], "\[LessEqual]", 
            "n"}], ",", "\[IndentingNewLine]", "\t\t", 
           RowBox[{
            RowBox[{"RischTrace", "[", 
             RowBox[{
             "CancelPolyDEPrimitiveCase", ",", "Q", ",", "\"\<Out\>\""}], 
             "]"}], ";", "\[IndentingNewLine]", "\t\t", 
            RowBox[{"Throw", "[", "Q", "]"}]}], ",", "\[IndentingNewLine]", 
           "\t\t", 
           RowBox[{
            RowBox[{"RischTrace", "[", 
             RowBox[{
             "CancelPolyDEPrimitiveCase", ",", "$Failed", ",", 
              "\"\<Out\>\""}], "]"}], ";", "\[IndentingNewLine]", "\t\t", 
            RowBox[{"Throw", "[", "$Failed", "]"}]}]}], "\[IndentingNewLine]",
           "\t", "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"m", "=", 
       RowBox[{"Exponent", "[", 
        RowBox[{"C", ",", 
         RowBox[{"Last", "[", "theta", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"m", ">", "n"}], ",", 
        RowBox[{
         RowBox[{"RischTrace", "[", 
          RowBox[{
          "CancelPolyDEPrimitiveCase", ",", "$Failed", ",", "\"\<Out\>\""}], 
          "]"}], ";", 
         RowBox[{"Throw", "[", "$Failed", "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"c", "=", 
       RowBox[{"lc", "[", 
        RowBox[{"C", ",", 
         RowBox[{"Last", "[", "theta", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"(*", 
       RowBox[{
       "solve", " ", "rde", " ", "for", " ", "r", " ", "in", " ", "k"}], 
       "*)"}], "\[IndentingNewLine]", "\t", 
      RowBox[{"r", "=", 
       RowBox[{"RischDE", "[", 
        RowBox[{
         RowBox[{"b", "/", "a"}], ",", 
         RowBox[{"c", "/", "a"}], ",", 
         RowBox[{"Most", "[", "theta", "]"}], ",", 
         RowBox[{"Most", "[", "tower", "]"}], ",", 
         RowBox[{"Most", "[", "Dtower", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"r", "===", "$Failed"}], ",", 
        RowBox[{
         RowBox[{"RischTrace", "[", 
          RowBox[{
          "CancelPolyDEPrimitiveCase", ",", "$Failed", ",", "\"\<Out\>\""}], 
          "]"}], ";", 
         RowBox[{"Throw", "[", "$Failed", "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"(*", "recursion", "*)"}], "\[IndentingNewLine]", "\t", 
      RowBox[{"H", "=", 
       RowBox[{"CancelPolyDE", "[", 
        RowBox[{"a", ",", "b", ",", 
         RowBox[{"Simplify", "[", 
          RowBox[{"C", "-", 
           RowBox[{"b", "*", "r", "*", 
            RowBox[{
             RowBox[{"Last", "[", "theta", "]"}], "^", "m"}]}], "-", 
           RowBox[{"a", "*", 
            RowBox[{"TotalDerivation", "[", 
             RowBox[{
              RowBox[{"r", "*", 
               RowBox[{
                RowBox[{"Last", "[", "theta", "]"}], "^", "m"}]}], ",", 
              "tower", ",", "Dtower"}], "]"}]}]}], "]"}], ",", 
         "\[IndentingNewLine]", "\t\t", 
         RowBox[{"m", "-", "1"}], ",", "theta", ",", "tower", ",", "Dtower"}],
         "]"}]}], ";", "\[IndentingNewLine]", "\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"H", "===", "$Failed"}], ",", 
        RowBox[{
         RowBox[{"RischTrace", "[", 
          RowBox[{
          "CancelPolyDEPrimitiveCase", ",", "$Failed", ",", "\"\<Out\>\""}], 
          "]"}], ";", 
         RowBox[{"Throw", "[", "$Failed", "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"RischTrace", "[", 
       RowBox[{"CancelPolyDEPrimitiveCase", ",", 
        RowBox[{
         RowBox[{"r", "*", 
          RowBox[{
           RowBox[{"Last", "[", "theta", "]"}], "^", "m"}]}], "+", "H"}], 
        ",", "\"\<Out\>\""}], "]"}], ";", "\[IndentingNewLine]", "\t", 
      RowBox[{"Throw", "[", 
       RowBox[{
        RowBox[{"r", "*", 
         RowBox[{
          RowBox[{"Last", "[", "theta", "]"}], "^", "m"}]}], "+", "H"}], 
       "]"}]}]}], "\[IndentingNewLine]", "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.404717895708267*^9, 3.404717978734784*^9}, {
  3.404962298938293*^9, 3.404962332924205*^9}, {3.404962453936956*^9, 
  3.404962485984364*^9}, {3.404962523729217*^9, 3.404962730362298*^9}, {
  3.408867196059822*^9, 3.408867256506752*^9}, {3.409054233180304*^9, 
  3.40905424864087*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Polynomial Cancellation DE Algorithm - exponential case", "Subsection",
 CellChangeTimes->{{3.395151179394326*^9, 3.395151202927348*^9}, 
   3.396397591620471*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"CancelPolyDEExponentialCase", "[", 
   RowBox[{
   "a_", ",", "b_", ",", "C_", ",", "n_", ",", "theta_", ",", "tower_", ",", 
    "Dtower_"}], "]"}], ":=", 
  RowBox[{"Catch", "[", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "int", ",", "alpha", ",", "q", ",", "Q", ",", "m", ",", "c", ",", 
       "Deta", ",", "r", ",", "H"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"RischTrace", "[", 
       RowBox[{"CancelPolyDEExponentialCase", ",", 
        RowBox[{"{", 
         RowBox[{
         "a", ",", "b", ",", "C", ",", "n", ",", "theta", ",", "tower", ",", 
          "Dtower"}], "}"}], ",", "\"\<In\>\""}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"Given", " ", "a"}], ",", 
        RowBox[{"b", " ", "in", " ", "k", " ", 
         RowBox[{"(", 
          RowBox[{"a", "!=", "0"}], ")"}]}], ",", " ", 
        RowBox[{"C", " ", "in", " ", 
         RowBox[{"k", "[", "theta", "]"}], " ", "and", " ", "n", " ", "in", 
         " ", 
         RowBox[{"Z", ".", " ", "Return"}], " ", "either", " ", "$Failed", 
         " ", "in", " ", "which", " ", "case", " ", "the", " ", "DE", " ", 
         "has", " ", "no", " ", "solution"}], ",", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"or", " ", "Q", " ", "in", " ", 
           RowBox[{"k", "[", "theta", "]"}], " ", "such", " ", "that", " ", 
           "deg", 
           RowBox[{"(", "Q", ")"}]}], "<=", 
          RowBox[{
           RowBox[{"n", " ", "and", " ", "a", " ", 
            RowBox[{"Q", "'"}]}], " ", "+", " ", 
           RowBox[{"b", " ", "Q"}]}]}], " ", "=", " ", 
         RowBox[{"C", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"C", "==", "0"}], ",", "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"RischTrace", "[", 
          RowBox[{
          "CancelPolyDEExponentialCase", ",", "0", ",", "\"\<In\>\""}], "]"}],
          ";", "\[IndentingNewLine]", "\t", 
         RowBox[{"Throw", "[", "0", "]"}]}]}], "\[IndentingNewLine]", "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"n", "<", "0"}], ",", "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"RischTrace", "[", 
          RowBox[{
          "CancelPolyDEExponentialCase", ",", "$Failed", ",", "\"\<In\>\""}], 
          "]"}], ";", "\[IndentingNewLine]", "\t", 
         RowBox[{"Throw", "[", "$Failed", "]"}]}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"write", " ", 
        RowBox[{"rischExp", "[", 
         RowBox[{"-", 
          RowBox[{"Risch", "[", 
           RowBox[{
            RowBox[{"b", "/", "a"}], ",", " ", "x"}], "]"}]}], "]"}], " ", 
        "as", " ", "beta", "*", 
        RowBox[{
         RowBox[{"Last", "[", "theta", "]"}], "^", "m"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"int", "=", 
       RowBox[{"ParametricLogarithmicDerivative", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "b"}], "/", "a"}], ",", "theta", ",", "tower", ",", 
         "Dtower"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"int", "=!=", "$Failed"}], ",", "\[IndentingNewLine]", "\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"First", "[", "int", "]"}], ">=", "0"}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{
           RowBox[{"alpha", "=", 
            RowBox[{"RischInternal", "[", 
             RowBox[{
              RowBox[{"b", "/", "a"}], ",", "theta", ",", "tower", ",", 
              "Dtower", ",", 
              RowBox[{"\"\<ExtendThetas\>\"", "->", "True"}], ",", 
              RowBox[{"\"\<RecursiveCall\>\"", "\[Rule]", "True"}]}], "]"}]}],
            ";", "\[IndentingNewLine]", "\t\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"alpha", "===", "$Failed"}], ",", "\[IndentingNewLine]", 
             "\t\t\t", 
             RowBox[{
              RowBox[{"RischTrace", "[", 
               RowBox[{
               "CancelPolyDEExponentialCase", ",", "$Failed", ",", 
                "\"\<In\>\""}], "]"}], ";", "\[IndentingNewLine]", "\t\t\t", 
              RowBox[{"Throw", "[", "$Failed", "]"}]}]}], 
            "\[IndentingNewLine]", "\t\t", "]"}], ";", "\[IndentingNewLine]", 
           "\t\t", 
           RowBox[{"alpha", "=", 
            RowBox[{"Last", "[", 
             RowBox[{"IsStructureExtended", "[", 
              RowBox[{
               RowBox[{"rischExp", "[", 
                RowBox[{"-", 
                 RowBox[{"First", "[", "alpha", "]"}]}], "]"}], ",", "theta", 
               ",", "tower"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           "\t\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"!", 
              RowBox[{"First", "[", "alpha", "]"}]}], ",", 
             RowBox[{"Throw", "[", "$Failed", "]"}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"(*", " ", 
            RowBox[{
            "line", " ", "above", " ", "assumes", " ", "result", " ", "lies", 
             " ", "in", " ", "tower"}], " ", "*)"}], "\[IndentingNewLine]", 
           "\t\t", 
           RowBox[{"q", "=", 
            RowBox[{"RischInternal", "[", 
             RowBox[{
              RowBox[{"C", "/", 
               RowBox[{"(", 
                RowBox[{"a", "*", "alpha"}], ")"}]}], ",", "theta", ",", 
              "tower", ",", "Dtower", ",", 
              RowBox[{"\"\<ExtendThetas\>\"", "\[Rule]", "False"}], ",", 
              RowBox[{"\"\<RecursiveCall\>\"", "\[Rule]", "True"}]}], "]"}]}],
            ";", "\[IndentingNewLine]", "\t\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"q", "===", "$Failed"}], ",", "\[IndentingNewLine]", 
             "\t\t\t", 
             RowBox[{
              RowBox[{"RischTrace", "[", 
               RowBox[{
               "CancelPolyDEExponentialCase", ",", "$Failed", ",", 
                "\"\<In\>\""}], "]"}], ";", "\[IndentingNewLine]", "\t\t\t", 
              RowBox[{"Throw", "[", "$Failed", "]"}]}]}], 
            "\[IndentingNewLine]", "\t\t", "]"}], ";", "\[IndentingNewLine]", 
           "\t\t", 
           RowBox[{"Q", "=", 
            RowBox[{"alpha", "*", "q"}]}], ";", "\[IndentingNewLine]", "\t\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Exponent", "[", 
               RowBox[{"Q", ",", 
                RowBox[{"Last", "[", "theta", "]"}]}], "]"}], ">", "n"}], ",",
              "\[IndentingNewLine]", "\t\t\t", 
             RowBox[{
              RowBox[{"RischTrace", "[", 
               RowBox[{
               "CancelPolyDEExponentialCase", ",", "$Failed", ",", 
                "\"\<In\>\""}], "]"}], ";", "\[IndentingNewLine]", "\t\t\t", 
              RowBox[{"Throw", "[", "$Failed", "]"}]}]}], 
            "\[IndentingNewLine]", "\t\t", "]"}], ";", "\[IndentingNewLine]", 
           "\t\t", 
           RowBox[{"Throw", "[", "Q", "]"}]}]}], "\[IndentingNewLine]", "\t", 
         "]"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"m", "=", 
       RowBox[{"Exponent", "[", 
        RowBox[{"C", ",", 
         RowBox[{"Last", "[", "theta", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"m", ">", "n"}], ",", "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"RischTrace", "[", 
          RowBox[{
          "CancelPolyDEExponentialCase", ",", "$Failed", ",", "\"\<In\>\""}], 
          "]"}], ";", "\[IndentingNewLine]", "\t", 
         RowBox[{"Throw", "[", "$Failed", "]"}]}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"lc", "[", 
        RowBox[{"C", ",", 
         RowBox[{"Last", "[", "theta", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Deta", "=", 
       RowBox[{
        RowBox[{"Last", "[", "Dtower", "]"}], "/", 
        RowBox[{"Last", "[", "theta", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"solve", " ", "rde", " ", "over", " ", "k"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"r", "=", 
       RowBox[{"RischDE", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"b", "/", "a"}], ")"}], "+", 
          RowBox[{"m", "*", "Deta"}]}], ",", 
         RowBox[{"c", "/", "a"}], ",", 
         RowBox[{"Most", "[", "theta", "]"}], ",", 
         RowBox[{"Most", "[", "tower", "]"}], ",", 
         RowBox[{"Most", "[", "Dtower", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"r", "===", "$Failed"}], ",", "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"RischTrace", "[", 
          RowBox[{
          "CancelPolyDEExponentialCase", ",", "$Failed", ",", "\"\<In\>\""}], 
          "]"}], ";", "\[IndentingNewLine]", "\t", 
         RowBox[{"Throw", "[", "$Failed", "]"}]}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", "recursion", " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"H", "=", 
       RowBox[{"CancelPolyDE", "[", 
        RowBox[{"a", ",", "b", ",", 
         RowBox[{"Simplify", "[", 
          RowBox[{"C", "-", 
           RowBox[{"c", "*", 
            SuperscriptBox[
             RowBox[{"Last", "[", "theta", "]"}], "m"]}]}], "]"}], ",", 
         RowBox[{"m", "-", "1"}], ",", "theta", ",", "tower", ",", "Dtower"}],
         "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"H", "===", "$Failed"}], ",", "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"RischTrace", "[", 
          RowBox[{
          "CancelPolyDEExponentialCase", ",", "$Failed", ",", "\"\<In\>\""}], 
          "]"}], ";", "\[IndentingNewLine]", "\t", 
         RowBox[{"Throw", "[", "$Failed", "]"}]}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"RischTrace", "[", 
       RowBox[{"CancelPolyDEExponentialCase", ",", 
        RowBox[{
         RowBox[{"r", "*", 
          SuperscriptBox[
           RowBox[{"Last", "[", "theta", "]"}], "m"]}], "+", "H"}], ",", 
        "\"\<In\>\""}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Throw", "[", 
       RowBox[{
        RowBox[{"r", "*", 
         SuperscriptBox[
          RowBox[{"Last", "[", "theta", "]"}], "m"]}], "+", "H"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.396353682851995*^9, 3.396353834672742*^9}, {
   3.396353955887014*^9, 3.3963540082919683`*^9}, {3.396354238939847*^9, 
   3.396354244631641*^9}, {3.39635428514402*^9, 3.396354296351997*^9}, {
   3.396354651495335*^9, 3.396354672781864*^9}, {3.396355334359544*^9, 
   3.396355337767694*^9}, {3.396355396669075*^9, 3.396355397027707*^9}, 
   3.3963554281692963`*^9, {3.396355458232111*^9, 3.396355474568375*^9}, {
   3.396355882256942*^9, 3.396355908948934*^9}, {3.396356041036056*^9, 
   3.396356080613236*^9}, {3.396356178141458*^9, 3.3963562125644836`*^9}, {
   3.39635624496002*^9, 3.396356251862788*^9}, {3.396356300184466*^9, 
   3.396356364711842*^9}, {3.3963565455753603`*^9, 3.396356552155179*^9}, 
   3.396356684169506*^9, {3.3963567258020277`*^9, 3.3963568557579412`*^9}, {
   3.396356893425366*^9, 3.396356898776733*^9}, {3.3963570481423807`*^9, 
   3.396357051507175*^9}, 3.396357084048456*^9, {3.396357142654982*^9, 
   3.396357159268605*^9}, {3.39635720467766*^9, 3.396357233674286*^9}, {
   3.396357264686954*^9, 3.396357274098435*^9}, {3.3963581072269382`*^9, 
   3.396358137401968*^9}, {3.396358172510252*^9, 3.3963582023633003`*^9}, {
   3.396358238475997*^9, 3.396358405928184*^9}, {3.3963584473827753`*^9, 
   3.39635846030062*^9}, {3.396358564536923*^9, 3.396358813602387*^9}, {
   3.3963588577672586`*^9, 3.396358890512848*^9}, {3.3963589481102037`*^9, 
   3.3963589574039183`*^9}, {3.396359034892251*^9, 3.3963590990986443`*^9}, 
   3.396397652704468*^9, 3.396397807648059*^9, {3.3964046409832153`*^9, 
   3.396404654846035*^9}, {3.396404766060424*^9, 3.396404779529587*^9}, {
   3.396404838330224*^9, 3.3964048388892603`*^9}, {3.396405017907092*^9, 
   3.396405054897271*^9}, {3.396405161073173*^9, 3.396405208904009*^9}, {
   3.396405847616075*^9, 3.396405882793894*^9}, {3.396406991226283*^9, 
   3.3964070086967278`*^9}, {3.3964082986322203`*^9, 3.396408307397336*^9}, {
   3.396408572536768*^9, 3.39640857408862*^9}, {3.396408614982113*^9, 
   3.396408623365739*^9}, {3.3964135555358353`*^9, 3.396413594173561*^9}, {
   3.396413866894188*^9, 3.3964139247065268`*^9}, {3.396413982646546*^9, 
   3.3964139854876757`*^9}, {3.3964146275664673`*^9, 3.396414642962617*^9}, {
   3.396414698903947*^9, 3.3964147211471167`*^9}, {3.396414751164015*^9, 
   3.396414766038184*^9}, {3.396414956789208*^9, 3.396414982128533*^9}, {
   3.396415034909636*^9, 3.3964151703461733`*^9}, {3.396415217088264*^9, 
   3.3964153234650784`*^9}, {3.3964155035969057`*^9, 3.396415568976066*^9}, {
   3.39641575488783*^9, 3.396415901685664*^9}, {3.404718005928746*^9, 
   3.4047180487530107`*^9}, {3.404962824070298*^9, 3.4049628846304493`*^9}, {
   3.4049629326070232`*^9, 3.404963034691931*^9}, 3.4079878950468407`*^9, {
   3.4088673270312567`*^9, 3.408867361173801*^9}, {3.4098213238257303`*^9, 
   3.409821400752068*^9}, {3.40982143388931*^9, 3.409821436567194*^9}, {
   3.409821509535989*^9, 3.409821513044636*^9}, {3.4098220894644613`*^9, 
   3.4098220896223993`*^9}, {3.409822181616521*^9, 3.409822197622058*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"CancelPolyDEExponentialCase", "[", 
   RowBox[{"1", ",", 
    RowBox[{
     RowBox[{"-", "2"}], "I"}], ",", "\[InvisibleSpace]", 
    RowBox[{"\[ImaginaryI]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        SubsuperscriptBox["\[Theta]", "2", "2"]}], "+", 
       RowBox[{
        SubsuperscriptBox["\[Theta]", "1", "4"], " ", 
        SubsuperscriptBox["\[Theta]", "2", "2"]}]}], ")"}]}], ",", "2", ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", 
      RowBox[{"theta", "[", "1", "]"}], ",", 
      RowBox[{"theta", "[", "2", "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", 
      RowBox[{"rischExp", "[", 
       RowBox[{"\[ImaginaryI]", " ", "x"}], "]"}], ",", 
      RowBox[{"rischExp", "[", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           FractionBox["1", 
            SubscriptBox["\[Theta]", "1"]]}], "+", 
          SubscriptBox["\[Theta]", "1"]}], ")"}]}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", 
      RowBox[{"I", " ", 
       RowBox[{"theta", "[", "1", "]"}]}], ",", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SubsuperscriptBox["\[Theta]", "1", "2"]}], ")"}], " ", 
        SubscriptBox["\[Theta]", "3"]}], 
       RowBox[{"2", " ", 
        SubscriptBox["\[Theta]", "1"]}]]}], "}"}]}], "]"}], 
  RowBox[{"(*", " ", "bug", " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.409821261853537*^9, 3.409821309361909*^9}, {
  3.409822242840164*^9, 3.409822244574956*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CancelPolyDEExponentialCase", "[", 
  RowBox[{"1", ",", 
   RowBox[{"2", " ", "x"}], ",", 
   RowBox[{"x", "+", 
    SubscriptBox["\[Theta]", "1"], "+", 
    RowBox[{"2", " ", "x", " ", 
     SubscriptBox["\[Theta]", "1"]}], "+", 
    SubsuperscriptBox["\[Theta]", "1", "2"], "+", 
    RowBox[{"x", " ", 
     SubsuperscriptBox["\[Theta]", "1", "2"]}]}], ",", "2", ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     SubscriptBox["\[Theta]", "1"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"rischExp", "[", "x", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     SubscriptBox["\[Theta]", "1"]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.3964041774525146`*^9, 3.396404199395811*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], "+", 
  SubscriptBox["\[Theta]", "1"], "+", 
  FractionBox[
   SubsuperscriptBox["\[Theta]", "1", "2"], "2"]}]], "Output",
 CellChangeTimes->{
  3.396404203067462*^9, 3.3964046593088408`*^9, 3.396404784146575*^9, 
   3.396404844377247*^9, 3.396405022856072*^9, 3.396405059175254*^9, 
   3.3964051763510237`*^9, 3.396405221912133*^9, 3.3964057259056807`*^9, 
   3.396405856126276*^9, 3.396406053284346*^9, 3.3964064984589357`*^9, 
   3.396406996190658*^9, 3.396408266935684*^9, 3.396408318804202*^9, 
   3.396408592026092*^9, 3.396408624777144*^9, {3.396413167291863*^9, 
   3.396413186634039*^9}, 3.39641355963181*^9, 3.39641359768932*^9, 
   3.396413705396117*^9, 3.3964138429919*^9, 3.3964139008677053`*^9, {
   3.396413962468471*^9, 3.396413988728345*^9}, 3.396414025529435*^9, 
   3.396414098255004*^9, 3.396414595910008*^9, 3.396414634022711*^9, {
   3.396414671967198*^9, 3.396414725312613*^9}, 3.396414771006321*^9, 
   3.3964149167657623`*^9, 3.3964149630344257`*^9, 3.396414996913406*^9, 
   3.396415176081831*^9, 3.3964153280384912`*^9, 3.39641558027656*^9, 
   3.396415656906262*^9, 3.396415739683669*^9, 3.396415803200581*^9, 
   3.396415906113059*^9, 3.397611057954544*^9, 3.404963040285784*^9, 
   3.404963229194025*^9, 3.4079879066608267`*^9, 3.409199693607829*^9}]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Structure Theorems", "Section",
 CellChangeTimes->{{3.3942295628727503`*^9, 3.3942295649352503`*^9}, {
   3.39431001431075*^9, 3.394310017576375*^9}, 3.39431030474825*^9, {
   3.395144038686387*^9, 3.395144044764532*^9}, 3.3951904992598867`*^9, {
   3.396007226005926*^9, 3.396007228469756*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"RischStructure", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"InputConvert", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", "x"}], "]"}], 
        RowBox[{"Cos", "[", 
         RowBox[{"Sin", "[", "x", "]"}], "]"}]}], ",", "x"}], "]"}], "//", 
     "First"}], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "this", " ", "should", " ", "not", " ", "be", " ", "an", " ", "algebraic",
      " ", "function"}], "..."}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.407451198213455*^9, 3.4074512276046133`*^9}, {
  3.4074512765055027`*^9, 3.4074512915064898`*^9}, {3.407451465787516*^9, 
  3.407451473414344*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SubsuperscriptBox["\[Theta]", "1", "4"]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SubsuperscriptBox["\[Theta]", "2", "2"]}], ")"}]}], 
     RowBox[{"4", " ", 
      SubsuperscriptBox["\[Theta]", "1", "2"], " ", 
      SubscriptBox["\[Theta]", "2"]}]]}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     SubscriptBox["\[Theta]", "1"], ",", 
     SubscriptBox["\[Theta]", "2"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"rischExp", "[", 
      RowBox[{"\[ImaginaryI]", " ", "x"}], "]"}], ",", 
     RowBox[{"rischExp", "[", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["1", 
           SubscriptBox["\[Theta]", "1"]]}], "+", 
         SubscriptBox["\[Theta]", "1"]}], ")"}]}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"\[ImaginaryI]", " ", 
      SubscriptBox["\[Theta]", "1"]}], ",", 
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SubsuperscriptBox["\[Theta]", "1", "2"]}], ")"}], " ", 
       SubscriptBox["\[Theta]", "3"]}], 
      RowBox[{"2", " ", 
       SubscriptBox["\[Theta]", "1"]}]]}], "}"}], ",", 
   RowBox[{"{", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.407451215745253*^9, 3.4074512282210827`*^9}, 
   3.4074512941582003`*^9, 3.4074514740228558`*^9, 3.407451644503034*^9, {
   3.407451749671924*^9, 3.407451752463723*^9}, 3.407451783601866*^9, 
   3.4074518242283783`*^9, 3.407452011376109*^9, 3.4074520951146193`*^9, 
   3.407983710835906*^9, 3.407983861821768*^9, 3.408181188931623*^9, 
   3.408848401128809*^9, 3.408866090982912*^9, 3.409044232855776*^9, 
   3.409054431004154*^9, 3.409125992644001*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"RischStructure", "[", 
   RowBox[{
    FractionBox[
     RowBox[{"x", 
      RowBox[{"(", 
       RowBox[{"x", "+", "1"}], ")"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["x", "2"], " ", 
           RowBox[{"Exp", "[", 
            RowBox[{"2", 
             SuperscriptBox["x", "2"]}], "]"}]}], "-", 
          SuperscriptBox[
           RowBox[{"Log", "[", 
            RowBox[{"x", "+", "1"}], "]"}], "2"]}], ")"}], "+", 
        RowBox[{"2", "x", " ", 
         RowBox[{"Exp", "[", 
          RowBox[{"3", 
           SuperscriptBox["x", "2"]}], "]"}], 
         RowBox[{"(", 
          RowBox[{"x", "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", 
               SuperscriptBox["x", "3"]}], "+", 
              RowBox[{"2", 
               SuperscriptBox["x", "2"]}], "+", "x", "+", "1"}], ")"}], 
            RowBox[{"Log", "[", 
             RowBox[{"x", "+", "1"}], "]"}]}]}], ")"}]}]}], ")"}]}], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"x", "+", "1"}], ")"}], 
         SuperscriptBox[
          RowBox[{"Log", "[", 
           RowBox[{"x", "+", "1"}], "]"}], "2"]}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["x", "3"], "+", 
           SuperscriptBox["x", "2"]}], ")"}], 
         RowBox[{"Exp", "[", 
          RowBox[{"2", 
           SuperscriptBox["x", "2"]}], "]"}]}]}], ")"}], "2"]], ",", "x"}], 
   "]"}], "//", "Timing", 
  RowBox[{"(*", " ", 
   RowBox[{"example", " ", "from", " ", "Geddes", " ", "et", " ", "al"}], " ",
    "*)"}]}]], "Input",
 CellChangeTimes->{{3.395487380257053*^9, 3.395487491394416*^9}, {
  3.395487753850424*^9, 3.395487755027108*^9}, {3.395489515752133*^9, 
  3.3954895229473333`*^9}, {3.395722029268852*^9, 3.395722029617256*^9}, {
  3.395722109076796*^9, 3.3957221102491703`*^9}, {3.407397460909809*^9, 
  3.407397462899089*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.004320999999997355`", ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{"x", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "x"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["x", "2"], " ", 
          SubsuperscriptBox["\[Theta]", "1", "2"]}], "-", 
         SubsuperscriptBox["\[Theta]", "2", "2"], "+", 
         RowBox[{"2", " ", "x", " ", 
          SubsuperscriptBox["\[Theta]", "1", "3"], " ", 
          RowBox[{"(", 
           RowBox[{"x", "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "+", "x", "+", 
               RowBox[{"2", " ", 
                SuperscriptBox["x", "2"]}], "+", 
               RowBox[{"2", " ", 
                SuperscriptBox["x", "3"]}]}], ")"}], " ", 
             SubscriptBox["\[Theta]", "2"]}]}], ")"}]}]}], ")"}]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["x", "3"]}], ")"}]}], " ", 
          SubsuperscriptBox["\[Theta]", "1", "2"]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", "x"}], ")"}], " ", 
          SubsuperscriptBox["\[Theta]", "2", "2"]}]}], ")"}], "2"]], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       SubscriptBox["\[Theta]", "1"], ",", 
       SubscriptBox["\[Theta]", "2"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"rischExp", "[", 
        SuperscriptBox["x", "2"], "]"}], ",", 
       RowBox[{"rischLog", "[", 
        RowBox[{"1", "+", "x"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"2", " ", "x", " ", 
        SubscriptBox["\[Theta]", "1"]}], ",", 
       FractionBox["1", 
        RowBox[{"1", "+", "x"}]]}], "}"}], ",", 
     RowBox[{"{", "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.406622182721574*^9, 3.406622564623268*^9, 3.406671170128771*^9, 
   3.4073974665190287`*^9, 3.4073978079204607`*^9, 3.407397942434111*^9, 
   3.407399127850459*^9, 3.407450518619452*^9, 3.4074505556041317`*^9, {
   3.407451137881578*^9, 3.407451149757386*^9}, 3.407451847689382*^9, 
   3.407452012844952*^9, 3.407452092091151*^9, 3.4079838622545013`*^9, {
   3.40818118619867*^9, 3.4081811898639593`*^9}, 3.40884847623337*^9, 
   3.408866091599354*^9, 3.4090442357371902`*^9, 3.409054431537389*^9, 
   3.409125993248067*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RischStructure", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"InputConvert", "[", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"Tan", "[", 
         RowBox[{"Tan", "[", 
          RowBox[{"Exp", "[", "x", "]"}], "]"}], "]"}], ",", "x"}], "]"}], 
      ",", "x"}], "]"}], "//", "First"}], ",", "x"}], "]"}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQB2IQrfurfUq130tHl4AjM0G0wcYIkXYgXWlTKAaim4Rz
yk8B6XVPBGtA9LakmVLM/i8ddQSKZEB00gVxTRDtfDUGTL+7EG8MomVWZoNp
uQ9/bEG0moapHYj+rnDFHURXvH4Cpg3V5CNAtFN7MJi+1bA+DURv8twFpqOs
z+aCaPu6mDwQbRo8dyWIvjz5AphOEZK8CKI3zwy4DKJPzGK6A6KPJEx4BqI5
zmi/BdFKu7Q/guhZrFX8LED6U/xZQRB9wWOpNIiO0EiVAdE/F3Ypg+ii7+yq
YHnHAk0Q3diRpQWi/Zi+sCkFvHS0WSLDDqJXs97+NDfxpWOX78rPILr0BpeZ
UfJLxzXL7MC0FmN6ZhOQVstXzwLRAFtynas=
  "]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{"16", " ", 
     SubscriptBox["\[Theta]", "1"], " ", 
     SubsuperscriptBox["\[Theta]", "2", "2"]}], 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SubsuperscriptBox["\[Theta]", "2", "2"]}], ")"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", 
        FractionBox["1", 
         SubsuperscriptBox["\[Theta]", "3", "2"]]}], ")"}], "2"], " ", 
     SubsuperscriptBox["\[Theta]", "3", "2"]}]], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     SubscriptBox["\[Theta]", "1"], ",", 
     SubscriptBox["\[Theta]", "2"], ",", 
     SubscriptBox["\[Theta]", "3"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"rischExp", "[", "x", "]"}], ",", 
     RowBox[{"rischExp", "[", 
      RowBox[{"\[ImaginaryI]", " ", 
       SubscriptBox["\[Theta]", "1"]}], "]"}], ",", 
     RowBox[{"rischExp", "[", 
      FractionBox[
       RowBox[{
        FractionBox["1", 
         SubscriptBox["\[Theta]", "2"]], "-", 
        SubscriptBox["\[Theta]", "2"]}], 
       RowBox[{
        FractionBox["1", 
         SubscriptBox["\[Theta]", "2"]], "+", 
        SubscriptBox["\[Theta]", "2"]}]], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     SubscriptBox["\[Theta]", "1"], ",", 
     RowBox[{"\[ImaginaryI]", " ", 
      SubscriptBox["\[Theta]", "1"], " ", 
      SubscriptBox["\[Theta]", "2"]}], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"4", " ", "\[ImaginaryI]", " ", 
        SubscriptBox["\[Theta]", "1"], " ", 
        SubsuperscriptBox["\[Theta]", "2", "2"], " ", 
        SubscriptBox["\[Theta]", "3"]}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SubsuperscriptBox["\[Theta]", "2", "2"]}], ")"}], "2"]]}]}], "}"}], 
   ",", 
   RowBox[{"{", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.406626003294992*^9, 3.406626044061366*^9}, 
   3.407398013616448*^9, 3.407399122192993*^9, 3.407399185637734*^9, {
   3.407450539915464*^9, 3.407450546683415*^9}, 3.40745113938697*^9, 
   3.407451859910482*^9, 3.407452014381033*^9, 3.407452088276132*^9, {
   3.4076147981765823`*^9, 3.407614801840488*^9}, 3.407965582278715*^9, 
   3.407983862646669*^9, {3.4081811844568033`*^9, 3.4081811901363983`*^9}, 
   3.4088484770131063`*^9, 3.408866092570356*^9, {3.40904423686878*^9, 
   3.409044238791438*^9}, 3.409054432492462*^9, 3.409125993910316*^9, 
   3.409174896243607*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RischStructure", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Log", "[", 
     SuperscriptBox["x", 
      RowBox[{"1", "/", "3"}]], "]"}], "-", 
    RowBox[{
     RowBox[{"Log", "[", "x", "]"}], "/", "3"}]}], ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.407573115672523*^9, 3.407573129290667*^9}, {
  3.4088660979340982`*^9, 3.408866107677902*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     SubscriptBox["\[Theta]", "1"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"rischLog", "[", "x", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     FractionBox["1", "x"]}], "}"}], ",", 
   RowBox[{"{", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.407573134198435*^9, 3.407613679511197*^9, 3.407614819217576*^9, 
   3.407658021453309*^9, 3.4079616292356443`*^9, 3.4079655964662743`*^9, {
   3.40798386367059*^9, 3.4079838681666813`*^9}, {3.408181180749648*^9, 
   3.4081811906279383`*^9}, {3.40886610320226*^9, 3.4088661087131777`*^9}, 
   3.409044240366823*^9, 3.409054433035007*^9, 3.409125988452668*^9, {
   3.409139996621346*^9, 3.4091400037674093`*^9}, 3.409175458982483*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"RischStructure", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"InputConvert", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          RowBox[{"2", " ", "x"}], "+", 
          SuperscriptBox[
           RowBox[{"Sin", "[", "x", "]"}], "2"]}], ")"}], "-", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"x", "+", "1"}], ")"}], "2"], "-", 
          SuperscriptBox[
           RowBox[{"Cos", "[", "x", "]"}], "2"]}], ")"}]}], ",", "x"}], "]"}],
      "//", "First"}], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{
   "Risch", " ", "structure", " ", "theorem", " ", "example", " ", "from", 
    " ", 
    RowBox[{"sci", ".", "math", ".", "symbolic"}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.410085229381215*^9, 3.410085320872842*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", 
   RowBox[{"{", "x", "}"}], ",", 
   RowBox[{"{", "x", "}"}], ",", 
   RowBox[{"{", "1", "}"}], ",", 
   RowBox[{"{", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.41008525621325*^9, 3.410085303938076*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Prelim stuff", "Subsection",
 CellChangeTimes->{{3.394310299170125*^9, 3.394310301013875*^9}, {
  3.404719881091351*^9, 3.404719883311351*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PreprocessExponents", "[", 
   RowBox[{"integrand_", ",", "x_"}], "]"}], ":=", 
  RowBox[{"Catch", "[", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"result", "=", "integrand"}], ",", "e", ",", "l", ",", 
       "reps"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"RischTrace", "[", 
       RowBox[{"PreprocessExponents", ",", 
        RowBox[{"{", 
         RowBox[{"integrand", ",", "x"}], "}"}], ",", "\"\<In\>\""}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "find", " ", "algebraic", " ", "relationships", " ", "between", " ", 
         "powers", " ", "like", " ", 
         RowBox[{"2", "^", "x"}]}], ",", 
        RowBox[{"4", "^", "x"}], ",", 
        RowBox[{
         RowBox[{"32", "^", "x"}], " ", 
         RowBox[{"etc", ".", " ", "\[IndentingNewLine]", "This"}], " ", 
         "means", " ", "we", " ", "can", " ", "find", " ", "integrals", " ", 
         "like", " ", 
         RowBox[{"Risch", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"2", "^", "x"}], "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"4", "^", "x"}], " ", "-", " ", 
              RowBox[{"2", "^", "x"}], " ", "+", " ", "1"}], ")"}]}], ",", 
           "x"}], "]"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"e", "=", 
       RowBox[{"Union", "[", 
        RowBox[{"Cases", "[", 
         RowBox[{"integrand", ",", 
          RowBox[{
           RowBox[{"rischExp", "[", 
            RowBox[{"x", " ", 
             RowBox[{"rischLog", "[", "a_", "]"}]}], "]"}], "\[RuleDelayed]", 
           RowBox[{"a", "/;", 
            RowBox[{"FreeQ", "[", 
             RowBox[{"a", ",", "x"}], "]"}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "Infinity"}], "}"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"e", "===", 
          RowBox[{"{", "}"}]}], "||", 
         RowBox[{
          RowBox[{"Length", "[", "e", "]"}], "===", "1"}]}], ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"RischTrace", "[", 
          RowBox[{
          "PreprocessExponents", ",", "integrand", ",", "\"\<Out\>\""}], 
          "]"}], ";", "\[IndentingNewLine]", "\t", 
         RowBox[{"Throw", "[", "integrand", "]"}]}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"l", "=", 
       RowBox[{"Thread", "[", 
        RowBox[{"{", 
         RowBox[{"e", ",", 
          RowBox[{"FactorInteger", "[", "e", "]"}]}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"reps", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"rischExp", "[", 
           RowBox[{"x", " ", 
            RowBox[{"rischLog", "[", "#1", "]"}]}], "]"}], "\[Rule]", 
          RowBox[{"joinexponents", "[", 
           RowBox[{"#2", ",", "x"}], "]"}]}], "&"}], "@@@", "l"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"result", "=", 
       RowBox[{"integrand", "//.", "reps"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"RischTrace", "[", 
       RowBox[{"PreprocessExponents", ",", "result", ",", "\"\<Out\>\""}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"return", " ", "the", " ", "modified", " ", "integrand"}], " ",
        "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Throw", "[", "result", "]"}]}]}], "\[IndentingNewLine]", "]"}],
    "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.396601104483843*^9, 3.3966012616120653`*^9}, {
   3.39660145394112*^9, 3.3966014634808617`*^9}, {3.39660202224903*^9, 
   3.396602246153236*^9}, {3.396602297603448*^9, 3.3966023572409487`*^9}, {
   3.3966024672650957`*^9, 3.3966024701844482`*^9}, {3.3966027955561657`*^9, 
   3.396602835097946*^9}, {3.396603055261593*^9, 3.396603332174671*^9}, 
   3.397617169914757*^9, {3.3980670615617723`*^9, 3.398067067305337*^9}, {
   3.3980683743957663`*^9, 3.398068583887163*^9}, {3.398069021389168*^9, 
   3.398069038484584*^9}, {3.398070202838006*^9, 3.39807020612212*^9}, {
   3.3980703001517153`*^9, 3.398070311302367*^9}, {3.398070400199088*^9, 
   3.3980704443906918`*^9}, {3.400487159768067*^9, 3.400487180210802*^9}, {
   3.404981651473723*^9, 3.40498177420474*^9}, {3.404981829044944*^9, 
   3.4049818294203978`*^9}, {3.4076140567831373`*^9, 3.407614066314314*^9}, 
   3.407614168403871*^9, {3.407983669549467*^9, 3.4079836997234163`*^9}, {
   3.408181224531777*^9, 3.408181230558413*^9}, {3.4091194260160837`*^9, 
   3.409119444009695*^9}, {3.409120781839837*^9, 3.4091208036922693`*^9}, {
   3.409120838960503*^9, 3.409120869976309*^9}, {3.409120962869032*^9, 
   3.40912102367198*^9}, {3.409121195881257*^9, 3.409121198808002*^9}, {
   3.409121342386145*^9, 3.4091213426104*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PreprocessExponents", "[", 
  RowBox[{
   RowBox[{"InputConvert", "[", 
    RowBox[{
     FractionBox[
      SuperscriptBox["2", "x"], 
      RowBox[{"1", "+", 
       SuperscriptBox["2", "x"], "-", 
       SuperscriptBox["4", "x"]}]], ",", "x"}], "]"}], ",", "x"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.407613759389195*^9, 3.40761381307605*^9}, {
  3.407613857599226*^9, 3.407613881852351*^9}, {3.407613990509138*^9, 
  3.407613992585791*^9}, {3.407614080902088*^9, 3.407614083066286*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{"rischExp", "[", 
     RowBox[{"x", " ", 
      RowBox[{"rischLog", "[", "2", "]"}]}], "]"}], 
    RowBox[{"1", "+", 
     RowBox[{"rischExp", "[", 
      RowBox[{"x", " ", 
       RowBox[{"rischLog", "[", "2", "]"}]}], "]"}], "-", 
     SuperscriptBox[
      RowBox[{"rischExp", "[", 
       RowBox[{"x", " ", 
        RowBox[{"rischLog", "[", "2", "]"}]}], "]"}], "2"]}]], ",", "x"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.407613794410099*^9, 3.407613814610578*^9}, {
   3.407613864702649*^9, 3.4076138825071697`*^9}, 3.407613993388097*^9, {
   3.407614058419691*^9, 3.407614084202585*^9}, 3.407614170109606*^9, 
   3.407961716564129*^9, 3.4090442757029676`*^9, 3.409054443996892*^9, 
   3.409119445295637*^9, 3.409121343673279*^9, 3.409121376336707*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PreprocessExponents", "[", 
  RowBox[{
   RowBox[{"InputConvert", "[", 
    RowBox[{
     FractionBox[
      RowBox[{
       SuperscriptBox["2", "x"], "+", 
       SuperscriptBox["3", "x"]}], 
      RowBox[{"1", "+", 
       SuperscriptBox["2", "x"], "-", 
       SuperscriptBox["4", "x"]}]], ",", "x"}], "]"}], ",", "x"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.407613759389195*^9, 3.40761381307605*^9}, {
  3.407613857599226*^9, 3.407613881852351*^9}, {3.407613990509138*^9, 
  3.407613992585791*^9}, {3.407614080902088*^9, 3.407614083066286*^9}, {
  3.4090442793727503`*^9, 3.409044294003818*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"rischExp", "[", 
      RowBox[{"x", " ", 
       RowBox[{"rischLog", "[", "2", "]"}]}], "]"}], "+", 
     RowBox[{"rischExp", "[", 
      RowBox[{"x", " ", 
       RowBox[{"rischLog", "[", "3", "]"}]}], "]"}]}], 
    RowBox[{"1", "+", 
     RowBox[{"rischExp", "[", 
      RowBox[{"x", " ", 
       RowBox[{"rischLog", "[", "2", "]"}]}], "]"}], "-", 
     SuperscriptBox[
      RowBox[{"rischExp", "[", 
       RowBox[{"x", " ", 
        RowBox[{"rischLog", "[", "2", "]"}]}], "]"}], "2"]}]], ",", "x"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.409044294946121*^9, 3.409054444796999*^9, 
  3.40911944635605*^9, 3.4091213444760647`*^9, 3.409121376755077*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PreprocessExponents", "[", 
  RowBox[{
   RowBox[{"InputConvert", "[", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["2", "x"]}], "-", 
       SuperscriptBox["3", "x"], "+", 
       SuperscriptBox["6", "x"], "-", 
       SuperscriptBox["12", "x"], "+", 
       SuperscriptBox["18", "x"]}], 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SuperscriptBox["3", "x"], "-", 
       SuperscriptBox["4", "x"], "+", 
       SuperscriptBox["9", "x"], "+", 
       SuperscriptBox["12", "x"], "+", 
       SuperscriptBox["36", "x"]}]], ",", "x"}], "]"}], ",", "x"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.409119469743203*^9, 3.4091194840979443`*^9}, {
   3.409121039473751*^9, 3.409121059286923*^9}, {3.409121097205942*^9, 
   3.4091211154390173`*^9}, 3.409121326170632*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"rischExp", "[", 
        RowBox[{"x", " ", 
         RowBox[{"rischLog", "[", "2", "]"}]}], "]"}]}], "-", 
      RowBox[{"rischExp", "[", 
       RowBox[{"x", " ", 
        RowBox[{"rischLog", "[", "3", "]"}]}], "]"}], "+", 
      RowBox[{
       RowBox[{"rischExp", "[", 
        RowBox[{"x", " ", 
         RowBox[{"rischLog", "[", "2", "]"}]}], "]"}], " ", 
       RowBox[{"rischExp", "[", 
        RowBox[{"x", " ", 
         RowBox[{"rischLog", "[", "3", "]"}]}], "]"}]}], "-", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"rischExp", "[", 
         RowBox[{"x", " ", 
          RowBox[{"rischLog", "[", "2", "]"}]}], "]"}], "2"], " ", 
       RowBox[{"rischExp", "[", 
        RowBox[{"x", " ", 
         RowBox[{"rischLog", "[", "3", "]"}]}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"rischExp", "[", 
        RowBox[{"x", " ", 
         RowBox[{"rischLog", "[", "2", "]"}]}], "]"}], " ", 
       SuperscriptBox[
        RowBox[{"rischExp", "[", 
         RowBox[{"x", " ", 
          RowBox[{"rischLog", "[", "3", "]"}]}], "]"}], "2"]}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "-", 
      SuperscriptBox[
       RowBox[{"rischExp", "[", 
        RowBox[{"x", " ", 
         RowBox[{"rischLog", "[", "2", "]"}]}], "]"}], "2"], "+", 
      RowBox[{"rischExp", "[", 
       RowBox[{"x", " ", 
        RowBox[{"rischLog", "[", "3", "]"}]}], "]"}], "+", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"rischExp", "[", 
         RowBox[{"x", " ", 
          RowBox[{"rischLog", "[", "2", "]"}]}], "]"}], "2"], " ", 
       RowBox[{"rischExp", "[", 
        RowBox[{"x", " ", 
         RowBox[{"rischLog", "[", "3", "]"}]}], "]"}]}], "+", 
      SuperscriptBox[
       RowBox[{"rischExp", "[", 
        RowBox[{"x", " ", 
         RowBox[{"rischLog", "[", "3", "]"}]}], "]"}], "2"], "+", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"rischExp", "[", 
         RowBox[{"x", " ", 
          RowBox[{"rischLog", "[", "2", "]"}]}], "]"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"rischExp", "[", 
         RowBox[{"x", " ", 
          RowBox[{"rischLog", "[", "3", "]"}]}], "]"}], "2"]}]}], ")"}]}], 
   ",", "x"}], "}"}]], "Output",
 CellChangeTimes->{
  3.409119484952715*^9, 3.409120389721003*^9, {3.409121026191372*^9, 
   3.409121060212881*^9}, 3.409121115999084*^9, 3.409121200225773*^9, {
   3.409121326851037*^9, 3.4091213487868853`*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"joinexponents", "[", 
    RowBox[{"lst_", ",", "x_"}], "]"}], ":=", 
   RowBox[{"Times", "@@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"rischExp", "[", 
         RowBox[{"x", " ", 
          RowBox[{"rischLog", "[", "#1", "]"}]}], "]"}], "#2"], "&"}], "@@@", 
      "lst"}], ")"}]}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4091212743711042`*^9, 3.4091212872803297`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"joinexponents", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "2"}], "}"}]}], "}"}], ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.4091213055501823`*^9, 3.409121309758256*^9}}],

Cell[BoxData[
 RowBox[{
  SuperscriptBox[
   RowBox[{"rischExp", "[", 
    RowBox[{"x", " ", 
     RowBox[{"rischLog", "[", "2", "]"}]}], "]"}], "2"], " ", 
  SuperscriptBox[
   RowBox[{"rischExp", "[", 
    RowBox[{"x", " ", 
     RowBox[{"rischLog", "[", "3", "]"}]}], "]"}], "2"]}]], "Output",
 CellChangeTimes->{3.4091213106404133`*^9, 3.409121351635408*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"allExprs", "[", "f_", "]"}], ":=", 
  RowBox[{"Join", "[", 
   RowBox[{
    RowBox[{"PureVariables", "[", "f", "]"}], ",", 
    RowBox[{"Cases", "[", 
     RowBox[{"f", ",", 
      RowBox[{"Tan", "[", "_", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "Infinity"}], "}"}]}], "]"}], ",", 
    RowBox[{"Cases", "[", 
     RowBox[{"f", ",", 
      RowBox[{"Log", "[", "_", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "Infinity"}], "}"}]}], "]"}], ",", 
    RowBox[{"Cases", "[", 
     RowBox[{"f", ",", 
      RowBox[{"Exp", "[", "_", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "Infinity"}], "}"}]}], "]"}], ",", 
    RowBox[{"Cases", "[", 
     RowBox[{"f", ",", 
      RowBox[{"ArcTan", "[", "_", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "Infinity"}], "}"}]}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.390189719013125*^9, 3.39018973902875*^9}, {
   3.390192718169375*^9, 3.390192764263125*^9}, {3.3901930398725*^9, 
   3.390193088794375*^9}, 3.390193259700625*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"UnsortedUnion", "[", "x_List", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "f", "}"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", "y_", "]"}], ":=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"f", "[", "y", "]"}], "=", 
         RowBox[{"Sequence", "[", "]"}]}], ";", "y"}], ")"}]}], ";", 
     RowBox[{"f", "/@", "x"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.3942302994352503`*^9, 3.3942303514196253`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"DependOnTheta", "[", 
   RowBox[{"fun_", ",", "theta_", ",", "intower_"}], "]"}], ":=", 
  RowBox[{"Catch", "[", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "thetas", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "want", " ", "to", " ", "check", " ", "if", " ", "any", " ", "thetas", 
       " ", "in", " ", "fun", " ", "depend", " ", "on", " ", "the", " ", 
       "specific", " ", "theta", " ", "we", " ", 
       RowBox[{"input", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"thetas", "=", 
       RowBox[{"Cases", "[", 
        RowBox[{"fun", ",", 
         SubscriptBox["\[Theta]", "_"], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "Infinity"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"thetas", "===", 
         RowBox[{"{", "}"}]}], ",", 
        RowBox[{"Throw", "[", "False", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"FreeQ", "[", 
            RowBox[{
             RowBox[{"intower", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", "theta"}], "]"}]}], ",", 
          RowBox[{"Throw", "[", "True", "]"}]}], "]"}], "\[IndentingNewLine]",
         ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "intower", "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Throw", "[", "False", "]"}]}]}], "\[IndentingNewLine]", "]"}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.395581020213333*^9, 3.395581377513818*^9}, {
  3.39558147475791*^9, 3.395581478331287*^9}, {3.3955815185246267`*^9, 
  3.395581531744464*^9}, {3.3955815858330393`*^9, 3.3955816183553047`*^9}, {
  3.408001927473987*^9, 3.4080019284485807`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DependOnTheta", "[", 
  RowBox[{
   SubscriptBox["\"\<\[Theta]\>\"", "2"], ",", 
   SubscriptBox["\"\<\[Theta]\>\"", "1"], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"rischExp", "[", "x", "]"}], ",", 
     RowBox[{"rischLog", "[", 
      RowBox[{"x", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         SubscriptBox["\"\<\[Theta]\>\"", "1"]}], ")"}]}], "]"}]}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.3955813801006107`*^9, 3.395581410000574*^9}}],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{3.408181259768463*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"UpdateExtensionField", "[", 
   RowBox[{"fun_", ",", "intheta_", ",", "inDtower_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"theta", ",", "Dtower"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"theta", "=", 
      RowBox[{"{", 
       RowBox[{"First", "[", "intheta", "]"}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Dtower", "=", 
      RowBox[{"{", "1", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"FreeQ", "[", 
           RowBox[{"fun", ",", 
            RowBox[{"Part", "[", 
             RowBox[{"intheta", ",", "i"}], "]"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", "\t\t", 
         RowBox[{
          RowBox[{"AppendTo", "[", 
           RowBox[{"theta", ",", 
            RowBox[{"Part", "[", 
             RowBox[{"intheta", ",", "i"}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"Dtower", ",", 
            RowBox[{"Part", "[", 
             RowBox[{"inDtower", ",", "i"}], "]"}]}], "]"}]}]}], 
        "\[IndentingNewLine]", "\t", "]"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "2", ",", 
         RowBox[{"Length", "[", "intheta", "]"}]}], "}"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"theta", ",", "Dtower"}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.39069958087425*^9, 3.390699628702375*^9}, {
  3.39114358101*^9, 3.3911435986975*^9}, {3.394422997546125*^9, 
  3.394423068764875*^9}, {3.394424889139875*^9, 3.394424890139875*^9}, {
  3.3944264047331247`*^9, 3.3944264220924997`*^9}, {3.3955796189318657`*^9, 
  3.395579624353166*^9}, {3.3955797124270983`*^9, 3.395579737493034*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"UpdateExtensionField", "[", 
   RowBox[{"fun_", ",", "intheta_", ",", "intower_", ",", "inDtower_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"theta", ",", "tower", ",", "Dtower"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"theta", "=", 
      RowBox[{"{", 
       RowBox[{"First", "[", "intheta", "]"}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tower", "=", 
      RowBox[{"{", 
       RowBox[{"First", "[", "intower", "]"}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Dtower", "=", 
      RowBox[{"{", "1", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"!", 
           RowBox[{"FreeQ", "[", 
            RowBox[{"fun", ",", 
             RowBox[{"Part", "[", 
              RowBox[{"intheta", ",", "i"}], "]"}]}], "]"}]}], "||", 
          RowBox[{"DependOnTheta", "[", 
           RowBox[{"fun", ",", 
            RowBox[{"Part", "[", 
             RowBox[{"intheta", ",", "i"}], "]"}], ",", "intower"}], "]"}]}], 
         ",", "\[IndentingNewLine]", "\t\t", 
         RowBox[{
          RowBox[{"AppendTo", "[", 
           RowBox[{"theta", ",", 
            RowBox[{"Part", "[", 
             RowBox[{"intheta", ",", "i"}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"tower", ",", 
            RowBox[{"Part", "[", 
             RowBox[{"intower", ",", "i"}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"Dtower", ",", 
            RowBox[{"Part", "[", 
             RowBox[{"inDtower", ",", "i"}], "]"}]}], "]"}]}]}], 
        "\[IndentingNewLine]", "\t", "]"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "2", ",", 
         RowBox[{"Length", "[", "intheta", "]"}]}], "}"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"theta", ",", "tower", ",", "Dtower"}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.39069958087425*^9, 3.390699628702375*^9}, {
   3.39114358101*^9, 3.3911435986975*^9}, {3.394422997546125*^9, 
   3.394423068764875*^9}, {3.394424889139875*^9, 3.394424890139875*^9}, {
   3.3944264047331247`*^9, 3.3944264220924997`*^9}, {3.3951943242235537`*^9, 
   3.3951943736878557`*^9}, 3.3951948581774187`*^9, {3.395579158550046*^9, 
   3.395579185321426*^9}, {3.395579250683675*^9, 3.395579306870356*^9}, {
   3.395579347020391*^9, 3.39557935139332*^9}, {3.395579398834043*^9, 
   3.395579399617629*^9}, {3.395579517054213*^9, 3.395579535246174*^9}, {
   3.39557956864817*^9, 3.395579604498355*^9}, {3.395579899851295*^9, 
   3.395579906387272*^9}, {3.39557993928568*^9, 3.39557994041131*^9}, 
   3.39558010582767*^9, {3.39558014542383*^9, 3.395580145595985*^9}, {
   3.395580202804805*^9, 3.395580223541613*^9}, {3.395580293888857*^9, 
   3.3955803266035757`*^9}, {3.395580373540908*^9, 3.395580410360701*^9}, {
   3.3955804776184807`*^9, 3.39558056845485*^9}, {3.39558060139485*^9, 
   3.3955806416318197`*^9}, {3.3955806932031183`*^9, 
   3.3955807426867247`*^9}, {3.3955807810814466`*^9, 
   3.3955808031833344`*^9}, {3.3955808627427483`*^9, 3.395580913712685*^9}, {
   3.395580984299596*^9, 3.39558101087285*^9}, {3.39558166255515*^9, 
   3.395581684869438*^9}}],

Cell[BoxData[
 RowBox[{"UpdateExtensionField", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "+", "x"}], ")"}], " ", 
    SubscriptBox["\"\<\[Theta]\>\"", "2"]}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     SubscriptBox["\"\<\[Theta]\>\"", "1"], ",", 
     SubscriptBox["\"\<\[Theta]\>\"", "2"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"rischExp", "[", 
      RowBox[{"-", 
       FractionBox["1", "x"]}], "]"}], ",", 
     RowBox[{"rischExp", "[", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["2", "x"]}], "+", 
       RowBox[{"x", " ", 
        SubscriptBox["\"\<\[Theta]\>\"", "1"]}]}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     FractionBox[
      SubscriptBox["\"\<\[Theta]\>\"", "1"], 
      SuperscriptBox["x", "2"]], ",", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{"2", "+", 
         RowBox[{"x", " ", 
          SubscriptBox["\"\<\[Theta]\>\"", "1"]}], "+", 
         RowBox[{
          SuperscriptBox["x", "2"], " ", 
          SubscriptBox["\"\<\[Theta]\>\"", "1"]}]}], ")"}], " ", 
       SubscriptBox["\"\<\[Theta]\>\"", "2"]}], 
      SuperscriptBox["x", "2"]]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.396091496026308*^9, 3.396091507013068*^9}}],

Cell[BoxData[
 RowBox[{"UpdateExtensionField", "[", 
  RowBox[{"1", ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     SubscriptBox["\"\<\[Theta]\>\"", "1"], ",", 
     SubscriptBox["\"\<\[Theta]\>\"", "2"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"rischExp", "[", "x", "]"}], ",", 
     RowBox[{"rischLog", "[", 
      RowBox[{"x", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         SubscriptBox["\"\<\[Theta]\>\"", "1"]}], ")"}]}], "]"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     SubscriptBox["\"\<\[Theta]\>\"", "1"], ",", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SubscriptBox["\"\<\[Theta]\>\"", "1"], "+", 
       RowBox[{"x", " ", 
        SubscriptBox["\"\<\[Theta]\>\"", "1"]}]}], 
      RowBox[{"x", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         SubscriptBox["\"\<\[Theta]\>\"", "1"]}], ")"}]}]]}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.395579848950857*^9, 3.395579864992077*^9}}],

Cell[BoxData[
 RowBox[{"UpdateExtensionField", "[", 
  RowBox[{
   SubscriptBox["\"\<\[Theta]\>\"", "2"], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     SubscriptBox["\"\<\[Theta]\>\"", "1"], ",", 
     SubscriptBox["\"\<\[Theta]\>\"", "2"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"rischExp", "[", "x", "]"}], ",", 
     RowBox[{"rischLog", "[", 
      RowBox[{"x", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         SubscriptBox["\"\<\[Theta]\>\"", "1"]}], ")"}]}], "]"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     SubscriptBox["\"\<\[Theta]\>\"", "1"], ",", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SubscriptBox["\"\<\[Theta]\>\"", "1"], "+", 
       RowBox[{"x", " ", 
        SubscriptBox["\"\<\[Theta]\>\"", "1"]}]}], 
      RowBox[{"x", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         SubscriptBox["\"\<\[Theta]\>\"", "1"]}], ")"}]}]]}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.395579075426733*^9, 3.395579102839951*^9}, {
  3.395579374558819*^9, 3.3955793945721607`*^9}, {3.395580154417448*^9, 
  3.3955801775828133`*^9}}],

Cell[BoxData[
 RowBox[{"Cases", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"rischExp", "[", "x", "]"}], ",", 
     RowBox[{"rischLog", "[", 
      RowBox[{"x", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         SubscriptBox["\"\<\[Theta]\>\"", "1"]}], ")"}]}], "]"}]}], "}"}], 
   ",", 
   SubscriptBox["\"\<\[Theta]\>\"", "1"], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "Infinity"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.3955804190682373`*^9, 3.39558043945269*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PureVariables", "[", "v_", "]"}], " ", ":=", " ", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"Variables", "[", " ", 
      RowBox[{"Level", "[", 
       RowBox[{"v", ",", " ", 
        RowBox[{"{", 
         RowBox[{"-", "1"}], "}"}]}], " ", "]"}], " ", "]"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"Attributes", "[", "#", "]"}], "]"}], "==", "0"}], "&"}]}], 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.397617278416048*^9, 3.3976172815001593`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"theta", "[", "n_", "]"}], ":=", 
  SubscriptBox["\[Theta]", "n"]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.3931373491970224`*^9, 3.3931373770070114`*^9}, {
  3.3942344016071253`*^9, 3.3942344025446253`*^9}, {3.407614423598301*^9, 
  3.407614424396901*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"StructureFast", "[", 
   RowBox[{"f_", ",", "x_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"f", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Log", "[", "arg_", "]"}], "\[RuleDelayed]", 
        RowBox[{"rischLog", "[", "arg", "]"}]}], ",", 
       RowBox[{
        RowBox[{"Exp", "[", "arg_", "]"}], "\[RuleDelayed]", 
        RowBox[{"rischExp", "[", "arg", "]"}]}]}], "}"}]}], ")"}], "//.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"c_.", " ", 
       RowBox[{"rischLog", "[", 
        RowBox[{"a_", "/", "b_"}], "]"}]}], "\[RuleDelayed]", 
      RowBox[{
       RowBox[{"c", " ", 
        RowBox[{"rischLog", "[", "a", "]"}]}], "-", 
       RowBox[{"c", " ", 
        RowBox[{"rischLog", "[", "b", "]"}]}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rischLog", "[", 
       RowBox[{"a_", " ", "b_"}], "]"}], "\[RuleDelayed]", 
      RowBox[{
       RowBox[{
        RowBox[{"Log", "[", "a", "]"}], "+", 
        RowBox[{"rischLog", "[", "b", "]"}]}], "/;", 
       RowBox[{"FreeQ", "[", 
        RowBox[{"a", ",", "x"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rischExp", "[", 
       RowBox[{"a_", " ", "b_"}], "]"}], "\[RuleDelayed]", 
      RowBox[{
       RowBox[{
        RowBox[{"rischExp", "[", "b", "]"}], "^", "a"}], "/;", 
       RowBox[{
        RowBox[{"FreeQ", "[", 
         RowBox[{"a", ",", "x"}], "]"}], "&&", 
        RowBox[{"!", 
         RowBox[{"FreeQ", "[", 
          RowBox[{"b", ",", "x"}], "]"}]}], "&&", 
        RowBox[{"IntegerQ", "[", "a", "]"}]}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rischExp", "[", 
       RowBox[{"a_", " ", "b_"}], "]"}], "\[RuleDelayed]", 
      RowBox[{
       RowBox[{
        RowBox[{"rischExp", "[", 
         RowBox[{"I", " ", "b"}], "]"}], "^", 
        RowBox[{"Im", "[", "a", "]"}]}], "/;", 
       RowBox[{
        RowBox[{"FreeQ", "[", 
         RowBox[{"a", ",", "x"}], "]"}], "&&", 
        RowBox[{"!", 
         RowBox[{"FreeQ", "[", 
          RowBox[{"b", ",", "x"}], "]"}]}], "&&", 
        RowBox[{
         RowBox[{"Im", "[", "a", "]"}], "=!=", "0"}], "&&", 
        RowBox[{
         RowBox[{"Re", "[", "a", "]"}], "===", "0"}], "&&", 
        RowBox[{"IntegerQ", "[", 
         RowBox[{"Im", "[", "a", "]"}], "]"}]}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rischLog", "[", "arg_", "]"}], "\[RuleDelayed]", 
      RowBox[{
       RowBox[{"Log", "[", "arg", "]"}], "/;", 
       RowBox[{"FreeQ", "[", 
        RowBox[{"arg", ",", "x"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rischExp", "[", "arg_", "]"}], "\[RuleDelayed]", 
      RowBox[{
       RowBox[{"Exp", "[", "arg", "]"}], "/;", 
       RowBox[{"FreeQ", "[", 
        RowBox[{"arg", ",", "x"}], "]"}]}]}]}], "}"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.40471868649478*^9, 3.404718795214755*^9}, {
  3.40471912786945*^9, 3.4047191767088633`*^9}, {3.4047561411513977`*^9, 
  3.404756188237124*^9}, {3.407397698738896*^9, 3.407397701624695*^9}, {
  3.4073979056023808`*^9, 3.407397908598242*^9}, {3.40745162640451*^9, 
  3.407451630895885*^9}, {3.407451674450259*^9, 3.407451704861389*^9}, {
  3.407451768214539*^9, 3.407451773373802*^9}, {3.4074519888780117`*^9, 
  3.40745199702779*^9}, {3.409821672010275*^9, 3.409821716593708*^9}, {
  3.409821750661118*^9, 3.409821756577654*^9}, {3.40982180717095*^9, 
  3.409821810089787*^9}, {3.4098218989345407`*^9, 3.409821938746106*^9}, {
  3.409822391124495*^9, 3.409822395256207*^9}, {3.409944342961596*^9, 
  3.409944384119362*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"StructureFast", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"5", " ", 
     RowBox[{"rischLog", "[", "x", "]"}]}], "+", 
    RowBox[{"5", " ", 
     RowBox[{"rischLog", "[", 
      FractionBox[
       RowBox[{"1", "+", 
        RowBox[{"x", " ", 
         SubscriptBox["\[Theta]", "1"]}]}], "x"], "]"}]}]}], ",", "x"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.40994432268716*^9, 3.4099443306698847`*^9}}],

Cell[BoxData[
 RowBox[{"5", " ", 
  RowBox[{"rischLog", "[", 
   RowBox[{"1", "+", 
    RowBox[{"x", " ", 
     SubscriptBox["\[Theta]", "1"]}]}], "]"}]}]], "Output",
 CellChangeTimes->{{3.409944331757917*^9, 3.4099443865689917`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"StructureFast", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Log", "[", 
     RowBox[{"7", "x"}], "]"}], "+", 
    RowBox[{"Exp", "[", 
     RowBox[{"5", " ", "x"}], "]"}], "-", 
    RowBox[{"Exp", "[", 
     RowBox[{"8", "x"}], "]"}]}], ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.4047191943755627`*^9, 3.404719209400716*^9}, {
  3.407397712743924*^9, 3.4073977179732428`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Log", "[", "7", "]"}], "+", 
  SuperscriptBox[
   RowBox[{"rischExp", "[", "x", "]"}], "5"], "-", 
  SuperscriptBox[
   RowBox[{"rischExp", "[", "x", "]"}], "8"], "+", 
  RowBox[{"rischLog", "[", "x", "]"}]}]], "Output",
 CellChangeTimes->{{3.404719209827677*^9, 3.404719218936535*^9}, 
   3.404722541100718*^9, 3.405478283726767*^9, {3.407397709576675*^9, 
   3.407397718663663*^9}, 3.407397797659657*^9, 3.407397921069112*^9, 
   3.407451633179388*^9, {3.407451706948354*^9, 3.407451709018527*^9}, 
   3.407451999160302*^9, 3.409821837338417*^9, {3.409821902514576*^9, 
   3.409821971920273*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"StructureFast", "[", 
  RowBox[{
   RowBox[{"rischExp", "[", 
    RowBox[{
     RowBox[{"-", "I"}], " ", "x"}], "]"}], ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.40982195736909*^9, 3.409821966332226*^9}}],

Cell[BoxData[
 FractionBox["1", 
  RowBox[{"rischExp", "[", 
   RowBox[{"\[ImaginaryI]", " ", "x"}], "]"}]]], "Output",
 CellChangeTimes->{{3.409821966755436*^9, 3.409821972469434*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"StructureFast", "[", 
  RowBox[{
   FractionBox[
    RowBox[{"x", 
     RowBox[{"(", 
      RowBox[{"x", "+", "1"}], ")"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["x", "2"], " ", 
          RowBox[{"Exp", "[", 
           RowBox[{"2", 
            SuperscriptBox["x", "2"]}], "]"}]}], "-", 
         SuperscriptBox[
          RowBox[{"Log", "[", 
           RowBox[{"x", "+", "1"}], "]"}], "2"]}], ")"}], "+", 
       RowBox[{"2", "x", " ", 
        RowBox[{"Exp", "[", 
         RowBox[{"3", 
          SuperscriptBox["x", "2"]}], "]"}], 
        RowBox[{"(", 
         RowBox[{"x", "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", 
              SuperscriptBox["x", "3"]}], "+", 
             RowBox[{"2", 
              SuperscriptBox["x", "2"]}], "+", "x", "+", "1"}], ")"}], 
           RowBox[{"Log", "[", 
            RowBox[{"x", "+", "1"}], "]"}]}]}], ")"}]}]}], ")"}]}], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"x", "+", "1"}], ")"}], 
        SuperscriptBox[
         RowBox[{"Log", "[", 
          RowBox[{"x", "+", "1"}], "]"}], "2"]}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["x", "3"], "+", 
          SuperscriptBox["x", "2"]}], ")"}], 
        RowBox[{"Exp", "[", 
         RowBox[{"2", 
          SuperscriptBox["x", "2"]}], "]"}]}]}], ")"}], "2"]], ",", "x"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.395487380257053*^9, 3.395487491394416*^9}, {
  3.395487753850424*^9, 3.395487755027108*^9}, {3.395489515752133*^9, 
  3.3954895229473333`*^9}, {3.395722029268852*^9, 3.395722029617256*^9}, {
  3.395722109076796*^9, 3.3957221102491703`*^9}, {3.407397460909809*^9, 
  3.407397462899089*^9}, {3.407397809918941*^9, 3.407397820376131*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"x", " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", "x"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["x", "2"], " ", 
      SuperscriptBox[
       RowBox[{"rischExp", "[", 
        SuperscriptBox["x", "2"], "]"}], "2"]}], "-", 
     SuperscriptBox[
      RowBox[{"rischLog", "[", 
       RowBox[{"1", "+", "x"}], "]"}], "2"], "+", 
     RowBox[{"2", " ", "x", " ", 
      SuperscriptBox[
       RowBox[{"rischExp", "[", 
        SuperscriptBox["x", "2"], "]"}], "3"], " ", 
      RowBox[{"(", 
       RowBox[{"x", "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "+", "x", "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["x", "2"]}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["x", "3"]}]}], ")"}], " ", 
         RowBox[{"rischLog", "[", 
          RowBox[{"1", "+", "x"}], "]"}]}]}], ")"}]}]}], ")"}]}], 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["x", "3"]}], ")"}]}], " ", 
      SuperscriptBox[
       RowBox[{"rischExp", "[", 
        SuperscriptBox["x", "2"], "]"}], "2"]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", "x"}], ")"}], " ", 
      SuperscriptBox[
       RowBox[{"rischLog", "[", 
        RowBox[{"1", "+", "x"}], "]"}], "2"]}]}], ")"}], "2"]]], "Output",
 CellChangeTimes->{3.407397821183529*^9, 3.407397935659841*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"StructureLogExpCollect", "[", 
   RowBox[{"f_", ",", "x_"}], "]"}], ":=", 
  RowBox[{"Union", "/@", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cases", "[", 
      RowBox[{"f", ",", 
       RowBox[{
        RowBox[{"rischLog", "[", "arg_", "]"}], "/;", 
        RowBox[{"!", 
         RowBox[{"FreeQ", "[", 
          RowBox[{"arg", ",", "x"}], "]"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "Infinity"}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Cases", "[", 
      RowBox[{"f", ",", 
       RowBox[{
        RowBox[{"rischExp", "[", "arg_", "]"}], "/;", 
        RowBox[{"!", 
         RowBox[{"FreeQ", "[", 
          RowBox[{"arg", ",", "x"}], "]"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "Infinity"}], "}"}]}], "]"}]}], "}"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.404718845028883*^9, 3.4047189162670097`*^9}, {
  3.4047192239410954`*^9, 3.404719254659335*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"StructureAlgTrans", "[", 
   RowBox[{"f_", ",", "x_"}], "]"}], ":=", 
  RowBox[{"Union", "[", 
   RowBox[{"Flatten", "[", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Cases", "[", 
       RowBox[{"f", ",", 
        RowBox[{"c_", "/;", 
         RowBox[{
          RowBox[{"FreeQ", "[", 
           RowBox[{"c", ",", "x"}], "]"}], "&&", 
          RowBox[{
           RowBox[{"Head", "[", "c", "]"}], "=!=", "Rational"}], "&&", 
          RowBox[{
           RowBox[{"Head", "[", "c", "]"}], "=!=", "Integer"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "Infinity"}], "}"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Cases", "[", 
       RowBox[{"f", ",", 
        RowBox[{
         RowBox[{"rischLog", "[", "c_", "]"}], "/;", 
         RowBox[{"FreeQ", "[", 
          RowBox[{"c", ",", "x"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "Infinity"}], "}"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Cases", "[", 
       RowBox[{"f", ",", 
        RowBox[{
         RowBox[{"rischExp", "[", "c_", "]"}], "/;", 
         RowBox[{"FreeQ", "[", 
          RowBox[{"c", ",", "x"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "Infinity"}], "}"}]}], "]"}]}], 
     "\[IndentingNewLine]", "}"}], "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.404719356481821*^9, 3.4047193751152143`*^9}, {
  3.404719437131423*^9, 3.404719557656148*^9}, {3.404719594216011*^9, 
  3.404719595061118*^9}, {3.404719802431789*^9, 3.404719809356757*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"StructureAlgTrans", "[", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"rischExp", "[", "3", "]"}], "+", 
     RowBox[{"x", "^", "3"}], "-", "1"}], 
    RowBox[{"1", "-", 
     RowBox[{"rischLog", "[", 
      RowBox[{"x", "-", "1"}], "]"}], "+", 
     RowBox[{"rischLog", "[", "8", "]"}]}]], ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.4047195636025543`*^9, 3.404719582769272*^9}, {
  3.4047197838180733`*^9, 3.4047197924895897`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"rischExp", "[", "3", "]"}], ",", 
   RowBox[{"rischLog", "[", "8", "]"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.404719583214423*^9, 3.404719603779739*^9}, {
   3.40471979300206*^9, 3.404719810662422*^9}, 3.4054639027982883`*^9, 
   3.409054552103695*^9, 3.409054590622847*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Swap", "[", 
   RowBox[{"lst_List", ",", "p1_Integer", ",", "p2_Integer"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"res", "=", "lst"}], "}"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"res", "[", 
       RowBox[{"[", "p1", "]"}], "]"}], "=", 
      RowBox[{"lst", "[", 
       RowBox[{"[", "p2", "]"}], "]"}]}], ";", 
     RowBox[{
      RowBox[{"res", "[", 
       RowBox[{"[", "p2", "]"}], "]"}], "=", 
      RowBox[{"lst", "[", 
       RowBox[{"[", "p1", "]"}], "]"}]}], ";", "res"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.40498085943675*^9, 3.404980896439375*^9}, {
  3.404981094472301*^9, 3.4049811447352037`*^9}, {3.404981218474197*^9, 
  3.404981229599169*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"StructureDerivation", "[", 
   RowBox[{"tower_", ",", "thetas_", ",", "var_", ",", "reps_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "res", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"RischTrace", "[", 
      RowBox[{"StructureDerivation", ",", 
       RowBox[{"{", 
        RowBox[{"tower", ",", "thetas", ",", "var", ",", "reps"}], "}"}], 
       ",", "\"\<In\>\""}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Reap", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Sow", "[", 
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{"#", ",", "var"}], "]"}], "//.", "reps"}], "]"}], "&"}],
           "/@", "tower"}], "]"}], "//", "Last"}], "//", "Flatten"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"RischTrace", "[", 
      RowBox[{"StructureDerivation", ",", "res", ",", "\"\<Out\>\""}], "]"}], 
     ";", "\[IndentingNewLine]", "res"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.3942386397790003`*^9, 3.3942387073102503`*^9}, {
   3.3942488210602503`*^9, 3.3942488238415003`*^9}, {3.394300643451375*^9, 
   3.39430064462325*^9}, {3.4047214924853354`*^9, 3.404721514216964*^9}, {
   3.4054606561451397`*^9, 3.4054606782793093`*^9}, 3.405460720130084*^9, {
   3.405462120128208*^9, 3.405462250837599*^9}, {3.405462318061769*^9, 
   3.405462350421962*^9}, {3.40546238225404*^9, 3.405462396046598*^9}, {
   3.40546242970217*^9, 3.4054625637420387`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"StructureDerivation", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"Log", "[", "x", "]"}], ",", 
     RowBox[{"Log", "[", 
      RowBox[{"Log", "[", "x", "]"}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["\"\<\[Theta]\>\"", "1"], ",", 
     SubscriptBox["\"\<\[Theta]\>\"", "2"], ",", 
     SubscriptBox["\"\<\[Theta]\>\"", "3"]}], "}"}], ",", "x", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x", "->", 
      SubscriptBox["\"\<\[Theta]\>\"", "1"]}], ",", 
     RowBox[{
      RowBox[{"Log", "[", "x", "]"}], "->", 
      SubscriptBox["\"\<\[Theta]\>\"", "2"]}], ",", 
     RowBox[{
      RowBox[{"Log", "[", 
       RowBox[{"Log", "[", "x", "]"}], "]"}], "->", 
      SubscriptBox["\"\<\[Theta]\>\"", "3"]}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.405462573877837*^9, 3.405462640156683*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", 
   FractionBox["1", 
    SubscriptBox["\<\"\[Theta]\"\>", "1"]], ",", 
   FractionBox["1", 
    RowBox[{
     SubscriptBox["\<\"\[Theta]\"\>", "1"], " ", 
     SubscriptBox["\<\"\[Theta]\"\>", "2"]}]]}], "}"}]], "Output",
 CellChangeTimes->{{3.4054626406187267`*^9, 3.4054626482585487`*^9}, 
   3.409054604250958*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"StructureDerivation", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"rischLog", "[", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "x"}], "]"}], ",", 
     RowBox[{"rischLog", "[", "x", "]"}], ",", 
     RowBox[{"rischLog", "[", 
      RowBox[{"1", "+", "x"}], "]"}], ",", 
     RowBox[{"rischLog", "[", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SuperscriptBox["x", "2"]}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["\"\<\[Theta]\>\"", "1"], ",", 
     SubscriptBox["\"\<\[Theta]\>\"", "2"], ",", 
     SubscriptBox["\"\<\[Theta]\>\"", "3"], ",", 
     SubscriptBox["\"\<\[Theta]\>\"", "4"], ",", 
     SubscriptBox["\"\<\[Theta]\>\"", "5"]}], "}"}], ",", "x", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x", "\[Rule]", 
      SubscriptBox["\"\<\[Theta]\>\"", "1"]}], ",", 
     RowBox[{
      RowBox[{"rischLog", "[", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "x"}], "]"}], "\[Rule]", 
      SubscriptBox["\"\<\[Theta]\>\"", "2"]}], ",", 
     RowBox[{
      RowBox[{"rischLog", "[", "x", "]"}], "\[Rule]", 
      SubscriptBox["\"\<\[Theta]\>\"", "3"]}], ",", 
     RowBox[{
      RowBox[{"rischLog", "[", 
       RowBox[{"1", "+", "x"}], "]"}], "\[Rule]", 
      SubscriptBox["\"\<\[Theta]\>\"", "4"]}], ",", 
     RowBox[{
      RowBox[{"rischLog", "[", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["x", "2"]}], "]"}], "\[Rule]", 
      SubscriptBox["\"\<\[Theta]\>\"", "5"]}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.405462424863805*^9, 3.405462425138036*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     SubscriptBox["\<\"\[Theta]\"\>", "1"]}]], ",", 
   FractionBox["1", 
    SubscriptBox["\<\"\[Theta]\"\>", "1"]], ",", 
   FractionBox["1", 
    RowBox[{"1", "+", 
     SubscriptBox["\<\"\[Theta]\"\>", "1"]}]], ",", 
   FractionBox[
    RowBox[{"2", " ", 
     SubscriptBox["\<\"\[Theta]\"\>", "1"]}], 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     SubsuperscriptBox["\<\"\[Theta]\"\>", "1", "2"]}]]}], "}"}]], "Output",
 CellChangeTimes->{3.405462433299707*^9, 3.405462497202709*^9, 
  3.4054625655128613`*^9, 3.4090546047341547`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"findlogexp", "[", "tower_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"exps", ",", "logs"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"RischTrace", "[", 
      RowBox[{"findlogexp", ",", "tower", ",", "\"\<In\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"exps", "=", 
      RowBox[{"Cases", "[", 
       RowBox[{"tower", ",", 
        RowBox[{
         RowBox[{"rischExp", "[", "a_", "]"}], "\[RuleDelayed]", "a"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "Infinity"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"logs", "=", 
      RowBox[{"Cases", "[", 
       RowBox[{"tower", ",", 
        RowBox[{
         RowBox[{"rischLog", "[", "a_", "]"}], "\[RuleDelayed]", "a"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "Infinity"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"RischTrace", "[", 
      RowBox[{"findlogexp", ",", 
       RowBox[{"{", 
        RowBox[{"exps", ",", "logs"}], "}"}], ",", "\"\<Out\>\""}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"exps", ",", "logs"}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4055427327840137`*^9, 3.405542824896409*^9}, {
  3.405542902967931*^9, 3.405542992681809*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RationalQ", "[", "n_", "]"}], ":=", 
  RowBox[{"Or", "@@", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Head", "[", "n", "]"}], "===", "Rational"}], ",", 
     RowBox[{
      RowBox[{"Head", "[", "n", "]"}], "===", "Integer"}]}], 
    "}"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.405479994302292*^9, 3.405480067493402*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"And", "@@", 
  RowBox[{"(", 
   RowBox[{"RationalQ", "/@", 
    RowBox[{"{", 
     RowBox[{"3", ",", 
      RowBox[{"4", "/", "5"}], ",", "Pi", ",", 
      RowBox[{"Exp", "[", "1", "]"}]}], "}"}]}], ")"}]}]], "Input",
 CellChangeTimes->{{3.4054800120624123`*^9, 3.405480014908422*^9}, {
  3.405480074807543*^9, 3.405480089052925*^9}, {3.4054803207284193`*^9, 
  3.405480323701087*^9}}],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{{3.40548001530202*^9, 3.405480101196576*^9}, 
   3.405480150194543*^9, 3.405480324102675*^9, 3.4055411595923243`*^9, 
   3.409054606866208*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Main Algorithm", "Subsection",
 CellChangeTimes->{{3.394310299170125*^9, 3.394310301013875*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RischStructure", "[", 
   RowBox[{"f_", ",", "x_"}], "]"}], ":=", 
  RowBox[{"Catch", "[", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "integrand", ",", " ", "logList", ",", "expList", ",", " ", 
       "algTranNums", ",", " ", "params", ",", "linExp", ",", 
       "\[IndentingNewLine]", "alphas", ",", " ", "ptower", ",", " ", 
       "cptower", ",", "tower", ",", " ", "Dtower", ",", " ", "thetas", ",", 
       "argument", ",", " ", "fail", ",", "ncp", ",", "testelem", ",", "reps",
        ",", "result"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "Implementation", " ", "of", " ", "Risch", " ", "structure", " ", 
        "theorem", " ", "for", " ", "log"}], "-", 
       RowBox[{"exp", " ", "functions"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Input", ":", " ", 
        RowBox[{"f", " ", 
         RowBox[{"(", "integrand", ")"}]}]}], ",", " ", 
       RowBox[{"x", " ", 
        RowBox[{"(", 
         RowBox[{"variable", " ", "of", " ", "integration"}], ")"}], 
        "\[IndentingNewLine]", 
        RowBox[{"Output", ":", " ", "integrand"}]}], ",", " ", "thetas", ",", 
       " ", "tower", ",", " ", 
       RowBox[{"derivation", " ", "of", " ", "tower"}], ",", " ", 
       RowBox[{"constant", " ", "field", " ", "over", " ", "Q"}]}], 
      "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "convert", " ", "the", " ", "integrand", " ", "into", " ", "internal", 
        " ", "form"}], ",", " ", 
       RowBox[{"if", " ", "not", " ", "already", " ", 
        RowBox[{"done", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"RischTrace", "[", 
       RowBox[{"RischStructure", ",", 
        RowBox[{"{", 
         RowBox[{"f", ",", "x"}], "}"}], ",", "\"\<In\>\""}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"integrand", "=", 
       RowBox[{"PreprocessExponents", "[", 
        RowBox[{"f", ",", "x"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"integrand", "=", 
       RowBox[{"StructureFast", "[", 
        RowBox[{"integrand", ",", "x"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "collect", " ", "all", " ", "the", " ", "logarithms", " ", "and", " ", 
        "exponentials", " ", "in", " ", "the", " ", "integrand"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"logList", ",", "expList"}], "}"}], "=", 
       RowBox[{"StructureLogExpCollect", "[", 
        RowBox[{"integrand", ",", "x"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"base", " ", 
        RowBox[{"case", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{"logList", ",", 
           RowBox[{"{", "}"}]}], "]"}], "&&", 
         RowBox[{"SameQ", "[", 
          RowBox[{"expList", ",", 
           RowBox[{"{", "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"RischTrace", "[", 
          RowBox[{"RischStructure", ",", 
           RowBox[{"{", 
            RowBox[{"integrand", ",", 
             RowBox[{"{", "x", "}"}], ",", 
             RowBox[{"{", "x", "}"}], ",", 
             RowBox[{"{", "1", "}"}], ",", 
             RowBox[{"{", "}"}]}], "}"}], ",", "\"\<Out\>\""}], "]"}], ";", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{"Throw", "[", 
          RowBox[{"{", 
           RowBox[{"integrand", ",", 
            RowBox[{"{", "x", "}"}], ",", 
            RowBox[{"{", "x", "}"}], ",", 
            RowBox[{"{", "1", "}"}], ",", 
            RowBox[{"{", "}"}]}], "}"}], "]"}]}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "all", " ", "parameters", " ", "in", " ", "the", " ", "integrand"}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"params", "=", 
       RowBox[{"DeleteCases", "[", 
        RowBox[{
         RowBox[{"PureVariables", "[", "f", "]"}], ",", "x"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "collect", " ", "all", " ", "the", " ", "algebraic", " ", "and", " ", 
        "transcendental", " ", "numbers", " ", "in", " ", "the", " ", 
        "integrand"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"algTranNums", "=", 
       RowBox[{"{", "}"}]}], 
      RowBox[{"(*", " ", 
       RowBox[{"StructureAlgTrans", "[", 
        RowBox[{"integrand", ",", "x"}], "]"}], " ", "*)"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"all", " ", 
        RowBox[{"transcendental", "/", "algebraics"}], " ", "over", " ", 
        "Q"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"alphas", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"params", ",", "algTranNums"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "define", " ", "the", " ", "preliminary", " ", "form", " ", "of", " ", 
        "the", " ", 
        RowBox[{"tower", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"ptower", "=", 
       RowBox[{"UnsortedUnion", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", "x", "}"}], ",", 
          RowBox[{"Sort", "[", 
           RowBox[{"expList", ",", "\[IndentingNewLine]", "\t", 
            RowBox[{
             RowBox[{
              RowBox[{"ByteCount", "[", "#1", "]"}], "<=", 
              RowBox[{"ByteCount", "[", "#2", "]"}]}], "&"}]}], "]"}], ",", 
          RowBox[{"Sort", "[", 
           RowBox[{"logList", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"ByteCount", "[", "#1", "]"}], "<=", 
              RowBox[{"ByteCount", "[", "#2", "]"}]}], "&"}]}], "]"}]}], 
         "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "make", " ", "a", " ", "canonical", " ", "ordering", " ", "of", " ", 
        "the", " ", "list"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"cptower", "=", 
       RowBox[{"StructureCanonicalRepresentation", "[", "ptower", "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"define", " ", "the", " ", 
         RowBox[{"theta", "'"}], "s"}], ",", " ", 
        RowBox[{
        "tower", " ", "and", " ", "the", " ", "tower", " ", "derivation"}]}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"thetas", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", "x", "}"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"theta", "[", "n", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "1", ",", 
             RowBox[{
              RowBox[{"Length", "[", "cptower", "]"}], "-", "1"}]}], "}"}]}], 
          "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"reps", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"First", "[", "#", "]"}], "->", 
          RowBox[{"Last", "[", "#", "]"}]}], "&"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"{", 
          RowBox[{"cptower", ",", "thetas"}], "}"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Dtower", "=", 
       RowBox[{"StructureDerivation", "[", 
        RowBox[{"cptower", ",", "thetas", ",", "x", ",", "reps"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Apply", " ", "the", " ", "structure", " ", "theorems"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"result", "=", 
       RowBox[{"StructureEliminate", "[", 
        RowBox[{
        "integrand", ",", "thetas", ",", "cptower", ",", "Dtower", ",", 
         "algTranNums", ",", "reps"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"integrand", "=", 
       RowBox[{
        RowBox[{"First", "[", "result", "]"}], "//.", "reps"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"RischTrace", "[", 
       RowBox[{"RischStructure", ",", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", "integrand", "}"}], ",", 
          RowBox[{"Rest", "[", "result", "]"}]}], "]"}], ",", "\"\<Out\>\""}],
        "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", "integrand", "}"}], ",", 
        RowBox[{"Rest", "[", "result", "]"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.39313295016152*^9, 3.393133082001096*^9}, {
   3.3931334012201104`*^9, 3.3931334344278607`*^9}, {3.3931335467994432`*^9, 
   3.3931336707376575`*^9}, {3.3931337261673613`*^9, 
   3.3931337311945906`*^9}, {3.3931338513974333`*^9, 
   3.3931339505800514`*^9}, {3.3931342703899155`*^9, 3.393134277139621*^9}, {
   3.393134307663512*^9, 3.393134368210574*^9}, {3.3931344068160863`*^9, 
   3.3931344162296224`*^9}, {3.3931345129186544`*^9, 
   3.3931345168242702`*^9}, {3.3931345769006557`*^9, 
   3.3931347207474976`*^9}, {3.3931349640473456`*^9, 
   3.3931349772663536`*^9}, {3.393135012066394*^9, 3.3931350198375683`*^9}, {
   3.393135100533603*^9, 3.393135167569997*^9}, {3.3931352043128304`*^9, 
   3.3931353294828157`*^9}, {3.393135367918083*^9, 3.3931353704517264`*^9}, {
   3.393135402838296*^9, 3.3931354031687713`*^9}, {3.3931354886116323`*^9, 
   3.3931354891724386`*^9}, {3.3931355214989214`*^9, 
   3.3931355438310337`*^9}, {3.393135589246338*^9, 3.393135636344061*^9}, {
   3.3931357222475843`*^9, 3.393135732882877*^9}, {3.393136015869792*^9, 
   3.3931360721407056`*^9}, {3.3931363645111136`*^9, 3.393136599368822*^9}, {
   3.3931366850119715`*^9, 3.3931367649769554`*^9}, {3.393136828257949*^9, 
   3.3931368756460896`*^9}, {3.393136967488152*^9, 3.3931370416347694`*^9}, {
   3.3931372034975166`*^9, 3.3931372199411616`*^9}, {3.3931372557125983`*^9, 
   3.3931373282468977`*^9}, {3.3931375960419683`*^9, 3.393137600017685*^9}, {
   3.3931377578846865`*^9, 3.393137785464344*^9}, {3.3931378659200335`*^9, 
   3.393137921409824*^9}, {3.393137953475933*^9, 3.3931380301762223`*^9}, {
   3.3942296640602503`*^9, 3.3942296652008753`*^9}, {3.3942297281696253`*^9, 
   3.3942297297790003`*^9}, {3.3942303685290003`*^9, 
   3.3942303747946253`*^9}, {3.3942306665602503`*^9, 
   3.3942306986383753`*^9}, {3.3942321274196253`*^9, 3.3942321718415003`*^9}, 
   3.3942322274508753`*^9, {3.3942325935290003`*^9, 3.3942325958571253`*^9}, {
   3.3942329244040003`*^9, 3.3942329386540003`*^9}, {3.3942336262008753`*^9, 
   3.3942336295602503`*^9}, {3.3942339863415003`*^9, 
   3.3942339951852503`*^9}, {3.3942344366852503`*^9, 
   3.3942345727008753`*^9}, {3.3942346435915003`*^9, 
   3.3942346593883753`*^9}, {3.3942347719196253`*^9, 
   3.3942348040602503`*^9}, {3.3942348812008753`*^9, 
   3.3942350195290003`*^9}, {3.3942371814665003`*^9, 
   3.3942372038883753`*^9}, {3.3942372543415003`*^9, 
   3.3942372652790003`*^9}, {3.3942373848571253`*^9, 
   3.3942373876852503`*^9}, {3.3942374310758753`*^9, 
   3.3942374593415003`*^9}, {3.3942375079196253`*^9, 
   3.3942375989665003`*^9}, {3.3942376710290003`*^9, 
   3.3942376760758753`*^9}, {3.3942377118727503`*^9, 
   3.3942377253258753`*^9}, {3.3942381137790003`*^9, 
   3.3942381155290003`*^9}, {3.3942383776852503`*^9, 
   3.3942386341852503`*^9}, {3.3942387485602503`*^9, 
   3.3942387674977503`*^9}, {3.3942460729040003`*^9, 
   3.3942461065758753`*^9}, {3.3942463702321253`*^9, 
   3.3942463706383753`*^9}, {3.3942464809977503`*^9, 
   3.3942464901227503`*^9}, {3.3942487394196253`*^9, 
   3.3942487508258753`*^9}, {3.3942488523727503`*^9, 
   3.3942488889352503`*^9}, {3.3942492771696253`*^9, 
   3.3942493145133753`*^9}, {3.3942493844665003`*^9, 
   3.3942493848258753`*^9}, {3.39426076901225*^9, 3.394260845684125*^9}, 
   3.39426089732475*^9, {3.394295071013875*^9, 3.394295154357625*^9}, {
   3.394295193467*^9, 3.394295224842*^9}, {3.394298916482625*^9, 
   3.394298948076375*^9}, {3.394298979842*^9, 3.3942990244045*^9}, {
   3.394299318717*^9, 3.394299330388875*^9}, {3.3942994057795*^9, 
   3.394299426967*^9}, {3.394299462842*^9, 3.394299495545125*^9}, {
   3.39429953818575*^9, 3.394299567607625*^9}, {3.394299661513875*^9, 
   3.394299681482625*^9}, {3.394301382763875*^9, 3.39430139231075*^9}, {
   3.394301456420125*^9, 3.39430146612325*^9}, {3.394301513967*^9, 
   3.394301532451375*^9}, {3.3943015640295*^9, 3.39430157949825*^9}, {
   3.394301702592*^9, 3.394301740920125*^9}, {3.394301780826375*^9, 
   3.394301781076375*^9}, {3.394308485420125*^9, 3.394308500357625*^9}, {
   3.394308575888875*^9, 3.3943086731545*^9}, {3.394308788295125*^9, 
   3.3943087936545*^9}, {3.394308931263875*^9, 3.394308938592*^9}, {
   3.3943089720295*^9, 3.3943089826545*^9}, {3.394309013826375*^9, 
   3.394309021467*^9}, {3.394309080076375*^9, 3.394309088982625*^9}, {
   3.394309119951375*^9, 3.394309127888875*^9}, {3.394309227092*^9, 
   3.394309278826375*^9}, {3.39430933406075*^9, 3.3943093564045*^9}, {
   3.394309388263875*^9, 3.39430942918575*^9}, {3.394309495795125*^9, 
   3.39430949681075*^9}, {3.394309539592*^9, 3.3943095482795*^9}, {
   3.394309599013875*^9, 3.394309623701375*^9}, {3.395196536871255*^9, 
   3.3951966511760273`*^9}, {3.3952033050859623`*^9, 3.395203372316709*^9}, {
   3.395203435295376*^9, 3.395203468017047*^9}, {3.395203502632348*^9, 
   3.395203504883225*^9}, {3.395203541366856*^9, 3.395203608792513*^9}, {
   3.3952036923711443`*^9, 3.395203701582101*^9}, {3.3952037407845488`*^9, 
   3.39520375437729*^9}, {3.395203800486848*^9, 3.3952038043565207`*^9}, {
   3.3952039157825947`*^9, 3.395203964595953*^9}, {3.395204477839551*^9, 
   3.395204495172324*^9}, {3.395313852551676*^9, 3.395313902956266*^9}, {
   3.395391814098117*^9, 3.395391819097164*^9}, {3.395488725390757*^9, 
   3.395488779505415*^9}, {3.395488882895069*^9, 3.395488920900158*^9}, {
   3.3954889787158012`*^9, 3.395489097583241*^9}, {3.3954891749149*^9, 
   3.395489176587927*^9}, {3.395491154559095*^9, 3.395491168566712*^9}, 
   3.3954939407003393`*^9, {3.395493997356238*^9, 3.395493999673252*^9}, {
   3.39572129204137*^9, 3.395721365096571*^9}, {3.395721421657296*^9, 
   3.395721442268347*^9}, {3.395721531370927*^9, 3.395721660603765*^9}, {
   3.395721914853537*^9, 3.395721940370076*^9}, {3.3957220636694098`*^9, 
   3.395722071239937*^9}, {3.3960801489603977`*^9, 3.396080283881034*^9}, {
   3.396080324830413*^9, 3.396080352885063*^9}, {3.396080421628417*^9, 
   3.396080428486244*^9}, {3.3961700998304367`*^9, 3.3961701054350653`*^9}, {
   3.3965829583651543`*^9, 3.396582970278194*^9}, {3.396583009962183*^9, 
   3.396583011351663*^9}, {3.3965830588949013`*^9, 3.3965830639762583`*^9}, {
   3.39658311080439*^9, 3.3965831605488253`*^9}, {3.396583203732881*^9, 
   3.3965832040438023`*^9}, {3.396600911790063*^9, 3.39660093842979*^9}, {
   3.396869248227312*^9, 3.396869268413279*^9}, {3.396869490040719*^9, 
   3.3968694902336617`*^9}, {3.396869826762536*^9, 3.396869831834641*^9}, {
   3.396870124265666*^9, 3.396870146443742*^9}, {3.396873301086329*^9, 
   3.3968733013805656`*^9}, {3.397456662118075*^9, 3.397456691501091*^9}, {
   3.397456726542139*^9, 3.397456732715222*^9}, 3.404718677202978*^9, {
   3.4047187242455482`*^9, 3.404718742212102*^9}, {3.4047188154417*^9, 
   3.4047188375915613`*^9}, {3.4047189265851097`*^9, 3.404718964656116*^9}, {
   3.4047190945973063`*^9, 3.404719107211334*^9}, {3.404719325299765*^9, 
   3.40471934939622*^9}, {3.404719387368616*^9, 3.4047194226298018`*^9}, {
   3.404720376950692*^9, 3.4047203783290987`*^9}, {3.404720481649641*^9, 
   3.404720602961562*^9}, 3.404720645596149*^9, {3.404720695251631*^9, 
   3.40472073979922*^9}, {3.404721126131898*^9, 3.4047211524865513`*^9}, {
   3.404721210521977*^9, 3.4047212404044724`*^9}, {3.404721434210472*^9, 
   3.404721440721517*^9}, {3.404721506834021*^9, 3.404721507992948*^9}, {
   3.4047215480276527`*^9, 3.4047216097530327`*^9}, {3.404721640619842*^9, 
   3.404721830664551*^9}, {3.404721862825252*^9, 3.40472186294971*^9}, {
   3.404722463689404*^9, 3.40472248914989*^9}, {3.404722568986402*^9, 
   3.404722702067417*^9}, {3.404722768226902*^9, 3.404722798170231*^9}, {
   3.404722842113484*^9, 3.40472291527308*^9}, {3.404754758586513*^9, 
   3.40475475898643*^9}, 3.404754825802796*^9, {3.4049777127647448`*^9, 
   3.404977749642887*^9}, 3.404978181783039*^9, {3.40497823198225*^9, 
   3.404978324587829*^9}, {3.404978357726416*^9, 3.404978360872633*^9}, {
   3.404978729572846*^9, 3.404978816958284*^9}, {3.4049793880483627`*^9, 
   3.404979409343611*^9}, {3.4051460922520113`*^9, 3.405146104980057*^9}, {
   3.4051461616208687`*^9, 3.405146163790934*^9}, {3.405146225378333*^9, 
   3.405146236932868*^9}, {3.405146286936167*^9, 3.405146320709725*^9}, {
   3.4051466562239437`*^9, 3.4051466828864307`*^9}, {3.4054601326116943`*^9, 
   3.405460168255445*^9}, {3.4054602245094643`*^9, 3.405460259514903*^9}, {
   3.405460305581004*^9, 3.405460337346347*^9}, {3.405460428096678*^9, 
   3.4054605443314953`*^9}, {3.405462362728779*^9, 3.4054623773840523`*^9}, {
   3.405462694512034*^9, 3.40546270384709*^9}, {3.405463930300558*^9, 
   3.405463934507504*^9}, {3.40547285030331*^9, 3.40547286005505*^9}, {
   3.405472931177799*^9, 3.405472931329007*^9}, {3.4055598684159813`*^9, 
   3.40555987496873*^9}, {3.4055599147362003`*^9, 3.405559919312941*^9}, {
   3.4055599658596783`*^9, 3.405559969360731*^9}, {3.406194708329823*^9, 
   3.406194708630728*^9}, {3.406231092902093*^9, 3.406231130440132*^9}, {
   3.406266922685206*^9, 3.406266929690184*^9}, {3.406266984928385*^9, 
   3.4062670143853817`*^9}, {3.406267057255116*^9, 3.40626713586642*^9}, {
   3.406269354970758*^9, 3.406269363010742*^9}, {3.406269411867955*^9, 
   3.406269431840651*^9}, {3.406538575385352*^9, 3.4065385807204237`*^9}, {
   3.406625872689864*^9, 3.4066258804825993`*^9}, {3.406625960061659*^9, 
   3.406625964196363*^9}, {3.4069642085656548`*^9, 3.4069642092057467`*^9}, {
   3.4074539928479567`*^9, 3.407453993160214*^9}, {3.4076142859191008`*^9, 
   3.407614292771736*^9}, {3.407617189269977*^9, 3.4076171934901733`*^9}, {
   3.409124935962015*^9, 3.409124940265869*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RischStructure", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"InputConvert", "[", 
     RowBox[{
      FractionBox[
       SuperscriptBox["2", "x"], 
       RowBox[{"1", "+", 
        SuperscriptBox["2", "x"], "-", 
        SuperscriptBox["4", "x"]}]], ",", "x"}], "]"}], "//", "First"}], ",", 
   "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.407614313685604*^9, 3.407614321109231*^9}, {
  3.407614689857238*^9, 3.407614693560055*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    SubscriptBox["\[Theta]", "1"], 
    RowBox[{"1", "+", 
     SubscriptBox["\[Theta]", "1"], "-", 
     SubsuperscriptBox["\[Theta]", "1", "2"]}]], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     SubscriptBox["\[Theta]", "1"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"rischExp", "[", 
      RowBox[{"x", " ", 
       RowBox[{"Log", "[", "2", "]"}]}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{
      RowBox[{"Log", "[", "2", "]"}], " ", 
      SubscriptBox["\[Theta]", "1"]}]}], "}"}], ",", 
   RowBox[{"{", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.407614233010335*^9, {3.407614307353653*^9, 3.40761432184454*^9}, 
   3.4076146942469473`*^9, 3.409174493784912*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RischStructure", "[", 
  RowBox[{
   RowBox[{"x", " ", 
    RowBox[{"Log", "[", "x", "]"}]}], ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.405559922311344*^9, 3.405559932663608*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"x", " ", 
    SubscriptBox["\<\"\[Theta]\"\>", "1"]}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"rischLog", "[", "x", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     FractionBox["1", "x"]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.4055599288191957`*^9, 3.4055599333452673`*^9}, 
   3.405559970436719*^9, 3.406194630619948*^9, 3.406194710462502*^9, 
   3.406230863695212*^9, 3.4062670306067133`*^9, 3.406267138758696*^9, 
   3.406269369580379*^9, {3.4062694188947687`*^9, 3.4062694330316133`*^9}, 
   3.406533853704927*^9, 3.406536564552944*^9, 3.406622633924781*^9, 
   3.406625930383047*^9, 3.407450666434507*^9, 3.4074539943869867`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"RischStructure", "[", 
   RowBox[{
    FractionBox[
     RowBox[{"rischExp", "[", 
      RowBox[{"x", "-", 
       RowBox[{"rischLog", "[", "x", "]"}], "-", 
       RowBox[{"rischExp", "[", "x", "]"}]}], "]"}], 
     RowBox[{
      RowBox[{
       RowBox[{"rischExp", "[", 
        RowBox[{"2", " ", "x"}], "]"}], 
       RowBox[{"rischExp", "[", 
        RowBox[{
         RowBox[{"x", " ", 
          RowBox[{"rischLog", "[", "x", "]"}]}], "-", 
         RowBox[{"rischExp", "[", "x", "]"}]}], "]"}]}], "-", "x"}]], ",", 
    "x"}], "]"}], 
  RowBox[{"(*", " ", "check", " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.4054726379052353`*^9, 3.4054726936928368`*^9}, {
   3.405472726831481*^9, 3.405472816965295*^9}, {3.4054728816102858`*^9, 
   3.405472898253769*^9}, 3.4062694621968737`*^9, {3.406278990496407*^9, 
   3.406278990637669*^9}, {3.406279103344637*^9, 3.406279107133832*^9}, {
   3.4074506563545113`*^9, 3.407450662286131*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    SubscriptBox["\[Theta]", "3"], 
    RowBox[{
     RowBox[{"-", "x"}], "+", 
     RowBox[{
      SubsuperscriptBox["\[Theta]", "1", "2"], " ", 
      SubscriptBox["\[Theta]", "4"]}]}]], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     SubscriptBox["\[Theta]", "1"], ",", 
     SubscriptBox["\[Theta]", "2"], ",", 
     SubscriptBox["\[Theta]", "3"], ",", 
     SubscriptBox["\[Theta]", "4"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"rischExp", "[", "x", "]"}], ",", 
     RowBox[{"rischLog", "[", "x", "]"}], ",", 
     RowBox[{"rischExp", "[", 
      RowBox[{"x", "-", 
       SubscriptBox["\[Theta]", "1"], "-", 
       SubscriptBox["\[Theta]", "2"]}], "]"}], ",", 
     RowBox[{"rischExp", "[", 
      RowBox[{
       RowBox[{"-", 
        SubscriptBox["\[Theta]", "1"]}], "+", 
       RowBox[{"x", " ", 
        SubscriptBox["\[Theta]", "2"]}]}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     SubscriptBox["\[Theta]", "1"], ",", 
     FractionBox["1", "x"], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "x", "+", 
          RowBox[{"x", " ", 
           SubscriptBox["\[Theta]", "1"]}]}], ")"}], " ", 
        SubscriptBox["\[Theta]", "3"]}], "x"]}], ",", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         SubscriptBox["\[Theta]", "1"], "-", 
         SubscriptBox["\[Theta]", "2"]}], ")"}]}], " ", 
      SubscriptBox["\[Theta]", "4"]}]}], "}"}], ",", 
   RowBox[{"{", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.407450627074367*^9, 3.407453995619986*^9, 
  3.409140224770713*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"RischStructure", "[", 
   RowBox[{
    FractionBox[
     RowBox[{"Log", "[", "x", "]"}], 
     RowBox[{
      RowBox[{"Log", "[", 
       RowBox[{
        SuperscriptBox["x", "2"], "-", "1"}], "]"}], "-", 
      RowBox[{"Log", "[", 
       RowBox[{"x", "-", "1"}], "]"}], "-", 
      RowBox[{"Log", "[", 
       RowBox[{"x", "+", "1"}], "]"}], "+", "1"}]], ",", "x"}], "]"}], "//", 
  "Timing"}]], "Input",
 CellChangeTimes->{{3.4054600986778*^9, 3.405460126747368*^9}, {
  3.406622641634955*^9, 3.40662264301746*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.017000000000000015`", ",", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["\[Theta]", "1"], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       SubscriptBox["\[Theta]", "1"], ",", 
       SubscriptBox["\[Theta]", "2"], ",", 
       SubscriptBox["\[Theta]", "3"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"rischLog", "[", "x", "]"}], ",", 
       RowBox[{"rischLog", "[", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "x"}], "]"}], ",", 
       RowBox[{"rischLog", "[", 
        RowBox[{"1", "+", "x"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", 
       FractionBox["1", "x"], ",", 
       FractionBox["1", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "x"}]], ",", 
       FractionBox["1", 
        RowBox[{"1", "+", "x"}]]}], "}"}], ",", 
     RowBox[{"{", "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.406230865872036*^9, 3.406267159602113*^9, 3.40626947522058*^9, 
   3.406275934692546*^9, 3.406279117175342*^9, 3.406533871540909*^9, 
   3.406538474667572*^9, {3.406622635892462*^9, 3.4066226436556168`*^9}, 
   3.407450682248232*^9, 3.407453996741477*^9, 3.407614366407774*^9, 
   3.4091400868229437`*^9, 3.409174498911961*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RischStructure", "[", 
  RowBox[{
   FractionBox[
    RowBox[{"Log", "[", "x", "]"}], "x"], ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.405146641347554*^9, 3.405146648332456*^9}, 
   3.4054719669851627`*^9, {3.406279122406521*^9, 3.406279124019754*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    SubscriptBox["\<\"\[Theta]\"\>", "1"], "x"], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"rischLog", "[", "x", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     FractionBox["1", "x"]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.405462943632366*^9, 3.405463053806345*^9, 3.405463498045109*^9, {
   3.405463943017771*^9, 3.405463947421974*^9}, 3.4054732076572313`*^9, {
   3.406279120565124*^9, 3.406279124429204*^9}, 3.406533881195394*^9, 
   3.4066227269901457`*^9, 3.407450683176128*^9, 3.4074539975359488`*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Structure Eliminate", "Subsection",
 CellChangeTimes->{{3.405478496434375*^9, 3.4054784997074003`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"StructureEliminate", "[", 
   RowBox[{
   "expr_", ",", "inthetas_", ",", "intower_", ",", "inDtower_", ",", "nums_",
     ",", "inreps_"}], "]"}], ":=", 
  RowBox[{"Catch", "[", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"integrand", "=", "expr"}], ",", "thetas", ",", "tower", ",", 
       "Dtower", ",", 
       RowBox[{"reps", "=", "inreps"}], ",", 
       RowBox[{"testtower", "=", "intower"}], ",", "\[IndentingNewLine]", 
       "test", ",", "state", ",", "result", ",", "res", ",", "new"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"RischTrace", "[", 
       RowBox[{"StructureEliminate", ",", 
        RowBox[{"{", 
         RowBox[{
         "integrand", ",", "inthetas", ",", "intower", ",", "inDtower"}], 
         "}"}], ",", "\"\<In\>\""}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "apply", " ", "Risch", " ", "structure", " ", "theorems", " ", "to", 
        " ", "tower", " ", "\[IndentingNewLine]", "to", " ", "remove", " ", 
        "any", " ", "algebraic", " ", "dependencies", " ", "between", " ", 
        "\[IndentingNewLine]", "the", " ", "thetas", " ", "and", " ", 
        "update", " ", "the", " ", "integrand", " ", "as", " ", "required"}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"thetas", ",", "tower", ",", "Dtower"}], "}"}], "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"inthetas", "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", "2"}], "]"}], "]"}], ",", 
         RowBox[{"intower", "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", "2"}], "]"}], "]"}], ",", 
         RowBox[{"inDtower", "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", "2"}], "]"}], "]"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "case", " ", "of", " ", "one", " ", "transcendental", " ", 
        "extension"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"SameQ", "[", 
         RowBox[{
          RowBox[{"Length", "[", "inthetas", "]"}], ",", "2"}], "]"}], ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"RischTrace", "[", 
          RowBox[{"StructureEliminate", ",", 
           RowBox[{"{", 
            RowBox[{
            "integrand", ",", "thetas", ",", "tower", ",", "Dtower", ",", 
             RowBox[{"{", "}"}]}], "}"}], ",", "\"\<Out\>\""}], "]"}], ";", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{"Throw", "[", 
          RowBox[{"{", 
           RowBox[{
           "integrand", ",", "thetas", ",", "tower", ",", "Dtower", ",", 
            RowBox[{"{", "}"}]}], "}"}], "]"}]}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"test", " ", "for", " ", "algebraic", " ", "dependicies"}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{
         RowBox[{"state", "=", "False"}], ";", "\[IndentingNewLine]", "\t", 
         RowBox[{"test", "=", 
          RowBox[{"testtower", "[", 
           RowBox[{"[", "n", "]"}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
         RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"SameQ", "[", 
            RowBox[{
             RowBox[{"Head", "[", "test", "]"}], ",", "rischLog"}], "]"}], 
           ",", "\[IndentingNewLine]", "\t\t", 
           RowBox[{
            RowBox[{"result", "=", 
             RowBox[{"LogStructure", "[", 
              RowBox[{
              "test", ",", "thetas", ",", "tower", ",", "Dtower", ",", "nums",
                ",", "reps"}], "]"}]}], ";", "\[IndentingNewLine]", "\t\t", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"SameQ", "[", 
                RowBox[{"result", ",", "$Failed"}], "]"}]}], ",", 
              "\[IndentingNewLine]", "\t\t\t", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                 "state", ",", "new", ",", "thetas", ",", "tower", ",", 
                  "Dtower", ",", "nums"}], "}"}], "=", "result"}], ";", 
               "\[IndentingNewLine]", "\t\t\t", 
               RowBox[{"testtower", "=", 
                RowBox[{"testtower", "//.", 
                 RowBox[{"test", ":>", "new"}]}]}]}], ",", 
              "\[IndentingNewLine]", "\t\t\t", 
              RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
            "\[IndentingNewLine]", "\t\t", 
            RowBox[{"If", "[", 
             RowBox[{"state", ",", "\[IndentingNewLine]", "\t\t\t", 
              RowBox[{"integrand", "=", 
               RowBox[{"integrand", "//.", 
                RowBox[{"test", ":>", "new"}]}]}]}], "\[IndentingNewLine]", 
             "\t\t", "]"}]}], ",", "\[IndentingNewLine]", "\t", 
           RowBox[{"SameQ", "[", 
            RowBox[{
             RowBox[{"Head", "[", "test", "]"}], ",", "rischExp"}], "]"}], 
           ",", "\[IndentingNewLine]", "\t\t", 
           RowBox[{
            RowBox[{"result", "=", 
             RowBox[{"ExpStructure", "[", 
              RowBox[{
              "test", ",", "thetas", ",", "tower", ",", "Dtower", ",", "nums",
                ",", "reps"}], "]"}]}], ";", "\[IndentingNewLine]", "\t\t", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"SameQ", "[", 
                RowBox[{"result", ",", "$Failed"}], "]"}]}], ",", 
              "\[IndentingNewLine]", "\t\t\t", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                 "state", ",", "new", ",", "thetas", ",", "tower", ",", 
                  "Dtower", ",", "nums"}], "}"}], "=", "result"}], ";", 
               "\[IndentingNewLine]", "\t\t\t", 
               RowBox[{"testtower", "=", 
                RowBox[{"testtower", "//.", 
                 RowBox[{"test", ":>", "new"}]}]}]}], ",", 
              "\[IndentingNewLine]", "\t\t\t", 
              RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
            "\[IndentingNewLine]", "\t\t", 
            RowBox[{"If", "[", 
             RowBox[{"state", ",", "\[IndentingNewLine]", "\t\t\t", 
              RowBox[{"integrand", "=", 
               RowBox[{"integrand", "//.", 
                RowBox[{"test", ":>", "new"}]}]}]}], "\[IndentingNewLine]", 
             "\t\t", "]"}]}], ",", "\[IndentingNewLine]", "\t", "True", ",", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{
            RowBox[{"RischTrace", "[", 
             RowBox[{
             "StructureEliminate", ",", "$Failed", ",", "\"\<Out\>\""}], 
             "]"}], ";", "\[IndentingNewLine]", "\t\t", 
            RowBox[{"Throw", "[", "$Failed", "]"}]}]}], "\[IndentingNewLine]",
           "\t", "]"}]}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", "3", ",", 
          RowBox[{"Length", "[", "intower", "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"integrand", "=", 
       RowBox[{"integrand", "//.", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", "#", "]"}], "\[RuleDelayed]", 
            RowBox[{"Last", "[", "#", "]"}]}], "&"}], ",", 
          RowBox[{"Thread", "[", 
           RowBox[{"{", 
            RowBox[{"tower", ",", "thetas"}], "}"}], "]"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"res", "=", 
       RowBox[{"{", 
        RowBox[{"integrand", ",", "thetas", ",", "tower", ",", "Dtower", ",", 
         RowBox[{"{", "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"RischTrace", "[", 
       RowBox[{"StructureEliminate", ",", "res", ",", "\"\<Out\>\""}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"Throw", "[", "res", "]"}]}]}], "\[IndentingNewLine]", "]"}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.405145919474934*^9, 3.40514592888614*^9}, {
   3.405145974307507*^9, 3.4051460793627043`*^9}, {3.405146787334745*^9, 
   3.4051467950842867`*^9}, {3.405477277928731*^9, 3.405477407175473*^9}, {
   3.405477489228129*^9, 3.405477522849049*^9}, {3.40547759492232*^9, 
   3.4054781591231327`*^9}, {3.40547822187604*^9, 3.405478259119256*^9}, {
   3.405478354927106*^9, 3.405478420556777*^9}, {3.405478520781868*^9, 
   3.405478534703861*^9}, {3.405478746877831*^9, 3.405478824117537*^9}, {
   3.405478869091824*^9, 3.405478889990313*^9}, {3.405480579001047*^9, 
   3.4054806193633623`*^9}, {3.405750243698296*^9, 3.405750244790021*^9}, {
   3.406195358611906*^9, 3.406195363168417*^9}, {3.40619541106201*^9, 
   3.4061954434369993`*^9}, {3.40619547921493*^9, 3.406195499946368*^9}, {
   3.406195592934608*^9, 3.406195692076776*^9}, {3.4062309465130043`*^9, 
   3.4062309467582083`*^9}, {3.406230992297945*^9, 3.406230998087912*^9}, {
   3.4062313180410347`*^9, 3.406231369217093*^9}, {3.406231472860629*^9, 
   3.406231473147406*^9}, {3.406231531200327*^9, 3.406231569431157*^9}, {
   3.406231636180976*^9, 3.406231636364436*^9}, 3.406266619254732*^9, {
   3.4062690910769653`*^9, 3.406269093392984*^9}, {3.406269272240786*^9, 
   3.4062692824479923`*^9}, {3.4065340627438707`*^9, 3.406534063487851*^9}, {
   3.4069642180428667`*^9, 3.406964233779488*^9}, {3.406965699715674*^9, 
   3.4069657533268347`*^9}, {3.4069658250384417`*^9, 3.406965883365336*^9}, {
   3.4069660032973537`*^9, 3.40696601400424*^9}, {3.4073985254371223`*^9, 
   3.4073985411573153`*^9}, {3.407398594171509*^9, 3.407398613067696*^9}, {
   3.407398722894662*^9, 3.407398809046856*^9}, {3.4073989011041327`*^9, 
   3.407398922278287*^9}, {3.407398975540279*^9, 3.4073990043892393`*^9}, {
   3.407962911816045*^9, 3.407962923383357*^9}, {3.408854274937042*^9, 
   3.4088542769802217`*^9}, {3.408854360335937*^9, 3.4088543689138603`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"rischDebug", "=", "True"}], ";"}]], "Input",
 CellChangeTimes->{{3.406266780796192*^9, 3.406266784064405*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RischStructure", "[", 
  RowBox[{
   FractionBox[
    RowBox[{"Log", "[", "x", "]"}], 
    RowBox[{
     RowBox[{"Log", "[", 
      RowBox[{
       SuperscriptBox["x", "2"], "-", "1"}], "]"}], "-", 
     RowBox[{"Log", "[", 
      RowBox[{"x", "-", "1"}], "]"}], "-", 
     RowBox[{"Log", "[", 
      RowBox[{"x", "+", "1"}], "]"}], "+", "1"}]], ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.40554734004298*^9, 3.405547349975739*^9}, 
   3.405547388655121*^9, {3.406195757057773*^9, 3.4061957612571077`*^9}, {
   3.4062696471598063`*^9, 3.4062696572046843`*^9}, {3.406276092272769*^9, 
   3.4062760938043737`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   SubscriptBox["\<\"\[Theta]\"\>", "1"], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     SubscriptBox["\<\"\[Theta]\"\>", "1"], ",", 
     SubscriptBox["\<\"\[Theta]\"\>", "2"], ",", 
     SubscriptBox["\<\"\[Theta]\"\>", "3"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"rischLog", "[", "x", "]"}], ",", 
     RowBox[{"rischLog", "[", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "x"}], "]"}], ",", 
     RowBox[{"rischLog", "[", 
      RowBox[{"1", "+", "x"}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     FractionBox["1", "x"], ",", 
     FractionBox["1", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "x"}]], ",", 
     FractionBox["1", 
      RowBox[{"1", "+", "x"}]]}], "}"}], ",", 
   RowBox[{"{", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.40626660624069*^9, 3.40626662454954*^9}, 
   3.406266787185782*^9, 3.4062673938358917`*^9, 3.406268825526704*^9, 
   3.406269102466115*^9, 3.4062692417728786`*^9, 3.406269287101433*^9, 
   3.406269625210374*^9, 3.406269661815082*^9, 3.407399013401559*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RischStructure", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Log", "[", "x", "]"}], 
    RowBox[{"Log", "[", 
     RowBox[{"x", "-", "1"}], "]"}], 
    RowBox[{"Log", "[", 
     RowBox[{
      SuperscriptBox["x", "2"], "-", "x"}], "]"}]}], ",", "x"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.3942461272790003`*^9, 3.3942461395133753`*^9}, {
   3.3942487093102503`*^9, 3.3942487174665003`*^9}, {3.3942489783727503`*^9, 
   3.3942489867946253`*^9}, {3.3942503568727503`*^9, 
   3.3942503574352503`*^9}, {3.3942504686071253`*^9, 3.3942504698415003`*^9}, 
   3.3942505934352503`*^9, 3.4047229264987*^9, {3.4054789753418703`*^9, 
   3.405478976917248*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SubscriptBox["\<\"\[Theta]\"\>", "1"], " ", 
    SubscriptBox["\<\"\[Theta]\"\>", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["\<\"\[Theta]\"\>", "1"], "+", 
      SubscriptBox["\<\"\[Theta]\"\>", "2"]}], ")"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     SubscriptBox["\<\"\[Theta]\"\>", "1"], ",", 
     SubscriptBox["\<\"\[Theta]\"\>", "3"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"rischLog", "[", "x", "]"}], ",", 
     RowBox[{"rischLog", "[", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "x"}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     FractionBox["1", "x"], ",", 
     FractionBox["1", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "x"}]]}], "}"}], ",", 
   RowBox[{"{", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.406231337343144*^9, 3.4062313722670097`*^9, 3.4062314455602083`*^9, {
   3.406231539569487*^9, 3.406231571337922*^9}, 3.406231639587673*^9, 
   3.406231704462504*^9, 3.406268847103669*^9, 3.4062696866830463`*^9, 
   3.4062760391978073`*^9, 3.406276099067683*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"RischStructure", "[", 
   RowBox[{
    FractionBox[
     RowBox[{"Log", "[", 
      RowBox[{
       SuperscriptBox["x", "2"], "+", "x"}], "]"}], 
     RowBox[{
      RowBox[{"Log", "[", "x", "]"}], "+", 
      RowBox[{"Log", "[", 
       RowBox[{"x", "+", "1"}], "]"}]}]], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "integrates", " ", "to", " ", "x", " ", "in", " ", "Mathematica", " ", 
     "if", " ", "assume", " ", "x"}], ">", "0"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.3942503597165003`*^9, 3.3942503829040003`*^9}, {
  3.3942504437165003`*^9, 3.3942504447008753`*^9}, {3.3942505971540003`*^9, 
  3.3942506114508753`*^9}, {3.4054786412381487`*^9, 3.405478657221985*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     SubscriptBox["\<\"\[Theta]\"\>", "1"], ",", 
     SubscriptBox["\<\"\[Theta]\"\>", "3"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"rischLog", "[", "x", "]"}], ",", 
     RowBox[{"rischLog", "[", 
      RowBox[{"1", "+", "x"}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     FractionBox["1", "x"], ",", 
     FractionBox["1", 
      RowBox[{"1", "+", "x"}]]}], "}"}], ",", 
   RowBox[{"{", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.406231150172585*^9, 3.406231324103055*^9, 
  3.406231451806484*^9, 3.406268894070147*^9, 3.406269697025395*^9, 
  3.4062760824761143`*^9, 3.406534322699581*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RischStructure", "[", 
  RowBox[{
   FractionBox[
    RowBox[{"Log", "[", "x", "]"}], "x"], ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.3942487711071253`*^9, 3.3942488006071253`*^9}, 
   3.3942503924196253`*^9, {3.3942504745758753`*^9, 3.3942504755133753`*^9}, 
   3.3942506391696253`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    SubscriptBox["\<\"\[Theta]\"\>", "1"], "x"], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"rischLog", "[", "x", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     FractionBox["1", "x"]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.406269746147653*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Structure Canonical Representation", "Subsection",
 CellChangeTimes->{{3.394310103138875*^9, 3.394310107701375*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"StructureCanonicalRepresentation", "[", "prelim_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"tower", "=", "prelim"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Check", " ", "that", " ", "theta_i", " ", "does", " ", "not", " ", 
      "occur", " ", "in", " ", "any", " ", "theta_j", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "<", "j", "<", "i"}], ")"}], ".", "If"}], " ", "so", " ",
       "then", " ", "we", " ", "must", " ", "swap", " ", "theta_i", " ", 
      "with", " ", "theta_j"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Do", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"Do", "[", "\[IndentingNewLine]", "\t\t", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{
              RowBox[{"tower", "[", 
               RowBox[{"[", "j", "]"}], "]"}], ",", 
              RowBox[{"tower", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "Infinity"}], "}"}]}], "]"}], "=!=", 
            RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", "\t\t\t", 
           RowBox[{"tower", "=", 
            RowBox[{"Swap", "[", 
             RowBox[{"tower", ",", "i", ",", "j"}], "]"}]}]}], 
          "\[IndentingNewLine]", "\t\t", "]"}], "\[IndentingNewLine]", "\t", 
         ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "i"}], "}"}]}], "\[IndentingNewLine]", 
        "\t", "]"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "tower", "]"}]}], "}"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "tower"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.3942313502477503`*^9, 3.3942314466696253`*^9}, 
   3.3942315822790003`*^9, {3.3942322518571253`*^9, 3.3942323461540003`*^9}, {
   3.3942323889821253`*^9, 3.3942324129508753`*^9}, {3.3942324503102503`*^9, 
   3.3942324539508753`*^9}, {3.3942326524977503`*^9, 
   3.3942326528258753`*^9}, {3.3942376441071253`*^9, 
   3.3942376521383753`*^9}, {3.404981295240452*^9, 3.4049812955921392`*^9}, {
   3.404981352295795*^9, 3.40498137129959*^9}, {3.404981422971711*^9, 
   3.404981470738431*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"StructureCanonicalRepresentation", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"rischExp", "[", 
     RowBox[{"x", " ", 
      RowBox[{"rischLog", "[", "x", "]"}]}], "]"}], ",", 
    RowBox[{"rischLog", "[", "x", "]"}]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.3942376296383753`*^9, 3.3942376320133753`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"rischLog", "[", "x", "]"}], ",", 
   RowBox[{"rischExp", "[", 
    RowBox[{"x", " ", 
     RowBox[{"rischLog", "[", "x", "]"}]}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.40498137338721*^9, {3.404981484237927*^9, 3.404981498954755*^9}, 
   3.4049852773559713`*^9, 3.405409787991342*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"StructureCanonicalRepresentation", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"rischLog", "[", "x", "]"}], 
     RowBox[{"rischLog", "[", 
      RowBox[{"x", "-", "1"}], "]"}]}], ",", 
    RowBox[{"rischLog", "[", 
     RowBox[{"x", "-", "1"}], "]"}], ",", 
    RowBox[{"rischLog", "[", "x", "]"}], ",", 
    RowBox[{"rischLog", "[", 
     RowBox[{"rischExp", "[", 
      RowBox[{"x", "-", "1"}], "]"}], "]"}], ",", 
    RowBox[{"rischExp", "[", 
     RowBox[{"x", "-", "1"}], "]"}]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.3942326073571253`*^9, 3.3942326702633753`*^9}, {
  3.3942327172008753`*^9, 3.3942327409196253`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"rischLog", "[", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "x"}], "]"}], ",", 
   RowBox[{"rischLog", "[", "x", "]"}], ",", 
   RowBox[{
    RowBox[{"rischLog", "[", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "x"}], "]"}], " ", 
    RowBox[{"rischLog", "[", "x", "]"}]}], ",", 
   RowBox[{"rischExp", "[", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "x"}], "]"}], ",", 
   RowBox[{"rischLog", "[", 
    RowBox[{"rischExp", "[", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "x"}], "]"}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.404981376156032*^9, {3.404981484814685*^9, 3.404981499205819*^9}, 
   3.4049852778089733`*^9, 3.405409788389735*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Constant System", "Subsection",
 CellChangeTimes->{{3.394307269482625*^9, 3.39430727343575*^9}, 
   3.3944268548893747`*^9, 3.395134944363318*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"MatrixOfConstants", "[", 
   RowBox[{"M_", ",", "var_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", "#", "]"}], "\[Equal]", "1"}], "&&", 
      RowBox[{"First", "[", "#", "]"}]}], ")"}], "&"}], "[", " ", 
   RowBox[{"Union", "[", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"FreeQ", "[", 
        RowBox[{
         RowBox[{"Cancel", "[", "#", "]"}], ",", "var"}], "]"}], "&"}], ",", 
      RowBox[{"Flatten", "[", "M", "]"}]}], "]"}], "]"}], " ", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.395133590628665*^9, 3.395133625972921*^9}, {
   3.3951336817835712`*^9, 3.395133764398*^9}, 3.395134944363987*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"MinColNonConstIndex", "[", 
   RowBox[{"A_", ",", "var_"}], "]"}], ":=", 
  RowBox[{"Catch", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MatrixOfConstants", "[", 
         RowBox[{"#", ",", "var"}], "]"}]}], ",", 
       RowBox[{"Throw", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"Transpose", "[", "A", "]"}], ",", "#"}], "]"}], "//", 
          "Flatten"}], "//", "First"}], "]"}]}], "]"}], "&"}], "/@", 
    RowBox[{"Transpose", "[", "A", "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.3951346200168257`*^9, 3.3951346362841463`*^9}, {
   3.395134770638467*^9, 3.39513478312173*^9}, {3.395134830303047*^9, 
   3.3951348925095663`*^9}, 3.3951349443670683`*^9, {3.3951383303006277`*^9, 
   3.3951383420347023`*^9}, {3.395138419355582*^9, 3.395138419602995*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RowNonConstIndex", "[", 
   RowBox[{"A_", ",", "var_"}], "]"}], ":=", 
  RowBox[{"Catch", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"FreeQ", "[", 
         RowBox[{"#", ",", "var"}], "]"}]}], ",", 
       RowBox[{"Throw", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"A", ",", "#"}], "]"}], "//", "Flatten"}], "//", "First"}],
         "]"}]}], "]"}], "&"}], "/@", "A"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.395135308200049*^9, 3.3951353094136066`*^9}, {
  3.395135834782202*^9, 3.395135861646286*^9}, {3.395135925905178*^9, 
  3.3951359267258587`*^9}, {3.395136138934813*^9, 3.395136142142062*^9}, {
  3.3951364066091013`*^9, 3.39513641366992*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ConstantSystem", "[", 
   RowBox[{"M_", ",", "U_", ",", "theta_", ",", "tower_", ",", "Dtower_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "k", ",", "A", ",", "u", ",", "m", ",", "j", ",", "i", ",", "R", ",", 
      "Rm"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"RischTrace", "[", 
      RowBox[{"ConstantSystem", ",", 
       RowBox[{"{", 
        RowBox[{"M", ",", "U", ",", "theta", ",", "tower", ",", "Dtower"}], 
        "}"}], ",", "\"\<In\>\""}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Constant", " ", 
        RowBox[{"System", ".", " ", 
         RowBox[{"Reference", ":", " ", 
          RowBox[{"Symbolic", " ", "Integration", " ", "1"}]}]}]}], ",", " ", 
       "Bronstein", ",", " ", 
       RowBox[{"p", ".", " ", "225"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"Given", " ", "a", " ", "differential", " ", "field", " ", 
        RowBox[{"(", 
         RowBox[{"K", ",", "D"}], ")"}], " ", "with", " ", "constant", " ", 
        "field", " ", "C"}], ",", " ", 
       RowBox[{
       "a", " ", "matrix", " ", "A", " ", "and", " ", "vector", " ", "u", " ",
         "with", " ", "coefficients", " ", "in", " ", "K"}], ",", " ", 
       RowBox[{
       "returna", " ", "a", " ", "matrix", " ", "B", " ", "with", " ", 
        "coefficients", " ", "in", " ", "C", " ", "and", " ", "a", " ", 
        "vector", " ", "V", " ", "such", " ", "that", " ", "either", " ", "v",
         " ", "has", " ", "coefficients", " ", "in", " ", "C"}], ",", " ", 
       RowBox[{
        RowBox[{
        "in", " ", "which", " ", "case", " ", "the", " ", "solutions", " ", 
         "in", " ", "C", " ", "of", " ", "Ax"}], "=", 
        RowBox[{
         RowBox[{
         "u", " ", "are", " ", "exactly", " ", "all", " ", "the", " ", 
          "solutions", " ", "of", " ", "Bx"}], "=", "v"}]}], ",", " ", 
       RowBox[{
       "or", " ", "v", " ", "has", " ", "a", " ", "non", " ", "constant", " ",
         "coefficient"}], ",", " ", 
       RowBox[{
        RowBox[{"in", " ", "which", " ", "case", " ", "Ax"}], "=", 
        RowBox[{"u", " ", "has", " ", "no", " ", "constant", " ", 
         RowBox[{"solution", "."}]}]}]}], "\[IndentingNewLine]", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"A", "=", 
      RowBox[{"RowReduce", "[", 
       RowBox[{"Transpose", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Transpose", "[", "M", "]"}], ",", " ", 
          RowBox[{"{", "U", "}"}]}], "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"u", "=", 
      RowBox[{"Last", "[", 
       RowBox[{"Transpose", "[", "A", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"m", "=", 
      RowBox[{"Length", "[", "A", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"A", "=", 
      RowBox[{"Transpose", "[", 
       RowBox[{"Most", "[", 
        RowBox[{"Transpose", "[", "A", "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"k", "=", "1"}], ";", 
     RowBox[{"(*", " ", 
      RowBox[{
      "this", " ", "is", " ", "just", " ", "a", " ", "recursion", " ", 
       "limit"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"!", 
         RowBox[{"MatrixOfConstants", "[", 
          RowBox[{"A", ",", 
           RowBox[{"First", "[", "theta", "]"}]}], "]"}]}], "&&", 
        RowBox[{"k", "<", "30"}]}], ",", 
       RowBox[{
        RowBox[{"k", "++"}], ";", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"j", " ", "--"}], ">", " ", 
          RowBox[{
          "minimal", " ", "index", " ", "of", " ", "A", " ", "such", " ", 
           "that", " ", "the", " ", "jth", " ", "column", " ", "of", " ", "A",
            " ", "is", " ", "not", " ", "constant"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"j", "=", 
         RowBox[{"MinColNonConstIndex", "[", 
          RowBox[{"A", ",", 
           RowBox[{"First", "[", "theta", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"i", " ", "--"}], ">", " ", 
          RowBox[{"any", " ", "index", " ", "such", " ", "that", " ", "a_", 
           RowBox[{"{", 
            RowBox[{"i", ",", "j"}], "}"}], " ", "notin", " ", "constant", 
           " ", "field", " ", "of", " ", "M"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"i", "=", 
         RowBox[{"RowNonConstIndex", "[", 
          RowBox[{"A", ",", 
           RowBox[{"First", "[", "theta", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"R", " ", "--"}], ">", " ", 
          RowBox[{"ith", " ", "row", " ", "of", " ", "A"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"A", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"TotalDerivation", "[", 
                RowBox[{"#", ",", "theta", ",", "tower"}], "]"}], "&"}], ",", 
              RowBox[{"A", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], " ", "]"}], ")"}], "/", 
           RowBox[{"TotalDerivation", "[", 
            RowBox[{
             RowBox[{"A", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", "theta", ",", 
             "tower"}], "]"}]}]}], " ", "]"}], ";", "\[IndentingNewLine]", 
        "\t\t", 
        RowBox[{"AppendTo", "[", " ", 
         RowBox[{"u", ",", 
          RowBox[{"TotalDerivation", "[", 
           RowBox[{
            RowBox[{"Part", "[", 
             RowBox[{"u", ",", "i"}], "]"}], ",", "theta", ",", "tower"}], 
           "]"}]}], " ", "]"}], ";", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", "\t\t\t", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"A", "[", 
             RowBox[{"[", "s", "]"}], "]"}], "=", 
            RowBox[{
             RowBox[{"A", "[", 
              RowBox[{"[", "s", "]"}], "]"}], "-", 
             RowBox[{
              RowBox[{"A", "[", 
               RowBox[{"[", 
                RowBox[{"s", ",", "j"}], "]"}], "]"}], "*", 
              RowBox[{"Last", "[", "A", "]"}]}]}]}], ";", 
           "\[IndentingNewLine]", "\t\t\t", 
           RowBox[{
            RowBox[{"u", "[", 
             RowBox[{"[", "s", "]"}], "]"}], "=", 
            RowBox[{
             RowBox[{"u", "[", 
              RowBox[{"[", "s", "]"}], "]"}], "-", 
             RowBox[{
              RowBox[{"A", "[", 
               RowBox[{"[", 
                RowBox[{"s", ",", "j"}], "]"}], "]"}], "*", 
              RowBox[{"Last", "[", "u", "]"}]}]}]}]}], "\[IndentingNewLine]", 
          "\t\t", ",", 
          RowBox[{"{", 
           RowBox[{"s", ",", "1", ",", "m"}], "}"}]}], "\[IndentingNewLine]", 
         "\t\t", "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"RischTrace", "[", 
      RowBox[{"ConstantSystem", ",", 
       RowBox[{"{", 
        RowBox[{"A", ",", "u"}], "}"}], ",", "\"\<Out\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"A", ",", "u"}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.3943072772795*^9, 3.39430749874825*^9}, {
   3.394307736795125*^9, 3.39430780724825*^9}, {3.3943078380295*^9, 
   3.394307855982625*^9}, 3.395133886550971*^9, {3.395133921231515*^9, 
   3.395133922948388*^9}, {3.395133953797999*^9, 3.39513395697499*^9}, {
   3.39513398724809*^9, 3.395134037899214*^9}, {3.395134103120473*^9, 
   3.39513410716527*^9}, {3.395134148590526*^9, 3.395134158948773*^9}, {
   3.395134248017397*^9, 3.3951342521975403`*^9}, {3.395134342093293*^9, 
   3.395134458974875*^9}, 3.395134944370308*^9, {3.395135193051984*^9, 
   3.395135207175582*^9}, {3.395135714144156*^9, 3.39513575598451*^9}, 
   3.395135893323711*^9, {3.3951365289656897`*^9, 3.395136560489421*^9}, {
   3.3951366062666883`*^9, 3.395136612713427*^9}, {3.395136657443839*^9, 
   3.395136776880858*^9}, {3.395136828857835*^9, 3.395136867793517*^9}, {
   3.395138354307342*^9, 3.3951383850328836`*^9}, {3.3951384259868402`*^9, 
   3.395138458809353*^9}, {3.395138525914199*^9, 3.3951385554822893`*^9}, {
   3.395138590221342*^9, 3.3951386497942247`*^9}, {3.395138787515461*^9, 
   3.395138788418314*^9}, {3.39513900976467*^9, 3.395139034474163*^9}, {
   3.3951391306313477`*^9, 3.395139204702175*^9}, {3.395139346393112*^9, 
   3.39513935773837*^9}, {3.395139432477927*^9, 3.395139444756773*^9}, {
   3.395139505327758*^9, 3.395139575529121*^9}, {3.395139610213264*^9, 
   3.3951396197326508`*^9}, {3.395139665766485*^9, 3.395139683758293*^9}, {
   3.395139726306608*^9, 3.3951397264898853`*^9}, {3.395139884358717*^9, 
   3.395139937761858*^9}, {3.395139974091247*^9, 3.395140013957242*^9}, {
   3.395140095399996*^9, 3.395140097887185*^9}, {3.39514014747675*^9, 
   3.3951401498884068`*^9}, {3.395140299596582*^9, 3.395140339896817*^9}, {
   3.395143201594453*^9, 3.39514322022542*^9}, {3.395304962537684*^9, 
   3.395305019137967*^9}, {3.395305853682337*^9, 3.3953058647847548`*^9}, {
   3.3953058986181927`*^9, 3.395305917694071*^9}, {3.395306145986125*^9, 
   3.395306152993388*^9}, 3.395306194585997*^9, {3.404981512739121*^9, 
   3.40498156254699*^9}, 3.4054631027993717`*^9, 3.407555263060919*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       FractionBox[
        RowBox[{
         RowBox[{"-", "x"}], "-", "3"}], 
        RowBox[{"x", "-", "1"}]], ",", 
       FractionBox[
        RowBox[{"x", "+", "1"}], 
        RowBox[{"x", "-", "1"}]], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "x"}], "-", "3"}], ",", 
       RowBox[{"x", "+", "1"}], ",", 
       RowBox[{"x", "-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       FractionBox[
        RowBox[{
         RowBox[{"2", "x"}], "+", "6"}], 
        RowBox[{"x", "-", "1"}]], ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.394307603576375*^9, 3.394307660842*^9}, {
   3.395133867823563*^9, 3.395133868606097*^9}, 3.3951346915422773`*^9, {
   3.39513472623139*^9, 3.395134726879825*^9}, {3.395134809300043*^9, 
   3.3951348099100103`*^9}, 3.395134944370844*^9, {3.3951393828303967`*^9, 
   3.395139383501849*^9}, {3.395139449350101*^9, 3.395139450102614*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"U", "=", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{"x", "+", "1"}], 
      RowBox[{"x", "-", "1"}]], ",", 
     RowBox[{"x", "+", "1"}], ",", "0"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.395133872817807*^9, 3.3951339011076813`*^9}, {
   3.39513467664491*^9, 3.395134689071369*^9}, 3.395134944377554*^9}],

Cell[BoxData[
 RowBox[{"ConstantSystem", "[", 
  RowBox[{"A", ",", "U", ",", 
   RowBox[{"{", "x", "}"}], ",", 
   RowBox[{"{", "x", "}"}], ",", 
   RowBox[{"{", "1", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.3951339038886137`*^9, 3.3951339167718887`*^9}, {
   3.395133991592621*^9, 3.395133992705989*^9}, 3.395134944380477*^9}],

Cell[BoxData[
 RowBox[{"ConstantSystem", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "4"}], "+", 
      RowBox[{"5", " ", 
       SubscriptBox["\"\<\[Theta]\>\"", "1"]}]}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", " ", 
     SubscriptBox["\"\<\[Theta]\>\"", "1"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     SubscriptBox["\"\<\[Theta]\>\"", "1"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"rischExp", "[", "x", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     SubscriptBox["\"\<\[Theta]\>\"", "1"]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.395305634324521*^9, 3.395305641507869*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Primitive Case", "Subsection",
 CellChangeTimes->{{3.3942295724196253`*^9, 3.3942295749508753`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"LogStructure", "[", 
   RowBox[{
   "test_", ",", "inthetas_", ",", "intower_", ",", "inDtower_", ",", 
    "innums_", ",", "reps_"}], "]"}], ":=", 
  RowBox[{"Catch", "[", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"thetas", "=", "inthetas"}], ",", 
       RowBox[{"tower", "=", "intower"}], ",", 
       RowBox[{"Dtower", "=", "inDtower"}], ",", 
       RowBox[{"nums", "=", "innums"}], ",", "\[IndentingNewLine]", "arg", 
       ",", "eqnrhs", ",", "exps", ",", "logs", ",", "n", ",", "eqnlhs", ",", 
       "smallreps", ",", "sol", ",", "rhs", ",", "c", ",", "Dnewtheta", ",", 
       "newtheta", ",", "newtower", ",", "res"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"RischTrace", "[", 
       RowBox[{"LogStructure", ",", 
        RowBox[{"{", 
         RowBox[{
         "test", ",", "thetas", ",", "tower", ",", "Dtower", ",", "nums"}], 
         "}"}], ",", "\"\<In\>\""}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Implementation", " ", "of", " ", "equation", " ", "9.8", " ", "from", 
        " ", 
        RowBox[{"Bronstein", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
         "With", " ", "a", " ", "in", " ", "Kstar", " ", "and", " ", "t"}], 
         " ", "=", " ", 
         RowBox[{"log", 
          RowBox[{"(", "a", ")"}]}]}], ",", " ", 
        RowBox[{
         RowBox[{"i", ".", "e", ".", " ", "Dt"}], " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Da", "/", 
            RowBox[{"a", ".", " ", "If"}]}], " ", 
           RowBox[{"(", "9.8", ")"}], " ", "has", " ", "a", " ", "solution", 
           " ", "r_i", " ", "in", " ", "Q", "\[IndentingNewLine]", "then", 
           " ", "it", " ", "provides", " ", "v", " ", "in", " ", "K", " ", 
           "such", " ", "that", " ", "Dv"}], " ", "=", " ", 
          RowBox[{"Da", "/", "a"}]}]}], ",", " ", 
        RowBox[{
         RowBox[{"hence", " ", "c"}], " ", "=", " ", 
         RowBox[{
          RowBox[{"t", " ", "-", " ", 
           RowBox[{"v", " ", "in", " ", "Cons_D", 
            RowBox[{"(", 
             RowBox[{"K", 
              RowBox[{"(", "t", ")"}]}], ")"}], " ", "and", " ", 
            "\[IndentingNewLine]", "K", 
            RowBox[{"(", "t", ")"}]}]}], " ", "=", " ", 
          RowBox[{"C", 
           RowBox[{"(", "c", ")"}], 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"t_", "1"}], ",", "...", ",", "t_n"}], ")"}], ".", " ", 
            "Otherwise"}]}]}]}], ",", " ", 
        RowBox[{
         RowBox[{"Da", "/", "a"}], " ", "is", " ", "the", " ", "the", " ", 
         "derivative", " ", "of", " ", "an", " ", "element", " ", "of", " ", 
         "K"}], ",", "\[IndentingNewLine]", "\t", 
        RowBox[{
        "so", " ", "t", " ", "is", " ", "a", " ", "monomial", " ", "over", 
         " ", "K", " ", "having", " ", "the", " ", "same", " ", "constant", 
         " ", 
         RowBox[{"field", "."}]}]}], "\[IndentingNewLine]", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"arg", "=", 
       RowBox[{"test", "/.", 
        RowBox[{
         RowBox[{"rischLog", "[", "a_", "]"}], ":>", "a"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"smallreps", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"First", "[", "#", "]"}], "\[Rule]", 
           RowBox[{"Last", "[", "#", "]"}]}], "&"}], ",", 
         RowBox[{"Thread", "[", 
          RowBox[{"{", 
           RowBox[{"tower", ",", "thetas"}], "}"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"rhs", " ", "of", " ", "equation", " ", "9.8"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"eqnrhs", "=", 
       RowBox[{
        RowBox[{"Cancel", "[", 
         RowBox[{
          RowBox[{"TotalDerivation", "[", 
           RowBox[{"arg", ",", "thetas", ",", "Dtower"}], "]"}], "/", "arg"}],
          "]"}], "//.", "reps"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "determine", " ", "equations", " ", "9.6", " ", "and", " ", "9.7"}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"exps", ",", "logs"}], "}"}], "=", 
       RowBox[{"findlogexp", "[", "tower", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"lhs", " ", "of", " ", "equation", " ", "9.8"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"n", ",", "eqnlhs"}], "}"}], "=", 
       RowBox[{"buildlhs", "[", 
        RowBox[{"exps", ",", "logs", ",", "thetas", ",", "Dtower"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"eqnlhs", "=", 
       RowBox[{"eqnlhs", "//.", "reps"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"solve", " ", "lhs"}], " ", "=", " ", 
        RowBox[{"rhs", " ", "for", " ", "the", " ", "unknown", " ", 
         RowBox[{
          RowBox[{"Risch`r", "[", "_", "]"}], "'"}], "s"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"sol", "=", 
       RowBox[{"structuresolve", "[", 
        RowBox[{"eqnlhs", ",", "eqnrhs", ",", "thetas", ",", "n"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"are", " ", "solution", 
        RowBox[{"(", "s", ")"}], " ", 
        RowBox[{"rational", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"SameQ", "[", 
         RowBox[{"sol", ",", "$Failed"}], "]"}], ",", "\[IndentingNewLine]", 
        "\t", 
        RowBox[{
         RowBox[{"Dtower", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"Dtower", ",", 
            RowBox[{"{", 
             RowBox[{"Cancel", "[", 
              RowBox[{
               RowBox[{"TotalDerivation", "[", 
                RowBox[{"test", ",", "thetas", ",", "Dtower"}], "]"}], "//.", 
               "reps"}], "]"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         "\t", 
         RowBox[{"thetas", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"thetas", ",", 
            RowBox[{"{", 
             RowBox[{"theta", "[", 
              RowBox[{"Length", "[", "thetas", "]"}], "]"}], "}"}]}], "]"}]}],
          ";", "\[IndentingNewLine]", "\t", 
         RowBox[{"tower", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"tower", ",", 
            RowBox[{"{", 
             RowBox[{"test", "//.", "smallreps"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{"res", "=", 
          RowBox[{"{", 
           RowBox[{
           "False", ",", "test", ",", "thetas", ",", "tower", ",", "Dtower", 
            ",", "nums"}], "}"}]}], ";", "\[IndentingNewLine]", "\t", 
         RowBox[{"RischTrace", "[", 
          RowBox[{"LogStructure", ",", "res", ",", "\"\<Out\>\""}], "]"}], 
         ";", "\[IndentingNewLine]", "\t", 
         RowBox[{"Throw", "[", 
          RowBox[{"{", 
           RowBox[{
           "False", ",", "test", ",", "thetas", ",", "tower", ",", "Dtower", 
            ",", "nums"}], "}"}], "]"}]}]}], "\[IndentingNewLine]", "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"solutions", " ", "are", " ", "rational"}], " ", "=", 
        RowBox[{">", " ", 
         RowBox[{"algebraically", " ", "dependent"}]}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"rhs", "=", 
       RowBox[{"buildnewlogtheta", "[", 
        RowBox[{"sol", ",", "tower", ",", "thetas"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"determine", " ", "constant", " ", "of", " ", "integration"}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"structureconstantlog", "[", 
        RowBox[{"test", ",", "rhs", ",", "thetas", ",", "tower"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"determine", " ", "new", " ", "theta"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"newtheta", "=", 
       RowBox[{"c", "+", "rhs"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"newtower", "=", 
       RowBox[{"tower", "//.", 
        RowBox[{"test", "\[Rule]", "newtheta"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"res", "=", 
       RowBox[{"{", 
        RowBox[{
        "True", ",", "newtheta", ",", "thetas", ",", "newtower", ",", 
         "Dtower", ",", "nums"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"RischTrace", "[", 
       RowBox[{"LogStructure", ",", "res", ",", "\"\<Out\>\""}], "]"}], ";", 
      "\[IndentingNewLine]", "res"}]}], "\[IndentingNewLine]", "]"}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.40547923591925*^9, 3.405479283483471*^9}, {
   3.405479339290969*^9, 3.40547946002092*^9}, {3.4054795097380543`*^9, 
   3.405479692833325*^9}, {3.405479741489648*^9, 3.405479768570588*^9}, {
   3.405479816578668*^9, 3.4054799553941393`*^9}, {3.405480114239089*^9, 
   3.40548023201156*^9}, {3.405480316014141*^9, 3.405480332355262*^9}, {
   3.4054803746519527`*^9, 3.405480395787533*^9}, {3.405480647812793*^9, 
   3.405480667029051*^9}, {3.405480748334138*^9, 3.4054807715699043`*^9}, {
   3.4054808584270487`*^9, 3.405480940654401*^9}, {3.405481007005015*^9, 
   3.4054811867430696`*^9}, 3.405481219474646*^9, {3.405481252822447*^9, 
   3.4054812538440323`*^9}, {3.405544515025489*^9, 3.4055445204142513`*^9}, {
   3.405546914132732*^9, 3.4055469153076982`*^9}, {3.405547848680333*^9, 
   3.405547853063468*^9}, {3.405668996631184*^9, 3.405668997392297*^9}, {
   3.405669372277918*^9, 3.4056693943982286`*^9}, {3.4056707675580063`*^9, 
   3.4056707721558228`*^9}, {3.405671742577814*^9, 3.405671745778152*^9}, {
   3.405671818244844*^9, 3.4056718213566027`*^9}, {3.405747322900454*^9, 
   3.40574732393666*^9}, {3.405747458875491*^9, 3.405747477560811*^9}, {
   3.405748411203886*^9, 3.405748414870569*^9}, {3.405750255920969*^9, 
   3.405750266045114*^9}, {3.406189253325156*^9, 3.406189302883637*^9}, {
   3.406189343738261*^9, 3.406189345551876*^9}, {3.406189393975998*^9, 
   3.406189397305098*^9}, {3.406189531629244*^9, 3.406189564266306*^9}, {
   3.4061896303252974`*^9, 3.406189632419622*^9}, {3.406189672338348*^9, 
   3.406189698819628*^9}, {3.406189755607934*^9, 3.406189756107736*^9}, {
   3.4061898205251093`*^9, 3.406189899314443*^9}, {3.406189936485094*^9, 
   3.4061899446315527`*^9}, {3.40619021412889*^9, 3.4061902166641283`*^9}, {
   3.406190385949978*^9, 3.406190450210745*^9}, {3.406191265573279*^9, 
   3.40619126865985*^9}, {3.406192234254924*^9, 3.40619223457526*^9}, {
   3.406192732309219*^9, 3.406192732667881*^9}, {3.406193021174345*^9, 
   3.406193022489167*^9}, {3.4061931944938383`*^9, 3.406193197468292*^9}, {
   3.406193350315441*^9, 3.4061933507600727`*^9}, {3.406194915045673*^9, 
   3.406194937305484*^9}, {3.406194980323021*^9, 3.40619500249655*^9}, {
   3.4061952668166847`*^9, 3.406195267199585*^9}, {3.406230831951531*^9, 
   3.406230833004242*^9}, {3.406231430224626*^9, 3.406231435599885*^9}, {
   3.4062316182181797`*^9, 3.4062316189671373`*^9}, {3.4062317854347343`*^9, 
   3.4062317857689323`*^9}, {3.4062675484352617`*^9, 
   3.4062675512492523`*^9}, {3.4062682754085817`*^9, 
   3.4062683585903997`*^9}, {3.4062683991260433`*^9, 3.4062683995808363`*^9}, 
   3.406268456321414*^9, {3.4062685110542603`*^9, 3.406268515717566*^9}, {
   3.4062695509495068`*^9, 3.406269575028388*^9}, {3.406271157385849*^9, 
   3.406271157679594*^9}, {3.406275065824156*^9, 3.406275065942869*^9}, {
   3.406275579621657*^9, 3.406275579908154*^9}, {3.406276645351296*^9, 
   3.4062766811321573`*^9}, {3.406278522429812*^9, 3.406278568956202*^9}, {
   3.40627867199174*^9, 3.406278672797612*^9}, {3.406278864109811*^9, 
   3.4062788711167927`*^9}, {3.406279043465927*^9, 3.406279044258203*^9}, {
   3.4062793362240257`*^9, 3.406279342388598*^9}, {3.406279437671843*^9, 
   3.4062794401966667`*^9}, {3.406538316213442*^9, 3.406538318292309*^9}, {
   3.406538408510229*^9, 3.4065384157662973`*^9}, {3.4065384498077583`*^9, 
   3.406538451864377*^9}, {3.406624345796327*^9, 3.406624348504971*^9}, {
   3.406625143411931*^9, 3.406625151380205*^9}, {3.406625263470682*^9, 
   3.4066252685490093`*^9}, {3.4066253645750017`*^9, 3.406625364893717*^9}, {
   3.406626077390986*^9, 3.406626078629546*^9}, {3.406963465636033*^9, 
   3.4069635387220182`*^9}, {3.406963623454547*^9, 3.406963630605288*^9}, {
   3.406963711664507*^9, 3.406963712943365*^9}, {3.4069638601991*^9, 
   3.406963862534336*^9}, {3.406964240076623*^9, 3.406964249557061*^9}, 
   3.406964334151318*^9, {3.4069644841669483`*^9, 3.406964486248864*^9}, {
   3.406964657807802*^9, 3.406964689895823*^9}, {3.40696500595114*^9, 
   3.406965011607339*^9}, {3.406965305001758*^9, 3.406965305130595*^9}, {
   3.406965422898642*^9, 3.406965448387726*^9}, {3.406965491391975*^9, 
   3.40696556949572*^9}, {3.4073981803458*^9, 3.407398199508065*^9}, {
   3.407399038521598*^9, 3.407399042833119*^9}, {3.407452057480006*^9, 
   3.40745206207255*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"LogStructure", "[", 
  RowBox[{
   RowBox[{"rischLog", "[", 
    RowBox[{"theta", "[", "1", "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"theta", "[", "1", "]"}], ",", 
     RowBox[{"theta", "[", "2", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"theta", "[", "1", "]"}], ",", 
     RowBox[{"rischLog", "[", 
      RowBox[{
       RowBox[{"theta", "[", "1", "]"}], "-", "1"}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     FractionBox["1", 
      RowBox[{"1", "+", 
       RowBox[{"theta", "[", "1", "]"}]}]]}], "}"}], ",", 
   RowBox[{"{", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.406231735791732*^9, 3.406231767809394*^9}, {
  3.406268762377763*^9, 3.4062687747641287`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"False", ",", 
   RowBox[{"rischLog", "[", 
    SubscriptBox["\<\"\[Theta]\"\>", "1"], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["\<\"\[Theta]\"\>", "1"], ",", 
     SubscriptBox["\<\"\[Theta]\"\>", "2"], ",", 
     SubscriptBox["\<\"\[Theta]\"\>", "3"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["\<\"\[Theta]\"\>", "1"], ",", 
     RowBox[{"rischLog", "[", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SubscriptBox["\<\"\[Theta]\"\>", "1"]}], "]"}], ",", 
     RowBox[{"rischLog", "[", 
      SubscriptBox["\<\"\[Theta]\"\>", "1"], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     FractionBox["1", 
      RowBox[{"1", "+", 
       SubscriptBox["\<\"\[Theta]\"\>", "1"]}]], ",", 
     FractionBox["1", 
      SubscriptBox["\<\"\[Theta]\"\>", "1"]]}], "}"}], ",", 
   RowBox[{"{", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.406231768918769*^9, 3.406266509553554*^9, 
  3.406267245776806*^9, 3.406268134076779*^9, 3.406268365946913*^9, 
  3.4062684015602627`*^9, 3.406268458471505*^9, 3.406268518081642*^9, 
  3.4062687761407213`*^9, 3.406269576663206*^9, 3.406275906007382*^9, 
  3.406534683416357*^9, 3.4065347374220657`*^9, 3.406538320248498*^9, 
  3.406538418693152*^9, 3.4065384542068787`*^9, 3.406963546940073*^9, 
  3.406965137702312*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"LogStructure", "[", 
  RowBox[{
   RowBox[{"rischLog", "[", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     SuperscriptBox[
      RowBox[{"theta", "[", "1", "]"}], "2"]}], "]"}], ",", 
   RowBox[{"{", "\[InvisibleSpace]", 
    RowBox[{
     RowBox[{"theta", "[", "1", "]"}], ",", "\[InvisibleSpace]", 
     SubscriptBox["\"\<\[Theta]\>\"", "2"], ",", "\[InvisibleSpace]", 
     SubscriptBox["\"\<\[Theta]\>\"", "3"], ",", "\[InvisibleSpace]", 
     SubscriptBox["\"\<\[Theta]\>\"", "4"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"theta", "[", "1", "]"}], ",", "\[InvisibleSpace]", 
     RowBox[{"rischLog", "[", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"theta", "[", "1", "]"}]}], "]"}], ",", "\[InvisibleSpace]", 
     RowBox[{"rischLog", "[", 
      RowBox[{"theta", "[", "1", "]"}], "]"}], ",", "\[InvisibleSpace]", 
     RowBox[{"rischLog", "[", 
      RowBox[{"1", "+", 
       RowBox[{"theta", "[", "1", "]"}]}], "]"}]}], 
    "\[InvisibleSpace]\[InvisibleSpace]", "}"}], ",", " ", 
   RowBox[{"{", "\[InvisibleSpace]", 
    RowBox[{"1", ",", "\[InvisibleSpace]", 
     FractionBox["1", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SubscriptBox["\"\<\[Theta]\>\"", "1"]}]], ",", "\[InvisibleSpace]", 
     FractionBox["1", 
      SubscriptBox["\"\<\[Theta]\>\"", "1"]], "\[InvisibleSpace]", ",", 
     FractionBox["1", 
      RowBox[{"1", "+", 
       SubscriptBox["\"\<\[Theta]\>\"", "1"]}]]}], "}"}], ",", 
   RowBox[{"{", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.4055477240216503`*^9, 3.40554781801298*^9}, {
   3.405548022087925*^9, 3.4055480235249043`*^9}, {3.405548134328232*^9, 
   3.405548144348888*^9}, {3.4056722174532967`*^9, 3.405672223140502*^9}, {
   3.40567250300386*^9, 3.4056725180597143`*^9}, {3.405750541649008*^9, 
   3.405750552972246*^9}, {3.406194522407118*^9, 3.406194523084186*^9}, {
   3.406194560661456*^9, 3.40619456126834*^9}, 3.4062316227682734`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"True", ",", 
   RowBox[{
    RowBox[{"rischLog", "[", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SubscriptBox["\<\"\[Theta]\"\>", "1"]}], "]"}], "+", 
    RowBox[{"rischLog", "[", 
     RowBox[{"1", "+", 
      SubscriptBox["\<\"\[Theta]\"\>", "1"]}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["\<\"\[Theta]\"\>", "1"], ",", 
     SubscriptBox["\<\"\[Theta]\"\>", "2"], ",", 
     SubscriptBox["\<\"\[Theta]\"\>", "3"], ",", 
     SubscriptBox["\<\"\[Theta]\"\>", "4"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["\<\"\[Theta]\"\>", "1"], ",", 
     RowBox[{"rischLog", "[", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SubscriptBox["\<\"\[Theta]\"\>", "1"]}], "]"}], ",", 
     RowBox[{"rischLog", "[", 
      SubscriptBox["\<\"\[Theta]\"\>", "1"], "]"}], ",", 
     RowBox[{"rischLog", "[", 
      RowBox[{"1", "+", 
       SubscriptBox["\<\"\[Theta]\"\>", "1"]}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     FractionBox["1", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SubscriptBox["\<\"\[Theta]\"\>", "1"]}]], ",", 
     FractionBox["1", 
      SubscriptBox["\<\"\[Theta]\"\>", "1"]], ",", 
     FractionBox["1", 
      RowBox[{"1", "+", 
       SubscriptBox["\<\"\[Theta]\"\>", "1"]}]]}], "}"}], ",", 
   RowBox[{"{", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.405750528817513*^9, 3.40575055421692*^9}, 
   3.406191172085842*^9, 3.406191243308915*^9, 3.4061912747551727`*^9, 
   3.4061913564404573`*^9, 3.406191505793009*^9, 3.406191794757169*^9, 
   3.406192251148425*^9, 3.4061926660248947`*^9, 3.4061927816718273`*^9, 
   3.40619285163232*^9, 3.406193025060851*^9, 3.406193064719018*^9, 
   3.406193163229866*^9, 3.406193215512967*^9, 3.40619329150527*^9, 
   3.40619341860603*^9, 3.406193489620278*^9, {3.406194461192346*^9, 
   3.40619449072556*^9}, 3.406194524408298*^9, 3.406194561968361*^9, {
   3.40619490034759*^9, 3.4061950037080297`*^9}, 3.406195212425396*^9, {
   3.406230810897571*^9, 3.4062308461663237`*^9}, 3.406231517753824*^9, 
   3.40623162607535*^9, 3.406266518567912*^9, 3.406267323767289*^9, 
   3.4062759099598*^9, 3.406534741283648*^9, 3.406538381974751*^9, 
   3.406538424262212*^9, 3.4065384588400497`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"LogStructure", "[", 
  RowBox[{
   RowBox[{"rischLog", "[", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"theta", "[", "1", "]"}], "2"], "-", 
     RowBox[{"theta", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"theta", "[", "1", "]"}], ",", 
     RowBox[{"theta", "[", "2", "]"}], ",", 
     RowBox[{"theta", "[", "3", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"theta", "[", "1", "]"}], ",", 
     RowBox[{"rischLog", "[", 
      RowBox[{"theta", "[", "1", "]"}], "]"}], ",", 
     RowBox[{"rischLog", "[", 
      RowBox[{
       RowBox[{"theta", "[", "1", "]"}], "-", "1"}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"1", "/", 
      RowBox[{"theta", "[", "1", "]"}]}], ",", 
     RowBox[{"1", "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"theta", "[", "1", "]"}], "-", "1"}], ")"}]}]}], "}"}], ",", 
   RowBox[{"{", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.4056719299903708`*^9, 3.405672011287027*^9}, {
  3.4056721155713654`*^9, 3.405672120771792*^9}, {3.405672546995495*^9, 
  3.405672555718689*^9}, {3.4061945726848497`*^9, 3.406194578923273*^9}, {
  3.406266534783856*^9, 3.4062665351879263`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"True", ",", 
   RowBox[{
    RowBox[{"rischLog", "[", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SubscriptBox["\<\"\[Theta]\"\>", "1"]}], "]"}], "+", 
    RowBox[{"rischLog", "[", 
     SubscriptBox["\<\"\[Theta]\"\>", "1"], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["\<\"\[Theta]\"\>", "1"], ",", 
     SubscriptBox["\<\"\[Theta]\"\>", "2"], ",", 
     SubscriptBox["\<\"\[Theta]\"\>", "3"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["\<\"\[Theta]\"\>", "1"], ",", 
     RowBox[{"rischLog", "[", 
      SubscriptBox["\<\"\[Theta]\"\>", "1"], "]"}], ",", 
     RowBox[{"rischLog", "[", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SubscriptBox["\<\"\[Theta]\"\>", "1"]}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     FractionBox["1", 
      SubscriptBox["\<\"\[Theta]\"\>", "1"]], ",", 
     FractionBox["1", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SubscriptBox["\<\"\[Theta]\"\>", "1"]}]]}], "}"}], ",", 
   RowBox[{"{", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.40619450471957*^9, {3.406194563038746*^9, 3.4061945799654083`*^9}, 
   3.4061952552792473`*^9, {3.406230847741239*^9, 3.406230850511496*^9}, {
   3.406266521078745*^9, 3.4062665358904247`*^9}, 3.406268721411675*^9, 
   3.406275914170416*^9, 3.406534760365685*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"buildlhs", "[", 
   RowBox[{"exps_", ",", "logs_", ",", "thetas_", ",", "Dtower_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"pt1", ",", "pt2", ",", "res"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"RischTrace", "[", 
      RowBox[{"buildlhs", ",", 
       RowBox[{"{", 
        RowBox[{"exps", ",", "logs", ",", "thetas", ",", "Dtower"}], "}"}], 
       ",", "\"\<In\>\""}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"log", " ", "terms"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"pt1", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Risch`r", "[", "#", "]"}], 
          RowBox[{
           RowBox[{"TotalDerivation", "[", 
            RowBox[{
             RowBox[{"logs", "[", 
              RowBox[{"[", "#", "]"}], "]"}], ",", "thetas", ",", "Dtower"}], 
            "]"}], "/", 
           RowBox[{"logs", "[", 
            RowBox[{"[", "#", "]"}], "]"}]}]}], "&"}], ",", 
        RowBox[{"Range", "[", 
         RowBox[{"Length", "[", "logs", "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"exp", " ", "terms"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"pt2", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Risch`r", "[", 
           RowBox[{"#", "+", 
            RowBox[{"Length", "[", "logs", "]"}]}], "]"}], 
          RowBox[{"TotalDerivation", "[", 
           RowBox[{
            RowBox[{"exps", "[", 
             RowBox[{"[", "#", "]"}], "]"}], ",", "thetas", ",", "Dtower"}], 
           "]"}]}], "&"}], ",", 
        RowBox[{"Range", "[", 
         RowBox[{"Length", "[", "exps", "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Length", "[", "#", "]"}], ",", 
           RowBox[{"Total", "[", "#", "]"}]}], "}"}], "&"}], "/@", 
        RowBox[{"{", 
         RowBox[{"Join", "[", 
          RowBox[{"pt1", ",", "pt2"}], "]"}], "}"}]}], "//", "Flatten"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"RischTrace", "[", 
      RowBox[{"buildlhs", ",", "res", ",", "\"\<Out\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", "res"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.405543073734264*^9, 3.4055430900975857`*^9}, {
  3.405543995742947*^9, 3.4055442005513563`*^9}, {3.4055442681235657`*^9, 
  3.4055443135692463`*^9}, {3.40554517516*^9, 3.40554518684669*^9}, {
  3.405546524513694*^9, 3.405546655736677*^9}, {3.405669202719017*^9, 
  3.405669355061941*^9}, {3.406275071182835*^9, 3.406275071331934*^9}, {
  3.406276594983018*^9, 3.406276596804306*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"buildlhs", "[", 
  RowBox[{
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"theta", "[", "1", "]"}]}], ",", 
     RowBox[{"theta", "[", "1", "]"}], ",", 
     RowBox[{"1", "+", 
      RowBox[{"theta", "[", "1", "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"theta", "[", "1", "]"}], ",", 
     SubscriptBox["\"\<\[Theta]\>\"", "2"], ",", 
     SubscriptBox["\"\<\[Theta]\>\"", "3"], ",", 
     SubscriptBox["\"\<\[Theta]\>\"", "4"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     FractionBox["1", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SubscriptBox["\"\<\[Theta]\>\"", "1"]}]], ",", 
     FractionBox["1", 
      SubscriptBox["\"\<\[Theta]\>\"", "1"]], ",", 
     FractionBox["1", 
      RowBox[{"1", "+", 
       SubscriptBox["\"\<\[Theta]\>\"", "1"]}]]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.4055478820421877`*^9, 3.405547953324399*^9}, 
   3.405547998310955*^9, {3.405559991804688*^9, 3.405560003314068*^9}, {
   3.406275073664569*^9, 3.406275073829398*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3", ",", 
   RowBox[{
    FractionBox[
     RowBox[{"Risch`r", "[", "1", "]"}], 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SubscriptBox["\<\"\[Theta]\"\>", "1"]}]], "+", 
    FractionBox[
     RowBox[{"Risch`r", "[", "2", "]"}], 
     SubscriptBox["\<\"\[Theta]\"\>", "1"]], "+", 
    FractionBox[
     RowBox[{"Risch`r", "[", "3", "]"}], 
     RowBox[{"1", "+", 
      SubscriptBox["\<\"\[Theta]\"\>", "1"]}]]}]}], "}"}]], "Output",
 CellChangeTimes->{3.405750522252123*^9, 3.406192743441217*^9, 
  3.406194615220907*^9, 3.406266547135598*^9, 3.4062750741869907`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"buildnewlogtheta", "[", 
   RowBox[{"sol_", ",", "tower_", ",", "thetas_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"exps", ",", "logs", ",", "pt1", ",", "pt2", ",", "res"}], "}"}],
     ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"RischTrace", "[", 
      RowBox[{"buildnewtheta", ",", 
       RowBox[{"{", 
        RowBox[{"sol", ",", "tower"}], "}"}], ",", "\"\<In\>\""}], "]"}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"exps", "=", 
      RowBox[{"Select", "[", 
       RowBox[{"tower", ",", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{
           RowBox[{"Head", "[", "#", "]"}], ",", "rischExp"}], "]"}], "&"}]}],
        "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"logs", "=", 
      RowBox[{"Select", "[", 
       RowBox[{"tower", ",", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{
           RowBox[{"Head", "[", "#", "]"}], ",", "rischLog"}], "]"}], "&"}]}],
        "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"log", " ", "terms"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"pt1", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"sol", "[", 
           RowBox[{"[", "#", "]"}], "]"}], 
          RowBox[{"logs", "[", 
           RowBox[{"[", "#", "]"}], "]"}]}], "&"}], ",", 
        RowBox[{"Range", "[", 
         RowBox[{"Length", "[", "logs", "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"exp", " ", "terms"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"pt2", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"sol", "[", 
           RowBox[{"[", 
            RowBox[{"#", "+", 
             RowBox[{"Length", "[", "logs", "]"}]}], "]"}], "]"}], 
          RowBox[{"exps", "[", 
           RowBox[{"[", "#", "]"}], "]"}]}], "&"}], ",", 
        RowBox[{"Range", "[", 
         RowBox[{"Length", "[", "exps", "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{
       RowBox[{"Total", "[", "pt1", "]"}], "+", 
       RowBox[{"Total", "[", "pt2", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"RischTrace", "[", 
      RowBox[{"buildnewtheta", ",", "res", ",", "\"\<Out\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", "res"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.406190059206802*^9, 3.406190173603507*^9}, {
  3.4061902271880283`*^9, 3.40619024624396*^9}, {3.406190279062788*^9, 
  3.406190337158168*^9}, {3.406191187519449*^9, 3.406191192788278*^9}, {
  3.406192656187944*^9, 3.406192659723526*^9}, {3.4061927190519857`*^9, 
  3.406192723091125*^9}, {3.406192835382532*^9, 3.406192846291707*^9}, {
  3.406192901249209*^9, 3.40619300354112*^9}, {3.406193048224216*^9, 
  3.406193056364749*^9}, {3.4061930958240337`*^9, 3.406193151782217*^9}, {
  3.406193273182293*^9, 3.4061932782511187`*^9}, {3.406195557648693*^9, 
  3.406195558603032*^9}, {3.406271166261978*^9, 3.4062711665471087`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Structure Solve", "Subsection",
 CellChangeTimes->{{3.405670809598114*^9, 3.4056708156597347`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"faststructuresolve", "[", 
   RowBox[{"eqnlhs_", ",", "eqnrhs_", ",", "inthetas_", ",", "n_"}], "]"}], ":=", 
  RowBox[{"Quiet", "[", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "ls", ",", "lhs", ",", "rhs", ",", "vars", ",", "soln", ",", "res"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "a", " ", "fast", " ", "heuristic", " ", "for", " ", "solving", " ", 
       "systems", " ", "of", " ", "equations", " ", "arising", " ", "from", 
       " ", "\[IndentingNewLine]", "structure", " ", 
       RowBox[{"theorems", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"RischTrace", "[", 
       RowBox[{"faststructuresolve", ",", 
        RowBox[{"{", 
         RowBox[{"eqnlhs", ",", "eqnrhs"}], "}"}], ",", "\"\<In\>\""}], "]"}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"ls", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "&"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"{", 
          RowBox[{"inthetas", ",", 
           RowBox[{"RandomInteger", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"25", ",", "45"}], "}"}], ",", 
             RowBox[{"Length", "[", "inthetas", "]"}]}], "]"}]}], "}"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"lhs", ",", "rhs"}], "}"}], "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"eqnlhs", ",", "eqnrhs"}], "}"}], "/.", "ls"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"vars", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Risch`r", "[", "i", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"soln", "=", 
       RowBox[{"Quiet", "[", 
        RowBox[{
         RowBox[{"vars", "/.", 
          RowBox[{"Solve", "[", 
           RowBox[{
            RowBox[{"lhs", "==", "rhs"}], ",", "vars"}], "]"}]}], "//", 
         "Flatten"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"rational", " ", 
        RowBox[{"solution", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"SameQ", "[", 
         RowBox[{"soln", ",", 
          RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"res", "=", "$Failed"}], ",", "\[IndentingNewLine]", "\t", 
        RowBox[{"And", "@@", 
         RowBox[{"(", 
          RowBox[{"RationalQ", "/@", "soln"}], ")"}]}], ",", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"res", "=", "soln"}], ",", "\[IndentingNewLine]", "\t", 
        "True", ",", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"res", "=", "$Failed"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"RischTrace", "[", 
       RowBox[{"faststructuresolve", ",", "res", ",", "\"\<Out\>\""}], "]"}], 
      ";", "\[IndentingNewLine]", "res"}]}], "\[IndentingNewLine]", "]"}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.409140267447315*^9, 3.4091404060786037`*^9}, {
   3.409140437801342*^9, 3.409140439206732*^9}, {3.409174134256543*^9, 
   3.40917426784029*^9}, {3.409174821906494*^9, 3.4091748865373163`*^9}, 
   3.409174928471373*^9, {3.409174964981456*^9, 3.409174991309291*^9}, {
   3.409175077069668*^9, 3.409175098395748*^9}, {3.409175184518434*^9, 
   3.409175185923952*^9}, {3.4091754121340446`*^9, 3.4091754176117887`*^9}, {
   3.409175516172112*^9, 3.409175519580041*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"faststructuresolve", "[", 
  RowBox[{
   FractionBox[
    RowBox[{"Risch`r", "[", "1", "]"}], "x"], ",", 
   FractionBox["1", 
    RowBox[{"3", "x"}]], ",", 
   RowBox[{"{", "x", "}"}], ",", "1"}], "]"}]], "Input",
 CellChangeTimes->{{3.409175476536272*^9, 3.409175500068433*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  FractionBox["1", "3"], "}"}]], "Output",
 CellChangeTimes->{{3.4091755007116137`*^9, 3.409175556772654*^9}, 
   3.409176935311254*^9, 3.4091770918005037`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"lhs", "=", 
   RowBox[{
    FractionBox[
     RowBox[{"Risch`r", "[", "1", "]"}], 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"theta", "[", "1", "]"}]}]], "+", 
    FractionBox[
     RowBox[{"Risch`r", "[", "2", "]"}], 
     RowBox[{"theta", "[", "1", "]"}]], "+", 
    FractionBox[
     RowBox[{"Risch`r", "[", "3", "]"}], 
     RowBox[{"1", "+", 
      RowBox[{"theta", "[", "1", "]"}]}]]}]}], ";", 
  RowBox[{"rhs", "=", 
   FractionBox[
    RowBox[{
     RowBox[{"2", " ", 
      RowBox[{"theta", "[", "1", "]"}]}], "+", "1"}], 
    RowBox[{
     SuperscriptBox[
      RowBox[{"theta", "[", "1", "]"}], "2"], "+", 
     RowBox[{"theta", "[", "1", "]"}]}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"faststructuresolve", "[", 
  RowBox[{"lhs", ",", "rhs", ",", 
   RowBox[{"{", 
    RowBox[{"theta", "[", "1", "]"}], "}"}], ",", "3"}], "]"}]}], "Input",
 CellChangeTimes->{{3.4056670978246613`*^9, 3.405667145958288*^9}, 
   3.405670667448432*^9, {3.409015730146798*^9, 3.409015730943829*^9}, {
   3.4091265418750467`*^9, 3.4091265446591253`*^9}, {3.409174941286056*^9, 
   3.409174941789468*^9}, {3.4091751406320953`*^9, 3.4091751497014627`*^9}}],

Cell[BoxData["$Failed"], "Output",
 CellChangeTimes->{
  3.4091751984728737`*^9, 3.409175347368001*^9, {3.409175419603901*^9, 
   3.409175443394075*^9}, {3.409175523514123*^9, 3.4091755315829973`*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"structuresolve", "[", 
   RowBox[{"eqnlhs_", ",", "eqnrhs_", ",", "inthetas_", ",", "n_"}], "]"}], ":=", 
  RowBox[{"Quiet", "[", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "thetas", ",", "lhs", ",", "rhs", ",", "plhs", ",", "prhs", ",", "eqns",
        ",", "res", ",", "vars", ",", "soln"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"RischTrace", "[", 
       RowBox[{"structuresolve", ",", 
        RowBox[{"{", 
         RowBox[{"eqnlhs", ",", "eqnrhs"}], "}"}], ",", "\"\<In\>\""}], "]"}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"thetas", "=", 
       RowBox[{"Union", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"First", "[", "inthetas", "]"}], "}"}], ",", 
          RowBox[{"Cases", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"eqnlhs", ",", "eqnrhs"}], "}"}], ",", 
            RowBox[{"theta", "[", "a_", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "Infinity"}], "}"}]}], "]"}]}], "]"}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "cross", " ", "multiply", " ", "and", " ", "cancel", " ", "terms"}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"lhs", ",", "rhs"}], "}"}], "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Together", "[", "eqnlhs", "]"}], ",", 
         RowBox[{"Together", "[", "eqnrhs", "]"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"plhs", "=", 
       RowBox[{"Expand", "[", 
        RowBox[{
         RowBox[{"Numerator", "[", "lhs", "]"}], " ", 
         RowBox[{"Denominator", "[", "rhs", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"prhs", "=", 
       RowBox[{"Expand", "[", 
        RowBox[{
         RowBox[{"Numerator", "[", "rhs", "]"}], " ", 
         RowBox[{"Denominator", "[", "lhs", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"build", " ", "system", " ", "of", " ", "equations"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"plhs", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"CoefficientArrays", "[", 
          RowBox[{
           RowBox[{"plhs", "-", "prhs"}], ",", "thetas"}], "]"}], "//", 
         "Normal"}], "//", "Flatten"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"prhs", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", "plhs", "]"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"eqns", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"First", "[", "#", "]"}], "\[Equal]", 
           RowBox[{"Last", "[", "#", "]"}]}], "&"}], ",", 
         RowBox[{"Thread", "[", 
          RowBox[{"{", 
           RowBox[{"plhs", ",", "prhs"}], "}"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"solve", " ", "the", " ", "system", " ", "of", " ", 
         RowBox[{"equations", ".", " ", "This"}], " ", "would", " ", "be", 
         " ", "faster", " ", "if", "\[IndentingNewLine]", "we", " ", "used", 
         " ", "LinearSolve"}], "..."}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"vars", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Risch`r", "[", "i", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"soln", "=", 
       RowBox[{"Quiet", "[", 
        RowBox[{
         RowBox[{"vars", "/.", 
          RowBox[{"Solve", "[", 
           RowBox[{"eqns", ",", "vars"}], "]"}]}], "//", "Flatten"}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"rational", " ", 
        RowBox[{"solution", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"SameQ", "[", 
         RowBox[{"soln", ",", 
          RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"res", "=", "$Failed"}], ",", "\[IndentingNewLine]", "\t", 
        RowBox[{"And", "@@", 
         RowBox[{"(", 
          RowBox[{"RationalQ", "/@", "soln"}], ")"}]}], ",", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"res", "=", "soln"}], ",", "\[IndentingNewLine]", "\t", 
        "True", ",", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"res", "=", "$Failed"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"RischTrace", "[", 
       RowBox[{"structuresolve", ",", "res", ",", "\"\<Out\>\""}], "]"}], ";",
       "\[IndentingNewLine]", "res"}]}], "\[IndentingNewLine]", "]"}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.405547104395747*^9, 3.405547172019369*^9}, {
   3.405547324581936*^9, 3.405547337204475*^9}, {3.405547422574794*^9, 
   3.405547428379819*^9}, {3.405560074346836*^9, 3.405560079770555*^9}, {
   3.4055606100879297`*^9, 3.4055606188398314`*^9}, {3.405666037423538*^9, 
   3.40566622403154*^9}, {3.405667257829126*^9, 3.405667300353956*^9}, {
   3.405667463360635*^9, 3.405667474256015*^9}, {3.4056678395523233`*^9, 
   3.405667890471395*^9}, {3.40566809680555*^9, 3.4056681390916767`*^9}, {
   3.4056681785266953`*^9, 3.40566823859579*^9}, {3.4056685079187727`*^9, 
   3.405668512676003*^9}, {3.405668635140523*^9, 3.4056686389716673`*^9}, 
   3.405668856212729*^9, {3.405668965003696*^9, 3.405669041005309*^9}, {
   3.405669123423978*^9, 3.405669143879507*^9}, {3.405669409618987*^9, 
   3.405669485463192*^9}, {3.405669633890294*^9, 3.405669642113096*^9}, {
   3.405669675194743*^9, 3.405669718075451*^9}, {3.405669765932981*^9, 
   3.405669777044072*^9}, {3.405670022659252*^9, 3.405670028826421*^9}, {
   3.405670158828269*^9, 3.405670218817464*^9}, {3.405670297653481*^9, 
   3.405670367210762*^9}, {3.405670432454702*^9, 3.405670533305723*^9}, {
   3.4056705777630987`*^9, 3.4056706278963747`*^9}, {3.406278252901373*^9, 
   3.406278257242752*^9}, {3.4062782987480392`*^9, 3.406278305162403*^9}, {
   3.406278342486424*^9, 3.4062783431407013`*^9}, {3.4062783802193117`*^9, 
   3.406278438531049*^9}, {3.406278593552225*^9, 3.406278644348275*^9}, {
   3.4062789072070312`*^9, 3.406278911892704*^9}, {3.406279156341772*^9, 
   3.4062791606927767`*^9}, {3.40653472103368*^9, 3.406534725457452*^9}, {
   3.406538679723597*^9, 3.406538685587865*^9}, {3.407614920410327*^9, 
   3.407614929927351*^9}, {3.409126079562056*^9, 3.409126082926667*^9}, {
   3.409126140127836*^9, 3.409126146965246*^9}, {3.409126307539155*^9, 
   3.409126329255826*^9}, {3.4091265655127783`*^9, 3.409126652800173*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"lhs", "=", 
   RowBox[{
    RowBox[{"Risch`r", "[", "1", "]"}], "-", 
    FractionBox[
     RowBox[{"Risch`r", "[", "2", "]"}], 
     SuperscriptBox["x", "2"]]}]}], ";", 
  RowBox[{"rhs", "=", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["4", 
      SuperscriptBox["x", "5"]]}], "+", 
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"2", " ", "x"}]}], ")"}], " ", 
      SubscriptBox["\[Theta]", "1"]}], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "-", "x", "+", 
        SuperscriptBox["x", "2"]}], ")"}], "2"]], "-", 
    FractionBox[
     SubscriptBox["\[Theta]", "1"], 
     RowBox[{
      RowBox[{"-", "1"}], "-", "x", "+", 
      SuperscriptBox["x", "2"]}]], "+", 
    FractionBox[
     RowBox[{"\[ExponentialE]", " ", 
      SuperscriptBox["x", "3"], " ", 
      SubscriptBox["\[Theta]", "2"]}], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"\[ExponentialE]", "+", 
        SubscriptBox["\[Theta]", "2"]}], ")"}], "2"]], "+", 
    FractionBox[
     RowBox[{"7", " ", 
      SuperscriptBox["x", "6"], " ", 
      SubscriptBox["\[Theta]", "2"]}], 
     RowBox[{"\[ExponentialE]", "+", 
      SubscriptBox["\[Theta]", "2"]}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"faststructuresolve", "[", 
   RowBox[{"lhs", ",", "rhs", ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", 
      RowBox[{"theta", "[", "1", "]"}], ",", 
      RowBox[{"theta", "[", "2", "]"}]}], "}"}], ",", "2"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"crashes", " ", "system"}], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.4090156097987833`*^9, 3.409015666956476*^9}, {
   3.4090157111359663`*^9, 3.409015718072844*^9}, 3.4091262519402227`*^9, {
   3.409126291606312*^9, 3.409126291812952*^9}, {3.4091266676048*^9, 
   3.4091266847236357`*^9}, {3.40917531281155*^9, 3.409175314281727*^9}, {
   3.4091753837853394`*^9, 3.409175385774879*^9}}],

Cell[BoxData["$Failed"], "Output",
 CellChangeTimes->{{3.409175344032483*^9, 3.409175425654234*^9}, 
   3.409175540332777*^9, 3.409177099874511*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"faststructuresolve", "[", 
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{"Risch`r", "[", "1", "]"}], "x"], "+", 
    RowBox[{"Risch`r", "[", "2", "]"}]}], "\[InvisibleSpace]", ",", 
   RowBox[{"theta", "[", "3", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"theta", "[", "3", "]"}]}], "}"}], ",", "2"}], "]"}]], "Input",
 CellChangeTimes->{{3.4062779346782417`*^9, 3.4062779778128347`*^9}, {
   3.406278195037719*^9, 3.406278223980487*^9}, 3.4062784752314367`*^9, {
   3.4091773261590147`*^9, 3.40917732791675*^9}}],

Cell[BoxData["$Failed"], "Output",
 CellChangeTimes->{{3.409177322460021*^9, 3.409177328392406*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"structureconstantlog", "[", 
   RowBox[{"test_", ",", "rhs_", ",", "thetas_", ",", "tower_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"reps", ",", "c"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"RischTrace", "[", 
      RowBox[{"structureconstantlog", ",", 
       RowBox[{"{", 
        RowBox[{"test", ",", "rhs", ",", "thetas", ",", "tower"}], "}"}], 
       ",", "\"\<In\>\""}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"reps", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"First", "[", "#", "]"}], "\[Rule]", 
          RowBox[{"Last", "[", "#", "]"}]}], "&"}], ",", 
        RowBox[{"Thread", "[", 
         RowBox[{"{", 
          RowBox[{"thetas", ",", "tower"}], "}"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"c", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"test", "-", "rhs"}], ")"}], "//.", "reps"}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"rischLog", "\[Rule]", "Log"}], ",", 
         RowBox[{"rischExp", "\[Rule]", "Exp"}]}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Of", " ", "course"}], ",", " ", 
       RowBox[{
       "the", " ", "following", " ", "line", " ", "will", " ", "fail", " ", 
        "if", " ", 
        RowBox[{"49", "/", "100"}], " ", "is", " ", "a", " ", 
        "\[IndentingNewLine]", "pole", " ", "of", " ", "test", " ", "or", " ",
         "rhs"}], ",", " ", 
       RowBox[{
        RowBox[{
        "but", " ", "this", " ", "will", " ", "do", " ", "for", " ", "now"}], 
        "..."}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"c", "=", 
      RowBox[{"c", "/.", 
       RowBox[{
        RowBox[{"First", "[", "thetas", "]"}], "\[Rule]", 
        RowBox[{"49", "/", "100"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "c", " ", "is", " ", "in", " ", "the", " ", "constant", " ", "field", 
       " ", "of", " ", 
       RowBox[{"integrand", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"c", "=", 
      RowBox[{"Simplify", "[", "c", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"RischTrace", "[", 
      RowBox[{"structureconstantlog", ",", "c", ",", "\"\<Out\>\""}], "]"}], 
     ";", "\[IndentingNewLine]", "c"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.406190476200131*^9, 3.4061905434181547`*^9}, {
   3.4061907418212852`*^9, 3.4061908323954144`*^9}, 3.4061908796499033`*^9, {
   3.4061909359264383`*^9, 3.40619094394064*^9}, {3.4061910005151653`*^9, 
   3.40619111682969*^9}, {3.4061914831200857`*^9, 3.4061914927411413`*^9}, {
   3.4061917858897963`*^9, 3.406191787878954*^9}, {3.406192025966221*^9, 
   3.40619203911712*^9}, {3.406193357638068*^9, 3.406193365356735*^9}, {
   3.406193428889118*^9, 3.406193441670244*^9}, {3.4061936230290537`*^9, 
   3.406193653497147*^9}, {3.406193704657197*^9, 3.406193708078026*^9}, {
   3.406193778092245*^9, 3.406193778281144*^9}, {3.406193894308176*^9, 
   3.4061939416182613`*^9}, {3.406193995579681*^9, 3.4061940504046917`*^9}, {
   3.4061941131285*^9, 3.406194116216744*^9}, {3.406194368591537*^9, 
   3.406194369313279*^9}, {3.406194416173255*^9, 3.4061944479036837`*^9}, {
   3.4061946015703487`*^9, 3.4061946047022123`*^9}, {3.406275573855854*^9, 
   3.406275574152418*^9}, {3.406275631707901*^9, 3.4062756389472513`*^9}, {
   3.406277788060317*^9, 3.406277789531734*^9}, {3.4091743262017593`*^9, 
   3.409174327680929*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"structureconstantlog", "[", 
  RowBox[{
   RowBox[{"rischLog", "[", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     RowBox[{
      RowBox[{"theta", "[", "1", "]"}], "^", "2"}]}], "]"}], ",", 
   RowBox[{
    RowBox[{"theta", "[", "2", "]"}], "+", 
    RowBox[{"theta", "[", "4", "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"theta", "[", "1", "]"}], ",", 
     RowBox[{"theta", "[", "2", "]"}], ",", 
     RowBox[{"theta", "[", "3", "]"}], ",", 
     RowBox[{"theta", "[", "4", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"theta", "[", "1", "]"}], ",", 
     RowBox[{"rischLog", "[", 
      RowBox[{
       RowBox[{"theta", "[", "1", "]"}], "-", "1"}], "]"}], ",", 
     RowBox[{"rischLog", "[", 
      RowBox[{"theta", "[", "1", "]"}], "]"}], ",", 
     RowBox[{"rischLog", "[", 
      RowBox[{"1", "+", 
       RowBox[{"theta", "[", "1", "]"}]}], "]"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.4061918970954227`*^9, 3.406191992563792*^9}, {
  3.40619345538876*^9, 3.4061934600738297`*^9}, {3.406193524148793*^9, 
  3.4061935325627613`*^9}, {3.4061937664561872`*^9, 3.406193766613411*^9}, {
  3.406194407356612*^9, 3.406194407697898*^9}, {3.406276822425043*^9, 
  3.406276822701992*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.406191984338634*^9, 3.406191993307922*^9}, {
   3.406192030621317*^9, 3.406192040321289*^9}, {3.40619344335288*^9, 
   3.406193469116516*^9}, 3.406193533646298*^9, 3.4061935900415783`*^9, {
   3.406193626664875*^9, 3.4061936566846657`*^9}, 3.406193709907148*^9, {
   3.406193767664175*^9, 3.40619379107283*^9}, {3.406193828818796*^9, 
   3.4061938514403887`*^9}, {3.406194053355255*^9, 3.406194065837265*^9}, 
   3.4061941199595346`*^9, 3.4061943709031763`*^9, {3.406194408365135*^9, 
   3.406194448994258*^9}, 3.40619460618356*^9, 3.4062665522488327`*^9, 
   3.4062768242119093`*^9, 3.406277792088111*^9, 3.4090161543922377`*^9, 
   3.409175547669834*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"structureconstantexp", "[", 
   RowBox[{"test_", ",", "rhs_", ",", "thetas_", ",", "tower_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"reps", ",", "c"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"RischTrace", "[", 
      RowBox[{"structureconstantexp", ",", 
       RowBox[{"{", 
        RowBox[{"test", ",", "rhs", ",", "thetas", ",", "tower"}], "}"}], 
       ",", "\"\<In\>\""}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"reps", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"First", "[", "#", "]"}], "\[Rule]", 
          RowBox[{"Last", "[", "#", "]"}]}], "&"}], ",", 
        RowBox[{"Thread", "[", 
         RowBox[{"{", 
          RowBox[{"thetas", ",", "tower"}], "}"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"c", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"test", "/", "rhs"}], ")"}], "//.", "reps"}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"rischLog", "\[Rule]", "Log"}], ",", 
         RowBox[{"rischExp", "\[Rule]", "Exp"}]}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Of", " ", "course"}], ",", " ", 
       RowBox[{
       "the", " ", "following", " ", "line", " ", "will", " ", "fail", " ", 
        "if", " ", "53502384", " ", "is", " ", "a", " ", 
        "\[IndentingNewLine]", "pole", " ", "of", " ", "test", " ", "or", " ",
         "rhs"}], ",", " ", 
       RowBox[{
        RowBox[{
        "but", " ", "this", " ", "will", " ", "do", " ", "for", " ", "now"}], 
        "..."}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"c", "=", 
      RowBox[{"c", "/.", 
       RowBox[{
        RowBox[{"First", "[", "thetas", "]"}], "\[Rule]", 
        RowBox[{"51", "/", "100"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "c", " ", "is", " ", "in", " ", "the", " ", "constant", " ", "field", 
       " ", "of", " ", 
       RowBox[{"integrand", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"RischTrace", "[", 
      RowBox[{"structureconstantexp", ",", "c", ",", "\"\<Out\>\""}], "]"}], 
     ";", "\[IndentingNewLine]", "c"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.406190476200131*^9, 3.4061905434181547`*^9}, {
   3.4061907418212852`*^9, 3.4061908323954144`*^9}, 3.4061908796499033`*^9, {
   3.4061909359264383`*^9, 3.40619094394064*^9}, {3.4061910005151653`*^9, 
   3.40619111682969*^9}, {3.4061914831200857`*^9, 3.4061914927411413`*^9}, {
   3.4061917858897963`*^9, 3.406191787878954*^9}, {3.406192025966221*^9, 
   3.40619203911712*^9}, {3.406193357638068*^9, 3.406193365356735*^9}, {
   3.406193428889118*^9, 3.406193441670244*^9}, {3.4061936230290537`*^9, 
   3.406193653497147*^9}, {3.406193704657197*^9, 3.406193708078026*^9}, {
   3.406193778092245*^9, 3.406193778281144*^9}, {3.406193894308176*^9, 
   3.4061939416182613`*^9}, {3.406193995579681*^9, 3.4061940504046917`*^9}, {
   3.4061941131285*^9, 3.406194116216744*^9}, {3.406194368591537*^9, 
   3.406194369313279*^9}, {3.406194416173255*^9, 3.4061944479036837`*^9}, {
   3.4061946015703487`*^9, 3.4061946047022123`*^9}, {3.406275573855854*^9, 
   3.406275574152418*^9}, {3.406275609972597*^9, 3.406275629123329*^9}, {
   3.406276897959394*^9, 3.4062769716130857`*^9}, {3.406277027459003*^9, 
   3.406277048613512*^9}, {3.406277274854375*^9, 3.406277277588932*^9}, {
   3.406277802757596*^9, 3.406277804140904*^9}, {3.4062791750213737`*^9, 
   3.406279180644335*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Exponential Case", "Subsection",
 CellChangeTimes->{{3.3942504154352503`*^9, 3.3942504219196253`*^9}, 
   3.4062699752827177`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ExpStructure", "[", 
   RowBox[{
   "test_", ",", "inthetas_", ",", "intower_", ",", "inDtower_", ",", "nums_",
     ",", "reps_"}], "]"}], ":=", 
  RowBox[{"Catch", "[", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"thetas", "=", "inthetas"}], ",", 
       RowBox[{"tower", "=", "intower"}], ",", 
       RowBox[{"Dtower", "=", "inDtower"}], ",", "arg", ",", 
       "\[IndentingNewLine]", "eqnrhs", ",", "exps", ",", "logs", ",", "n", 
       ",", "eqnlhs", ",", "sol", ",", "res", ",", "rhs", ",", "c"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"RischTrace", "[", 
       RowBox[{"ExpStructure", ",", 
        RowBox[{"{", 
         RowBox[{"test", ",", "thetas", ",", "tower", ",", "Dtower"}], "}"}], 
        ",", "\"\<In\>\""}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Implementation", " ", "of", " ", "equation", " ", "9.9", " ", "from", 
        " ", 
        RowBox[{"Bronstein", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
         "With", " ", "b", " ", "in", " ", "K", " ", "and", " ", "t"}], " ", 
         "=", " ", 
         RowBox[{"exp", 
          RowBox[{"(", "b", ")"}]}]}], ",", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"i", ".", "e", ".", " ", "Dt"}], "/", "t"}], " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Db", ".", " ", "If"}], " ", 
           RowBox[{"(", "9.9", ")"}], " ", "has", " ", "a", " ", "solution", 
           " ", "r_i", " ", "in", " ", "Q", "\[IndentingNewLine]", "then", 
           " ", "it", " ", "provides", " ", "a", " ", "nonzero", " ", 
           "integer", " ", "e", " ", "and", " ", "u", " ", "in", " ", "Kstar",
            " ", "such", " ", "that", " ", "eDb"}], " ", "=", " ", 
          RowBox[{"Du", "/", "u"}]}]}], ",", " ", 
        RowBox[{
         RowBox[{"hence", " ", "c"}], " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"t", "^", "e"}], ")"}], "/", "u"}], " ", "in", 
           "\[IndentingNewLine]", "Const_D", 
           RowBox[{"(", 
            RowBox[{"K", 
             RowBox[{"(", "t", ")"}]}], ")"}], " ", "and", " ", "K", 
           RowBox[{"(", "t", ")"}], " ", "is", " ", "algebraic", " ", "over", 
           " ", "C", 
           RowBox[{"(", "c", ")"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"t_", "1"}], ",", "...", ",", "t_n"}], ")"}], " ", 
           "since", " ", 
           RowBox[{"t", "^", "e"}]}], " ", "=", " ", 
          RowBox[{"cu", ".", " ", "Otherwise"}]}]}], ",", " ", 
        RowBox[{
         RowBox[{
         "Db", " ", "is", " ", "not", " ", "the", "\[IndentingNewLine]", " ", 
          "logarithmic", " ", "derivative", " ", "of", " ", "a", " ", "K"}], 
         "-", "radical"}], ",", " ", 
        RowBox[{
        "so", " ", "t", " ", "is", " ", "a", " ", "monomial", " ", "over", 
         " ", "K", " ", "having", " ", "the", " ", "same", " ", "constant", 
         " ", 
         RowBox[{"field", "."}]}]}], "\[IndentingNewLine]", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"arg", "=", 
       RowBox[{"test", "/.", 
        RowBox[{
         RowBox[{"rischExp", "[", "a_", "]"}], ":>", "a"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"rhs", " ", "of", " ", "equation", " ", "9.8"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"eqnrhs", "=", 
       RowBox[{
        RowBox[{"Cancel", "[", 
         RowBox[{"TotalDerivation", "[", 
          RowBox[{"arg", ",", "thetas", ",", "Dtower"}], "]"}], "]"}], "//.", 
        "reps"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "determine", " ", "equations", " ", "9.6", " ", "and", " ", "9.7"}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"exps", ",", "logs"}], "}"}], "=", 
       RowBox[{"findlogexp", "[", "tower", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"lhs", " ", "of", " ", "equation", " ", "9.9"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"n", ",", "eqnlhs"}], "}"}], "=", 
       RowBox[{"buildlhs", "[", 
        RowBox[{"exps", ",", "logs", ",", "thetas", ",", "Dtower"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"eqnlhs", "=", 
       RowBox[{"eqnlhs", "//.", "reps"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"solve", " ", "lhs"}], " ", "=", " ", 
        RowBox[{"rhs", " ", "for", " ", "the", " ", "unknown", " ", 
         RowBox[{
          RowBox[{"Risch`r", "[", "_", "]"}], "'"}], "s"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"sol", "=", 
       RowBox[{"structuresolve", "[", 
        RowBox[{"eqnlhs", ",", "eqnrhs", ",", "thetas", ",", "n"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"are", " ", "solution", 
        RowBox[{"(", "s", ")"}], " ", 
        RowBox[{"rational", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"SameQ", "[", 
         RowBox[{"sol", ",", "$Failed"}], "]"}], ",", "\[IndentingNewLine]", 
        "\t", 
        RowBox[{
         RowBox[{"Dtower", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"Dtower", ",", 
            RowBox[{"{", 
             RowBox[{"Cancel", "[", 
              RowBox[{
               RowBox[{"TotalDerivation", "[", 
                RowBox[{"test", ",", "thetas", ",", "Dtower"}], "]"}], "//.", 
               "reps"}], "]"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         "\t", 
         RowBox[{"thetas", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"thetas", ",", 
            RowBox[{"{", 
             RowBox[{"theta", "[", 
              RowBox[{"Length", "[", "thetas", "]"}], "]"}], "}"}]}], "]"}]}],
          ";", "\[IndentingNewLine]", "\t", 
         RowBox[{"tower", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"tower", ",", 
            RowBox[{"{", 
             RowBox[{"rischExp", "[", 
              RowBox[{"arg", "//.", "reps"}], "]"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{"res", "=", 
          RowBox[{"{", 
           RowBox[{
           "False", ",", "test", ",", "thetas", ",", "tower", ",", "Dtower", 
            ",", "nums"}], "}"}]}], ";", "\[IndentingNewLine]", "\t", 
         RowBox[{"RischTrace", "[", 
          RowBox[{"ExpStructure", ",", "res", ",", "\"\<Out\>\""}], "]"}], 
         ";", "\[IndentingNewLine]", "\t", 
         RowBox[{"Throw", "[", 
          RowBox[{"{", 
           RowBox[{
           "False", ",", "test", ",", "thetas", ",", "tower", ",", "Dtower", 
            ",", "nums"}], "}"}], "]"}]}]}], "\[IndentingNewLine]", "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"solutions", " ", "are", " ", "rational"}], " ", "=", 
        RowBox[{">", " ", 
         RowBox[{"algebraically", " ", "dependent"}]}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"rhs", "=", 
       RowBox[{"buildnewexptheta", "[", 
        RowBox[{"sol", ",", "tower", ",", "thetas"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"determine", " ", "constant", " ", "of", " ", "integration"}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"structureconstantexp", "[", 
        RowBox[{"test", ",", "rhs", ",", "thetas", ",", "tower"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"determine", " ", "new", " ", "theta"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"res", "=", 
       RowBox[{"{", 
        RowBox[{"True", ",", 
         RowBox[{"c", " ", "rhs"}], ",", "thetas", ",", "tower", ",", 
         "Dtower", ",", "nums"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"RischTrace", "[", 
       RowBox[{"ExpStructure", ",", "res", ",", "\"\<Out\>\""}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Throw", "[", "res", "]"}]}]}], "\[IndentingNewLine]", "]"}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJwdz00ow2EAx/G1XGSWMgfNYZMlRqGwRGvZSpbDFHOQ2NqF5ECGuJhWToq/
kQO1YmjDYcNta7NleWu7IBNNXv5zwN6aleb5PYdvn/NXrBvrNnA5HI6QBD3p
ZtfPIKtgBKwXvp07HuDs6WoExjdMz3BR+fQOlfl1mjhRJrL3wLylgcoEMVSu
p37cJ9uSxJm/DLW9uo+B5lvuGgxqL3wwY5P7Ycuv6RsuNC5RraMWfoooWRYX
wWxuJQ1VtetU6fQJJ03c4Yep9mY1D3qYwiLYrckK4W7wsAxWBH318MX5ReVN
sr0w0mTUwkBpSAdj7i49FMzb9yaGWAW35pNqtZUdwVavyQXdVXNeuH8XoHbc
XCeg9EqWhK9hSXaTyBs3UBmja3uLmJuKUi3egjOljlUcHxT74WXsMQRH7PIw
dMpEnSricIlZDd38/lSDnnw5otR/Ni7xtw==
  "]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ExpStructure", "[", 
  RowBox[{
   RowBox[{"rischExp", "[", 
    RowBox[{"7", "x"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"theta", "[", "1", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"rischExp", "[", "x", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"theta", "[", "1", "]"}]}], "}"}], ",", 
   RowBox[{"{", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.406276424062108*^9, 3.406276458500197*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"True", ",", 
   SuperscriptBox[
    RowBox[{"rischExp", "[", "x", "]"}], "7"], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     SubscriptBox["\<\"\[Theta]\"\>", "1"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"rischExp", "[", "x", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     SubscriptBox["\<\"\[Theta]\"\>", "1"]}], "}"}], ",", 
   RowBox[{"{", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.406276459882965*^9, 3.406276487169929*^9}, 
   3.4062767522659893`*^9, 3.40627740478333*^9, 3.406277738942811*^9, 
   3.4062787883851433`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"rischExp", "[", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"rischExp", "[", "x", "]"}]}], "+", 
    RowBox[{"x", " ", 
     RowBox[{"rischLog", "[", "x", "]"}]}]}], "]"}], "\[InvisibleSpace]", 
  "\"\<, \>\"", "\[InvisibleSpace]", "x", "\[InvisibleSpace]", "\"\<, \>\"", 
  "\[InvisibleSpace]", 
  SubscriptBox["\"\<\[Theta]\>\"", "1"], "\[InvisibleSpace]", "\"\<, \>\"", 
  "\[InvisibleSpace]", 
  SubscriptBox["\"\<\[Theta]\>\"", "3"], "\[InvisibleSpace]", "\"\<, \>\"", 
  "\[InvisibleSpace]", "x", "\[InvisibleSpace]", "\"\<, \>\"", 
  "\[InvisibleSpace]", 
  RowBox[{"rischExp", "[", "x", "]"}], "\[InvisibleSpace]", "\"\<, \>\"", 
  "\[InvisibleSpace]", 
  RowBox[{"rischLog", "[", "x", "]"}], "\[InvisibleSpace]", "\"\<, \>\"", 
  "\[InvisibleSpace]", "1", "\[InvisibleSpace]", "\"\<, \>\"", 
  "\[InvisibleSpace]", 
  SubscriptBox["\"\<\[Theta]\>\"", "1"], "\[InvisibleSpace]", "\"\<, \>\"", 
  "\[InvisibleSpace]", 
  FractionBox["1", "x"]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ExpStructure", "[", 
  RowBox[{
   RowBox[{"rischExp", "[", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"rischExp", "[", "x", "]"}]}], "+", 
     RowBox[{"x", " ", 
      RowBox[{"rischLog", "[", "x", "]"}]}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"theta", "[", "1", "]"}], ",", 
     RowBox[{"theta", "[", "3", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"rischExp", "[", "x", "]"}], ",", 
     RowBox[{"rischLog", "[", "x", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"theta", "[", "1", "]"}], ",", 
     RowBox[{"1", "/", "x"}]}], "}"}], ",", 
   RowBox[{"{", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.4065374056515102`*^9, 3.406537455603221*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"False", ",", 
   RowBox[{"rischExp", "[", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"rischExp", "[", "x", "]"}]}], "+", 
     RowBox[{"x", " ", 
      RowBox[{"rischLog", "[", "x", "]"}]}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     SubscriptBox["\<\"\[Theta]\"\>", "1"], ",", 
     SubscriptBox["\<\"\[Theta]\"\>", "3"], ",", 
     SubscriptBox["\<\"\[Theta]\"\>", "4"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"rischExp", "[", "x", "]"}], ",", 
     RowBox[{"rischLog", "[", "x", "]"}], ",", 
     RowBox[{"rischExp", "[", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"rischExp", "[", "x", "]"}]}], "+", 
       RowBox[{"x", " ", 
        RowBox[{"rischLog", "[", "x", "]"}]}]}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     SubscriptBox["\<\"\[Theta]\"\>", "1"], ",", 
     FractionBox["1", "x"], ",", 
     RowBox[{
      RowBox[{"rischExp", "[", 
       RowBox[{
        RowBox[{"-", 
         SubscriptBox["\<\"\[Theta]\"\>", "1"]}], "+", 
        RowBox[{"x", " ", 
         SubscriptBox["\<\"\[Theta]\"\>", "3"]}]}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        SubscriptBox["\<\"\[Theta]\"\>", "1"], "+", 
        SubscriptBox["\<\"\[Theta]\"\>", "3"]}], ")"}]}]}], "}"}], ",", 
   RowBox[{"{", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.406537457114024*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"buildnewexptheta", "[", 
   RowBox[{"sol_", ",", "tower_", ",", "thetas_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"res", ",", "exps", ",", "logs", ",", "pt1", ",", "pt2"}], "}"}],
     ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"RischTrace", "[", 
      RowBox[{"buildnewexptheta", ",", 
       RowBox[{"{", 
        RowBox[{"sol", ",", "tower", ",", "thetas"}], "}"}], ",", 
       "\"\<In\>\""}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"exps", "=", 
      RowBox[{"Select", "[", 
       RowBox[{"tower", ",", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{
           RowBox[{"Head", "[", "#", "]"}], ",", "rischExp"}], "]"}], "&"}]}],
        "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"logs", "=", 
      RowBox[{"Select", "[", 
       RowBox[{"tower", ",", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{
           RowBox[{"Head", "[", "#", "]"}], ",", "rischLog"}], "]"}], "&"}]}],
        "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"log", " ", "terms"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"logs", "=", 
      RowBox[{"logs", "/.", 
       RowBox[{
        RowBox[{"rischLog", "[", "a_", "]"}], "\[RuleDelayed]", "a"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"pt1", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"logs", "[", 
           RowBox[{"[", "#", "]"}], "]"}], "^", 
          RowBox[{"sol", "[", 
           RowBox[{"[", "#", "]"}], "]"}]}], "&"}], ",", 
        RowBox[{"Range", "[", 
         RowBox[{"Length", "[", "logs", "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"exp", " ", "terms"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"pt2", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"exps", "[", 
           RowBox[{"[", "#", "]"}], "]"}], "^", 
          RowBox[{"sol", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"Length", "[", "logs", "]"}], "+", "#"}], "]"}], "]"}]}],
          "&"}], ",", 
        RowBox[{"Range", "[", 
         RowBox[{"Length", "[", "exps", "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{"Times", "@@", 
       RowBox[{"Join", "[", 
        RowBox[{"pt1", ",", "pt2"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"RischTrace", "[", 
      RowBox[{"buildnewexptheta", ",", "res", ",", "\"\<Out\>\""}], "]"}], 
     ";", "\[IndentingNewLine]", "res"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.406275109469428*^9, 3.406275163069738*^9}, {
  3.4062752566330023`*^9, 3.40627529665681*^9}, {3.406275352829343*^9, 
  3.406275543822171*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Parametric Logarithmic Derivative Problem", "Subsection",
 CellChangeTimes->{{3.39430435893575*^9, 3.3943043676545*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ParametricLogarithmicDerivative", "[", 
   RowBox[{"f_", ",", "thetas_", ",", "tower_", ",", "Dtower_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "exps", ",", "logs", ",", "n", ",", "eqnlhs", ",", "reps", ",", "sol", 
      ",", "rhs", ",", "c", ",", "newtheta", ",", "newtower", ",", "res"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"RischTrace", "[", 
      RowBox[{"ParametricLogarithmicDerivative", ",", 
       RowBox[{"{", 
        RowBox[{"f", ",", "thetas", ",", "tower", ",", "Dtower"}], "}"}], 
       ",", "\"\<In\>\""}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Solve", " ", "the", " ", "parametric", " ", "logarithmic", " ", 
       "derivative", " ", "problem", " ", "using", " ", "the", " ", 
       "structure", " ", "theorem", " ", 
       RowBox[{"approach", ".", "\[IndentingNewLine]", "See"}], " ", 
       "Bronstein", " ", "p", ".250", " ", "onwards"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"reps", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"First", "[", "#", "]"}], "\[Rule]", 
          RowBox[{"Last", "[", "#", "]"}]}], "&"}], ",", 
        RowBox[{"Thread", "[", 
         RowBox[{"{", 
          RowBox[{"tower", ",", "thetas"}], "}"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"rhs", " ", "of", " ", "equation", " ", "9.8"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "determine", " ", "equations", " ", "9.6", " ", "and", " ", "9.7"}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"exps", ",", "logs"}], "}"}], "=", 
      RowBox[{"findlogexp", "[", "tower", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"lhs", " ", "of", " ", "equation", " ", "9.8"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"n", ",", "eqnlhs"}], "}"}], "=", 
      RowBox[{"buildlhs", "[", 
       RowBox[{"exps", ",", "logs", ",", "thetas", ",", "Dtower"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"eqnlhs", "=", 
      RowBox[{"eqnlhs", "//.", "reps"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"solve", " ", "lhs"}], " ", "=", " ", 
       RowBox[{"rhs", " ", "for", " ", "the", " ", "unknown", " ", 
        RowBox[{
         RowBox[{"Risch`r", "[", "_", "]"}], "'"}], "s"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"{", 
       RowBox[{"eqnlhs", ",", "f", ",", "thetas", ",", "n"}], "}"}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"sol", "=", 
      RowBox[{"structuresolve", "[", 
       RowBox[{"eqnlhs", ",", "f", ",", "thetas", ",", "n"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"are", " ", "solution", 
       RowBox[{"(", "s", ")"}], " ", 
       RowBox[{"rational", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"SameQ", "[", 
        RowBox[{"sol", ",", "$Failed"}], "]"}], ",", "\[IndentingNewLine]", 
       "\t", 
       RowBox[{
        RowBox[{"RischTrace", "[", 
         RowBox[{"LogStructure", ",", "res", ",", "\"\<Out\>\""}], "]"}], ";",
         "\[IndentingNewLine]", "\t", 
        RowBox[{"Return", "[", "$Failed", "]"}]}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"solutions", " ", "are", " ", "rational"}], " ", "=", 
       RowBox[{">", " ", 
        RowBox[{"algebraically", " ", "dependent"}]}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"rhs", "=", 
      RowBox[{"buildnewexptheta", "[", 
       RowBox[{"sol", ",", "tower", ",", "thetas"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"determine", " ", "constant", " ", "of", " ", "integration"}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"c", "=", 
      RowBox[{"structureconstantlog", "[", 
       RowBox[{"f", ",", "rhs", ",", "thetas", ",", "tower"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"determine", " ", "new", " ", "theta"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"newtheta", "=", 
      RowBox[{"c", "+", "rhs"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"newtower", "=", 
      RowBox[{"tower", "//.", 
       RowBox[{"f", "\[Rule]", "newtheta"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{"Join", "[", 
       RowBox[{"sol", ",", 
        RowBox[{"{", "rhs", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"RischTrace", "[", 
      RowBox[{
      "ParametricLogarithmicDerivative", ",", "res", ",", "\"\<Out\>\""}], 
      "]"}], ";", "\[IndentingNewLine]", "res"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.406672138693469*^9, 3.406672234789208*^9}, {
  3.406672385588128*^9, 3.406672400764879*^9}, {3.406672667702962*^9, 
  3.4066726695943613`*^9}, {3.407986902047729*^9, 3.407986995097451*^9}, {
  3.407987098690769*^9, 3.4079871398148823`*^9}, {3.4079872315848923`*^9, 
  3.407987232926858*^9}, {3.407987272863235*^9, 3.407987302534481*^9}, {
  3.4079873790645037`*^9, 3.407987403405725*^9}, {3.4079874379762287`*^9, 
  3.407987438518137*^9}, {3.409016606815032*^9, 3.409016607522287*^9}, {
  3.4173400804830217`*^9, 3.417340110087438*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ParametricLogarithmicDerivative", "[", 
  RowBox[{"11", ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"theta", "[", "1", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"rischExp", "[", "x", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"theta", "[", "1", "]"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.4079873067857*^9, 3.4079873125646553`*^9}, {
  3.407987347110691*^9, 3.407987360595642*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 FormBox[
  InterpretationBox[
   RowBox[{"\<\"Enter \"\>", 
    "\[InvisibleSpace]", "\<\"ParametricLogarithmicDerivative\"\>", 
    "\[InvisibleSpace]", "\<\": \"\>", "\[InvisibleSpace]", 
    InterpretationBox[
     RowBox[{
     "11", "\[InvisibleSpace]", "\<\", \"\>", "\[InvisibleSpace]", "x", 
      "\[InvisibleSpace]", "\<\", \"\>", "\[InvisibleSpace]", 
      SubscriptBox["\[Theta]", "1"], "\[InvisibleSpace]", "\<\", \"\>", 
      "\[InvisibleSpace]", "x", "\[InvisibleSpace]", "\<\", \"\>", 
      "\[InvisibleSpace]", 
      RowBox[{"rischExp", "(", "x", ")"}], "\[InvisibleSpace]", "\<\", \"\>", 
      "\[InvisibleSpace]", "1", "\[InvisibleSpace]", "\<\", \"\>", 
      "\[InvisibleSpace]", 
      SubscriptBox["\[Theta]", "1"]}],
     Row[{11, ", ", $CellContext`x, ", ", 
       Subscript[$CellContext`\[Theta], 1], ", ", $CellContext`x, ", ", 
       $CellContext`rischExp[$CellContext`x], ", ", 1, ", ", 
       Subscript[$CellContext`\[Theta], 1]}]]}],
   SequenceForm["Enter ", "ParametricLogarithmicDerivative", ": ", 
    Row[{11, ", ", $CellContext`x, ", ", 
      Subscript[$CellContext`\[Theta], 1], ", ", $CellContext`x, ", ", 
      $CellContext`rischExp[$CellContext`x], ", ", 1, ", ", 
      Subscript[$CellContext`\[Theta], 1]}]],
   Editable->False], TraditionalForm]], "Print",
 CellChangeTimes->{{3.4173400846382513`*^9, 3.4173401110964327`*^9}}],

Cell[BoxData[
 FormBox[
  InterpretationBox[
   RowBox[{"\<\"Enter \"\>", "\[InvisibleSpace]", "\<\"findlogexp\"\>", 
    "\[InvisibleSpace]", "\<\": \"\>", "\[InvisibleSpace]", 
    InterpretationBox[
     RowBox[{"x", "\[InvisibleSpace]", "\<\", \"\>", "\[InvisibleSpace]", 
      RowBox[{"rischExp", "(", "x", ")"}]}],
     Row[{$CellContext`x, ", ", 
       $CellContext`rischExp[$CellContext`x]}]]}],
   SequenceForm["Enter ", "findlogexp", ": ", 
    Row[{$CellContext`x, ", ", 
      $CellContext`rischExp[$CellContext`x]}]],
   Editable->False], TraditionalForm]], "Print",
 CellChangeTimes->{{3.4173400846382513`*^9, 3.4173401111010723`*^9}}],

Cell[BoxData[
 FormBox[
  InterpretationBox[
   RowBox[{"\<\"Exit \"\>", "\[InvisibleSpace]", "\<\"findlogexp\"\>", 
    "\[InvisibleSpace]", "\<\": \"\>", "\[InvisibleSpace]", 
    InterpretationBox["x",
     Row[{$CellContext`x}]]}],
   SequenceForm["Exit ", "findlogexp", ": ", 
    Row[{$CellContext`x}]],
   Editable->False], TraditionalForm]], "Print",
 CellChangeTimes->{{3.4173400846382513`*^9, 3.4173401111056232`*^9}}],

Cell[BoxData[
 FormBox[
  InterpretationBox[
   RowBox[{"\<\"Enter \"\>", "\[InvisibleSpace]", "\<\"buildlhs\"\>", 
    "\[InvisibleSpace]", "\<\": \"\>", "\[InvisibleSpace]", 
    InterpretationBox[
     RowBox[{
     "x", "\[InvisibleSpace]", "\<\", \"\>", "\[InvisibleSpace]", "x", 
      "\[InvisibleSpace]", "\<\", \"\>", "\[InvisibleSpace]", 
      SubscriptBox["\[Theta]", "1"], "\[InvisibleSpace]", "\<\", \"\>", 
      "\[InvisibleSpace]", "1", "\[InvisibleSpace]", "\<\", \"\>", 
      "\[InvisibleSpace]", 
      SubscriptBox["\[Theta]", "1"]}],
     Row[{$CellContext`x, ", ", $CellContext`x, ", ", 
       Subscript[$CellContext`\[Theta], 1], ", ", 1, ", ", 
       Subscript[$CellContext`\[Theta], 1]}]]}],
   SequenceForm["Enter ", "buildlhs", ": ", 
    Row[{$CellContext`x, ", ", $CellContext`x, ", ", 
      Subscript[$CellContext`\[Theta], 1], ", ", 1, ", ", 
      Subscript[$CellContext`\[Theta], 1]}]],
   Editable->False], TraditionalForm]], "Print",
 CellChangeTimes->{{3.4173400846382513`*^9, 3.417340111110111*^9}}],

Cell[BoxData[
 FormBox[
  InterpretationBox[
   RowBox[{"\<\"Enter \"\>", "\[InvisibleSpace]", "\<\"TotalDerivation\"\>", 
    "\[InvisibleSpace]", "\<\": \"\>", "\[InvisibleSpace]", 
    InterpretationBox[
     RowBox[{
     "x", "\[InvisibleSpace]", "\<\", \"\>", "\[InvisibleSpace]", "x", 
      "\[InvisibleSpace]", "\<\", \"\>", "\[InvisibleSpace]", 
      SubscriptBox["\[Theta]", "1"], "\[InvisibleSpace]", "\<\", \"\>", 
      "\[InvisibleSpace]", "1", "\[InvisibleSpace]", "\<\", \"\>", 
      "\[InvisibleSpace]", 
      SubscriptBox["\[Theta]", "1"]}],
     Row[{$CellContext`x, ", ", $CellContext`x, ", ", 
       Subscript[$CellContext`\[Theta], 1], ", ", 1, ", ", 
       Subscript[$CellContext`\[Theta], 1]}]]}],
   SequenceForm["Enter ", "TotalDerivation", ": ", 
    Row[{$CellContext`x, ", ", $CellContext`x, ", ", 
      Subscript[$CellContext`\[Theta], 1], ", ", 1, ", ", 
      Subscript[$CellContext`\[Theta], 1]}]],
   Editable->False], TraditionalForm]], "Print",
 CellChangeTimes->{{3.4173400846382513`*^9, 3.417340111114732*^9}}],

Cell[BoxData[
 FormBox[
  InterpretationBox[
   RowBox[{"\<\"Enter \"\>", "\[InvisibleSpace]", "\<\"TotalDerivation\"\>", 
    "\[InvisibleSpace]", "\<\": \"\>", "\[InvisibleSpace]", "1"}],
   SequenceForm["Enter ", "TotalDerivation", ": ", 1],
   Editable->False], TraditionalForm]], "Print",
 CellChangeTimes->{{3.4173400846382513`*^9, 3.417340111119152*^9}}],

Cell[BoxData[
 FormBox[
  InterpretationBox[
   RowBox[{"\<\"Exit \"\>", "\[InvisibleSpace]", "\<\"buildlhs\"\>", 
    "\[InvisibleSpace]", "\<\": \"\>", "\[InvisibleSpace]", 
    InterpretationBox[
     RowBox[{"1", "\[InvisibleSpace]", "\<\", \"\>", "\[InvisibleSpace]", 
      RowBox[{"Risch`r", "(", "1", ")"}]}],
     Row[{1, ", ", 
       Risch`r[1]}]]}],
   SequenceForm["Exit ", "buildlhs", ": ", 
    Row[{1, ", ", 
      Risch`r[1]}]],
   Editable->False], TraditionalForm]], "Print",
 CellChangeTimes->{{3.4173400846382513`*^9, 3.417340111123487*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Risch`r", "(", "1", ")"}], ",", "11", ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", 
      SubscriptBox["\[Theta]", "1"]}], "}"}], ",", "1"}], "}"}], 
  TraditionalForm]], "Print",
 CellChangeTimes->{{3.4173400846382513`*^9, 3.417340111127864*^9}}],

Cell[BoxData[
 FormBox[
  InterpretationBox[
   RowBox[{"\<\"Enter \"\>", "\[InvisibleSpace]", "\<\"structuresolve\"\>", 
    "\[InvisibleSpace]", "\<\": \"\>", "\[InvisibleSpace]", 
    InterpretationBox[
     RowBox[{
      RowBox[{"Risch`r", "(", "1", ")"}], "\[InvisibleSpace]", "\<\", \"\>", 
      "\[InvisibleSpace]", "11"}],
     Row[{
       Risch`r[1], ", ", 11}]]}],
   SequenceForm["Enter ", "structuresolve", ": ", 
    Row[{
      Risch`r[1], ", ", 11}]],
   Editable->False], TraditionalForm]], "Print",
 CellChangeTimes->{{3.4173400846382513`*^9, 3.4173401111519012`*^9}}],

Cell[BoxData[
 FormBox[
  InterpretationBox[
   RowBox[{"\<\"Exit \"\>", "\[InvisibleSpace]", "\<\"structuresolve\"\>", 
    "\[InvisibleSpace]", "\<\": \"\>", "\[InvisibleSpace]", 
    InterpretationBox["11",
     Row[{11}]]}],
   SequenceForm["Exit ", "structuresolve", ": ", 
    Row[{11}]],
   Editable->False], TraditionalForm]], "Print",
 CellChangeTimes->{{3.4173400846382513`*^9, 3.4173401111920843`*^9}}],

Cell[BoxData[
 FormBox[
  InterpretationBox[
   RowBox[{"\<\"Enter \"\>", "\[InvisibleSpace]", "\<\"buildnewexptheta\"\>", 
    "\[InvisibleSpace]", "\<\": \"\>", "\[InvisibleSpace]", 
    InterpretationBox[
     RowBox[{
     "11", "\[InvisibleSpace]", "\<\", \"\>", "\[InvisibleSpace]", "x", 
      "\[InvisibleSpace]", "\<\", \"\>", "\[InvisibleSpace]", 
      RowBox[{"rischExp", "(", "x", ")"}], "\[InvisibleSpace]", "\<\", \"\>", 
      "\[InvisibleSpace]", "x", "\[InvisibleSpace]", "\<\", \"\>", 
      "\[InvisibleSpace]", 
      SubscriptBox["\[Theta]", "1"]}],
     Row[{11, ", ", $CellContext`x, ", ", 
       $CellContext`rischExp[$CellContext`x], ", ", $CellContext`x, ", ", 
       Subscript[$CellContext`\[Theta], 1]}]]}],
   SequenceForm["Enter ", "buildnewexptheta", ": ", 
    Row[{11, ", ", $CellContext`x, ", ", 
      $CellContext`rischExp[$CellContext`x], ", ", $CellContext`x, ", ", 
      Subscript[$CellContext`\[Theta], 1]}]],
   Editable->False], TraditionalForm]], "Print",
 CellChangeTimes->{{3.4173400846382513`*^9, 3.417340111229368*^9}}],

Cell[BoxData[
 FormBox[
  InterpretationBox[
   RowBox[{"\<\"Exit \"\>", "\[InvisibleSpace]", "\<\"buildnewexptheta\"\>", 
    "\[InvisibleSpace]", "\<\": \"\>", "\[InvisibleSpace]", 
    SuperscriptBox[
     RowBox[{"rischExp", "(", "x", ")"}], "11"]}],
   SequenceForm[
   "Exit ", "buildnewexptheta", 
    ": ", $CellContext`rischExp[$CellContext`x]^11],
   Editable->False], TraditionalForm]], "Print",
 CellChangeTimes->{{3.4173400846382513`*^9, 3.417340111261631*^9}}],

Cell[BoxData[
 FormBox[
  InterpretationBox[
   RowBox[{"\<\"Enter \"\>", 
    "\[InvisibleSpace]", "\<\"structureconstantlog\"\>", 
    "\[InvisibleSpace]", "\<\": \"\>", "\[InvisibleSpace]", 
    InterpretationBox[
     RowBox[{"11", "\[InvisibleSpace]", "\<\", \"\>", "\[InvisibleSpace]", 
      SuperscriptBox[
       RowBox[{"rischExp", "(", "x", ")"}], "11"], 
      "\[InvisibleSpace]", "\<\", \"\>", "\[InvisibleSpace]", "x", 
      "\[InvisibleSpace]", "\<\", \"\>", "\[InvisibleSpace]", 
      SubscriptBox["\[Theta]", "1"], "\[InvisibleSpace]", "\<\", \"\>", 
      "\[InvisibleSpace]", "x", "\[InvisibleSpace]", "\<\", \"\>", 
      "\[InvisibleSpace]", 
      RowBox[{"rischExp", "(", "x", ")"}]}],
     Row[{
      11, ", ", $CellContext`rischExp[$CellContext`x]^11, 
       ", ", $CellContext`x, ", ", 
       Subscript[$CellContext`\[Theta], 1], ", ", $CellContext`x, ", ", 
       $CellContext`rischExp[$CellContext`x]}]]}],
   SequenceForm["Enter ", "structureconstantlog", ": ", 
    Row[{11, ", ", $CellContext`rischExp[$CellContext`x]^11, 
      ", ", $CellContext`x, ", ", 
      Subscript[$CellContext`\[Theta], 1], ", ", $CellContext`x, ", ", 
      $CellContext`rischExp[$CellContext`x]}]],
   Editable->False], TraditionalForm]], "Print",
 CellChangeTimes->{{3.4173400846382513`*^9, 3.4173401112955*^9}}],

Cell[BoxData[
 FormBox[
  InterpretationBox[
   RowBox[{"\<\"Exit \"\>", 
    "\[InvisibleSpace]", "\<\"structureconstantlog\"\>", 
    "\[InvisibleSpace]", "\<\": \"\>", "\[InvisibleSpace]", 
    RowBox[{"11", "-", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"539", "/", "100"}]]}]}],
   SequenceForm[
   "Exit ", "structureconstantlog", ": ", 11 - E^Rational[539, 100]],
   Editable->False], TraditionalForm]], "Print",
 CellChangeTimes->{{3.4173400846382513`*^9, 3.417340111329111*^9}}],

Cell[BoxData[
 FormBox[
  InterpretationBox[
   RowBox[{"\<\"Exit \"\>", 
    "\[InvisibleSpace]", "\<\"ParametricLogarithmicDerivative\"\>", 
    "\[InvisibleSpace]", "\<\": \"\>", "\[InvisibleSpace]", 
    InterpretationBox[
     RowBox[{"11", "\[InvisibleSpace]", "\<\", \"\>", "\[InvisibleSpace]", 
      SuperscriptBox[
       RowBox[{"rischExp", "(", "x", ")"}], "11"]}],
     Row[{11, ", ", $CellContext`rischExp[$CellContext`x]^11}]]}],
   SequenceForm["Exit ", "ParametricLogarithmicDerivative", ": ", 
    Row[{11, ", ", $CellContext`rischExp[$CellContext`x]^11}]],
   Editable->False], TraditionalForm]], "Print",
 CellChangeTimes->{{3.4173400846382513`*^9, 3.4173401113629837`*^9}}]
}, Open  ]],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{"11", ",", 
    SuperscriptBox[
     RowBox[{"rischExp", "(", "x", ")"}], "11"]}], "}"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{{3.4079873658174562`*^9, 3.407987406234496*^9}, 
   3.407987443069277*^9, 3.417340005418722*^9, {3.4173400849887123`*^9, 
   3.417340111395782*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ParametricLogarithmicDerivative", "[", 
  RowBox[{"11", ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"theta", "[", "1", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"rischExp", "[", "x", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"theta", "[", "1", "]"}]}], "}"}]}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 FormBox[
  InterpretationBox[
   RowBox[{"\<\"Enter \"\>", 
    "\[InvisibleSpace]", "\<\"ParametricLogarithmicDerivative\"\>", 
    "\[InvisibleSpace]", "\<\": \"\>", "\[InvisibleSpace]", 
    RowBox[{"{", 
     RowBox[{"11", ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", 
        SubscriptBox["\[Theta]", "1"]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", 
        RowBox[{"rischExp", "(", "x", ")"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", 
        SubscriptBox["\[Theta]", "1"]}], "}"}]}], "}"}]}],
   SequenceForm[
   "Enter ", "ParametricLogarithmicDerivative", ": ", {11, {$CellContext`x, 
      Subscript[$CellContext`\[Theta], 1]}, {$CellContext`x, 
      $CellContext`rischExp[$CellContext`x]}, {1, 
      Subscript[$CellContext`\[Theta], 1]}}],
   Editable->False], TraditionalForm]], "Print",
 CellChangeTimes->{3.417340018848051*^9}],

Cell[BoxData[
 FormBox[
  InterpretationBox[
   RowBox[{"\<\"Enter \"\>", "\[InvisibleSpace]", "\<\"findlogexp\"\>", 
    "\[InvisibleSpace]", "\<\": \"\>", "\[InvisibleSpace]", 
    RowBox[{"{", 
     RowBox[{"x", ",", 
      RowBox[{"rischExp", "(", "x", ")"}]}], "}"}]}],
   SequenceForm["Enter ", "findlogexp", ": ", {$CellContext`x, 
     $CellContext`rischExp[$CellContext`x]}],
   Editable->False], TraditionalForm]], "Print",
 CellChangeTimes->{3.417340018851265*^9}],

Cell[BoxData[
 FormBox[
  InterpretationBox[
   RowBox[{"\<\"Exit \"\>", "\[InvisibleSpace]", "\<\"findlogexp\"\>", 
    "\[InvisibleSpace]", "\<\": \"\>", "\[InvisibleSpace]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "x", "}"}], ",", 
      RowBox[{"{", "}"}]}], "}"}]}],
   SequenceForm["Exit ", "findlogexp", ": ", {{$CellContext`x}, {}}],
   Editable->False], TraditionalForm]], "Print",
 CellChangeTimes->{3.417340018856379*^9}],

Cell[BoxData[
 FormBox[
  InterpretationBox[
   RowBox[{"\<\"Enter \"\>", "\[InvisibleSpace]", "\<\"buildlhs\"\>", 
    "\[InvisibleSpace]", "\<\": \"\>", "\[InvisibleSpace]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "x", "}"}], ",", 
      RowBox[{"{", "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", 
        SubscriptBox["\[Theta]", "1"]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", 
        SubscriptBox["\[Theta]", "1"]}], "}"}]}], "}"}]}],
   SequenceForm[
   "Enter ", "buildlhs", ": ", {{$CellContext`x}, {}, {$CellContext`x, 
      Subscript[$CellContext`\[Theta], 1]}, {1, 
      Subscript[$CellContext`\[Theta], 1]}}],
   Editable->False], TraditionalForm]], "Print",
 CellChangeTimes->{3.417340018861507*^9}],

Cell[BoxData[
 FormBox[
  InterpretationBox[
   RowBox[{"\<\"Enter \"\>", "\[InvisibleSpace]", "\<\"TotalDerivation\"\>", 
    "\[InvisibleSpace]", "\<\": \"\>", "\[InvisibleSpace]", 
    RowBox[{"{", 
     RowBox[{"x", ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", 
        SubscriptBox["\[Theta]", "1"]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", 
        SubscriptBox["\[Theta]", "1"]}], "}"}]}], "}"}]}],
   SequenceForm[
   "Enter ", "TotalDerivation", ": ", {$CellContext`x, {$CellContext`x, 
      Subscript[$CellContext`\[Theta], 1]}, {1, 
      Subscript[$CellContext`\[Theta], 1]}}],
   Editable->False], TraditionalForm]], "Print",
 CellChangeTimes->{3.4173400188665543`*^9}],

Cell[BoxData[
 FormBox[
  InterpretationBox[
   RowBox[{"\<\"Enter \"\>", "\[InvisibleSpace]", "\<\"TotalDerivation\"\>", 
    "\[InvisibleSpace]", "\<\": \"\>", "\[InvisibleSpace]", "1"}],
   SequenceForm["Enter ", "TotalDerivation", ": ", 1],
   Editable->False], TraditionalForm]], "Print",
 CellChangeTimes->{3.417340018871359*^9}],

Cell[BoxData[
 FormBox[
  InterpretationBox[
   RowBox[{"\<\"Exit \"\>", "\[InvisibleSpace]", "\<\"buildlhs\"\>", 
    "\[InvisibleSpace]", "\<\": \"\>", "\[InvisibleSpace]", 
    RowBox[{"{", 
     RowBox[{"1", ",", 
      RowBox[{"Risch`r", "(", "1", ")"}]}], "}"}]}],
   SequenceForm["Exit ", "buildlhs", ": ", {1, 
     Risch`r[1]}],
   Editable->False], TraditionalForm]], "Print",
 CellChangeTimes->{3.417340018876177*^9}],

Cell[BoxData[
 FormBox[
  InterpretationBox[
   RowBox[{"\<\"Enter \"\>", "\[InvisibleSpace]", "\<\"structuresolve\"\>", 
    "\[InvisibleSpace]", "\<\": \"\>", "\[InvisibleSpace]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Risch`r", "(", "1", ")"}], ",", "11"}], "}"}]}],
   SequenceForm["Enter ", "structuresolve", ": ", {
     Risch`r[1], 11}],
   Editable->False], TraditionalForm]], "Print",
 CellChangeTimes->{3.4173400188810387`*^9}],

Cell[BoxData[
 FormBox[
  InterpretationBox[
   RowBox[{"\<\"Exit \"\>", "\[InvisibleSpace]", "\<\"structuresolve\"\>", 
    "\[InvisibleSpace]", "\<\": \"\>", "\[InvisibleSpace]", "$Failed"}],
   SequenceForm["Exit ", "structuresolve", ": ", $Failed],
   Editable->False], TraditionalForm]], "Print",
 CellChangeTimes->{3.417340018885683*^9}],

Cell[BoxData[
 FormBox[
  InterpretationBox[
   RowBox[{"\<\"Exit \"\>", 
    "\[InvisibleSpace]", "\<\"ParametricLogarithmicDerivative\"\>", 
    "\[InvisibleSpace]", "\<\": \"\>", "\[InvisibleSpace]", "$Failed"}],
   SequenceForm["Exit ", "ParametricLogarithmicDerivative", ": ", $Failed],
   Editable->False], TraditionalForm]], "Print",
 CellChangeTimes->{3.417340018890316*^9}]
}, Open  ]],

Cell[BoxData[
 FormBox["$Failed", TraditionalForm]], "Output",
 CellChangeTimes->{3.417340018918342*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ParametricLogarithmicDerivative", "[", 
  RowBox[{
   RowBox[{"-", 
    SqrtBox["3"]}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     SubscriptBox["\"\<\[Theta]\>\"", "1"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"rischExp", "[", "x", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     SubscriptBox["\"\<\[Theta]\>\"", "1"]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.397470576608963*^9, 3.397470581368125*^9}, {
  3.4079874311824093`*^9, 3.4079874321079187`*^9}}],

Cell[BoxData["$Failed"], "Output",
 CellChangeTimes->{{3.4079874277949553`*^9, 3.4079874446368723`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ParametricLogarithmicDerivative", "[", 
  RowBox[{
   RowBox[{"-", "1"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"theta", "[", "1", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"rischExp", "[", "x", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"theta", "[", "1", "]"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.394305704420125*^9, 3.394305725842*^9}, {
  3.407987449299638*^9, 3.407987450363738*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "1"}], ",", 
   FractionBox["1", 
    RowBox[{"rischExp", "[", "x", "]"}]]}], "}"}]], "Output",
 CellChangeTimes->{
  3.397470553203993*^9, {3.407987446992365*^9, 3.4079874505908012`*^9}}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Is the structure extended", "Subsection",
 CellChangeTimes->{{3.4088502291600437`*^9, 3.40885023791473*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"IsStructureExtended", "[", 
   RowBox[{"$Failed", ",", "thetas_", ",", "tower_"}], "]"}], ":=", 
  RowBox[{"{", "True", "}"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4088506865997353`*^9, 3.40885070306946*^9}, 
   3.4088508056608267`*^9, {3.40886640803959*^9, 3.4088664082527657`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"IsStructureExtended", "[", 
   RowBox[{"0", ",", "thetas_", ",", "tower_"}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{"False", ",", "0"}], "}"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.408852414686203*^9, 3.40885243451772*^9}, {
  3.4088664104837217`*^9, 3.408866410684905*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"IsStructureExtended", "[", 
   RowBox[{"expr_", ",", "thetas_", ",", "tower_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"reps", ",", "fun", ",", "lst", ",", "res"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
      "Checking", " ", "to", " ", "see", " ", "of", " ", "the", " ", 
       "structure", " ", "of", " ", "expr", " ", "is", " ", "contained", " ", 
       "within", " ", "the", " ", "given", " ", 
       RowBox[{"tower", ".", "\[IndentingNewLine]", "If"}], " ", "the", " ", 
       "structure", " ", "is", " ", "extended", " ", "then", " ", "we", " ", 
       "return", " ", "False"}], ",", " ", 
      RowBox[{
      "otherwise", " ", "we", " ", "return", " ", "expr", " ", "expressed", 
       " ", "using", "\[IndentingNewLine]", "the", " ", 
       RowBox[{"thetas", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"RischTrace", "[", 
      RowBox[{"IsStructureExtended", ",", 
       RowBox[{"{", 
        RowBox[{"expr", ",", "thetas", ",", "tower"}], "}"}], ",", 
       "\"\<In\>\""}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"PolynomialQ", "[", 
         RowBox[{"expr", ",", 
          RowBox[{"First", "[", "thetas", "]"}]}], "]"}], "||", 
        RowBox[{"IsIntegrandRational", "[", 
         RowBox[{"expr", ",", 
          RowBox[{"First", "[", "thetas", "]"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"RischTrace", "[", 
         RowBox[{"IsStructureExtended", ",", 
          RowBox[{"{", "True", "}"}], ",", "\"\<Out\>\""}], "]"}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"Return", "[", 
         RowBox[{"{", 
          RowBox[{"False", ",", "expr"}], "}"}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"reps", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "&"}], ",", 
        RowBox[{"Thread", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Rest", "[", "thetas", "]"}], ",", 
           RowBox[{"Rest", "[", "tower", "]"}]}], "}"}], "]"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"fun", "=", 
      RowBox[{
       RowBox[{"TrigToExp", "[", "expr", "]"}], "//.", "reps"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"call", " ", "structure", " ", "theorems"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"lst", "=", 
      RowBox[{"RischStructure", "[", 
       RowBox[{"fun", ",", 
        RowBox[{"First", "[", "thetas", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "need", " ", "to", " ", "check", " ", "that", " ", "the", " ", "new", 
        " ", "thetas", " ", "match", " ", "the", " ", "old"}], "..."}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{
        RowBox[{"lst", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "===", "tower"}], ",", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"res", "=", 
        RowBox[{"{", 
         RowBox[{"False", ",", 
          RowBox[{"First", "[", "lst", "]"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"Complement", "[", 
         RowBox[{
          RowBox[{"lst", "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", "tower"}], "]"}], "=!=", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"res", "=", 
        RowBox[{"{", "True", "}"}]}], ",", "\[IndentingNewLine]", "\t", 
       "True", ",", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"res", "=", 
        RowBox[{"{", 
         RowBox[{"False", ",", 
          RowBox[{"First", "[", "lst", "]"}]}], "}"}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"RischTrace", "[", 
      RowBox[{"IsStructureExtended", ",", "res", ",", "\"\<Out\>\""}], "]"}], 
     ";", "\[IndentingNewLine]", "res"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.408002272638707*^9, 3.408002331766029*^9}, {
   3.408002369478188*^9, 3.4080024119557333`*^9}, {3.408002450303502*^9, 
   3.4080024520249567`*^9}, {3.4081666728681307`*^9, 3.408166725801948*^9}, {
   3.4081771931726093`*^9, 3.408177193411201*^9}, {3.4088488778780327`*^9, 
   3.408848912030553*^9}, {3.408849004838833*^9, 3.4088490095404587`*^9}, {
   3.408849045321138*^9, 3.408849061055725*^9}, {3.408849137572008*^9, 
   3.40884916107198*^9}, {3.4088492000515223`*^9, 3.408849202778092*^9}, {
   3.4088492469262447`*^9, 3.408849253132976*^9}, {3.408849527162841*^9, 
   3.408849533178878*^9}, {3.408849764054778*^9, 3.408849797997933*^9}, {
   3.408849870905105*^9, 3.408849953516633*^9}, 3.4088501668079433`*^9, {
   3.408850302942781*^9, 3.408850304270039*^9}, {3.4088503595204573`*^9, 
   3.408850360061709*^9}, {3.4088519709201097`*^9, 3.40885197868716*^9}, {
   3.40885246736279*^9, 3.4088524810406523`*^9}, {3.4088528746926126`*^9, 
   3.4088529327543087`*^9}, {3.4088530132794447`*^9, 
   3.4088530164370823`*^9}, {3.4088531014397*^9, 3.408853104977765*^9}, {
   3.4088531478713923`*^9, 3.408853154188431*^9}, {3.40885325670607*^9, 
   3.408853278905039*^9}, {3.408853441285397*^9, 3.408853512668716*^9}, {
   3.408853577719157*^9, 3.408853582492227*^9}, 3.408853630176168*^9, {
   3.408861611333989*^9, 3.40886161741082*^9}, {3.408861730462699*^9, 
   3.4088617480961113`*^9}, {3.4088618860509777`*^9, 3.408861888610515*^9}, {
   3.4088621616258173`*^9, 3.408862174952771*^9}, {3.4088664130902977`*^9, 
   3.4088664132815237`*^9}, {3.409821610279752*^9, 3.409821613405491*^9}, {
   3.409822225589588*^9, 3.40982222574186*^9}, 3.41421978834315*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"IsStructureExtended", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "12"]}], " ", 
     RowBox[{"rischLog", "[", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "x"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", 
      RowBox[{"theta", "[", "1", "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", 
      RowBox[{"rischLog", "[", 
       RowBox[{"1", "-", "x"}], "]"}]}], "}"}]}], "]"}], 
  RowBox[{"(*", " ", "bug", " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.410161549525866*^9, 3.410161584497795*^9}, {
   3.41016174348494*^9, 3.4101617451373787`*^9}, 3.410161916986084*^9}],

Cell[BoxData[
 RowBox[{"{", "True", "}"}]], "Output",
 CellChangeTimes->{{3.4101615742751303`*^9, 3.410161589369361*^9}, 
   3.410161920451192*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"IsStructureExtended", "[", 
  RowBox[{
   RowBox[{"rischExp", "[", 
    RowBox[{
     RowBox[{"-", "2"}], "I", " ", "x"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"theta", "[", "1", "]"}], ",", 
     RowBox[{"theta", "[", "2", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"rischExp", "[", 
      RowBox[{"\[ImaginaryI]", " ", "x"}], "]"}], ",", 
     RowBox[{"rischExp", "[", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["1", 
           SubscriptBox["\[Theta]", "1"]]}], "+", 
         SubscriptBox["\[Theta]", "1"]}], ")"}]}], "]"}]}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.409821548854062*^9, 3.409821578093586*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"False", ",", 
   FractionBox["1", 
    SubsuperscriptBox["\[Theta]", "1", "2"]]}], "}"}]], "Output",
 CellChangeTimes->{{3.409821580073641*^9, 3.409821614413762*^9}, 
   3.409821729485815*^9, {3.4098217783159113`*^9, 3.409821792222609*^9}, 
   3.409821979486733*^9, 3.409822226604165*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"IsStructureExtended", "[", 
  RowBox[{
   RowBox[{"rischExp", "[", "x", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"theta", "[", "1", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"rischLog", "[", "x", "]"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.408851948258705*^9, 3.408851952196579*^9}, {
  3.4088529664887466`*^9, 3.408852995009841*^9}, {3.4088664206106033`*^9, 
  3.408866421768153*^9}}],

Cell[BoxData[
 RowBox[{"{", "True", "}"}]], "Output",
 CellChangeTimes->{{3.408852995784683*^9, 3.408853046155322*^9}, 
   3.408853106806163*^9, {3.4088531622777977`*^9, 3.4088531819675493`*^9}, {
   3.408853262608025*^9, 3.4088532805477753`*^9}, 3.408853516112376*^9, 
   3.408861750467766*^9, 3.408861889724853*^9, 3.408862177228602*^9, 
   3.408866422245268*^9, 3.409821136493101*^9, 3.409821599331702*^9, 
   3.409822227086973*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"IsStructureExtended", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "x"}], "+", 
    RowBox[{"x", " ", 
     RowBox[{"rischLog", "[", "x", "]"}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"theta", "[", "1", "]"}], ",", 
     RowBox[{"theta", "[", "2", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"rischLog", "[", "x", "]"}], ",", 
     RowBox[{"rischLog", "[", 
      RowBox[{"x", "+", "1"}], "]"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.408861475536721*^9, 3.4088615006973867`*^9}, {
  3.408861547612303*^9, 3.40886158537016*^9}, {3.40886642497423*^9, 
  3.40886642799289*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"False", ",", 
   RowBox[{
    RowBox[{"-", "x"}], "+", 
    RowBox[{"x", " ", 
     SubscriptBox["\[Theta]", "1"]}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.408861557603257*^9, 3.408861586642618*^9}, 
   3.408861620414131*^9, 3.40886175737626*^9, 3.408861890030018*^9, 
   3.4088621780052*^9, 3.408866428517149*^9, 3.4098211365630608`*^9, 
   3.409821599598723*^9, 3.4098222275868053`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"IsStructureExtended", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"5", " ", 
      RowBox[{"rischLog", "[", "x", "]"}]}], "+", 
     RowBox[{"5", " ", 
      RowBox[{"rischLog", "[", 
       FractionBox[
        RowBox[{"1", "+", 
         RowBox[{"x", " ", 
          SubscriptBox["\[Theta]", "1"]}]}], "x"], "]"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", 
      RowBox[{"theta", "[", "1", "]"}], ",", 
      RowBox[{"theta", "[", "2", "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", 
      RowBox[{"rischExp", "[", "x", "]"}], ",", 
      RowBox[{"rischLog", "[", 
       RowBox[{"1", "+", 
        RowBox[{"x", " ", 
         RowBox[{"theta", "[", "1", "]"}]}]}], "]"}]}], "}"}]}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"better", " ", 
    RowBox[{"result", "!!"}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.409944206935216*^9, 3.409944245810439*^9}, {
  3.409944413632749*^9, 3.409944417538919*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"False", ",", 
   RowBox[{"5", " ", 
    SubscriptBox["\[Theta]", "2"]}]}], "}"}]], "Output",
 CellChangeTimes->{3.40994424825134*^9, 3.409944406981433*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Structure Theorem Examples", "Subsection",
 CellChangeTimes->{{3.39431000574825*^9, 3.39431001218575*^9}}],

Cell[BoxData[
 RowBox[{"f", ":=", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"-", "2"}], "x", " ", 
     RowBox[{"Exp", "[", "x", "]"}]}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["x", "2"], "-", "9"}], ")"}], 
     RowBox[{"Log", "[", 
      RowBox[{
       SuperscriptBox["x", "2"], "-", "9"}], "]"}]}]], "+", 
   RowBox[{"3", " ", 
    RowBox[{"Exp", "[", 
     RowBox[{"3", " ", "x"}], "]"}], 
    RowBox[{"Log", "[", 
     RowBox[{"Log", "[", 
      RowBox[{"x", "-", "3"}], "]"}], "]"}]}], "+", 
   RowBox[{"4", " ", 
    RowBox[{"Exp", "[", 
     RowBox[{"4", " ", "x"}], "]"}], 
    RowBox[{"Log", "[", 
     RowBox[{"Log", "[", 
      RowBox[{"x", "+", "3"}], "]"}], "]"}]}], "-", 
   RowBox[{
    RowBox[{"Exp", "[", "x", "]"}], 
    RowBox[{"Log", "[", 
     RowBox[{"Log", "[", 
      RowBox[{
       SuperscriptBox["x", "2"], "-", "9"}], "]"}], "]"}]}], "+", 
   FractionBox[
    RowBox[{"Exp", "[", 
     RowBox[{"3", "x"}], "]"}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"x", "-", "3"}], ")"}], 
     RowBox[{"Log", "[", 
      RowBox[{"x", "-", "3"}], "]"}]}]], "+", 
   FractionBox[
    RowBox[{"Exp", "[", 
     RowBox[{"4", " ", "x"}], "]"}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"x", "+", "3"}], ")"}], 
     RowBox[{"Log", "[", 
      RowBox[{"x", "+", "3"}], "]"}]}]], 
   RowBox[{"(*", " ", 
    RowBox[{"example", " ", "from", " ", "project"}], " ", 
    "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.3931327548707056`*^9, 3.3931328784684305`*^9}, {
  3.39431002893575*^9, 3.394310033482625*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"RischStructure", "[", 
   RowBox[{
    RowBox[{"f", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Log", "\[Rule]", "rischLog"}], ",", 
       RowBox[{"Exp", "\[Rule]", "rischExp"}]}], "}"}]}], ",", "x"}], "]"}], "//",
   "Timing"}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", "f", "]"}]}], "Input",
 CellChangeTimes->{{3.4066228110087023`*^9, 3.406622819741144*^9}, {
  3.406625317343362*^9, 3.4066253546460867`*^9}, {3.406625974931818*^9, 
  3.406625982227565*^9}, {3.406626225893888*^9, 3.406626226941011*^9}, {
  3.4066262649984303`*^9, 3.406626265196602*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.06799699999999986`", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      FractionBox[
       SubsuperscriptBox["\[Theta]", "1", "3"], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "3"}], "+", "x"}], ")"}], " ", 
        SubscriptBox["\[Theta]", "2"]}]], "+", 
      FractionBox[
       SubsuperscriptBox["\[Theta]", "1", "4"], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"3", "+", "x"}], ")"}], " ", 
        SubscriptBox["\[Theta]", "3"]}]], "-", 
      FractionBox[
       RowBox[{"2", " ", "x", " ", 
        SubscriptBox["\[Theta]", "1"]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "9"}], "+", 
          SuperscriptBox["x", "2"]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["\[Theta]", "2"], "+", 
          SubscriptBox["\[Theta]", "3"]}], ")"}]}]], "+", 
      RowBox[{"3", " ", 
       SubsuperscriptBox["\[Theta]", "1", "3"], " ", 
       SubscriptBox["\[Theta]", "4"]}], "+", 
      RowBox[{"4", " ", 
       SubsuperscriptBox["\[Theta]", "1", "4"], " ", 
       SubscriptBox["\[Theta]", "5"]}], "-", 
      RowBox[{
       SubscriptBox["\[Theta]", "1"], " ", 
       SubscriptBox["\[Theta]", "6"]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       SubscriptBox["\[Theta]", "1"], ",", 
       SubscriptBox["\[Theta]", "2"], ",", 
       SubscriptBox["\[Theta]", "3"], ",", 
       SubscriptBox["\[Theta]", "4"], ",", 
       SubscriptBox["\[Theta]", "5"], ",", 
       SubscriptBox["\[Theta]", "6"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"rischExp", "[", "x", "]"}], ",", 
       RowBox[{"rischLog", "[", 
        RowBox[{
         RowBox[{"-", "3"}], "+", "x"}], "]"}], ",", 
       RowBox[{"rischLog", "[", 
        RowBox[{"3", "+", "x"}], "]"}], ",", 
       RowBox[{"rischLog", "[", 
        SubscriptBox["\[Theta]", "2"], "]"}], ",", 
       RowBox[{"rischLog", "[", 
        SubscriptBox["\[Theta]", "3"], "]"}], ",", 
       RowBox[{"rischLog", "[", 
        RowBox[{
         SubscriptBox["\[Theta]", "2"], "+", 
         SubscriptBox["\[Theta]", "3"]}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", 
       SubscriptBox["\[Theta]", "1"], ",", 
       FractionBox["1", 
        RowBox[{
         RowBox[{"-", "3"}], "+", "x"}]], ",", 
       FractionBox["1", 
        RowBox[{"3", "+", "x"}]], ",", 
       FractionBox["1", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "3"}], "+", "x"}], ")"}], " ", 
         SubscriptBox["\[Theta]", "2"]}]], ",", 
       FractionBox["1", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"3", "+", "x"}], ")"}], " ", 
         SubscriptBox["\[Theta]", "3"]}]], ",", 
       FractionBox[
        RowBox[{"2", " ", "x"}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "3"}], "+", "x"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"3", "+", "x"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["\[Theta]", "2"], "+", 
           SubscriptBox["\[Theta]", "3"]}], ")"}]}]]}], "}"}], ",", 
     RowBox[{"{", "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.4073990574930067`*^9, 3.407615020606936*^9, 
  3.409140143006572*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"RischStructure", "[", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{
       RowBox[{"rischLog", "[", "x", "]"}], 
       RowBox[{"rischLog", "[", 
        RowBox[{"rischLog", "[", "x", "]"}], "]"}]}], "+", "1"}], 
     RowBox[{"rischLog", "[", "x", "]"}]], ",", "x"}], "]"}], "//", 
  "Timing"}]], "Input",
 CellChangeTimes->{{3.394294971717*^9, 3.39429499737325*^9}, {
   3.394302275592*^9, 3.394302276482625*^9}, 3.394308762842*^9, {
   3.395143998515339*^9, 3.395143999605784*^9}, {3.406279544511663*^9, 
   3.406279552964723*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.002383000000000024`", ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{"1", "+", 
       RowBox[{
        SubscriptBox["\[Theta]", "1"], " ", 
        SubscriptBox["\[Theta]", "2"]}]}], 
      SubscriptBox["\[Theta]", "1"]], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       SubscriptBox["\[Theta]", "1"], ",", 
       SubscriptBox["\[Theta]", "2"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"rischLog", "[", "x", "]"}], ",", 
       RowBox[{"rischLog", "[", 
        SubscriptBox["\[Theta]", "1"], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", 
       FractionBox["1", "x"], ",", 
       FractionBox["1", 
        RowBox[{"x", " ", 
         SubscriptBox["\[Theta]", "1"]}]]}], "}"}], ",", 
     RowBox[{"{", "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.406279536596951*^9, 3.406279554504828*^9}, 
   3.406279617957065*^9, 3.4069643987566433`*^9, 3.407399096929512*^9, 
   3.407615069680588*^9, 3.407961687860279*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"RischStructure", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"rischExp", "[", 
      RowBox[{"2", "x"}], "]"}], "+", 
     RowBox[{"rischExp", "[", 
      RowBox[{"x", "+", 
       RowBox[{
        RowBox[{"rischLog", "[", "x", "]"}], "/", "2"}]}], "]"}]}], ",", 
    "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"Bronstein", " ", "Example"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.394301862357625*^9, 3.394301896451375*^9}, {
   3.394302111763875*^9, 3.394302151670125*^9}, {3.3943022725295*^9, 
   3.394302273513875*^9}, 3.39430876181075*^9, {3.395144004200307*^9, 
   3.395144005275124*^9}, {3.406279490967803*^9, 3.4062794966767683`*^9}, {
   3.406279528806835*^9, 3.406279530036543*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     SqrtBox["x"], " ", 
     SubscriptBox["\[Theta]", "1"]}], "+", 
    SubsuperscriptBox["\[Theta]", "1", "2"]}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     SubscriptBox["\[Theta]", "1"], ",", 
     SubscriptBox["\[Theta]", "2"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"rischExp", "[", "x", "]"}], ",", 
     RowBox[{"rischLog", "[", "x", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     SubscriptBox["\[Theta]", "1"], ",", 
     FractionBox["1", "x"]}], "}"}], ",", 
   RowBox[{"{", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.406279481692471*^9, 3.4062794993234787`*^9}, {
   3.4073990912649193`*^9, 3.407399093123425*^9}, 3.40761509278868*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"RischStructure", "[", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"x", "+", "1"}], ")"}], 
       SuperscriptBox["\[ExponentialE]", 
        SuperscriptBox["x", "2"]]}], "+", "1"}], 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        SuperscriptBox["\[ExponentialE]", 
         SuperscriptBox["x", "2"]], ")"}], "2"], "-", "1"}]], ",", "x"}], 
   "]"}], "//", "Timing"}]], "Input",
 CellChangeTimes->{{3.39430217037325*^9, 3.394302215576375*^9}, {
   3.394302269217*^9, 3.394302270232625*^9}, 3.39430876068575*^9, {
   3.3951440109603233`*^9, 3.3951440121258173`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.0028329999999998634`", ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{"1", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", "x"}], ")"}], " ", 
        SubscriptBox["\[Theta]", "1"]}]}], 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SubsuperscriptBox["\[Theta]", "1", "2"]}]], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       SubscriptBox["\[Theta]", "1"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"rischExp", "[", 
        SuperscriptBox["x", "2"], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"2", " ", "x", " ", 
        SubscriptBox["\[Theta]", "1"]}]}], "}"}], ",", 
     RowBox[{"{", "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.4062796242099123`*^9, 3.407399073788241*^9, 
  3.407615098478269*^9, 3.4079616927910957`*^9, 3.409140187665366*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"RischStructure", "[", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"Log", "[", 
       RowBox[{"x", "+", "1"}], "]"}], "+", 
      RowBox[{"Log", "[", 
       FractionBox["x", 
        RowBox[{"x", "+", "1"}]], "]"}]}], "x"], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", "great", " ", "*)"}], "//", "Timing"}]], "Input",
 CellChangeTimes->{{3.394308230232625*^9, 3.394308249107625*^9}, {
  3.3943089244045*^9, 3.39430892656075*^9}, {3.3943098426545*^9, 
  3.39430986706075*^9}, {3.395144015472302*^9, 3.395144017109894*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.0010210000000001607`", ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      SubscriptBox["\[Theta]", "1"], "x"], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"rischLog", "[", "x", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", 
       FractionBox["1", "x"]}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.406279637403235*^9, 3.406626274078476*^9, 
  3.407399081398665*^9, 3.407615100590252*^9, 3.407961694356781*^9}]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Debugging and Examples", "Section",
 CellChangeTimes->{{3.393527953604125*^9, 3.393527955026*^9}, {
  3.394313448670125*^9, 3.394313450607625*^9}, {3.3973737386486893`*^9, 
  3.397373740332782*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"expr", "=", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"Exp", "[", "2", "]"}], 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["x", "3"], "-", 
           SuperscriptBox["x", "2"]}], ")"}], 
         RowBox[{"Log", "[", 
          RowBox[{"2", " ", "x"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"Exp", "[", "2", "]"}], "x", " ", 
         RowBox[{"Exp", "[", "x", "]"}]}]}], 
       RowBox[{
        RowBox[{
         SuperscriptBox["x", "2"], 
         RowBox[{"Log", "[", 
          RowBox[{"2", " ", "x"}], "]"}]}], "+", 
        RowBox[{"Exp", "[", "x", "]"}]}]], ",", "x"}], "]"}], "//", 
    "Simplify"}]}], 
  RowBox[{"(*", " ", 
   RowBox[{
   "Axiom", " ", "fails", " ", "to", " ", "integrate", " ", "this", " ", 
    RowBox[{"expression", "!"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Risch", "[", 
  RowBox[{"expr", ",", "x"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", "expr", "]"}]}], "Input",
 CellChangeTimes->{{3.40601833694881*^9, 3.406018372404632*^9}, {
   3.406018452110663*^9, 3.406018461942526*^9}, {3.408862445386477*^9, 
   3.4088624559267187`*^9}, 3.4088625448855963`*^9, {3.409123058450261*^9, 
   3.409123061689272*^9}, 3.4100575420158052`*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["\[ExponentialE]", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["\[ExponentialE]", "x"], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", "x"], "-", "x"}], ")"}]}], "+", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", "x"], " ", "x", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "2"}], "+", 
        RowBox[{"3", " ", "x"}]}], ")"}], " ", 
      RowBox[{"Log", "[", 
       RowBox[{"2", " ", "x"}], "]"}]}], "+", 
     RowBox[{
      SuperscriptBox["x", "4"], " ", 
      SuperscriptBox[
       RowBox[{"Log", "[", 
        RowBox[{"2", " ", "x"}], "]"}], "2"]}]}], ")"}]}], 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", "x"], "+", 
     RowBox[{
      SuperscriptBox["x", "2"], " ", 
      RowBox[{"Log", "[", 
       RowBox[{"2", " ", "x"}], "]"}]}]}], ")"}], "2"]]], "Output",
 CellChangeTimes->{3.5405934857705708`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["\[ExponentialE]", "2"], " ", "x"}], "+", 
  FractionBox[
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"2", "+", "x"}]], 
   RowBox[{
    SuperscriptBox["\[ExponentialE]", "x"], "+", 
    RowBox[{
     SuperscriptBox["x", "2"], " ", 
     RowBox[{"Log", "[", "2", "]"}]}], "+", 
    RowBox[{
     SuperscriptBox["x", "2"], " ", 
     RowBox[{"Log", "[", "x", "]"}]}]}]]}]], "Output",
 CellChangeTimes->{3.5405934859289837`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Integrate", "[", 
   RowBox[{
    RowBox[{"x", " ", 
     RowBox[{"Log", "[", "x", "]"}], 
     SuperscriptBox[
      RowBox[{"Log", "[", 
       RowBox[{"x", "+", "1"}], "]"}], "4"]}], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{
   "great", " ", "example", " ", "to", " ", "test", " ", "cherry", " ", 
    "code", " ", "in", " ", "the", " ", "future"}], " ", "*)"}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.405466537773094*^9, 3.405466555624982*^9}, {
  3.406963144267274*^9, 3.406963146120418*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "8"], " ", 
  RowBox[{"(", 
   RowBox[{"234", "+", 
    RowBox[{"744", " ", "x"}], "-", 
    RowBox[{"15", " ", 
     SuperscriptBox["x", "2"]}], "-", 
    RowBox[{"180", " ", "x", " ", 
     RowBox[{"Log", "[", "x", "]"}]}], "+", 
    RowBox[{"6", " ", 
     SuperscriptBox["x", "2"], " ", 
     RowBox[{"Log", "[", "x", "]"}]}], "-", 
    RowBox[{"564", " ", 
     RowBox[{"Log", "[", 
      RowBox[{"1", "+", "x"}], "]"}]}], "-", 
    RowBox[{"540", " ", "x", " ", 
     RowBox[{"Log", "[", 
      RowBox[{"1", "+", "x"}], "]"}]}], "+", 
    RowBox[{"24", " ", 
     SuperscriptBox["x", "2"], " ", 
     RowBox[{"Log", "[", 
      RowBox[{"1", "+", "x"}], "]"}]}], "+", 
    RowBox[{"180", " ", 
     RowBox[{"Log", "[", "x", "]"}], " ", 
     RowBox[{"Log", "[", 
      RowBox[{"1", "+", "x"}], "]"}]}], "+", 
    RowBox[{"168", " ", "x", " ", 
     RowBox[{"Log", "[", "x", "]"}], " ", 
     RowBox[{"Log", "[", 
      RowBox[{"1", "+", "x"}], "]"}]}], "-", 
    RowBox[{"12", " ", 
     SuperscriptBox["x", "2"], " ", 
     RowBox[{"Log", "[", "x", "]"}], " ", 
     RowBox[{"Log", "[", 
      RowBox[{"1", "+", "x"}], "]"}]}], "+", 
    RowBox[{"186", " ", 
     SuperscriptBox[
      RowBox[{"Log", "[", 
       RowBox[{"1", "+", "x"}], "]"}], "2"]}], "+", 
    RowBox[{"168", " ", "x", " ", 
     SuperscriptBox[
      RowBox[{"Log", "[", 
       RowBox[{"1", "+", "x"}], "]"}], "2"]}], "-", 
    RowBox[{"18", " ", 
     SuperscriptBox["x", "2"], " ", 
     SuperscriptBox[
      RowBox[{"Log", "[", 
       RowBox[{"1", "+", "x"}], "]"}], "2"]}], "+", 
    RowBox[{"84", " ", 
     RowBox[{"Log", "[", 
      RowBox[{"-", "x"}], "]"}], " ", 
     SuperscriptBox[
      RowBox[{"Log", "[", 
       RowBox[{"1", "+", "x"}], "]"}], "2"]}], "-", 
    RowBox[{"84", " ", 
     RowBox[{"Log", "[", "x", "]"}], " ", 
     SuperscriptBox[
      RowBox[{"Log", "[", 
       RowBox[{"1", "+", "x"}], "]"}], "2"]}], "-", 
    RowBox[{"72", " ", "x", " ", 
     RowBox[{"Log", "[", "x", "]"}], " ", 
     SuperscriptBox[
      RowBox[{"Log", "[", 
       RowBox[{"1", "+", "x"}], "]"}], "2"]}], "+", 
    RowBox[{"12", " ", 
     SuperscriptBox["x", "2"], " ", 
     RowBox[{"Log", "[", "x", "]"}], " ", 
     SuperscriptBox[
      RowBox[{"Log", "[", 
       RowBox[{"1", "+", "x"}], "]"}], "2"]}], "-", 
    RowBox[{"32", " ", 
     SuperscriptBox[
      RowBox[{"Log", "[", 
       RowBox[{"1", "+", "x"}], "]"}], "3"]}], "-", 
    RowBox[{"24", " ", "x", " ", 
     SuperscriptBox[
      RowBox[{"Log", "[", 
       RowBox[{"1", "+", "x"}], "]"}], "3"]}], "+", 
    RowBox[{"8", " ", 
     SuperscriptBox["x", "2"], " ", 
     SuperscriptBox[
      RowBox[{"Log", "[", 
       RowBox[{"1", "+", "x"}], "]"}], "3"]}], "-", 
    RowBox[{"24", " ", 
     RowBox[{"Log", "[", 
      RowBox[{"-", "x"}], "]"}], " ", 
     SuperscriptBox[
      RowBox[{"Log", "[", 
       RowBox[{"1", "+", "x"}], "]"}], "3"]}], "+", 
    RowBox[{"24", " ", 
     RowBox[{"Log", "[", "x", "]"}], " ", 
     SuperscriptBox[
      RowBox[{"Log", "[", 
       RowBox[{"1", "+", "x"}], "]"}], "3"]}], "+", 
    RowBox[{"16", " ", "x", " ", 
     RowBox[{"Log", "[", "x", "]"}], " ", 
     SuperscriptBox[
      RowBox[{"Log", "[", 
       RowBox[{"1", "+", "x"}], "]"}], "3"]}], "-", 
    RowBox[{"8", " ", 
     SuperscriptBox["x", "2"], " ", 
     RowBox[{"Log", "[", "x", "]"}], " ", 
     SuperscriptBox[
      RowBox[{"Log", "[", 
       RowBox[{"1", "+", "x"}], "]"}], "3"]}], "+", 
    RowBox[{"2", " ", 
     SuperscriptBox[
      RowBox[{"Log", "[", 
       RowBox[{"1", "+", "x"}], "]"}], "4"]}], "-", 
    RowBox[{"2", " ", 
     SuperscriptBox["x", "2"], " ", 
     SuperscriptBox[
      RowBox[{"Log", "[", 
       RowBox[{"1", "+", "x"}], "]"}], "4"]}], "+", 
    RowBox[{"4", " ", 
     RowBox[{"Log", "[", 
      RowBox[{"-", "x"}], "]"}], " ", 
     SuperscriptBox[
      RowBox[{"Log", "[", 
       RowBox[{"1", "+", "x"}], "]"}], "4"]}], "-", 
    RowBox[{"4", " ", 
     RowBox[{"Log", "[", "x", "]"}], " ", 
     SuperscriptBox[
      RowBox[{"Log", "[", 
       RowBox[{"1", "+", "x"}], "]"}], "4"]}], "+", 
    RowBox[{"4", " ", 
     SuperscriptBox["x", "2"], " ", 
     RowBox[{"Log", "[", "x", "]"}], " ", 
     SuperscriptBox[
      RowBox[{"Log", "[", 
       RowBox[{"1", "+", "x"}], "]"}], "4"]}], "+", 
    RowBox[{"180", " ", 
     RowBox[{"PolyLog", "[", 
      RowBox[{"2", ",", 
       RowBox[{"-", "x"}]}], "]"}]}], "+", 
    RowBox[{"8", " ", 
     RowBox[{"Log", "[", 
      RowBox[{"1", "+", "x"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{"21", "-", 
       RowBox[{"9", " ", 
        RowBox[{"Log", "[", 
         RowBox[{"1", "+", "x"}], "]"}]}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"Log", "[", 
          RowBox[{"1", "+", "x"}], "]"}], "2"]}]}], ")"}], " ", 
     RowBox[{"PolyLog", "[", 
      RowBox[{"2", ",", 
       RowBox[{"1", "+", "x"}]}], "]"}]}], "-", 
    RowBox[{"168", " ", 
     RowBox[{"PolyLog", "[", 
      RowBox[{"3", ",", 
       RowBox[{"1", "+", "x"}]}], "]"}]}], "+", 
    RowBox[{"144", " ", 
     RowBox[{"Log", "[", 
      RowBox[{"1", "+", "x"}], "]"}], " ", 
     RowBox[{"PolyLog", "[", 
      RowBox[{"3", ",", 
       RowBox[{"1", "+", "x"}]}], "]"}]}], "-", 
    RowBox[{"48", " ", 
     SuperscriptBox[
      RowBox[{"Log", "[", 
       RowBox[{"1", "+", "x"}], "]"}], "2"], " ", 
     RowBox[{"PolyLog", "[", 
      RowBox[{"3", ",", 
       RowBox[{"1", "+", "x"}]}], "]"}]}], "-", 
    RowBox[{"144", " ", 
     RowBox[{"PolyLog", "[", 
      RowBox[{"4", ",", 
       RowBox[{"1", "+", "x"}]}], "]"}]}], "+", 
    RowBox[{"96", " ", 
     RowBox[{"Log", "[", 
      RowBox[{"1", "+", "x"}], "]"}], " ", 
     RowBox[{"PolyLog", "[", 
      RowBox[{"4", ",", 
       RowBox[{"1", "+", "x"}]}], "]"}]}], "-", 
    RowBox[{"96", " ", 
     RowBox[{"PolyLog", "[", 
      RowBox[{"5", ",", 
       RowBox[{"1", "+", "x"}]}], "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.759207164823167*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"expr", "=", 
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Together", "[", 
       RowBox[{
        FractionBox[
         SuperscriptBox["3", "x"], 
         RowBox[{
          SuperscriptBox["9", "x"], "+", "1"}]], "-", 
        FractionBox[
         SuperscriptBox["2", "x"], 
         RowBox[{
          SuperscriptBox["4", "x"], "+", 
          SuperscriptBox["2", "x"], "-", "1"}]]}], "]"}], "//", 
      "ExpandDenominator"}], ",", "x"}], "]"}]}], 
  RowBox[{"(*", " ", 
   RowBox[{"BUG", "!"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{"expr", ",", "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"Compare", " ", "with", " ", "Integrate"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Integrate", "[", 
  RowBox[{"expr", ",", "x"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", "expr", "]"}]}], "Input",
 CellChangeTimes->{{3.409085530647379*^9, 3.4090855328285427`*^9}, {
  3.409121585149775*^9, 3.409121587764833*^9}, {3.409122557496315*^9, 
  3.409122558541395*^9}, {3.4091225964712877`*^9, 3.4091226165455*^9}, {
  3.40912569691251*^9, 3.409125733958652*^9}, {3.410334565709737*^9, 
  3.410334593245655*^9}, {3.410334696280422*^9, 3.410334700912409*^9}, {
  3.410334734345438*^9, 3.410334734448901*^9}, {3.540593532036422*^9, 
  3.540593569923801*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RischStructure", "[", 
  RowBox[{
   RowBox[{"InputConvert", "[", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["2", "x"]}], "-", 
       SuperscriptBox["3", "x"], "+", 
       SuperscriptBox["6", "x"], "+", 
       SuperscriptBox["12", "x"], "-", 
       SuperscriptBox["18", "x"]}], 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SuperscriptBox["2", "x"], "+", 
       SuperscriptBox["4", "x"], "-", 
       SuperscriptBox["9", "x"], "+", 
       SuperscriptBox["18", "x"], "+", 
       SuperscriptBox["36", "x"]}]], ",", "x"}], "]"}], ",", "x"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.414266510455546*^9, 3.414266518102458*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"-", 
        SubscriptBox["\[Theta]", "1"]}], "-", 
       SubscriptBox["\[Theta]", "2"], "+", 
       RowBox[{
        SubscriptBox["\[Theta]", "1"], " ", 
        SubscriptBox["\[Theta]", "2"]}], "+", 
       RowBox[{
        SubsuperscriptBox["\[Theta]", "1", "2"], " ", 
        SubscriptBox["\[Theta]", "2"]}], "-", 
       RowBox[{
        SubscriptBox["\[Theta]", "1"], " ", 
        SubsuperscriptBox["\[Theta]", "2", "2"]}]}], 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SubscriptBox["\[Theta]", "1"], "+", 
       SubsuperscriptBox["\[Theta]", "1", "2"], "-", 
       SubsuperscriptBox["\[Theta]", "2", "2"], "+", 
       RowBox[{
        SubscriptBox["\[Theta]", "1"], " ", 
        SubsuperscriptBox["\[Theta]", "2", "2"]}], "+", 
       RowBox[{
        SubsuperscriptBox["\[Theta]", "1", "2"], " ", 
        SubsuperscriptBox["\[Theta]", "2", "2"]}]}]], ",", "x"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     SubscriptBox["\[Theta]", "1"], ",", 
     SubscriptBox["\[Theta]", "2"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"rischExp", "[", 
      RowBox[{"x", " ", 
       RowBox[{"Log", "[", "2", "]"}]}], "]"}], ",", 
     RowBox[{"rischExp", "[", 
      RowBox[{"x", " ", 
       RowBox[{"Log", "[", "3", "]"}]}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{
      RowBox[{"Log", "[", "2", "]"}], " ", 
      SubscriptBox["\[Theta]", "1"]}], ",", 
     RowBox[{
      RowBox[{"Log", "[", "3", "]"}], " ", 
      SubscriptBox["\[Theta]", "2"]}]}], "}"}], ",", 
   RowBox[{"{", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.414266522003869*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Manipulates", "Subsection",
 CellChangeTimes->{{3.409890158746991*^9, 3.409890164242969*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Davenport", " ", "construction", " ", "of", " ", "elementary", " ", 
     "exponential", " ", "integrals"}], ",", " ", 
    RowBox[{"Davenport", " ", "1986", " ", "p", ".915"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"fun1", "[", "n_", "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["x", "n"], "-", "n"}], ")"}], 
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"x", " ", 
        RowBox[{"Exp", "[", 
         RowBox[{"1", "/", 
          SuperscriptBox["x", "n"]}], "]"}]}], "+", 
       FractionBox[
        RowBox[{"n", "+", "1"}], 
        SuperscriptBox["x", "n"]]}], "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{"Manipulate", "[", 
    RowBox[{
     RowBox[{"Row", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"HoldForm", "[", 
           RowBox[{"Risch", "[", 
            RowBox[{"#1", ",", "#2"}], "]"}], "]"}], "&"}], "[", 
         RowBox[{
          RowBox[{"fun1", "[", "n", "]"}], ",", "x"}], "]"}], ",", 
        "\"\< = \>\"", ",", 
        RowBox[{"Risch", "[", 
         RowBox[{
          RowBox[{"Evaluate", "[", 
           RowBox[{"fun1", "[", "n", "]"}], "]"}], ",", "x"}], "]"}]}], "}"}],
       "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "1", ",", "5", ",", "1"}], "}"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.3962537787234697`*^9, 3.3962537799561234`*^9}, {
  3.3962538200991*^9, 3.3962539033526897`*^9}, {3.3962539437885437`*^9, 
  3.396254004721579*^9}, {3.396254039180819*^9, 3.3962540476510553`*^9}, {
  3.396254165227612*^9, 3.396254187234433*^9}, {3.396254224351437*^9, 
  3.396254224942514*^9}, {3.39626739963905*^9, 3.396267415452545*^9}, {
  3.396268025517659*^9, 3.3962680410025997`*^9}, {3.396268241133562*^9, 
  3.39626825179396*^9}, {3.3963402319749107`*^9, 3.3963402322937183`*^9}, {
  3.396416187163609*^9, 3.396416192921258*^9}, {3.4098897508694677`*^9, 
  3.4098897563013887`*^9}, {3.409890091559971*^9, 3.409890092596962*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Integral", " ", "requiring", " ", "polynomial", " ", "cancellation", " ", 
    "Risch", " ", "DE", " ", 
    RowBox[{"implementation", ".", " ", "Solution"}], " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", " ", "+", " ", 
       RowBox[{"Exp", "[", "x", "]"}]}], ")"}], "^", "n"}], " ", 
    RowBox[{
     RowBox[{"Exp", "[", 
      RowBox[{"x", "^", "n"}], "]"}], "/", 
     RowBox[{"n", ".", " ", "This"}]}], " ", "example", " ", "illustrates", 
    " ", "the", " ", "massive", " ", "amount", " ", "of", " ", "recursion", 
    " ", "required", " ", "for", " ", "some", " ", 
    RowBox[{"integrals", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"fun2", "[", "n_", "]"}], ":=", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SuperscriptBox["\[ExponentialE]", "x"]}], ")"}], 
      RowBox[{
       RowBox[{"-", "1"}], "+", "n"}]], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["x", 
        RowBox[{"n", "-", "1"}]], "+", 
       SuperscriptBox["\[ExponentialE]", "x"], "+", 
       RowBox[{
        SuperscriptBox["x", 
         RowBox[{"n", "-", "1"}]], 
        SuperscriptBox["\[ExponentialE]", "x"]}]}], ")"}], 
     RowBox[{"Exp", "[", 
      SuperscriptBox["x", "n"], "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{"Manipulate", "[", 
    RowBox[{
     RowBox[{"Row", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"HoldForm", "[", 
           RowBox[{"Risch", "[", 
            RowBox[{"#1", ",", "#2"}], "]"}], "]"}], "&"}], "[", 
         RowBox[{
          RowBox[{"fun2", "[", "n", "]"}], ",", "x"}], "]"}], ",", 
        "\"\< = \>\"", ",", 
        RowBox[{"Risch", "[", 
         RowBox[{
          RowBox[{"Evaluate", "[", 
           RowBox[{"fun2", "[", "n", "]"}], "]"}], ",", "x"}], "]"}]}], "}"}],
       "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "1", ",", "5", ",", "1"}], "}"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.396347931114208*^9, 3.396347972650272*^9}, {
   3.396348154517516*^9, 3.3963481840729856`*^9}, {3.396348217700943*^9, 
   3.3963482307402763`*^9}, {3.3963483423192253`*^9, 3.396348369380101*^9}, {
   3.396348434696394*^9, 3.3963484481715107`*^9}, 3.3963485554070177`*^9, {
   3.396348626732955*^9, 3.396348669008987*^9}, {3.396348703833653*^9, 
   3.3963487520138187`*^9}, {3.396348846663619*^9, 3.396349059255423*^9}, {
   3.396349120178406*^9, 3.396349184943923*^9}, {3.3963492541087713`*^9, 
   3.396349277540823*^9}, {3.3963493765726967`*^9, 3.396349382497965*^9}, {
   3.3963494201742687`*^9, 3.396349420291575*^9}, {3.3963496695665007`*^9, 
   3.396349684626911*^9}, {3.396350760801857*^9, 3.396350800758987*^9}, {
   3.39635920081954*^9, 3.396359212738102*^9}, {3.396359302516618*^9, 
   3.396359326818747*^9}, {3.3963593730750837`*^9, 3.3963593782429132`*^9}, {
   3.396397499420521*^9, 3.3963975199518957`*^9}, {3.396397701160927*^9, 
   3.396397730743524*^9}, {3.3963985290302067`*^9, 3.396398545415936*^9}, {
   3.396398605950438*^9, 3.396398606616034*^9}, {3.396416126605646*^9, 
   3.396416129418442*^9}, {3.404548276484807*^9, 3.4045483168336687`*^9}, {
   3.409889761031123*^9, 3.409889773153062*^9}, {3.4098900775601397`*^9, 
   3.4098900791611156`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"example", " ", "from", " ", "Bronstein", " ", "p", ".180"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"fun3", "[", "n_", "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", 
       FractionBox[
        SuperscriptBox["x", 
         RowBox[{"2", "-", "n"}]], 
        RowBox[{"2", "-", "n"}]], "+", 
       FractionBox[
        RowBox[{"n", "-", "1"}], 
        SuperscriptBox["x", "n"]]}], ")"}], 
     RowBox[{"Exp", "[", "x", "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{"Manipulate", "[", 
    RowBox[{
     RowBox[{"Row", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"HoldForm", "[", 
           RowBox[{"Risch", "[", 
            RowBox[{"#1", ",", "#2"}], "]"}], "]"}], "&"}], "[", 
         RowBox[{
          RowBox[{"fun3", "[", "n", "]"}], ",", "x"}], "]"}], ",", 
        "\"\< = \>\"", ",", 
        RowBox[{"Risch", "[", 
         RowBox[{
          RowBox[{"fun3", "[", "n", "]"}], ",", "x"}], "]"}]}], "}"}], "]"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "3", ",", "10", ",", "1"}], "}"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.4098898118615713`*^9, 3.409889903723234*^9}, {
  3.409890003722859*^9, 3.409890012761977*^9}, {3.409890053011492*^9, 
  3.409890071346964*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Mainly Bugs", "Subsection",
 CellChangeTimes->{{3.398850542014057*^9, 3.398850544468712*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      SuperscriptBox["\[ExponentialE]", "x"], " ", 
      SuperscriptBox["x", "2"]}], "+", 
     FractionBox[
      RowBox[{"x", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["\[ExponentialE]", "x"]}], "+", 
         RowBox[{"3", " ", 
          SuperscriptBox["x", "2"]}]}], ")"}]}], 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["\[ExponentialE]", "x"]}], "+", 
       SuperscriptBox["x", "3"]}]], "+", 
     RowBox[{"3", " ", 
      SuperscriptBox["\[ExponentialE]", "x"], " ", 
      SuperscriptBox["x", "2"], " ", 
      RowBox[{"Log", "[", "x", "]"}]}], "+", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", "x"], " ", 
      SuperscriptBox["x", "3"], " ", 
      RowBox[{"Log", "[", "x", "]"}]}], "+", 
     RowBox[{"Log", "[", 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["\[ExponentialE]", "x"]}], "+", 
       SuperscriptBox["x", "3"]}], "]"}]}], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", "fixed", " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.410381691154458*^9, 3.4103817030065804`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["\[ExponentialE]", "x"], " ", 
   SuperscriptBox["x", "3"], " ", 
   RowBox[{"Log", "[", "x", "]"}]}], "+", 
  RowBox[{"x", " ", 
   RowBox[{"Log", "[", 
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox["\[ExponentialE]", "x"]}], "+", 
     SuperscriptBox["x", "3"]}], "]"}]}]}]], "Output",
 CellChangeTimes->{3.410381711495675*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    RowBox[{"Tan", "[", "x", "]"}], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"bug", "!!"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.410223804641892*^9, 3.410223847079911*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[ImaginaryI]", " ", "x"}], "-", 
  RowBox[{"Log", "[", 
   RowBox[{"Cos", "[", "x", "]"}], "]"}]}]], "Output",
 CellChangeTimes->{{3.4102238079905977`*^9, 3.410223821976675*^9}, 
   3.410345046524632*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    RowBox[{"x", "^", "n"}], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{
   "need", " ", "table", " ", "lookup", " ", "for", " ", "these", " ", 
    "types", " ", "of", " ", 
    RowBox[{"integrals", ".", " ", "Implemented"}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.410058383970358*^9, 3.410058388127652*^9}, {
  3.410058445560193*^9, 3.410058448831726*^9}, {3.410072143562305*^9, 
  3.410072144753744*^9}, {3.410073085295054*^9, 3.410073098890175*^9}, {
  3.410345052720614*^9, 3.410345055709673*^9}}],

Cell[BoxData[
 FractionBox[
  SuperscriptBox["x", 
   RowBox[{"1", "+", "n"}]], 
  RowBox[{"1", "+", "n"}]]], "Output",
 CellChangeTimes->{
  3.410071956738159*^9, 3.410072145798851*^9, 3.410072976459578*^9, 
   3.4102238625851717`*^9, {3.41034504751416*^9, 3.410345056869947*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    RowBox[{
     SuperscriptBox["x", 
      RowBox[{"3", "+", "x"}]], " ", 
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        RowBox[{"3", "+", "x"}], "x"], "+", 
       RowBox[{"Log", "[", "x", "]"}]}], ")"}]}], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", "fixed", " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.404031951744288*^9, 3.404031958555958*^9}, {
  3.404032009742936*^9, 3.404032013356172*^9}, {3.4090207444247837`*^9, 
  3.409020746774013*^9}, {3.410381782167626*^9, 3.410381796648142*^9}}],

Cell[BoxData[
 SuperscriptBox["x", 
  RowBox[{"3", "+", "x"}]]], "Output",
 CellChangeTimes->{
  3.4040320138411694`*^9, 3.404544913593492*^9, 3.408009368252322*^9, 
   3.40902074693596*^9, 3.409201645314413*^9, 3.409888665373893*^9, 
   3.409944560078499*^9, 3.410081708452519*^9, 3.410345057796397*^9, {
   3.410381777513586*^9, 3.410381800802114*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    FractionBox["1", 
     RowBox[{
      FractionBox["b", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"m", " ", "x"}]]], "+", 
      RowBox[{"a", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"m", " ", "x"}]]}]}]], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"bug", "!"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.40252449927857*^9, 3.402524502699321*^9}, {
  3.402524537958795*^9, 3.402524540564968*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"x", " ", 
       RowBox[{"Exp", "[", 
        RowBox[{"2", " ", 
         SuperscriptBox["x", "2"]}], "]"}]}], "+", 
      RowBox[{"8", 
       SqrtBox["2"], "x", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"Exp", "[", 
          SuperscriptBox["x", "2"], "]"}]}], ")"}]}], "+", 
      RowBox[{"2", "x"}]}], 
     RowBox[{
      RowBox[{"Exp", "[", 
       RowBox[{"3", 
        SuperscriptBox["x", "2"]}], "]"}], "+", 
      RowBox[{"Exp", "[", 
       RowBox[{"2", 
        SuperscriptBox["x", "2"]}], "]"}], "+", 
      RowBox[{"2", " ", 
       RowBox[{"Exp", "[", 
        SuperscriptBox["x", "2"], "]"}]}], "+", "2"}]], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"BUG", ":", " ", 
    RowBox[{"PureLogPart", ":", " ", 
     RowBox[{
     "appears", " ", "to", " ", "be", " ", "a", " ", "problem", " ", "is", 
      " ", "splitsquarefreefactor"}]}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.397876801532065*^9, 3.39787680430473*^9}, {
  3.397876840164338*^9, 3.397876894294464*^9}, {3.39787916620138*^9, 
  3.397879179129993*^9}, {3.3978802439588337`*^9, 3.397880281759968*^9}, {
  3.409888785734288*^9, 3.409888787359947*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    FractionBox[
     SuperscriptBox["3", "x"], 
     RowBox[{
      RowBox[{"Exp", "[", 
       SuperscriptBox["3", "x"], "]"}], "+", "1"}]], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", "works", " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.39806968936513*^9, 3.3980697589294767`*^9}, {
  3.3980701254224052`*^9, 3.398070129661277*^9}, {3.398220060283104*^9, 
  3.398220061047062*^9}, {3.3982200955690804`*^9, 3.39822009601511*^9}, {
  3.408009419512773*^9, 3.4080094213341703`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   SuperscriptBox["3", "x"], 
   RowBox[{"Log", "[", "3", "]"}]], "-", 
  FractionBox[
   RowBox[{"Log", "[", 
    RowBox[{"1", "+", 
     SuperscriptBox["\[ExponentialE]", 
      SuperscriptBox["3", "x"]]}], "]"}], 
   RowBox[{"Log", "[", "3", "]"}]]}]], "Output",
 CellChangeTimes->{3.408009415815423*^9, 3.409020675049654*^9, 
  3.4092016877464247`*^9, 3.409888804797172*^9, 3.410081718131528*^9, 
  3.410345087955621*^9, 3.4103818116329937`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Exp", "[", "x", "]"}], 
     RowBox[{"Exp", "[", 
      RowBox[{"Exp", "[", "x", "]"}], "]"}], 
     RowBox[{"Sin", "[", 
      RowBox[{"Exp", "[", 
       RowBox[{"Exp", "[", "x", "]"}], "]"}], "]"}]}], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", "bug", " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.398222640200746*^9, 3.398222682285913*^9}, {
  3.398225407831933*^9, 3.398225412132881*^9}, {3.408009426234198*^9, 
  3.408009429758445*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      SuperscriptBox["\[ExponentialE]", "x"], " ", 
      RowBox[{"Cos", "[", "x", "]"}], " ", 
      RowBox[{"Log", "[", "x", "]"}]}], "+", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[ExponentialE]", "x"], " ", 
       RowBox[{"Sin", "[", "x", "]"}]}], "x"], "+", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", "x"], " ", 
      RowBox[{"Log", "[", "x", "]"}], " ", 
      RowBox[{"Sin", "[", "x", "]"}]}]}], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", "bug", " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.397804438826509*^9, 3.3978044654577303`*^9}}],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "+", "\[ImaginaryI]"}], ")"}], " ", "x"}]], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
   RowBox[{"Cos", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", "\[ImaginaryI]"}], ")"}], " ", "x"}], "]"}], " ", 
   RowBox[{"Log", "[", "x", "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"Log", "[", "x", "]"}], " ", 
   RowBox[{"Sin", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", "\[ImaginaryI]"}], ")"}], " ", "x"}], 
    "]"}]}]}]], "Output",
 CellChangeTimes->{3.409888829296143*^9, 3.4100817295199013`*^9, 
  3.4103451187205353`*^9, 3.410381839999147*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    FractionBox["1", 
     RowBox[{
      SuperscriptBox["x", "4"], "-", 
      RowBox[{"4", 
       SuperscriptBox["x", "2"]}], "+", "6"}]], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"M", "-", " ", 
    RowBox[{"wins", " ", "on", " ", "this", " ", "one"}]}], " ", 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.3982326178502703`*^9, 3.398232643004404*^9}, {
  3.398235444270727*^9, 3.3982354514394407`*^9}, {3.398235523314465*^9, 
  3.398235539544403*^9}, {3.3982357987411127`*^9, 3.398235799796796*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "4"], " ", 
  RowBox[{"RootSum", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"6", "-", 
      RowBox[{"4", " ", 
       SuperscriptBox["#1", "2"]}], "+", 
      SuperscriptBox["#1", "4"]}], "&"}], ",", 
    RowBox[{
     FractionBox[
      RowBox[{"Log", "[", 
       RowBox[{"x", "-", "#1"}], "]"}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", "#1"}], "+", 
       SuperscriptBox["#1", "3"]}]], "&"}]}], "]"}]}]], "Output",
 CellChangeTimes->{{3.40920174147826*^9, 3.409201749022985*^9}, 
   3.409888831460765*^9, 3.410081730373783*^9, 3.410345120084489*^9, 
   3.410381845338505*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    FractionBox["1", 
     RowBox[{
      SuperscriptBox["x", "4"], "+", 
      RowBox[{"9", 
       SuperscriptBox["x", "2"]}], "-", "2"}]], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"M", "-", " ", 
    RowBox[{"wins", " ", "on", " ", "this", " ", "one"}]}], " ", 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.398236848332225*^9, 3.3982368637507057`*^9}, {
  3.398236904336364*^9, 3.398236916750887*^9}, {3.398237154697646*^9, 
  3.398237165456682*^9}, {3.398237221538385*^9, 3.3982372476189413`*^9}, {
  3.398237844293104*^9, 3.3982378518518*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    FractionBox["1", "2"]}], " ", 
   SqrtBox[
    RowBox[{
     RowBox[{"-", 
      FractionBox["9", "89"]}], "+", 
     FractionBox["1", 
      SqrtBox["89"]]}]], " ", 
   RowBox[{"ArcTan", "[", 
    FractionBox[
     RowBox[{"4", " ", "x"}], 
     RowBox[{
      SqrtBox[
       RowBox[{
        RowBox[{"-", "9"}], "+", 
        SqrtBox["89"]}]], " ", 
      RowBox[{"(", 
       RowBox[{"9", "+", 
        SqrtBox["89"]}], ")"}]}]], "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   SqrtBox[
    RowBox[{
     FractionBox["9", "89"], "+", 
     FractionBox["1", 
      SqrtBox["89"]]}]], " ", 
   RowBox[{"Log", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "9"}], "+", 
        SqrtBox["89"]}], ")"}], " ", 
      SqrtBox[
       RowBox[{"9", "+", 
        SqrtBox["89"]}]]}], "-", 
     RowBox[{"4", " ", "x"}]}], "]"}]}], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   SqrtBox[
    RowBox[{
     FractionBox["9", "89"], "+", 
     FractionBox["1", 
      SqrtBox["89"]]}]], " ", 
   RowBox[{"Log", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "9"}], "+", 
        SqrtBox["89"]}], ")"}], " ", 
      SqrtBox[
       RowBox[{"9", "+", 
        SqrtBox["89"]}]]}], "+", 
     RowBox[{"4", " ", "x"}]}], "]"}]}]}]], "Output",
 CellChangeTimes->{3.4098888325675573`*^9, 3.410081731292982*^9, 
  3.410381864412705*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Exp", "[", 
        RowBox[{"1", "/", 
         RowBox[{"(", 
          RowBox[{"x", " ", 
           RowBox[{"Exp", "[", "x", "]"}]}], ")"}]}], "]"}], 
       RowBox[{"(", 
        FractionBox[
         RowBox[{"Exp", "[", "x", "]"}], 
         RowBox[{"1", "-", 
          RowBox[{"Log", "[", 
           RowBox[{"x", "-", "1"}], "]"}]}]], ")"}]}], ",", "x"}], "]"}], ",",
     "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"problem", " ", "here"}], ",", " ", 
    RowBox[{
    "after", " ", "Hermite", " ", "reduction", " ", "the", " ", "remaining", 
     " ", "integral", " ", "is", " ", "zero"}], ",", " ", 
    RowBox[{"but", " ", "requires", " ", "a", " ", "simplification"}], ",", 
    " ", 
    RowBox[{
     RowBox[{
      RowBox[{
      "this", " ", "could", " ", "be", " ", "done", " ", "with", " ", 
       "structure", " ", "theorems", " ", "or", " ", "Simplify"}], "..."}], 
     " ", "NOW", " ", 
     RowBox[{"WORKING", "!"}]}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.4090206459241543`*^9, 3.4090206515540237`*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     FractionBox[
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"-", "x"}]], "x"], "+", "x"}]], 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    RowBox[{"Log", "[", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "x"}], "]"}]}]]}]], "Output",
 CellChangeTimes->{3.397724862124793*^9, 3.3981581393614492`*^9, 
  3.3993818891978083`*^9, 3.401937462098097*^9, 3.408009453909127*^9, 
  3.409020642452693*^9, 3.409201756012104*^9, 3.4103451354383383`*^9, 
  3.410381873382642*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Log", "[", 
      RowBox[{"x", "+", "1"}], "]"}], 
     RowBox[{"Log", "[", 
      RowBox[{
       RowBox[{"2", "x"}], "+", "2"}], "]"}]}], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"problems", " ", "with", " ", "extensions"}], " ", 
   "*)"}]}]], "Input",
 CellChangeTimes->{
  3.397724877197153*^9, 3.40988886513616*^9, {3.410081784285133*^9, 
   3.410081790146825*^9}, {3.410381887157393*^9, 3.410381888107851*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FactorList", "::", "\<\"nonopt\"\>"}], ":", 
  " ", "\<\"Options expected (instead of \\!\\({Extension\\^\\(\\(\\(-2\\)\\) \
+ \\(\\(Log[2]\\)\\)\\)}\\)) beyond position \\!\\(1\\) in \
\\!\\(FactorList[\\(\\(\\((\\(-2\\))\\)\\^\\(\\((\\(-rischZ\\))\\)\\^\\(Log[2]\
\\)\\), \\(\\({Extension\\^\\(\\(\\(-2\\)\\) + \
\\(\\(Log[2]\\)\\)\\)}\\)\\)\\)\\)]\\). An option must be a rule or a list of \
rules. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/nonopt\\\", ButtonNote -> \
\\\"FactorList::nonopt\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.410345137998783*^9, 3.410381888868936*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"2", " ", "x"}], "-", 
  RowBox[{"x", " ", 
   RowBox[{"Log", "[", "2", "]"}]}], "-", 
  RowBox[{"2", " ", "x", " ", 
   RowBox[{"Log", "[", 
    RowBox[{"1", "+", "x"}], "]"}]}], "+", 
  RowBox[{"x", " ", 
   RowBox[{"Log", "[", "2", "]"}], " ", 
   RowBox[{"Log", "[", 
    RowBox[{"1", "+", "x"}], "]"}]}], "+", 
  SuperscriptBox[
   RowBox[{"Log", "[", 
    RowBox[{"1", "+", "x"}], "]"}], "2"], "+", 
  RowBox[{"x", " ", 
   SuperscriptBox[
    RowBox[{"Log", "[", 
     RowBox[{"1", "+", "x"}], "]"}], "2"]}]}]], "Output",
 CellChangeTimes->{3.410345138022428*^9, 3.4103818888740664`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "x"}], ")"}], " ", 
         RowBox[{"Log", "[", 
          FractionBox[
           RowBox[{
            RowBox[{"-", "1"}], "+", "x"}], "x"], "]"}]}]}], ")"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"x", " ", 
        RowBox[{"Log", "[", 
         FractionBox[
          RowBox[{
           RowBox[{"-", "1"}], "+", "x"}], "x"], "]"}]}], "]"}]}], 
     RowBox[{
      RowBox[{"-", "1"}], "+", "x"}]], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", "WORKS", " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.4080095232810802`*^9, 3.408009525582446*^9}, {
  3.410381900503169*^9, 3.410381907161437*^9}}],

Cell[BoxData[
 RowBox[{"Cos", "[", 
  RowBox[{
   RowBox[{"x", " ", 
    RowBox[{"Log", "[", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "x"}], "]"}]}], "-", 
   RowBox[{"x", " ", 
    RowBox[{"Log", "[", "x", "]"}]}]}], "]"}]], "Output",
 CellChangeTimes->{3.4080094966786957`*^9, 3.409020636239586*^9, 
  3.4092017921803427`*^9, 3.409888882543311*^9, 3.4100817976100407`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"Tan", "[", 
       RowBox[{"Tan", "[", 
        RowBox[{"Exp", "[", "x", "]"}], "]"}], "]"}], ",", "x"}], "]"}], ",", 
    "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"BUG", ":", " ", 
    RowBox[{"recursion", " ", "problems"}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.396590756249289*^9, 3.396590798134798*^9}, {
  3.3966143067716293`*^9, 3.396614323538632*^9}, {3.3967523153773813`*^9, 
  3.396752352559165*^9}, {3.3968683087932997`*^9, 3.396868323564474*^9}, {
  3.3968684247441874`*^9, 3.396868426901033*^9}, {3.396868506994254*^9, 
  3.396868507364393*^9}, {3.396868591904311*^9, 3.396868593661151*^9}, {
  3.396868670629024*^9, 3.3968686711537437`*^9}, {3.396868800973412*^9, 
  3.396868802610261*^9}, {3.396868917484479*^9, 3.396868917821496*^9}, {
  3.396868974413495*^9, 3.396868978890411*^9}, {3.396869452916407*^9, 
  3.396869454518045*^9}, {3.3970293911050797`*^9, 3.3970294216524363`*^9}, {
  3.408009578609775*^9, 3.408009581598423*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    RowBox[{"ArcTan", "[", "x", "]"}], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"make", " ", "this", " ", "one", " ", "an", " ", "ArcTan"}], " ", 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.398591548572617*^9, 3.398591554837075*^9}, {
  3.398591673280102*^9, 3.39859167829447*^9}, {3.3988504062114477`*^9, 
  3.398850414145627*^9}, {3.398850452834395*^9, 3.398850453261087*^9}, {
  3.39885048899551*^9, 3.398850492083301*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", "x", " ", 
   RowBox[{"Log", "[", 
    RowBox[{"1", "-", 
     RowBox[{"\[ImaginaryI]", " ", "x"}]}], "]"}]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", "x", " ", 
   RowBox[{"Log", "[", 
    RowBox[{"1", "+", 
     RowBox[{"\[ImaginaryI]", " ", "x"}]}], "]"}]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"Log", "[", 
    RowBox[{"1", "+", 
     SuperscriptBox["x", "2"]}], "]"}]}]}]], "Output",
 CellChangeTimes->{{3.408009905142427*^9, 3.408009906395266*^9}, 
   3.409020584095723*^9, 3.4100818062254267`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Log", "[", "x", "]"}], 
        SuperscriptBox[
         RowBox[{"ArcTan", "[", "x", "]"}], "2"]}], ",", "x"}], "]"}], "//", 
     "Simplify"}], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", "bug", " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.398592550110235*^9, 3.398592557725194*^9}, {
  3.398592609166093*^9, 3.398592658245068*^9}, {3.398593029548538*^9, 
  3.398593038883677*^9}, {3.398593178032201*^9, 3.39859318777136*^9}, {
  3.3985940239911213`*^9, 3.3985940241596413`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    FractionBox["1", "4"]}], " ", 
   SuperscriptBox[
    RowBox[{"Log", "[", 
     RowBox[{"1", "-", 
      RowBox[{"\[ImaginaryI]", " ", "x"}]}], "]"}], "2"], " ", 
   RowBox[{"Log", "[", "x", "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"Log", "[", 
    RowBox[{"1", "-", 
     RowBox[{"\[ImaginaryI]", " ", "x"}]}], "]"}], " ", 
   RowBox[{"Log", "[", 
    RowBox[{"1", "+", 
     RowBox[{"\[ImaginaryI]", " ", "x"}]}], "]"}], " ", 
   RowBox[{"Log", "[", "x", "]"}]}], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   SuperscriptBox[
    RowBox[{"Log", "[", 
     RowBox[{"1", "+", 
      RowBox[{"\[ImaginaryI]", " ", "x"}]}], "]"}], "2"], " ", 
   RowBox[{"Log", "[", "x", "]"}]}]}]], "Output",
 CellChangeTimes->{3.4100818071779222`*^9, 3.4103819176202908`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    FractionBox[
     RowBox[{"-", "\[ImaginaryI]"}], 
     RowBox[{"1", "+", 
      SuperscriptBox["x", "2"]}]], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"bug", ",", " ", 
    RowBox[{
    "we", " ", "need", " ", "this", " ", "as", " ", "an", " ", "ArcTan"}]}], 
   " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.3985932638026943`*^9, 3.398593285669922*^9}, {
  3.3985939702423487`*^9, 3.398593978270096*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    FractionBox["1", "2"]}], " ", 
   RowBox[{"Log", "[", 
    RowBox[{
     RowBox[{"-", "\[ImaginaryI]"}], "+", "x"}], "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"Log", "[", 
    RowBox[{"\[ImaginaryI]", "+", "x"}], "]"}]}]}]], "Output",
 CellChangeTimes->{
  3.398593793163291*^9, {3.3985938355244102`*^9, 3.3985938647705173`*^9}, 
   3.398655488626396*^9, 3.3987393429498672`*^9, 3.3987405435481787`*^9, 
   3.398741850178195*^9, 3.398741948797695*^9, 3.398850384358*^9, 
   3.399287640719269*^9, 3.399381914461097*^9, 3.4040316004502077`*^9, {
   3.408009936909174*^9, 3.4080099378244534`*^9}, 3.409020577351308*^9, 
   3.410081811907647*^9, 3.410381919801857*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    FractionBox[
     RowBox[{
      SuperscriptBox["x", "4"], "+", 
      SuperscriptBox["x", "3"], "+", 
      SuperscriptBox["x", "2"], "+", "x", "+", "1"}], 
     RowBox[{
      SuperscriptBox["x", "5"], "+", 
      SuperscriptBox["x", "4"], "+", 
      RowBox[{"2", 
       SuperscriptBox["x", "3"]}], "-", "2", "+", 
      RowBox[{"4", 
       SqrtBox[
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         SqrtBox["3"]}]]}]}]], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"Hangs", ",", " ", 
    RowBox[{"should", " ", "return", " ", "naive", " ", "form"}]}], " ", 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.3989427012000628`*^9, 3.398942702420684*^9}, {
  3.398942799750407*^9, 3.398942813932838*^9}}],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.39938192034934*^9, 3.408009945742978*^9, 
  3.41008181705448*^9, 3.410381924054647*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    FractionBox[
     RowBox[{"1", "+", 
      SuperscriptBox["x", "2"], "+", 
      SuperscriptBox["x", "3"], "-", 
      RowBox[{"3", 
       SuperscriptBox["x", "5"]}]}], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", "x", "-", 
        SuperscriptBox["x", "2"]}], ")"}], "2"]], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"want", " ", "this", " ", "as", " ", "an", " ", 
      RowBox[{"ArcTanh", ".", " ", "M"}]}], "-", " ", 
     RowBox[{
     "v4", ".2", " ", "gives", " ", "as", " ", "an", " ", "arctanh"}]}], ",", 
    " ", 
    RowBox[{
    "it", " ", "seems", " ", "difficult", " ", "to", " ", "do", " ", "using", 
     " ", "LRTR"}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.3990325388721247`*^9, 3.3990325574396963`*^9}, {
  3.399032697746941*^9, 3.3990327223126183`*^9}, {3.39903421053305*^9, 
  3.399034219415146*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "6"}], " ", "x"}], "-", 
  FractionBox[
   RowBox[{"3", " ", 
    SuperscriptBox["x", "2"]}], "2"], "+", 
  FractionBox[
   RowBox[{"6", " ", 
    RowBox[{"(", 
     RowBox[{"3", "+", 
      RowBox[{"4", " ", "x"}]}], ")"}]}], 
   RowBox[{"5", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "-", "x", "+", 
      SuperscriptBox["x", "2"]}], ")"}]}]], "+", 
  RowBox[{
   FractionBox["1", "25"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "175"}], "-", 
     RowBox[{"76", " ", 
      SqrtBox["5"]}]}], ")"}], " ", 
   RowBox[{"Log", "[", 
    RowBox[{
     RowBox[{"-", "1"}], "-", 
     SqrtBox["5"], "+", 
     RowBox[{"2", " ", "x"}]}], "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "25"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "175"}], "+", 
     RowBox[{"76", " ", 
      SqrtBox["5"]}]}], ")"}], " ", 
   RowBox[{"Log", "[", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     SqrtBox["5"], "+", 
     RowBox[{"2", " ", "x"}]}], "]"}]}]}]], "Output",
 CellChangeTimes->{
  3.399032562785602*^9, 3.399032723614669*^9, 3.399032756674818*^9, 
   3.399033124741598*^9, {3.399033723363666*^9, 3.399033751031005*^9}, 
   3.3990340151495533`*^9, 3.3990342037591877`*^9, 3.399034238287869*^9, 
   3.399287634584695*^9, 3.399381922895369*^9, 3.404031571794037*^9, 
   3.4080099524523897`*^9, {3.4100818182108717`*^9, 3.4100818411263866`*^9}, 
   3.4103819263646803`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"Tan", "[", 
       RowBox[{"Tan", "[", 
        RowBox[{"Exp", "[", "x", "]"}], "]"}], "]"}], ",", "x"}], "]"}], ",", 
    "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"again", ",", " ", "crashes"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.409053356086648*^9, 3.409053368028851*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    FractionBox[
     RowBox[{"2", "+", 
      SuperscriptBox[
       RowBox[{"Tan", "[", "x", "]"}], "2"]}], 
     RowBox[{"1", "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"x", "+", 
         RowBox[{"Tan", "[", "x", "]"}]}], ")"}], "2"]}]], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", "bug", " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LogToReal", "[", 
   RowBox[{
    RowBox[{"1", "+", 
     RowBox[{"4", " ", 
      SuperscriptBox["rischZ", "2"]}]}], ",", 
    RowBox[{
     RowBox[{"-", "I"}], "+", 
     RowBox[{"2", " ", "rischZ"}], "+", "x"}], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", "bug", " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.396006149439979*^9, 3.396006251420101*^9}, {
   3.396006429291561*^9, 3.396006443979294*^9}, {3.396753443017304*^9, 
   3.396753452690055*^9}, {3.397454070164647*^9, 3.397454110708452*^9}, 
   3.397454142572855*^9, {3.397454303169571*^9, 3.397454322634302*^9}, {
   3.397454477539733*^9, 3.397454478016659*^9}, {3.4090159643806257`*^9, 
   3.409015977484768*^9}, {3.409127796555438*^9, 3.40912780036201*^9}, {
   3.4091332184385653`*^9, 3.409133219609728*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"Tan", "[", "x", "]"}]], "+", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"Tan", "[", "x", "]"}]]], " ", 
        RowBox[{"Sin", "[", "x", "]"}]}]}]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cos", "[", "x", "]"}], "+", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"Tan", "[", "x", "]"}]], " ", 
        RowBox[{"Sec", "[", "x", "]"}], " ", 
        RowBox[{"Tan", "[", "x", "]"}]}]}], ")"}]}], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"hangs", ",", " ", 
    RowBox[{"probably", " ", "in", " ", "CoefficientArrays"}]}], " ", 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.4091396185778637`*^9, 3.4091396735415783`*^9}}],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.40913963965956*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    FractionBox[
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       FractionBox["1", 
        RowBox[{"Log", "[", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"n", " ", "x"}]}], "]"}]]], " ", "n", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "n"}], " ", "x"}], "+", 
        RowBox[{
         RowBox[{"Log", "[", 
          RowBox[{"n", " ", "x"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "n"}], " ", "x"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              RowBox[{"n", " ", "x"}]}], ")"}], " ", 
            SuperscriptBox[
             RowBox[{"Log", "[", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               RowBox[{"n", " ", "x"}]}], "]"}], "2"]}]}], ")"}]}]}], ")"}]}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"n", " ", "x"}]}], ")"}], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"Log", "[", 
          RowBox[{"n", " ", "x"}], "]"}]}], ")"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"Log", "[", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"n", " ", "x"}]}], "]"}], "2"]}]], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", "bug", " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.3964422791020403`*^9, 3.3964423607007923`*^9}, {
  3.3964423927004137`*^9, 3.3964423928654957`*^9}, {3.396442496513454*^9, 
  3.396442505240993*^9}, {3.39745507768428*^9, 3.397455097893804*^9}, {
  3.397470032856249*^9, 3.397470035615027*^9}, {3.398158161575864*^9, 
  3.3981581644891567`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"2", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"2", " ", "x"}]], " ", 
       SuperscriptBox["x", "2"]}], "+", 
      RowBox[{"4", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"3", " ", "x"}]], " ", "x"}], "+", 
      SuperscriptBox["\[ExponentialE]", "x"], "-", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"2", " ", "x"}]], "-", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"3", " ", "x"}]], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"4", " ", "x"}]]}], "+", "1"}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"2", " ", "x"}]]}], ")"}], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"x", "+", 
         SuperscriptBox["\[ExponentialE]", "x"]}], ")"}], "2"]}]], ",", "x"}],
    "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"FIXED", "!!"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.40049275994018*^9, 3.400492764406155*^9}, {
  3.400492905272393*^9, 3.400492907818294*^9}, {3.4080094038251457`*^9, 
  3.408009406375279*^9}, {3.410081420670292*^9, 3.410081423163762*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{
    SuperscriptBox["\[ExponentialE]", "x"], "+", "x"}]], "+", 
  RowBox[{"Log", "[", 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"2", " ", "x"}]]}], "]"}]}]], "Output",
 CellChangeTimes->{
  3.410080524993807*^9, 3.410080610458089*^9, 3.410080644329021*^9, 
   3.410081205008665*^9, 3.4100812788621693`*^9, {3.410081376358202*^9, 
   3.4100813873705673`*^9}, 3.410081829400229*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Rational Functions", "Subsection",
 CellChangeTimes->{{3.396342094746798*^9, 3.396342097829104*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    FractionBox[
     RowBox[{"2", "x"}], 
     RowBox[{
      SuperscriptBox["x", "8"], "+", "1"}]], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Mathematica", " ", "makes", " ", "a", " ", "mess", " ", "of", " ", 
     "this", " ", "one"}], "..."}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Integrate", "[", 
  RowBox[{
   FractionBox[
    RowBox[{"2", "x"}], 
    RowBox[{
     SuperscriptBox["x", "8"], "+", "1"}]], ",", "x"}], "]"}]}], "Input",
 CellChangeTimes->{{3.407656012096418*^9, 3.4076560565147142`*^9}, {
  3.407656100347711*^9, 3.40765611038733*^9}, {3.4076566716441107`*^9, 
  3.407656682571198*^9}, {3.5405937800865393`*^9, 3.5405937829186583`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{"ArcTan", "[", 
     RowBox[{"1", "-", 
      RowBox[{
       SqrtBox["2"], " ", 
       SuperscriptBox["x", "2"]}]}], "]"}], 
    RowBox[{"2", " ", 
     SqrtBox["2"]}]]}], "+", 
  FractionBox[
   RowBox[{"ArcTan", "[", 
    RowBox[{"1", "+", 
     RowBox[{
      SqrtBox["2"], " ", 
      SuperscriptBox["x", "2"]}]}], "]"}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"Log", "[", 
    RowBox[{"1", "-", 
     RowBox[{
      SqrtBox["2"], " ", 
      SuperscriptBox["x", "2"]}], "+", 
     SuperscriptBox["x", "4"]}], "]"}], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"Log", "[", 
    RowBox[{"1", "+", 
     RowBox[{
      SqrtBox["2"], " ", 
      SuperscriptBox["x", "2"]}], "+", 
     SuperscriptBox["x", "4"]}], "]"}], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]]}]], "Output",
 CellChangeTimes->{
  3.407656025984949*^9, 3.4076560572011557`*^9, 3.407656282848074*^9, {
   3.4076566760103607`*^9, 3.407656683373723*^9}, 3.4090567340958357`*^9, 
   3.409123066455798*^9, 3.40920161967589*^9, 3.4098112598485003`*^9, 
   3.410345201263254*^9, 3.540593793194569*^9}],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"4", " ", 
     SqrtBox["2"]}]], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", 
      RowBox[{"ArcTan", "[", 
       RowBox[{
        RowBox[{"Cot", "[", 
         FractionBox["\[Pi]", "8"], "]"}], "-", 
        RowBox[{"x", " ", 
         RowBox[{"Csc", "[", 
          FractionBox["\[Pi]", "8"], "]"}]}]}], "]"}]}], "+", 
     RowBox[{"2", " ", 
      RowBox[{"ArcTan", "[", 
       RowBox[{
        RowBox[{"Cot", "[", 
         FractionBox["\[Pi]", "8"], "]"}], "+", 
        RowBox[{"x", " ", 
         RowBox[{"Csc", "[", 
          FractionBox["\[Pi]", "8"], "]"}]}]}], "]"}]}], "-", 
     RowBox[{"2", " ", 
      RowBox[{"ArcTan", "[", 
       RowBox[{
        RowBox[{"x", " ", 
         RowBox[{"Sec", "[", 
          FractionBox["\[Pi]", "8"], "]"}]}], "-", 
        RowBox[{"Tan", "[", 
         FractionBox["\[Pi]", "8"], "]"}]}], "]"}]}], "+", 
     RowBox[{"2", " ", 
      RowBox[{"ArcTan", "[", 
       RowBox[{
        RowBox[{"x", " ", 
         RowBox[{"Sec", "[", 
          FractionBox["\[Pi]", "8"], "]"}]}], "+", 
        RowBox[{"Tan", "[", 
         FractionBox["\[Pi]", "8"], "]"}]}], "]"}]}], "+", 
     RowBox[{"Log", "[", 
      RowBox[{"1", "+", 
       SuperscriptBox["x", "2"], "-", 
       RowBox[{"2", " ", "x", " ", 
        RowBox[{"Cos", "[", 
         FractionBox["\[Pi]", "8"], "]"}]}]}], "]"}], "+", 
     RowBox[{"Log", "[", 
      RowBox[{"1", "+", 
       SuperscriptBox["x", "2"], "+", 
       RowBox[{"2", " ", "x", " ", 
        RowBox[{"Cos", "[", 
         FractionBox["\[Pi]", "8"], "]"}]}]}], "]"}], "-", 
     RowBox[{"Log", "[", 
      RowBox[{"1", "+", 
       SuperscriptBox["x", "2"], "-", 
       RowBox[{"2", " ", "x", " ", 
        RowBox[{"Sin", "[", 
         FractionBox["\[Pi]", "8"], "]"}]}]}], "]"}], "-", 
     RowBox[{"Log", "[", 
      RowBox[{"1", "+", 
       SuperscriptBox["x", "2"], "+", 
       RowBox[{"2", " ", "x", " ", 
        RowBox[{"Sin", "[", 
         FractionBox["\[Pi]", "8"], "]"}]}]}], "]"}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.407656025984949*^9, 3.4076560572011557`*^9, 3.407656282848074*^9, {
   3.4076566760103607`*^9, 3.407656683373723*^9}, 3.4090567340958357`*^9, 
   3.409123066455798*^9, 3.40920161967589*^9, 3.4098112598485003`*^9, 
   3.410345201263254*^9, 3.5405937933994293`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Risch", "[", 
  RowBox[{
   FractionBox["1", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"a", "+", 
        RowBox[{"b", " ", "x"}]}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{"c", "+", 
       RowBox[{"d", " ", "x"}]}], ")"}]}]], ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.402524305628511*^9, 3.402524309851226*^9}, {
  3.402524341420762*^9, 3.40252434491492*^9}, {3.407657198717596*^9, 
  3.4076572069875097`*^9}, {3.409056750583624*^9, 3.409056755525135*^9}, {
  3.409056895391962*^9, 3.409056902133553*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"b", " ", "c"}], "-", 
       RowBox[{"a", " ", "d"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"a", "+", 
       RowBox[{"b", " ", "x"}]}], ")"}]}]]}], "-", 
  FractionBox[
   RowBox[{"d", " ", 
    RowBox[{"Log", "[", 
     RowBox[{
      FractionBox["a", "b"], "+", "x"}], "]"}]}], 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"b", " ", "c"}], "-", 
      RowBox[{"a", " ", "d"}]}], ")"}], "2"]], "+", 
  FractionBox[
   RowBox[{"d", " ", 
    RowBox[{"Log", "[", 
     RowBox[{
      FractionBox["c", "d"], "+", "x"}], "]"}]}], 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"b", " ", "c"}], "-", 
      RowBox[{"a", " ", "d"}]}], ")"}], "2"]]}]], "Output",
 CellChangeTimes->{{3.4025243116336527`*^9, 3.40252434540788*^9}, {
   3.4040329522982397`*^9, 3.404032965844324*^9}, 3.404718122634281*^9, {
   3.40765719422791*^9, 3.4076571965109997`*^9}, {3.409056735056609*^9, 
   3.409056755833324*^9}, {3.409056879252007*^9, 3.409056902410067*^9}, 
   3.40912306732507*^9, 3.409201618392069*^9, 3.409811261215513*^9, 
   3.410345201581366*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Risch", "[", 
  RowBox[{
   FractionBox[
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", 
        SuperscriptBox["x", "3"]}], "+", 
       RowBox[{"12", " ", "x"}], "-", "1"}], ")"}], "3"], 
    RowBox[{
     RowBox[{"7", " ", 
      SuperscriptBox["x", "5"]}], "+", "17"}]], ",", "x"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{"864", " ", "x"}], "7"]}], "-", 
  FractionBox[
   RowBox[{"6", " ", 
    SuperscriptBox["x", "2"]}], "7"], "+", 
  FractionBox[
   RowBox[{"48", " ", 
    SuperscriptBox["x", "3"]}], "7"], "-", 
  FractionBox[
   RowBox[{"8", " ", 
    SuperscriptBox["x", "5"]}], "35"], "+", 
  RowBox[{
   FractionBox["1", "245"], " ", 
   RowBox[{"RootSum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"17", "+", 
       RowBox[{"7", " ", 
        SuperscriptBox["#1", "5"]}]}], "&"}], ",", 
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{"14681", " ", 
         RowBox[{"Log", "[", 
          RowBox[{"x", "-", "#1"}], "]"}]}], "+", 
        RowBox[{"456", " ", 
         RowBox[{"Log", "[", 
          RowBox[{"x", "-", "#1"}], "]"}], " ", "#1"}], "-", 
        RowBox[{"5472", " ", 
         RowBox[{"Log", "[", 
          RowBox[{"x", "-", "#1"}], "]"}], " ", 
         SuperscriptBox["#1", "2"]}], "+", 
        RowBox[{"12054", " ", 
         RowBox[{"Log", "[", 
          RowBox[{"x", "-", "#1"}], "]"}], " ", 
         SuperscriptBox["#1", "3"]}], "+", 
        RowBox[{"1144", " ", 
         RowBox[{"Log", "[", 
          RowBox[{"x", "-", "#1"}], "]"}], " ", 
         SuperscriptBox["#1", "4"]}]}], 
       SuperscriptBox["#1", "4"]], "&"}]}], "]"}]}]}]], "Output",
 CellChangeTimes->{
  3.400765544646152*^9, {3.40076656810632*^9, 3.400766569098847*^9}, 
   3.404032988539673*^9, 3.404546869255657*^9, {3.409056761584395*^9, 
   3.4090567861726313`*^9}, 3.4091230682575407`*^9, 3.409201616779978*^9, 
   3.40981126249482*^9, 3.410345201739541*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Risch", "[", 
  RowBox[{
   FractionBox[
    RowBox[{
     SuperscriptBox["x", "3"], "+", 
     RowBox[{"4", "x"}], "-", "1"}], 
    RowBox[{
     RowBox[{"6", " ", 
      SuperscriptBox["x", "4"]}], "-", 
     SuperscriptBox["x", "2"], "+", "1"}]], ",", "x"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Risch", "[", 
      RowBox[{"#", ",", "x"}], "]"}], "&"}], ",", 
    RowBox[{
     RowBox[{"Apart", "[", 
      FractionBox[
       RowBox[{
        SuperscriptBox["x", "3"], "+", 
        RowBox[{"4", "x"}], "-", "1"}], 
       RowBox[{
        RowBox[{"6", " ", 
         SuperscriptBox["x", "4"]}], "-", 
        SuperscriptBox["x", "2"], "+", "1"}]], "]"}], "//", "Expand"}]}], 
   "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"better", " ", "result"}], ",", " ", 
    RowBox[{"pity", "..."}]}], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.39354469668225*^9, 3.39354473636975*^9}, {
   3.39354697261975*^9, 3.393546973651*^9}, {3.39354707768225*^9, 
   3.39354709018225*^9}, {3.393548147822875*^9, 3.39354816055725*^9}, {
   3.395189849221492*^9, 3.395189897601934*^9}, 3.3953933733646603`*^9, {
   3.398159939962001*^9, 3.398159947223267*^9}, 3.398740550586999*^9, {
   3.398741324019696*^9, 3.39874135339585*^9}, {3.3988506250245743`*^9, 
   3.398850626144125*^9}, {3.398850681723813*^9, 3.398850690412128*^9}, {
   3.398850754757386*^9, 3.3988507644365683`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"RootSum", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"1", "-", 
      SuperscriptBox["#1", "2"], "+", 
      RowBox[{"6", " ", 
       SuperscriptBox["#1", "4"]}]}], "&"}], ",", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Log", "[", 
         RowBox[{"x", "-", "#1"}], "]"}]}], "+", 
       RowBox[{"4", " ", 
        RowBox[{"Log", "[", 
         RowBox[{"x", "-", "#1"}], "]"}], " ", "#1"}], "+", 
       RowBox[{
        RowBox[{"Log", "[", 
         RowBox[{"x", "-", "#1"}], "]"}], " ", 
        SuperscriptBox["#1", "3"]}]}], 
      RowBox[{
       RowBox[{"-", "#1"}], "+", 
       RowBox[{"12", " ", 
        SuperscriptBox["#1", "3"]}]}]], "&"}]}], "]"}]}]], "Output",
 CellChangeTimes->{
  3.399381934025975*^9, 3.3995479168692827`*^9, {3.400765545875867*^9, 
   3.4007655741316633`*^9}, 3.400766571592387*^9, 3.404032992587043*^9, 
   3.404546874684161*^9, 3.4090567879658403`*^9, 3.409123071860417*^9, 
   3.409811264919969*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"49", " ", 
    RowBox[{"ArcTan", "[", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"12", " ", 
        SuperscriptBox["x", "2"]}]}], 
      SqrtBox["23"]], "]"}]}], 
   RowBox[{"12", " ", 
    SqrtBox["23"]}]], "+", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   RowBox[{"Log", "[", 
    RowBox[{"1", "-", 
     SuperscriptBox["x", "2"], "+", 
     RowBox[{"6", " ", 
      SuperscriptBox["x", "4"]}]}], "]"}]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"RootSum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"1", "-", 
       SuperscriptBox["#1", "2"], "+", 
       RowBox[{"6", " ", 
        SuperscriptBox["#1", "4"]}]}], "&"}], ",", 
     RowBox[{
      FractionBox[
       RowBox[{"Log", "[", 
        RowBox[{"x", "-", "#1"}], "]"}], 
       RowBox[{
        RowBox[{"-", "#1"}], "+", 
        RowBox[{"12", " ", 
         SuperscriptBox["#1", "3"]}]}]], "&"}]}], "]"}]}]}]], "Output",
 CellChangeTimes->{
  3.399381934025975*^9, 3.3995479168692827`*^9, {3.400765545875867*^9, 
   3.4007655741316633`*^9}, 3.400766571592387*^9, 3.404032992587043*^9, 
   3.404546874684161*^9, 3.4090567879658403`*^9, 3.409123071860417*^9, 
   3.409811265057208*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    FractionBox["1", 
     RowBox[{
      SuperscriptBox["x", "8"], "+", "x", "+", "1"}]], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"better", "!!"}], "!!"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.398652021786475*^9, 3.3986520281546593`*^9}, {
  3.398655442542471*^9, 3.398655445731565*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"8", " ", 
    RowBox[{"ArcTan", "[", 
     FractionBox[
      RowBox[{"1", "+", 
       RowBox[{"2", " ", "x"}]}], 
      SqrtBox["3"]], "]"}]}], 
   RowBox[{"19", " ", 
    SqrtBox["3"]}]], "-", 
  RowBox[{
   FractionBox["1", "19"], " ", 
   RowBox[{"Log", "[", 
    RowBox[{"1", "+", "x", "+", 
     SuperscriptBox["x", "2"]}], "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "19"], " ", 
   RowBox[{"RootSum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"1", "-", 
       SuperscriptBox["#1", "2"], "+", 
       SuperscriptBox["#1", "3"], "-", 
       SuperscriptBox["#1", "5"], "+", 
       SuperscriptBox["#1", "6"]}], "&"}], ",", 
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{"16", " ", 
         RowBox[{"Log", "[", 
          RowBox[{"x", "-", "#1"}], "]"}]}], "-", 
        RowBox[{"14", " ", 
         RowBox[{"Log", "[", 
          RowBox[{"x", "-", "#1"}], "]"}], " ", "#1"}], "+", 
        RowBox[{
         RowBox[{"Log", "[", 
          RowBox[{"x", "-", "#1"}], "]"}], " ", 
         SuperscriptBox["#1", "2"]}], "+", 
        RowBox[{"8", " ", 
         RowBox[{"Log", "[", 
          RowBox[{"x", "-", "#1"}], "]"}], " ", 
         SuperscriptBox["#1", "3"]}], "-", 
        RowBox[{"7", " ", 
         RowBox[{"Log", "[", 
          RowBox[{"x", "-", "#1"}], "]"}], " ", 
         SuperscriptBox["#1", "4"]}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"Log", "[", 
          RowBox[{"x", "-", "#1"}], "]"}], " ", 
         SuperscriptBox["#1", "5"]}]}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "#1"}], "+", 
        RowBox[{"3", " ", 
         SuperscriptBox["#1", "2"]}], "-", 
        RowBox[{"5", " ", 
         SuperscriptBox["#1", "4"]}], "+", 
        RowBox[{"6", " ", 
         SuperscriptBox["#1", "5"]}]}]], "&"}]}], "]"}]}]}]], "Output",
 CellChangeTimes->{
  3.398652425985311*^9, {3.398652484791071*^9, 3.398652496302537*^9}, {
   3.398653463111803*^9, 3.398653476954693*^9}, {3.398653515137814*^9, 
   3.398653534360611*^9}, {3.3986537488766603`*^9, 3.398653777110416*^9}, {
   3.398653988865995*^9, 3.398654006654172*^9}, {3.398654039900078*^9, 
   3.398654042033736*^9}, {3.398654077124344*^9, 3.3986540851813374`*^9}, 
   3.398654130649315*^9, {3.398654177534203*^9, 3.398654195283637*^9}, {
   3.398654232045732*^9, 3.398654233951943*^9}, {3.398654313452752*^9, 
   3.398654336416212*^9}, 3.398654444525622*^9, 3.398654515397664*^9, {
   3.398654588493163*^9, 3.3986546093980017`*^9}, 3.39865466057973*^9, 
   3.398654805192137*^9, {3.3986549129544888`*^9, 3.398654914571056*^9}, {
   3.398654958948399*^9, 3.398654959924836*^9}, 3.398654992565407*^9, {
   3.3986550354713507`*^9, 3.398655085784593*^9}, 3.398655151667973*^9, 
   3.3986551882283373`*^9, 3.398655230945819*^9, 3.398655438450597*^9, 
   3.398741365813446*^9, {3.398850648954233*^9, 3.3988506511653767`*^9}, 
   3.399381942305355*^9, 3.409056790491207*^9, 3.409123073834166*^9, 
   3.409201622525778*^9, 3.409811267226457*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{
       RowBox[{"-", "19"}], " ", 
       SuperscriptBox["x", "6"]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["x", "5"]}], "-", 
      RowBox[{"15", " ", 
       SuperscriptBox["x", "3"]}], "-", 
      RowBox[{"14", " ", 
       SuperscriptBox["x", "2"]}], "+", "7"}], 
     RowBox[{
      RowBox[{
       RowBox[{"-", "10"}], " ", 
       SuperscriptBox["x", "18"]}], "+", 
      RowBox[{"5", " ", 
       SuperscriptBox["x", "17"]}], "-", 
      RowBox[{"8", " ", 
       SuperscriptBox["x", "16"]}], "-", 
      RowBox[{"18", " ", 
       SuperscriptBox["x", "15"]}], "-", 
      SuperscriptBox["x", "14"], "+", 
      RowBox[{"7", " ", 
       SuperscriptBox["x", "13"]}], "-", 
      RowBox[{"11", " ", 
       SuperscriptBox["x", "12"]}], "-", 
      RowBox[{"10", " ", 
       SuperscriptBox["x", "11"]}], "+", 
      RowBox[{"14", " ", 
       SuperscriptBox["x", "10"]}], "+", 
      RowBox[{"19", " ", 
       SuperscriptBox["x", "8"]}], "+", 
      RowBox[{"18", " ", 
       SuperscriptBox["x", "6"]}], "+", 
      RowBox[{"16", " ", 
       SuperscriptBox["x", "5"]}], "-", 
      RowBox[{"8", " ", 
       SuperscriptBox["x", "3"]}], "-", 
      RowBox[{"19", " ", 
       SuperscriptBox["x", "2"]}], "-", 
      RowBox[{"17", " ", "x"}], "-", "16"}]], ",", "x"}], "]"}], "//", 
  "Timing", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Example", " ", "form", " ", "Becker"}], ",", " ", 
    RowBox[{
    "his", " ", "java", " ", "algorithm", " ", "took", " ", "9", "s", " ", 
     "in", " ", "2001."}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.396270133187944*^9, 3.396270156559441*^9}, {
  3.396270190736259*^9, 3.396270192464547*^9}, {3.396270222769285*^9, 
  3.396270290862659*^9}, {3.397552836748919*^9, 3.397552861929204*^9}, {
  3.398741386325989*^9, 3.398741388418578*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.10329600000000005`", ",", 
   RowBox[{"RootSum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"16", "+", 
       RowBox[{"17", " ", "#1"}], "+", 
       RowBox[{"19", " ", 
        SuperscriptBox["#1", "2"]}], "+", 
       RowBox[{"8", " ", 
        SuperscriptBox["#1", "3"]}], "-", 
       RowBox[{"16", " ", 
        SuperscriptBox["#1", "5"]}], "-", 
       RowBox[{"18", " ", 
        SuperscriptBox["#1", "6"]}], "-", 
       RowBox[{"19", " ", 
        SuperscriptBox["#1", "8"]}], "-", 
       RowBox[{"14", " ", 
        SuperscriptBox["#1", "10"]}], "+", 
       RowBox[{"10", " ", 
        SuperscriptBox["#1", "11"]}], "+", 
       RowBox[{"11", " ", 
        SuperscriptBox["#1", "12"]}], "-", 
       RowBox[{"7", " ", 
        SuperscriptBox["#1", "13"]}], "+", 
       SuperscriptBox["#1", "14"], "+", 
       RowBox[{"18", " ", 
        SuperscriptBox["#1", "15"]}], "+", 
       RowBox[{"8", " ", 
        SuperscriptBox["#1", "16"]}], "-", 
       RowBox[{"5", " ", 
        SuperscriptBox["#1", "17"]}], "+", 
       RowBox[{"10", " ", 
        SuperscriptBox["#1", "18"]}]}], "&"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "7"}], " ", 
          RowBox[{"Log", "[", 
           RowBox[{"x", "-", "#1"}], "]"}]}], "+", 
         RowBox[{"14", " ", 
          RowBox[{"Log", "[", 
           RowBox[{"x", "-", "#1"}], "]"}], " ", 
          SuperscriptBox["#1", "2"]}], "+", 
         RowBox[{"15", " ", 
          RowBox[{"Log", "[", 
           RowBox[{"x", "-", "#1"}], "]"}], " ", 
          SuperscriptBox["#1", "3"]}], "-", 
         RowBox[{"2", " ", 
          RowBox[{"Log", "[", 
           RowBox[{"x", "-", "#1"}], "]"}], " ", 
          SuperscriptBox["#1", "5"]}], "+", 
         RowBox[{"19", " ", 
          RowBox[{"Log", "[", 
           RowBox[{"x", "-", "#1"}], "]"}], " ", 
          SuperscriptBox["#1", "6"]}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"17", "+", 
         RowBox[{"38", " ", "#1"}], "+", 
         RowBox[{"24", " ", 
          SuperscriptBox["#1", "2"]}], "-", 
         RowBox[{"80", " ", 
          SuperscriptBox["#1", "4"]}], "-", 
         RowBox[{"108", " ", 
          SuperscriptBox["#1", "5"]}], "-", 
         RowBox[{"152", " ", 
          SuperscriptBox["#1", "7"]}], "-", 
         RowBox[{"140", " ", 
          SuperscriptBox["#1", "9"]}], "+", 
         RowBox[{"110", " ", 
          SuperscriptBox["#1", "10"]}], "+", 
         RowBox[{"132", " ", 
          SuperscriptBox["#1", "11"]}], "-", 
         RowBox[{"91", " ", 
          SuperscriptBox["#1", "12"]}], "+", 
         RowBox[{"14", " ", 
          SuperscriptBox["#1", "13"]}], "+", 
         RowBox[{"270", " ", 
          SuperscriptBox["#1", "14"]}], "+", 
         RowBox[{"128", " ", 
          SuperscriptBox["#1", "15"]}], "-", 
         RowBox[{"85", " ", 
          SuperscriptBox["#1", "16"]}], "+", 
         RowBox[{"180", " ", 
          SuperscriptBox["#1", "17"]}]}], ")"}]}], "&"}]}], "]"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.396270166248451*^9, {3.396270212608571*^9, 3.396270236204105*^9}, {
   3.397552847912403*^9, 3.3975528712829037`*^9}, 3.3979589781082*^9, {
   3.398741376002171*^9, 3.398741398385743*^9}, 3.409056792715494*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    FractionBox["1", 
     RowBox[{
      RowBox[{"2", " ", 
       SuperscriptBox["x", "3"]}], "+", 
      RowBox[{"8", " ", 
       SuperscriptBox["x", "2"]}], "+", 
      RowBox[{"9", " ", "x"}], "+", "2"}]], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"In", " ", "this", " ", "exampe", " ", "M"}], "-", " ", 
     RowBox[{
     "may", " ", "allow", " ", "cubic", " ", "resultants", " ", "to", " ", 
      "be", " ", "evaluated"}]}], ",", " ", 
    RowBox[{
    "but", " ", "most", " ", "likely", " ", "uses", " ", "a", " ", "partial", 
     " ", "fraction", " ", 
     RowBox[{"expansion", "."}]}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.39353651380725*^9, 3.393536529729125*^9}, {
  3.39353657586975*^9, 3.393536596385375*^9}, {3.393536871510375*^9, 
  3.3935368957135*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     SqrtBox["2"]}], ")"}], " ", 
   RowBox[{"Log", "[", 
    RowBox[{
     RowBox[{"-", "7"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "2"}], "+", 
       SqrtBox["2"], "-", 
       RowBox[{"2", " ", "x"}]}], ")"}]}], "]"}]}], "+", 
  RowBox[{"Log", "[", 
   RowBox[{"2", "+", "x"}], "]"}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "-", 
     SqrtBox["2"]}], ")"}], " ", 
   RowBox[{"Log", "[", 
    RowBox[{"7", " ", 
     RowBox[{"(", 
      RowBox[{"2", "+", 
       SqrtBox["2"], "+", 
       RowBox[{"2", " ", "x"}]}], ")"}]}], "]"}]}]}]], "Output",
 CellChangeTimes->{
  3.3962678645954*^9, 3.396486135873248*^9, 3.396589482845355*^9, 
   3.39755289321985*^9, 3.397729495264736*^9, 3.3979589827261343`*^9, 
   3.397959255108396*^9, 3.397960506381914*^9, {3.409056795732732*^9, 
   3.409056797428194*^9}, 3.409123077608309*^9, 3.409811269885126*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"RandPoly", "[", "deg_", "]"}], ":=", 
  RowBox[{"Part", "[", 
   RowBox[{
    RowBox[{"Total", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}], 
         SuperscriptBox["x", 
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}]]}], "}"}], "&"}], "/@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"#", ",", 
           RowBox[{"Random", "[", 
            RowBox[{"Integer", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "10"}], ",", "10"}], "}"}]}], "]"}]}], "}"}], 
         "&"}], "/@", 
        RowBox[{"Range", "[", 
         RowBox[{"0", ",", "deg"}], "]"}]}], ")"}]}], "]"}], ",", "1"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.393526988666625*^9, 3.3935270123385*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PolyDebug", "[", 
   RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"integrand", "=", 
      FractionBox[
       RowBox[{"RandPoly", "[", "a", "]"}], 
       RowBox[{"RandPoly", "[", "b", "]"}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Mresult", "=", 
      RowBox[{
       RowBox[{"Integrate", "[", 
        RowBox[{"integrand", ",", "x"}], "]"}], "//", "Timing"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"MyResult", "=", 
      RowBox[{
       RowBox[{"Risch", "[", 
        RowBox[{"integrand", ",", "x"}], "]"}], "//", "Timing"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"answer", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Reap", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Sow", "[", 
           RowBox[{"Row", "[", 
            RowBox[{"{", 
             RowBox[{
             "\"\<Integrate[\>\"", ",", "integrand", ",", "\"\<,x] = \>\"", 
              ",", "Mresult"}], "}"}], "]"}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Sow", "[", 
           RowBox[{"Row", "[", 
            RowBox[{"{", 
             RowBox[{
             "\"\<Risch[\>\"", ",", "integrand", ",", "\"\<,x] = \>\"", ",", 
              "MyResult"}], "}"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
         "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], "//", "Flatten"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Column", "[", 
      RowBox[{"answer", ",", 
       RowBox[{"Spacings", "\[Rule]", "2"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.393527062010375*^9, 3.393527202354125*^9}, {
   3.393527235526*^9, 3.393527276447875*^9}, 3.393527371104125*^9, {
   3.393527688729125*^9, 3.3935276934635*^9}, 3.395460537134766*^9}],

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"PolyDebug", "[", 
    RowBox[{"a", ",", "b"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"a", ",", "1", ",", "6", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"b", ",", "1", ",", "5", ",", "1"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.393537471151*^9, 3.3935374945885*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"rischDebug", "=", "True"}], ";"}]], "Input",
 CellChangeTimes->{{3.397729068172875*^9, 3.397729071265829*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Risch", "[", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     RowBox[{"3", " ", "x"}], "-", 
     SuperscriptBox["x", "2"], "-", 
     RowBox[{"4", " ", 
      SuperscriptBox["x", "3"]}]}], 
    RowBox[{
     RowBox[{"-", "4"}], "+", 
     RowBox[{"8", " ", "x"}], "-", 
     RowBox[{"8", " ", 
      SuperscriptBox["x", "2"]}]}]], ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.3954607534885683`*^9, 3.395460791429484*^9}, {
  3.3954608228292913`*^9, 3.3954608377175293`*^9}, {3.39573214011841*^9, 
  3.395732142539536*^9}, {3.3957352070548162`*^9, 3.395735207675012*^9}, {
  3.3981595957418833`*^9, 3.398159599235177*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"5", " ", "x"}], "8"], "+", 
  FractionBox[
   SuperscriptBox["x", "2"], "4"], "+", 
  RowBox[{
   FractionBox["3", "8"], " ", 
   RowBox[{"ArcTan", "[", 
    RowBox[{"1", "-", 
     RowBox[{"2", " ", "x"}]}], "]"}]}]}]], "Output",
 CellChangeTimes->{3.397958991848497*^9, 3.397959234773334*^9, 
  3.397960659460594*^9, 3.398159602982095*^9, 3.398741413233934*^9, 
  3.399547914507245*^9, 3.409056802078051*^9, 3.409811273580852*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Risch", "[", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"9", " ", 
      SuperscriptBox["x", "3"]}], "+", 
     RowBox[{"9", " ", 
      SuperscriptBox["x", "2"]}], "-", 
     RowBox[{"10", " ", "x"}], "+", "1"}], 
    RowBox[{
     RowBox[{
      RowBox[{"-", "10"}], " ", 
      SuperscriptBox["x", "2"]}], "-", "x", "+", "4"}]], ",", "x"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.395393537207687*^9, 3.395393554552436*^9}, {
  3.3953936291190863`*^9, 3.395393636918042*^9}, {3.395460968998282*^9, 
  3.3954609916193027`*^9}, {3.3975531869514914`*^9, 3.3975531904614*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{"81", " ", "x"}], "100"]}], "-", 
  FractionBox[
   RowBox[{"9", " ", 
    SuperscriptBox["x", "2"]}], "20"], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"116081", "-", 
      RowBox[{"9201", " ", 
       SqrtBox["161"]}]}], ")"}], " ", 
    RowBox[{"Log", "[", 
     RowBox[{"1", "-", 
      SqrtBox["161"], "+", 
      RowBox[{"20", " ", "x"}]}], "]"}]}], "322000"], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"116081", "+", 
      RowBox[{"9201", " ", 
       SqrtBox["161"]}]}], ")"}], " ", 
    RowBox[{"Log", "[", 
     RowBox[{"1", "+", 
      SqrtBox["161"], "+", 
      RowBox[{"20", " ", "x"}]}], "]"}]}], "322000"]}]], "Output",
 CellChangeTimes->{
  3.397958995248641*^9, 3.397959232867293*^9, 3.397960660824975*^9, 
   3.398159604034759*^9, {3.398741410311378*^9, 3.398741411852524*^9}, 
   3.409056803620604*^9, 3.409811274789983*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Risch", "[", 
  RowBox[{
   FractionBox["1", 
    RowBox[{
     SuperscriptBox["x", "10"], "+", 
     RowBox[{"n", " ", "x"}]}]], ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.395299190223978*^9, 3.395299278331729*^9}, {
   3.3952993318163767`*^9, 3.3952993321177053`*^9}, 3.395299830681575*^9, {
   3.395301761512946*^9, 3.3953017676284847`*^9}, {3.395301822767869*^9, 
   3.3953018412289143`*^9}, {3.3960032510768023`*^9, 3.39600325932401*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"Log", "[", "x", "]"}], "n"], "-", 
  FractionBox[
   RowBox[{"Log", "[", 
    RowBox[{"n", "+", 
     SuperscriptBox["x", "9"]}], "]"}], 
   RowBox[{"9", " ", "n"}]]}]], "Output",
 CellChangeTimes->{
  3.396267883018106*^9, 3.39632323760331*^9, 3.396324876327902*^9, {
   3.396342846394862*^9, 3.396342859079362*^9}, 3.3964861464484787`*^9, 
   3.396589492714405*^9, 3.397959019671723*^9, 3.397959226537781*^9, 
   3.397960666744925*^9, 3.398160015128811*^9, 3.3987392521541862`*^9, {
   3.398741416238522*^9, 3.3987414396486588`*^9}, {3.3987414889519987`*^9, 
   3.398741523101202*^9}, 3.3987415762750273`*^9, {3.398741628440208*^9, 
   3.398741629474671*^9}, {3.398741733441403*^9, 3.398741734305891*^9}, 
   3.3988508737776423`*^9, 3.4090568049621153`*^9, 3.40905687565097*^9, 
   3.409123082608344*^9, 3.409811276164955*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Risch", "[", 
  RowBox[{
   FractionBox["1", 
    RowBox[{
     SuperscriptBox["x", "12"], "-", "1"}]], ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.3982245019803057`*^9, 3.398224508288291*^9}, {
  3.39954760430192*^9, 3.3995476078996964`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "12"], " ", 
   RowBox[{"ArcTan", "[", 
    RowBox[{
     SqrtBox["3"], "-", 
     RowBox[{"2", " ", "x"}]}], "]"}]}], "-", 
  FractionBox[
   RowBox[{"ArcTan", "[", "x", "]"}], "6"], "-", 
  FractionBox[
   RowBox[{"ArcTan", "[", 
    FractionBox[
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"2", " ", "x"}]}], 
     SqrtBox["3"]], "]"}], 
   RowBox[{"4", " ", 
    SqrtBox["3"]}]], "-", 
  FractionBox[
   RowBox[{"ArcTan", "[", 
    FractionBox[
     RowBox[{"1", "+", 
      RowBox[{"2", " ", "x"}]}], 
     SqrtBox["3"]], "]"}], 
   RowBox[{"4", " ", 
    SqrtBox["3"]}]], "-", 
  RowBox[{
   FractionBox["1", "12"], " ", 
   RowBox[{"ArcTan", "[", 
    RowBox[{
     SqrtBox["3"], "+", 
     RowBox[{"2", " ", "x"}]}], "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "12"], " ", 
   RowBox[{"Log", "[", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "x"}], "]"}]}], "-", 
  RowBox[{
   FractionBox["1", "12"], " ", 
   RowBox[{"Log", "[", 
    RowBox[{"1", "+", "x"}], "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   RowBox[{"Log", "[", 
    RowBox[{"1", "-", "x", "+", 
     SuperscriptBox["x", "2"]}], "]"}]}], "-", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   RowBox[{"Log", "[", 
    RowBox[{"1", "+", "x", "+", 
     SuperscriptBox["x", "2"]}], "]"}]}], "+", 
  FractionBox[
   RowBox[{"Log", "[", 
    RowBox[{"1", "-", 
     RowBox[{
      SqrtBox["3"], " ", "x"}], "+", 
     SuperscriptBox["x", "2"]}], "]"}], 
   RowBox[{"8", " ", 
    SqrtBox["3"]}]], "-", 
  FractionBox[
   RowBox[{"Log", "[", 
    RowBox[{"1", "+", 
     RowBox[{
      SqrtBox["3"], " ", "x"}], "+", 
     SuperscriptBox["x", "2"]}], "]"}], 
   RowBox[{"8", " ", 
    SqrtBox["3"]}]]}]], "Output",
 CellChangeTimes->{
  3.398224508794421*^9, 3.398739136951118*^9, {3.3987416633886833`*^9, 
   3.3987416691892757`*^9}, 3.398741744914309*^9, {3.399547605481688*^9, 
   3.399547608477419*^9}, {3.399547721286121*^9, 3.399547733167564*^9}, {
   3.399547776952491*^9, 3.399547799729055*^9}, {3.399547842548418*^9, 
   3.399547858155096*^9}, 3.4040330268011103`*^9, 3.409056806667666*^9, 
   3.409123083242856*^9, 3.4098112781924257`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Risch", "[", 
  RowBox[{
   FractionBox[
    RowBox[{"x", "+", "10"}], 
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox["x", "3"]}], "-", 
     RowBox[{"2", " ", 
      SuperscriptBox["x", "2"]}], "-", 
     RowBox[{"6", " ", "x"}]}]], ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.395393302015298*^9, 3.395393391776202*^9}, {
  3.395393426891127*^9, 3.395393431240201*^9}, {3.398159907033947*^9, 
  3.398159909286332*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"2", " ", 
    RowBox[{"ArcTan", "[", 
     FractionBox[
      RowBox[{"1", "+", "x"}], 
      SqrtBox["5"]], "]"}]}], 
   RowBox[{"3", " ", 
    SqrtBox["5"]}]], "-", 
  FractionBox[
   RowBox[{"5", " ", 
    RowBox[{"Log", "[", "x", "]"}]}], "3"], "+", 
  RowBox[{
   FractionBox["5", "6"], " ", 
   RowBox[{"Log", "[", 
    RowBox[{"6", "+", 
     RowBox[{"2", " ", "x"}], "+", 
     SuperscriptBox["x", "2"]}], "]"}]}]}]], "Output",
 CellChangeTimes->{
  3.3979590017514963`*^9, {3.397959229512912*^9, 3.397959231243211*^9}, 
   3.397960662770692*^9, {3.39815960517208*^9, 3.398159618334578*^9}, {
   3.398159698813128*^9, 3.398159702380529*^9}, 3.398159746864716*^9, 
   3.3981598105334463`*^9, 3.398159869640431*^9, {3.398159902975232*^9, 
   3.398159910445507*^9}, 3.398741414870234*^9, 3.3987416470444508`*^9, 
   3.398741769592558*^9, 3.398850882045537*^9, 3.399547910630518*^9, 
   3.4090568085733232`*^9, 3.409123083755134*^9, 3.4098112815503807`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{"5", " ", 
       SuperscriptBox["x", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", 
         RowBox[{"3", " ", "x"}]}], ")"}]}], 
      RowBox[{"1", "+", 
       SuperscriptBox["x", "2"]}]]}], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"log", " ", "argument", " ", "now", " ", "monic"}], " ", 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.395312966706848*^9, 3.3953129714728413`*^9}, {
  3.3953135049284687`*^9, 3.395313510590351*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "10"}], " ", "x"}], "-", 
  FractionBox[
   RowBox[{"15", " ", 
    SuperscriptBox["x", "2"]}], "2"], "+", 
  RowBox[{"10", " ", 
   RowBox[{"ArcTan", "[", "x", "]"}]}], "+", 
  RowBox[{
   FractionBox["15", "2"], " ", 
   RowBox[{"Log", "[", 
    RowBox[{"1", "+", 
     SuperscriptBox["x", "2"]}], "]"}]}]}]], "Output",
 CellChangeTimes->{
  3.397959022521978*^9, {3.397959224717464*^9, 3.397959237090344*^9}, 
   3.397960668143199*^9, 3.398160018535934*^9, 3.398739249560266*^9, 
   3.39874164771733*^9, 3.398850883234342*^9, 3.409056811607909*^9, 
   3.4091230846516237`*^9, 3.409811283060961*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    FractionBox[
     RowBox[{"9", "-", 
      RowBox[{"4", " ", "x"}]}], 
     RowBox[{"4", " ", 
      SuperscriptBox["x", "2"], 
      RowBox[{"(", 
       RowBox[{"x", "-", "1"}], ")"}]}]], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"fixed", " ", "bug", " ", "in", " ", "hermite", " ", "reduction"}],
    " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.395314591685643*^9, 3.3953145969795933`*^9}, {
  3.395314656061125*^9, 3.395314671601905*^9}, {3.395314884359016*^9, 
  3.3953148902566233`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["9", 
   RowBox[{"4", " ", "x"}]], "+", 
  RowBox[{
   FractionBox["5", "4"], " ", 
   RowBox[{"Log", "[", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "x"}], "]"}]}], "-", 
  FractionBox[
   RowBox[{"5", " ", 
    RowBox[{"Log", "[", "x", "]"}]}], "4"]}]], "Output",
 CellChangeTimes->{3.396267888273736*^9, 3.3963248830606194`*^9, 
  3.396341844765932*^9, 3.396342868435513*^9, 3.396486148050622*^9, 
  3.396589494600253*^9, 3.3966035454223433`*^9, 3.3975534927350683`*^9, 
  3.3979590300414543`*^9, 3.3979592385032454`*^9, 3.3979606695940723`*^9, 
  3.3981600201415873`*^9, 3.398739247587521*^9, 3.398741650248781*^9, 
  3.398741793729774*^9, 3.3988508838777523`*^9, 3.409056813512417*^9, 
  3.409123085909683*^9, 3.409811283832163*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Risch", "[", 
  RowBox[{
   RowBox[{"1", "-", 
    FractionBox["1", "x"], "+", 
    SuperscriptBox["x", "2"]}], ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.392872710077875*^9, 3.392872714296625*^9}, {
  3.392873082140375*^9, 3.392873082921625*^9}, {3.392873695827875*^9, 
  3.392873696015375*^9}, {3.4090568223355093`*^9, 3.409056822925118*^9}}],

Cell[BoxData[
 RowBox[{"x", "+", 
  FractionBox[
   SuperscriptBox["x", "3"], "3"], "-", 
  RowBox[{"Log", "[", "x", "]"}]}]], "Output",
 CellChangeTimes->{
  3.396267890299274*^9, 3.3963248877293262`*^9, 3.396341846803866*^9, 
   3.396342971744533*^9, 3.396486148861779*^9, 3.396589495562207*^9, 
   3.39660354677168*^9, 3.397553528152214*^9, 3.397959240060102*^9, 
   3.398160020868071*^9, 3.398741650723772*^9, 3.398741795140081*^9, 
   3.398850884458885*^9, {3.409056815387724*^9, 3.4090568233528967`*^9}, 
   3.409123086673683*^9, 3.4098112843282022`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Risch", "[", 
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{"x", "+", "1"}], 
     RowBox[{
      SuperscriptBox["x", "2"], "+", "x", "+", "1"}]], "+", 
    FractionBox["1", 
     RowBox[{"1", "-", 
      SuperscriptBox["x", "4"]}]]}], ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.395198650062372*^9, 3.395198676789596*^9}, 
   3.397729510850438*^9, {3.409056833278714*^9, 3.409056848413597*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"ArcTan", "[", "x", "]"}], "2"], "+", 
  FractionBox[
   RowBox[{"ArcTan", "[", 
    FractionBox[
     RowBox[{"1", "+", 
      RowBox[{"2", " ", "x"}]}], 
     SqrtBox["3"]], "]"}], 
   SqrtBox["3"]], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   RowBox[{"Log", "[", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "x"}], "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   RowBox[{"Log", "[", 
    RowBox[{"1", "+", "x"}], "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"Log", "[", 
    RowBox[{"1", "+", "x", "+", 
     SuperscriptBox["x", "2"]}], "]"}]}]}]], "Output",
 CellChangeTimes->{
  3.396269426154015*^9, 3.3963248904222193`*^9, 3.396341853018836*^9, 
   3.396342978638792*^9, 3.396486149631645*^9, 3.3965894969067307`*^9, 
   3.396603548142812*^9, 3.396753550803606*^9, {3.397729330178698*^9, 
   3.397729331477314*^9}, 3.397729512081759*^9, 3.3979592413246183`*^9, 
   3.398160023491913*^9, 3.398739243909296*^9, 3.398741651269169*^9, 
   3.398741796163106*^9, 3.3988508851284227`*^9, 3.404033048995426*^9, {
   3.4090568313101892`*^9, 3.409056848784354*^9}, 3.4091230884654303`*^9, 
   3.409811284939931*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    FractionBox[
     RowBox[{
      SuperscriptBox["x", "4"], "-", 
      RowBox[{"3", 
       SuperscriptBox["x", "2"]}], "+", "6"}], 
     RowBox[{
      SuperscriptBox["x", "6"], "-", 
      RowBox[{"5", 
       SuperscriptBox["x", "4"]}], "+", 
      RowBox[{"5", 
       SuperscriptBox["x", "2"]}], "+", "4"}]], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"Bronstein", " ", "main", " ", "rational", " ", "example"}], " ", 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.3954976774725122`*^9, 3.3954977091841173`*^9}, {
  3.395498732003682*^9, 3.3954987378993893`*^9}, {3.3955475123819237`*^9, 
  3.395547512957924*^9}, {3.395740003602639*^9, 3.395740004943595*^9}, {
  3.3975535704835978`*^9, 3.397553571809107*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ArcTan", "[", "x", "]"}], "+", 
  RowBox[{"ArcTan", "[", 
   SuperscriptBox["x", "3"], "]"}], "+", 
  RowBox[{"ArcTan", "[", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{"x", "-", 
      RowBox[{"3", " ", 
       SuperscriptBox["x", "3"]}], "+", 
      SuperscriptBox["x", "5"]}], ")"}]}], "]"}]}]], "Output",
 CellChangeTimes->{3.397959033508589*^9, 3.397959245048049*^9, 
  3.397960677509541*^9, 3.3981600300745087`*^9, 3.39873924225531*^9, 
  3.398741652111002*^9, 3.398741797489008*^9, 3.398850886168027*^9, 
  3.404033056497015*^9, 3.409056852772664*^9, 3.409123089364624*^9, 
  3.409811287889166*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"RootSum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"4", 
             RowBox[{"#", "^", "2"}]}], "+", 
            RowBox[{"7", "#"}], "+", "9"}], "&"}], ",", 
          RowBox[{
           RowBox[{"#", " ", 
            RowBox[{"Log", "[", 
             RowBox[{
              RowBox[{"#", 
               RowBox[{"x", "^", "3"}]}], "+", 
              RowBox[{"3", "#", 
               SuperscriptBox["x", "2"]}], "+", "x", "-", "1"}], "]"}]}], 
           "&"}]}], "]"}], ",", "x"}], "]"}], "//", "Simplify"}], "//", 
     "ExpandDenominator"}], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"project", " ", "example"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.3955461163205338`*^9, 3.395546199990896*^9}, {
  3.395546236667686*^9, 3.395546306129064*^9}, {3.39554748762391*^9, 
  3.395547502300075*^9}, {3.395746942168351*^9, 3.395746945127812*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "4"], " ", 
   SqrtBox["95"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"ArcTan", "[", 
       FractionBox[
        RowBox[{"65", "+", 
         RowBox[{"72", " ", "x"}], "+", 
         RowBox[{"18", " ", 
          SuperscriptBox["x", "2"]}]}], 
        SqrtBox["95"]], "]"}]}], "+", 
     RowBox[{"ArcTan", "[", 
      FractionBox[
       RowBox[{"10", "+", 
        RowBox[{"4", " ", "x"}], "+", 
        RowBox[{"87", " ", 
         SuperscriptBox["x", "2"]}], "+", 
        RowBox[{"137", " ", 
         SuperscriptBox["x", "3"]}], "+", 
        RowBox[{"63", " ", 
         SuperscriptBox["x", "4"]}], "+", 
        RowBox[{"9", " ", 
         SuperscriptBox["x", "5"]}]}], 
       RowBox[{"2", " ", 
        SqrtBox["95"]}]], "]"}]}], ")"}]}], "-", 
  RowBox[{
   FractionBox["7", "8"], " ", 
   RowBox[{"Log", "[", 
    RowBox[{"4", "-", 
     RowBox[{"8", " ", "x"}], "+", 
     RowBox[{"25", " ", 
      SuperscriptBox["x", "2"]}], "-", 
     RowBox[{"14", " ", 
      SuperscriptBox["x", "3"]}], "+", 
     RowBox[{"74", " ", 
      SuperscriptBox["x", "4"]}], "+", 
     RowBox[{"54", " ", 
      SuperscriptBox["x", "5"]}], "+", 
     RowBox[{"9", " ", 
      SuperscriptBox["x", "6"]}]}], "]"}]}]}]], "Output",
 CellChangeTimes->{3.396267911390636*^9, 3.396269328114259*^9, 
  3.396324905309655*^9, 3.396486160664219*^9, 3.396589502538701*^9, 
  3.396603552406431*^9, 3.39772951740553*^9, 3.3979590382133703`*^9, 
  3.397959248310567*^9, 3.39796067404095*^9, 3.39816003124858*^9, 
  3.398739239980431*^9, 3.3987416527964497`*^9, 3.398741799454681*^9, 
  3.404033067530222*^9, 3.4090568557332706`*^9, 3.409811288637389*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    FractionBox[
     RowBox[{"2", " ", 
      SqrtBox["3"], " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"3", " ", 
         SuperscriptBox["x", "2"]}], "+", 
        RowBox[{"4", " ", 
         SqrtBox["3"], " ", 
         SuperscriptBox["x", "3"]}]}], ")"}]}], 
     RowBox[{"9", "+", "x", "-", 
      SuperscriptBox["x", "3"], "+", 
      RowBox[{
       SqrtBox["3"], " ", 
       SuperscriptBox["x", "4"]}]}]], ",", "x"}], "]"}], "+", 
  RowBox[{"Risch", "[", 
   RowBox[{
    FractionBox[
     RowBox[{"9", " ", 
      SqrtBox["11"], " ", 
      SuperscriptBox["x", "8"]}], 
     RowBox[{
      RowBox[{"-", 
       SqrtBox["3"]}], "+", 
      SuperscriptBox["x", "9"]}]], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"project", " ", "example"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.3955489280408993`*^9, 3.3955489327152863`*^9}, {
   3.395548970950427*^9, 3.395549037937289*^9}, 3.3955490686178102`*^9, 
   3.395549100183711*^9, 3.395549299357678*^9, {3.39554945407169*^9, 
   3.395549490978709*^9}, {3.39555106684389*^9, 3.395551072162417*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"2", " ", 
   SqrtBox["3"], " ", 
   RowBox[{"Log", "[", 
    RowBox[{
     RowBox[{"9", " ", 
      SqrtBox["3"]}], "+", 
     RowBox[{
      SqrtBox["3"], " ", "x"}], "-", 
     RowBox[{
      SqrtBox["3"], " ", 
      SuperscriptBox["x", "3"]}], "+", 
     RowBox[{"3", " ", 
      SuperscriptBox["x", "4"]}]}], "]"}]}], "+", 
  RowBox[{
   SqrtBox["11"], " ", 
   RowBox[{"Log", "[", 
    RowBox[{
     RowBox[{"-", 
      SqrtBox["3"]}], "+", 
     SuperscriptBox["x", "9"]}], "]"}]}]}]], "Output",
 CellChangeTimes->{3.396269325199464*^9, 3.396323349139346*^9, 
  3.396324909327877*^9, 3.39648616217914*^9, 3.396589503711216*^9, 
  3.3966035538103247`*^9, 3.397729519817507*^9, 3.397959042062743*^9, 
  3.397959251562003*^9, 3.397960675741193*^9, 3.3981600325588093`*^9, 
  3.398739237184454*^9, 3.398741654999147*^9, 3.398741800930203*^9, 
  3.398850891561942*^9, 3.404033069883984*^9, 3.4090568568380117`*^9, 
  3.409811289372973*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    FractionBox[
     RowBox[{"3", "+", 
      RowBox[{"3", " ", "x"}], "-", 
      RowBox[{"4", " ", 
       SuperscriptBox["x", "2"]}], "-", 
      RowBox[{"4", " ", 
       SuperscriptBox["x", "3"]}], "-", 
      RowBox[{"7", " ", 
       SuperscriptBox["x", "6"]}], "+", 
      RowBox[{"4", " ", 
       SuperscriptBox["x", "7"]}], "+", 
      RowBox[{"10", " ", 
       SuperscriptBox["x", "8"]}], "+", 
      RowBox[{"7", " ", 
       SuperscriptBox["x", "13"]}]}], 
     RowBox[{"1", "+", 
      RowBox[{"2", " ", "x"}], "-", 
      SuperscriptBox["x", "2"], "-", 
      RowBox[{"4", " ", 
       SuperscriptBox["x", "3"]}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["x", "4"]}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["x", "7"]}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["x", "8"]}], "+", 
      SuperscriptBox["x", "14"]}]], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"old", " ", "classic", " ", "example"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.397961387189767*^9, 3.3979613892139482`*^9}, 
   3.3979620415605593`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     SqrtBox["2"]}], ")"}], " ", 
   RowBox[{"Log", "[", 
    RowBox[{
     RowBox[{"-", "1"}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SqrtBox["2"]}], ")"}], " ", "x"}], "-", 
     RowBox[{
      SqrtBox["2"], " ", 
      SuperscriptBox["x", "2"]}], "+", 
     SuperscriptBox["x", "7"]}], "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     SqrtBox["2"]}], ")"}], " ", 
   RowBox[{"Log", "[", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SqrtBox["2"]}], ")"}], " ", "x"}], "+", 
     RowBox[{
      SqrtBox["2"], " ", 
      SuperscriptBox["x", "2"]}], "+", 
     SuperscriptBox["x", "7"]}], "]"}]}]}]], "Output",
 CellChangeTimes->{3.3979620420618343`*^9, 3.3981600353932*^9, 
  3.398739235406468*^9, 3.398741655875513*^9, 3.398741802692645*^9, 
  3.398850892874668*^9, 3.4090568575471077`*^9, 3.4098112900632343`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Risch", "[", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"-", "7"}], " ", 
      SqrtBox["2"], " ", 
      SuperscriptBox["x", "6"]}], "+", 
     RowBox[{"7", " ", 
      SuperscriptBox["x", "6"]}], "+", 
     RowBox[{"2", " ", 
      SqrtBox["2"], " ", "x"}], "-", 
     RowBox[{"4", " ", "x"}], "+", 
     RowBox[{"2", " ", 
      SqrtBox["2"]}], "-", "3"}], 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["x", "7"], "+", 
       RowBox[{
        SqrtBox["2"], " ", 
        SuperscriptBox["x", "2"]}], "+", 
       RowBox[{
        SqrtBox["2"], " ", "x"}], "-", "x", "-", "1"}], ")"}]}]], ",", "x"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.39796195327942*^9, 3.397961954303528*^9}, {
  3.3979620079082527`*^9, 3.397962018684659*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{"1", "-", 
    SqrtBox["2"]}], ")"}], " ", 
  RowBox[{"Log", "[", 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SqrtBox["2"]}], ")"}], " ", "x"}], "+", 
    RowBox[{
     SqrtBox["2"], " ", 
     SuperscriptBox["x", "2"]}], "+", 
    SuperscriptBox["x", "7"]}], "]"}]}]], "Output",
 CellChangeTimes->{3.397962019890603*^9, 3.3981600378225937`*^9, 
  3.3987392333279552`*^9, 3.3987416565167103`*^9, 3.398741804411249*^9, 
  3.398850893786079*^9, 3.409056858084762*^9, 3.409811290821148*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"integrand", "=", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"Log", "[", 
        FractionBox[
         RowBox[{
          RowBox[{
           SqrtBox["2"], 
           SuperscriptBox["x", "5"]}], "-", 
          SqrtBox["3"]}], 
         RowBox[{
          RowBox[{
           SqrtBox["7"], 
           SuperscriptBox["x", "3"]}], "+", "x", "+", "1"}]], "]"}], ",", 
       "x"}], "]"}], "//", "Apart"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"M", "-", " ", 
     RowBox[{"fails", " ", "on", " ", 
      RowBox[{"GCD", "'"}], 
      RowBox[{"s", ".", " ", "Apart"}], " ", "works", " ", "best", " ", 
      "here"}]}], "..."}], "  ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Map", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Risch", "[", 
     RowBox[{"#", ",", "x"}], "]"}], "&"}], ",", "integrand"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", "integrand", "]"}]}], "Input",
 CellChangeTimes->{{3.3905458334987497`*^9, 3.3905458872799997`*^9}, {
   3.3906272983125*^9, 3.390627325046875*^9}, {3.39062735534375*^9, 
   3.39062737528125*^9}, {3.390854213903*^9, 3.390854240153*^9}, {
   3.395190784359509*^9, 3.3951907846790743`*^9}, {3.3978918570815163`*^9, 
   3.3978918581374807`*^9}, {3.397891896732856*^9, 3.397891906089424*^9}, {
   3.397893241260062*^9, 3.3978932417911997`*^9}, {3.397893608295369*^9, 
   3.3978936093576603`*^9}, {3.3978941785960503`*^9, 3.397894189978467*^9}, {
   3.398140020124174*^9, 3.398140048267426*^9}, {3.398140132377161*^9, 
   3.398140134448308*^9}, {3.398140223815607*^9, 3.3981402386024218`*^9}, {
   3.3981403853871613`*^9, 3.398140395832061*^9}, {3.398140433564331*^9, 
   3.3981404649805927`*^9}, 3.398141303634437*^9, {3.3981600482583303`*^9, 
   3.398160051917037*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   RowBox[{"Log", "[", 
    RowBox[{
     FractionBox["1", "7"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1470"}], "+", 
       RowBox[{"1099", " ", 
        SqrtBox["6"]}], "+", 
       RowBox[{"4", " ", 
        SqrtBox["7"]}], "+", 
       RowBox[{"2", " ", 
        SqrtBox["42"]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", "x", "+", 
       RowBox[{
        SqrtBox["7"], " ", 
        SuperscriptBox["x", "3"]}]}], ")"}]}], "]"}]}], "+", 
  RowBox[{"Log", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1470"}], "+", 
      RowBox[{"1099", " ", 
       SqrtBox["6"]}], "+", 
      RowBox[{"4", " ", 
       SqrtBox["7"]}], "+", 
      RowBox[{"2", " ", 
       SqrtBox["42"]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SqrtBox["3"]}], "+", 
      RowBox[{
       SqrtBox["2"], " ", 
       SuperscriptBox["x", "5"]}]}], ")"}]}], "]"}]}]], "Output",
 CellChangeTimes->{{3.39814005785776*^9, 3.398140086322011*^9}, {
   3.398140125420725*^9, 3.3981401364031477`*^9}, {3.39814023044834*^9, 
   3.3981402419877367`*^9}, {3.398140385949341*^9, 3.3981403969182997`*^9}, 
   3.398140470357456*^9, 3.398140687489943*^9, {3.398140761694562*^9, 
   3.398140776244647*^9}, {3.3981408204739113`*^9, 3.3981408403394327`*^9}, 
   3.398140879030425*^9, {3.39814100370148*^9, 3.398141058717423*^9}, 
   3.398141104450214*^9, {3.3981411509130917`*^9, 3.39814117200168*^9}, 
   3.3981412101131773`*^9, {3.3981412962490377`*^9, 3.3981413049004374`*^9}, {
   3.398160042715487*^9, 3.3981600603810663`*^9}, 3.398741658592333*^9, 
   3.398850900091135*^9, 3.404033084654212*^9, 3.4091230970979548`*^9, 
   3.409811294204916*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    FractionBox["1", 
     RowBox[{
      SuperscriptBox["x", "12"], "-", "1"}]], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"should", " ", "factor", " ", "biquadratic"}], " ", 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.39817261877494*^9, 3.398172666269697*^9}, {
  3.3981727005364943`*^9, 3.398172710029985*^9}, {3.3987392228504353`*^9, 
  3.398739228311152*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "12"], " ", 
   RowBox[{"ArcTan", "[", 
    RowBox[{
     SqrtBox["3"], "-", 
     RowBox[{"2", " ", "x"}]}], "]"}]}], "-", 
  FractionBox[
   RowBox[{"ArcTan", "[", "x", "]"}], "6"], "-", 
  FractionBox[
   RowBox[{"ArcTan", "[", 
    FractionBox[
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"2", " ", "x"}]}], 
     SqrtBox["3"]], "]"}], 
   RowBox[{"4", " ", 
    SqrtBox["3"]}]], "-", 
  FractionBox[
   RowBox[{"ArcTan", "[", 
    FractionBox[
     RowBox[{"1", "+", 
      RowBox[{"2", " ", "x"}]}], 
     SqrtBox["3"]], "]"}], 
   RowBox[{"4", " ", 
    SqrtBox["3"]}]], "-", 
  RowBox[{
   FractionBox["1", "12"], " ", 
   RowBox[{"ArcTan", "[", 
    RowBox[{
     SqrtBox["3"], "+", 
     RowBox[{"2", " ", "x"}]}], "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "12"], " ", 
   RowBox[{"Log", "[", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "x"}], "]"}]}], "-", 
  RowBox[{
   FractionBox["1", "12"], " ", 
   RowBox[{"Log", "[", 
    RowBox[{"1", "+", "x"}], "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   RowBox[{"Log", "[", 
    RowBox[{"1", "-", "x", "+", 
     SuperscriptBox["x", "2"]}], "]"}]}], "-", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   RowBox[{"Log", "[", 
    RowBox[{"1", "+", "x", "+", 
     SuperscriptBox["x", "2"]}], "]"}]}], "+", 
  FractionBox[
   RowBox[{"Log", "[", 
    RowBox[{"1", "-", 
     RowBox[{
      SqrtBox["3"], " ", "x"}], "+", 
     SuperscriptBox["x", "2"]}], "]"}], 
   RowBox[{"8", " ", 
    SqrtBox["3"]}]], "-", 
  FractionBox[
   RowBox[{"Log", "[", 
    RowBox[{"1", "+", 
     RowBox[{
      SqrtBox["3"], " ", "x"}], "+", 
     SuperscriptBox["x", "2"]}], "]"}], 
   RowBox[{"8", " ", 
    SqrtBox["3"]}]]}]], "Output",
 CellChangeTimes->{{3.398172626165237*^9, 3.3981726815133553`*^9}, {
   3.398223636478819*^9, 3.398223658530113*^9}, 3.398223723434482*^9, 
   3.398223761406636*^9, 3.398223800271954*^9, 3.398223984029586*^9, {
   3.398224090559264*^9, 3.3982240959584093`*^9}, {3.3987391996553307`*^9, 
   3.3987392290242558`*^9}, 3.398741660094323*^9, 3.398741807704752*^9, 
   3.398850916250168*^9, 3.404033096273745*^9, 3.4091231020533047`*^9, 
   3.409811297117579*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Risch", "[", 
  RowBox[{
   FractionBox["1", 
    RowBox[{
     SuperscriptBox["x", "3"], "+", "1"}]], ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.398224490034368*^9, 3.3982244997842817`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"ArcTan", "[", 
    FractionBox[
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"2", " ", "x"}]}], 
     SqrtBox["3"]], "]"}], 
   SqrtBox["3"]], "+", 
  RowBox[{
   FractionBox["1", "3"], " ", 
   RowBox[{"Log", "[", 
    RowBox[{"1", "+", "x"}], "]"}]}], "-", 
  RowBox[{
   FractionBox["1", "6"], " ", 
   RowBox[{"Log", "[", 
    RowBox[{"1", "-", "x", "+", 
     SuperscriptBox["x", "2"]}], "]"}]}]}]], "Output",
 CellChangeTimes->{3.3982245002345133`*^9, 3.398739198456894*^9, 
  3.398741662811446*^9, 3.398741809807157*^9, 3.398850917222485*^9, 
  3.404033097142497*^9, 3.409123102790552*^9, 3.4098112977206078`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Risch", "[", 
  RowBox[{
   FractionBox["1", 
    RowBox[{
     SuperscriptBox["x", "6"], "+", "1"}]], ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.3982245125780783`*^9, 3.398224519168274*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    FractionBox["1", "6"]}], " ", 
   RowBox[{"ArcTan", "[", 
    RowBox[{
     SqrtBox["3"], "-", 
     RowBox[{"2", " ", "x"}]}], "]"}]}], "+", 
  FractionBox[
   RowBox[{"ArcTan", "[", "x", "]"}], "3"], "+", 
  RowBox[{
   FractionBox["1", "6"], " ", 
   RowBox[{"ArcTan", "[", 
    RowBox[{
     SqrtBox["3"], "+", 
     RowBox[{"2", " ", "x"}]}], "]"}]}], "-", 
  FractionBox[
   RowBox[{"Log", "[", 
    RowBox[{"1", "-", 
     RowBox[{
      SqrtBox["3"], " ", "x"}], "+", 
     SuperscriptBox["x", "2"]}], "]"}], 
   RowBox[{"4", " ", 
    SqrtBox["3"]}]], "+", 
  FractionBox[
   RowBox[{"Log", "[", 
    RowBox[{"1", "+", 
     RowBox[{
      SqrtBox["3"], " ", "x"}], "+", 
     SuperscriptBox["x", "2"]}], "]"}], 
   RowBox[{"4", " ", 
    SqrtBox["3"]}]]}]], "Output",
 CellChangeTimes->{3.3982245196955957`*^9, 3.39873913362951*^9, 
  3.398741811117935*^9, 3.3988509183316183`*^9, 3.404033098086591*^9, 
  3.409123104082192*^9, 3.409811298368518*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Risch", "[", 
  RowBox[{
   FractionBox["1", 
    RowBox[{
     SuperscriptBox["x", "8"], "+", "x", "+", "1"}]], ",", "x"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.398224532497403*^9, 3.398224542432356*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"8", " ", 
    RowBox[{"ArcTan", "[", 
     FractionBox[
      RowBox[{"1", "+", 
       RowBox[{"2", " ", "x"}]}], 
      SqrtBox["3"]], "]"}]}], 
   RowBox[{"19", " ", 
    SqrtBox["3"]}]], "-", 
  RowBox[{
   FractionBox["1", "19"], " ", 
   RowBox[{"Log", "[", 
    RowBox[{"1", "+", "x", "+", 
     SuperscriptBox["x", "2"]}], "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "19"], " ", 
   RowBox[{"RootSum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"1", "-", 
       SuperscriptBox["#1", "2"], "+", 
       SuperscriptBox["#1", "3"], "-", 
       SuperscriptBox["#1", "5"], "+", 
       SuperscriptBox["#1", "6"]}], "&"}], ",", 
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{"16", " ", 
         RowBox[{"Log", "[", 
          RowBox[{"x", "-", "#1"}], "]"}]}], "-", 
        RowBox[{"14", " ", 
         RowBox[{"Log", "[", 
          RowBox[{"x", "-", "#1"}], "]"}], " ", "#1"}], "+", 
        RowBox[{
         RowBox[{"Log", "[", 
          RowBox[{"x", "-", "#1"}], "]"}], " ", 
         SuperscriptBox["#1", "2"]}], "+", 
        RowBox[{"8", " ", 
         RowBox[{"Log", "[", 
          RowBox[{"x", "-", "#1"}], "]"}], " ", 
         SuperscriptBox["#1", "3"]}], "-", 
        RowBox[{"7", " ", 
         RowBox[{"Log", "[", 
          RowBox[{"x", "-", "#1"}], "]"}], " ", 
         SuperscriptBox["#1", "4"]}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"Log", "[", 
          RowBox[{"x", "-", "#1"}], "]"}], " ", 
         SuperscriptBox["#1", "5"]}]}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "#1"}], "+", 
        RowBox[{"3", " ", 
         SuperscriptBox["#1", "2"]}], "-", 
        RowBox[{"5", " ", 
         SuperscriptBox["#1", "4"]}], "+", 
        RowBox[{"6", " ", 
         SuperscriptBox["#1", "5"]}]}]], "&"}]}], "]"}]}]}]], "Output",
 CellChangeTimes->{3.39822454309182*^9, 3.3987390535775013`*^9, 
  3.3987418143262863`*^9, 3.398850936427019*^9, 3.400766585375835*^9, 
  3.4090568635407877`*^9, 3.409123112632269*^9, 3.4098112993042917`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Risch", "[", 
  RowBox[{
   FractionBox[
    RowBox[{
     SuperscriptBox["x", "77"], "-", "1"}], 
    RowBox[{
     SuperscriptBox["x", "12"], "-", "1"}]], ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.398738933898047*^9, 3.398738985303022*^9}, {
   3.398739016681818*^9, 3.398739022763235*^9}, 3.759207210106471*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   SuperscriptBox["x", "6"], "6"], "+", 
  FractionBox[
   SuperscriptBox["x", "18"], "18"], "+", 
  FractionBox[
   SuperscriptBox["x", "30"], "30"], "+", 
  FractionBox[
   SuperscriptBox["x", "42"], "42"], "+", 
  FractionBox[
   SuperscriptBox["x", "54"], "54"], "+", 
  FractionBox[
   SuperscriptBox["x", "66"], "66"], "-", 
  RowBox[{
   FractionBox["1", "12"], " ", 
   RowBox[{"ArcTan", "[", 
    RowBox[{
     SqrtBox["3"], "-", 
     RowBox[{"2", " ", "x"}]}], "]"}]}], "+", 
  FractionBox[
   RowBox[{"ArcTan", "[", "x", "]"}], "6"], "+", 
  FractionBox[
   RowBox[{"ArcTan", "[", 
    FractionBox[
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"2", " ", "x"}]}], 
     SqrtBox["3"]], "]"}], 
   RowBox[{"4", " ", 
    SqrtBox["3"]}]], "+", 
  FractionBox[
   RowBox[{"ArcTan", "[", 
    FractionBox[
     RowBox[{"1", "+", 
      RowBox[{"2", " ", "x"}]}], 
     SqrtBox["3"]], "]"}], 
   RowBox[{"4", " ", 
    SqrtBox["3"]}]], "+", 
  RowBox[{
   FractionBox["1", "12"], " ", 
   RowBox[{"ArcTan", "[", 
    RowBox[{
     SqrtBox["3"], "+", 
     RowBox[{"2", " ", "x"}]}], "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "6"], " ", 
   RowBox[{"Log", "[", 
    RowBox[{"1", "+", "x"}], "]"}]}], "-", 
  RowBox[{
   FractionBox["1", "12"], " ", 
   RowBox[{"Log", "[", 
    RowBox[{"1", "+", 
     SuperscriptBox["x", "2"]}], "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   RowBox[{"Log", "[", 
    RowBox[{"1", "-", "x", "+", 
     SuperscriptBox["x", "2"]}], "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   RowBox[{"Log", "[", 
    RowBox[{"1", "+", "x", "+", 
     SuperscriptBox["x", "2"]}], "]"}]}], "-", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   RowBox[{"(", 
    RowBox[{"2", "+", 
     SqrtBox["3"]}], ")"}], " ", 
   RowBox[{"Log", "[", 
    RowBox[{"1", "-", 
     RowBox[{
      SqrtBox["3"], " ", "x"}], "+", 
     SuperscriptBox["x", "2"]}], "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "2"}], "+", 
     SqrtBox["3"]}], ")"}], " ", 
   RowBox[{"Log", "[", 
    RowBox[{"1", "+", 
     RowBox[{
      SqrtBox["3"], " ", "x"}], "+", 
     SuperscriptBox["x", "2"]}], "]"}]}]}]], "Output",
 CellChangeTimes->{{3.398738941989766*^9, 3.398738987092564*^9}, 
   3.398741817422442*^9, 3.398850938949176*^9, 3.404033132383463*^9, 
   3.4091231142129173`*^9, 3.40981130152957*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Risch", "[", 
  RowBox[{
   FractionBox[
    RowBox[{"100", "+", 
     RowBox[{"136", " ", "x"}], "-", 
     RowBox[{"24", " ", 
      SuperscriptBox["x", "2"]}], "-", 
     RowBox[{"60", " ", 
      SuperscriptBox["x", "3"]}], "+", 
     RowBox[{"34", " ", 
      SuperscriptBox["x", "4"]}], "+", 
     RowBox[{"48", " ", 
      SuperscriptBox["x", "5"]}], "+", 
     RowBox[{"20", " ", 
      SuperscriptBox["x", "6"]}], "+", 
     RowBox[{"4", " ", 
      SuperscriptBox["x", "7"]}]}], 
    RowBox[{"43", "+", 
     RowBox[{"98", " ", "x"}], "+", 
     RowBox[{"28", " ", 
      SuperscriptBox["x", "2"]}], "-", 
     RowBox[{"64", " ", 
      SuperscriptBox["x", "3"]}], "-", 
     RowBox[{"33", " ", 
      SuperscriptBox["x", "4"]}], "+", 
     RowBox[{"10", " ", 
      SuperscriptBox["x", "5"]}], "+", 
     RowBox[{"10", " ", 
      SuperscriptBox["x", "6"]}], "+", 
     RowBox[{"4", " ", 
      SuperscriptBox["x", "7"]}], "+", 
     SuperscriptBox["x", "8"]}]], ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.407617295869437*^9, 3.407617302735971*^9}, {
  3.40761739498382*^9, 3.4076174068615713`*^9}, {3.407617485507448*^9, 
  3.407617509942054*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SqrtBox["3"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"ArcTan", "[", 
      FractionBox[
       RowBox[{"1", "+", 
        RowBox[{"2", " ", "x"}]}], 
       RowBox[{"4", " ", 
        SqrtBox["3"]}]], "]"}], "+", 
     RowBox[{"ArcTan", "[", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "29"}], "+", 
        RowBox[{"38", " ", "x"}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["x", "2"]}], "+", 
        RowBox[{"4", " ", 
         SuperscriptBox["x", "3"]}]}], 
       RowBox[{"18", " ", 
        SqrtBox["3"]}]], "]"}], "+", 
     RowBox[{"ArcTan", "[", 
      FractionBox[
       RowBox[{"13345", "-", 
        RowBox[{"10078", " ", "x"}], "-", 
        RowBox[{"5200", " ", 
         SuperscriptBox["x", "2"]}], "+", 
        RowBox[{"4576", " ", 
         SuperscriptBox["x", "3"]}], "+", 
        RowBox[{"684", " ", 
         SuperscriptBox["x", "4"]}], "+", 
        RowBox[{"792", " ", 
         SuperscriptBox["x", "5"]}]}], 
       RowBox[{"4356", " ", 
        SqrtBox["3"]}]], "]"}], "+", 
     RowBox[{"ArcTan", "[", 
      FractionBox[
       RowBox[{"32995", "+", 
        RowBox[{"40260", " ", "x"}], "-", 
        RowBox[{"19888", " ", 
         SuperscriptBox["x", "2"]}], "-", 
        RowBox[{"27104", " ", 
         SuperscriptBox["x", "3"]}], "+", 
        RowBox[{"2026", " ", 
         SuperscriptBox["x", "4"]}], "+", 
        RowBox[{"5548", " ", 
         SuperscriptBox["x", "5"]}], "+", 
        RowBox[{"2268", " ", 
         SuperscriptBox["x", "6"]}], "+", 
        RowBox[{"792", " ", 
         SuperscriptBox["x", "7"]}]}], 
       RowBox[{"1129", " ", 
        SqrtBox["3"]}]], "]"}]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"Log", "[", 
    RowBox[{"43", "+", 
     RowBox[{"98", " ", "x"}], "+", 
     RowBox[{"28", " ", 
      SuperscriptBox["x", "2"]}], "-", 
     RowBox[{"64", " ", 
      SuperscriptBox["x", "3"]}], "-", 
     RowBox[{"33", " ", 
      SuperscriptBox["x", "4"]}], "+", 
     RowBox[{"10", " ", 
      SuperscriptBox["x", "5"]}], "+", 
     RowBox[{"10", " ", 
      SuperscriptBox["x", "6"]}], "+", 
     RowBox[{"4", " ", 
      SuperscriptBox["x", "7"]}], "+", 
     SuperscriptBox["x", "8"]}], "]"}]}]}]], "Output",
 CellChangeTimes->{{3.407617497166975*^9, 3.4076175107407007`*^9}, 
   3.409123114567485*^9, 3.409811303919574*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    FractionBox["1", 
     RowBox[{
      SuperscriptBox["x", "4"], "-", 
      SuperscriptBox["a", "4"]}]], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"BUG", "!!"}], " ", "fixed", " ", 
    RowBox[{
     RowBox[{"21", "/", "11"}], "/", "07"}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.401348970114998*^9, 3.40134899133305*^9}, {
  3.401350226159231*^9, 3.401350228785791*^9}, {3.404546023507913*^9, 
  3.40454602381317*^9}, {3.404549645642398*^9, 3.4045496541089354`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{"ArcTan", "[", 
     FractionBox["x", "a"], "]"}], 
    RowBox[{"2", " ", 
     SuperscriptBox["a", "3"]}]]}], "+", 
  FractionBox[
   RowBox[{"Log", "[", 
    RowBox[{
     RowBox[{"-", "a"}], "+", "x"}], "]"}], 
   RowBox[{"4", " ", 
    SuperscriptBox["a", "3"]}]], "-", 
  FractionBox[
   RowBox[{"Log", "[", 
    RowBox[{"a", "+", "x"}], "]"}], 
   RowBox[{"4", " ", 
    SuperscriptBox["a", "3"]}]]}]], "Output",
 CellChangeTimes->{
  3.404544929848249*^9, {3.404545141034731*^9, 3.4045451421149406`*^9}, 
   3.404545310633513*^9, {3.404545376174234*^9, 3.4045453822481003`*^9}, {
   3.404546018669029*^9, 3.4045460246260757`*^9}, {3.40454618667802*^9, 
   3.404546191794117*^9}, 3.40454633776525*^9, {3.4045463793511057`*^9, 
   3.404546386855132*^9}, 3.404546426907403*^9, {3.404546670108665*^9, 
   3.404546673963019*^9}, {3.40454682936383*^9, 3.404546844885552*^9}, 
   3.404547028521673*^9, 3.4045470690035763`*^9, {3.40454832684337*^9, 
   3.4045483591583147`*^9}, {3.404548517414304*^9, 3.4045485595947247`*^9}, {
   3.404548612464027*^9, 3.404548619034534*^9}, {3.404548654199626*^9, 
   3.404548684234845*^9}, 3.4045487664366293`*^9, 3.404549022034005*^9, 
   3.404549130018523*^9, 3.404549637621876*^9, 3.4049854903292637`*^9, 
   3.408009366908205*^9, 3.4090205537714567`*^9, 3.40905686734895*^9, 
   3.409811304671605*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Log/Exp Rational Functions", "Subsection",
 CellChangeTimes->{{3.396342110190921*^9, 3.3963421237331247`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Risch", "[", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"1", "+", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"2", " ", "x"}]], "+", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"4", " ", "x"}]]}]], ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.4100798604617643`*^9, 3.4100798879226227`*^9}, {
  3.410080686977997*^9, 3.4100806888230953`*^9}, {3.410081295820956*^9, 
  3.4100812984427567`*^9}, {3.4100813293971577`*^9, 3.4100813303306627`*^9}, {
  3.410081465141109*^9, 3.41008150487234*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox["1", "2"]}], " ", 
  RowBox[{"RootSum", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"1", "+", 
      SuperscriptBox["#1", "2"], "+", 
      SuperscriptBox["#1", "4"]}], "&"}], ",", 
    RowBox[{
     FractionBox[
      RowBox[{"Log", "[", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", "x"], "-", "#1"}], "]"}], 
      RowBox[{"2", "+", 
       SuperscriptBox["#1", "2"]}]], "&"}]}], "]"}]}]], "Output",
 CellChangeTimes->{
  3.4100806913588953`*^9, {3.410081087837092*^9, 3.410081105007695*^9}, {
   3.41008114126373*^9, 3.410081201747244*^9}, {3.4100812804830713`*^9, 
   3.410081330746695*^9}, {3.410081377279642*^9, 3.410081385225572*^9}, {
   3.4100814422359047`*^9, 3.4100814654600077`*^9}, {3.410081505711443*^9, 
   3.4100815125758543`*^9}, 3.410081611069681*^9, {3.41039600150066*^9, 
   3.4103960438489428`*^9}, {3.410397234995957*^9, 3.410397237182789*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Risch", "[", 
  RowBox[{
   FractionBox["1", 
    RowBox[{
     RowBox[{"Exp", "[", 
      RowBox[{"2", "x"}], "]"}], "+", 
     RowBox[{"Exp", "[", "x", "]"}], "-", "1"}]], ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.409892322724633*^9, 3.4098923366583443`*^9}, {
  3.410081542517516*^9, 3.410081549789259*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "10"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "5"}], "-", 
     SqrtBox["5"]}], ")"}], " ", "x"}], "+", 
  RowBox[{
   FractionBox["1", "10"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "5"}], "+", 
     SqrtBox["5"]}], ")"}], " ", "x"}], "+", 
  RowBox[{
   FractionBox["1", "10"], " ", 
   RowBox[{"(", 
    RowBox[{"5", "+", 
     SqrtBox["5"]}], ")"}], " ", 
   RowBox[{"Log", "[", 
    RowBox[{
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{"3", "+", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "5"}], "-", 
           SqrtBox["5"]}], ")"}]}]}], ")"}]}], "+", 
     RowBox[{"2", " ", 
      SuperscriptBox["\[ExponentialE]", "x"]}]}], "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "10"], " ", 
   RowBox[{"(", 
    RowBox[{"5", "-", 
     SqrtBox["5"]}], ")"}], " ", 
   RowBox[{"Log", "[", 
    RowBox[{
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{"3", "+", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "5"}], "+", 
           SqrtBox["5"]}], ")"}]}]}], ")"}]}], "+", 
     RowBox[{"2", " ", 
      SuperscriptBox["\[ExponentialE]", "x"]}]}], "]"}]}]}]], "Output",
 CellChangeTimes->{
  3.4098923391573668`*^9, {3.409906895211122*^9, 3.409906914492385*^9}, {
   3.410081538240109*^9, 3.410081550202434*^9}, 3.4103960654728003`*^9, 
   3.4103972383009043`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"x", "+", "1"}], ")"}], 
       SuperscriptBox["\[ExponentialE]", 
        SuperscriptBox["x", "2"]]}], "+", "1"}], 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        SuperscriptBox["\[ExponentialE]", 
         SuperscriptBox["x", "2"]], ")"}], "2"], "-", "1"}]], ",", "x"}], 
   "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"Bronstein", " ", "p", ".180"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.396006070731677*^9, 3.3960061467376623`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PureLogPart", "::", "\<\"warning\"\>"}], ":", 
  " ", "\<\"Integral not elementary -- roots of resultant polynomial are non \
constant.\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.396873380201611*^9, 3.397891106185584*^9, 
  3.398741823514264*^9, 3.398851767173074*^9, 3.409123125119751*^9, 
  3.409889216777845*^9, 3.4099069155680428`*^9, 3.410396066869278*^9, 
  3.4103972391187696`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"Risch", "[", 
   RowBox[{
    FractionBox[
     RowBox[{"1", "+", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        SuperscriptBox["x", "2"]], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "x"}], ")"}]}]}], 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"2", " ", 
        SuperscriptBox["x", "2"]}]]}]], ",", "x"}], "]"}],
  HoldForm]], "Output",
 CellChangeTimes->{3.396873380204722*^9, 3.3978911061886683`*^9, 
  3.3987418235185413`*^9, 3.398851767177394*^9, 3.409123125123665*^9, 
  3.4098892167819853`*^9, 3.4099069155718937`*^9, 3.410396066873271*^9, 
  3.4103972391230383`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    FractionBox[
     RowBox[{
      SuperscriptBox["\[ExponentialE]", "x"], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "x", "-", 
        RowBox[{"x", " ", 
         RowBox[{"Log", "[", "x", "]"}]}]}], ")"}]}], 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"Log", "[", "x", "]"}]}], ")"}], "2"], " ", "x"}]], ",", 
    "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"Hermite", " ", "reduction", " ", "example"}], " ", 
   "*)"}]}]], "Input",
 CellChangeTimes->{
  3.396159439547179*^9, 3.3961715089507933`*^9, {3.396171552950946*^9, 
   3.396171578144607*^9}, {3.396171627346381*^9, 3.396171628840521*^9}, {
   3.3961717822112627`*^9, 3.39617179558593*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   SuperscriptBox["\[ExponentialE]", "x"], 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    RowBox[{"Log", "[", "x", "]"}]}]]}]], "Output",
 CellChangeTimes->{3.396267846616652*^9, 3.396269496100628*^9, 
  3.3962695322064953`*^9, 3.396323075672195*^9, 3.3963248402953663`*^9, 
  3.396337483314062*^9, 3.396483604423181*^9, 3.396590448008627*^9, 
  3.396600832337389*^9, 3.396603697028504*^9, 3.396665862107736*^9, 
  3.396699680196918*^9, 3.3967508561148663`*^9, 3.3967509152983923`*^9, 
  3.396752241186631*^9, 3.396753511756621*^9, 3.396873380931175*^9, 
  3.39789111602488*^9, 3.398741827507876*^9, 3.3988517824413767`*^9, 
  3.409123126268622*^9, 3.409123195739002*^9, 3.409889234280703*^9, 
  3.4099069171662483`*^9, 3.4103960679182987`*^9, 3.41039723987239*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SuperscriptBox["\[ExponentialE]", "x"], "-", "x", "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["\[ExponentialE]", "x"], " ", "x"}]}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["\[ExponentialE]", "x"]}], ")"}], " ", "x"}]], ",", 
    "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{
   "fixed", " ", "inequalities", " ", "for", " ", "long", " ", "division"}], 
   " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.3955443345960903`*^9, 3.395544359903598*^9}, {
  3.395544407508429*^9, 3.395544432623474*^9}, {3.395578636513509*^9, 
  3.39557864225476*^9}, {3.39558188666615*^9, 3.395581900303277*^9}, {
  3.39634318486819*^9, 3.396343191990941*^9}}],

Cell[BoxData[
 RowBox[{"x", "+", 
  RowBox[{"Log", "[", 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    SuperscriptBox["\[ExponentialE]", "x"]}], "]"}], "+", 
  RowBox[{"Log", "[", "x", "]"}]}]], "Output",
 CellChangeTimes->{3.3962678625727673`*^9, 3.396269465341691*^9, 
  3.396324847092942*^9, 3.396483610179913*^9, 3.396590448546067*^9, 
  3.3966008338042297`*^9, 3.396603697554929*^9, 3.396665862938839*^9, 
  3.396699681549697*^9, 3.396750916138624*^9, 3.396753512246696*^9, 
  3.39687338144829*^9, 3.397992881279285*^9, 3.39874182906819*^9, 
  3.398851804057439*^9, 3.409123126882511*^9, 3.409123196407804*^9, 
  3.409889235005234*^9, 3.409906918053424*^9, 3.410396072331555*^9, 
  3.410397240729519*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    FractionBox[
     RowBox[{"1", "-", 
      RowBox[{"Log", "[", "x", "]"}]}], 
     RowBox[{
      SuperscriptBox["x", "2"], "-", 
      SuperscriptBox[
       RowBox[{"Log", "[", "x", "]"}], "2"]}]], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "example", " ", "that", " ", "can", " ", "be", " ", "done", " ", "with", 
     " ", "the", " ", "parallel", " ", "Risch"}], ",", " ", 
    RowBox[{"but", " ", "is", " ", "too", " ", "slow"}]}], " ", 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.39364369595175*^9, 3.393643706936125*^9}, {
  3.393644807186125*^9, 3.393644828108*^9}, {3.394160100871875*^9, 
  3.394160101996875*^9}, {3.394310194388875*^9, 3.39431019749825*^9}, {
  3.395540827166276*^9, 3.3955408293959303`*^9}, {3.396096833257154*^9, 
  3.3960968343929167`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    FractionBox["1", "2"]}], " ", 
   RowBox[{"Log", "[", 
    RowBox[{
     RowBox[{"-", "x"}], "+", 
     RowBox[{"Log", "[", "x", "]"}]}], "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"Log", "[", 
    RowBox[{"x", "+", 
     RowBox[{"Log", "[", "x", "]"}]}], "]"}]}]}]], "Output",
 CellChangeTimes->{
  3.3962678729453793`*^9, 3.396323164593174*^9, 3.3963248627903643`*^9, 
   3.3964836154739323`*^9, 3.396590449296302*^9, 3.396600834878269*^9, 
   3.3966036980122757`*^9, 3.3966658639392023`*^9, 3.3966996817397213`*^9, 
   3.3967509170041523`*^9, 3.3967535128265953`*^9, 3.396873382061236*^9, 
   3.3988518048664513`*^9, 3.4046744789904757`*^9, 3.409123197423523*^9, 
   3.409889248096119*^9, {3.40990691874083*^9, 3.409906938456892*^9}, 
   3.409906987604361*^9, 3.409907172643889*^9, 3.410396073167955*^9, 
   3.4103972449758244`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Risch", "[", 
  RowBox[{
   FractionBox[
    RowBox[{"1", "+", 
     RowBox[{"2", " ", 
      SuperscriptBox["x", "2"], " ", 
      SuperscriptBox[
       RowBox[{"Log", "[", 
        RowBox[{"1", "+", 
         SuperscriptBox["x", "2"]}], "]"}], "3"]}], "+", 
     RowBox[{"2", " ", "x", " ", 
      SuperscriptBox[
       RowBox[{"Log", "[", 
        RowBox[{"1", "+", 
         SuperscriptBox["x", "2"]}], "]"}], "4"]}]}], 
    RowBox[{"x", "+", 
     RowBox[{"Log", "[", 
      RowBox[{"1", "+", 
       SuperscriptBox["x", "2"]}], "]"}]}]], ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.394404418858625*^9, 3.394404424764875*^9}, {
   3.394405482014875*^9, 3.39440550237425*^9}, {3.39440560362425*^9, 
   3.39440563156175*^9}, {3.3944134084055*^9, 3.394413415608625*^9}, {
   3.394414650952375*^9, 3.39441465199925*^9}, {3.3951491277863007`*^9, 
   3.395149133625929*^9}, {3.3953080999861813`*^9, 3.3953081136880503`*^9}, 
   3.395312214813051*^9, 3.4103973127153597`*^9}],

Cell[BoxData[
 RowBox[{"Risch", "[", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"Log", "[", "x", "]"}], "-", "1"}], 
    RowBox[{
     RowBox[{"Log", "[", "x", "]"}], "+", "1"}]], ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.394414003764875*^9, 3.394414012983625*^9}, {
   3.394414658358625*^9, 3.39441465943675*^9}, 3.396342852202752*^9}],

Cell[BoxData[
 RowBox[{"Risch", "[", 
  RowBox[{
   FractionBox[
    RowBox[{"1", "+", 
     RowBox[{"x", " ", 
      SuperscriptBox[
       RowBox[{"Log", "[", 
        RowBox[{"1", "+", "x", "+", 
         SuperscriptBox["x", "2"]}], "]"}], "2"]}], "+", 
     RowBox[{"2", " ", 
      SuperscriptBox["x", "2"], " ", 
      SuperscriptBox[
       RowBox[{"Log", "[", 
        RowBox[{"1", "+", "x", "+", 
         SuperscriptBox["x", "2"]}], "]"}], "2"]}]}], 
    RowBox[{"x", " ", 
     RowBox[{"Log", "[", 
      RowBox[{"1", "+", "x", "+", 
       SuperscriptBox["x", "2"]}], "]"}]}]], ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.3944266838268747`*^9, 3.3944266873424997`*^9}, {
  3.3944268032018747`*^9, 3.3944268035143747`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"1", "+", 
      RowBox[{"Exp", "[", "x", "]"}]}]], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{
   "classic", " ", "example", " ", "of", " ", "RT", " ", "returning", " ", 
    "a", " ", "polynomial", " ", "part"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.3951968769499073`*^9, 3.395196906248102*^9}, {
   3.395197310699965*^9, 3.3951973157387123`*^9}, {3.3951988528319798`*^9, 
   3.395198855784886*^9}, {3.395199619332144*^9, 3.395199631507902*^9}, {
   3.395200203277658*^9, 3.395200203666642*^9}, {3.395200470938662*^9, 
   3.395200480135952*^9}, {3.395200511734728*^9, 3.3952005120280437`*^9}, {
   3.395578414761825*^9, 3.3955784365170937`*^9}, 3.395731939505364*^9, {
   3.396005664310009*^9, 3.396005718044113*^9}}],

Cell[BoxData[
 RowBox[{"x", "-", 
  RowBox[{"Log", "[", 
   RowBox[{"1", "+", 
    SuperscriptBox["\[ExponentialE]", "x"]}], "]"}]}]], "Output",
 CellChangeTimes->{3.3962678911875057`*^9, 3.396323263260676*^9, 
  3.396324888479044*^9, 3.396341850245131*^9, 3.396342972341473*^9, 
  3.396483637838348*^9, 3.396590453168819*^9, 3.3966008399744673`*^9, 
  3.3966037020803432`*^9, 3.396665867326159*^9, 3.396699685671846*^9, 
  3.396750924850459*^9, 3.396752216199765*^9, 3.3967535172056227`*^9, 
  3.396873384213484*^9, 3.398851837136406*^9, 3.409123212139042*^9, 
  3.409889272266089*^9, 3.4099071771474123`*^9, 3.410396130411509*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"rischDebug", "=", "True"}], ";"}]], "Input",
 CellChangeTimes->{{3.409907188882751*^9, 3.409907191628834*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"x", 
       RowBox[{"(", 
        RowBox[{"x", "+", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["x", "2"], " ", 
             RowBox[{"Exp", "[", 
              RowBox[{"2", 
               SuperscriptBox["x", "2"]}], "]"}]}], "-", 
            SuperscriptBox[
             RowBox[{"Log", "[", 
              RowBox[{"x", "+", "1"}], "]"}], "2"]}], ")"}], "2"], "+", 
         RowBox[{"2", "x", " ", 
          RowBox[{"Exp", "[", 
           RowBox[{"3", 
            SuperscriptBox["x", "2"]}], "]"}], 
          RowBox[{"(", 
           RowBox[{"x", "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", 
                SuperscriptBox["x", "3"]}], "+", 
               RowBox[{"2", 
                SuperscriptBox["x", "2"]}], "+", "x", "+", "1"}], ")"}], 
             RowBox[{"Log", "[", 
              RowBox[{"x", "+", "1"}], "]"}]}]}], ")"}]}]}], ")"}]}], ")"}], 
     "/", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"x", "+", "1"}], ")"}], 
         SuperscriptBox[
          RowBox[{"Log", "[", 
           RowBox[{"x", "+", "1"}], "]"}], "2"]}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["x", "3"], "+", 
           SuperscriptBox["x", "2"]}], ")"}], 
         RowBox[{"Exp", "[", 
          RowBox[{"2", 
           SuperscriptBox["x", "2"]}], "]"}]}]}], ")"}], "2"]}], ",", "x"}], 
   "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Example", " ", "from", " ", "Geddes", " ", "et", " ", "al"}], 
    ",", " ", 
    RowBox[{
     RowBox[{"faster", " ", "then", " ", "M"}], "-"}]}], " ", 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.395487380257053*^9, 3.395487491394416*^9}, {
  3.395487753850424*^9, 3.395487755027108*^9}, {3.395489196156868*^9, 
  3.395489199760928*^9}, {3.395489468270876*^9, 3.395489469088231*^9}, {
  3.395490350580353*^9, 3.395490364134748*^9}, {3.395490510691875*^9, 
  3.395490527866481*^9}, {3.395490803720604*^9, 3.395490804447178*^9}, {
  3.395490881627553*^9, 3.395490883644759*^9}, {3.397554754268858*^9, 
  3.3975547565197353`*^9}}],

Cell[BoxData[
 RowBox[{"x", "-", 
  RowBox[{"Log", "[", 
   RowBox[{"1", "+", "x"}], "]"}], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     SuperscriptBox["x", "2"]], " ", "x", " ", 
    RowBox[{"Log", "[", 
     RowBox[{"1", "+", "x"}], "]"}]}], 
   RowBox[{
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"2", " ", 
       SuperscriptBox["x", "2"]}]], " ", 
     SuperscriptBox["x", "2"]}], "-", 
    SuperscriptBox[
     RowBox[{"Log", "[", 
      RowBox[{"1", "+", "x"}], "]"}], "2"]}]], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"Log", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["\[ExponentialE]", 
        SuperscriptBox["x", "2"]]}], " ", "x"}], "+", 
     RowBox[{"Log", "[", 
      RowBox[{"1", "+", "x"}], "]"}]}], "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"Log", "[", 
    RowBox[{
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       SuperscriptBox["x", "2"]], " ", "x"}], "+", 
     RowBox[{"Log", "[", 
      RowBox[{"1", "+", "x"}], "]"}]}], "]"}]}]}]], "Output",
 CellChangeTimes->{3.409907450110425*^9, 3.4099084751507463`*^9, 
  3.4103961341348877`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    FractionBox[
     RowBox[{
      SuperscriptBox[
       RowBox[{"Log", "[", "x", "]"}], "3"], "-", 
      SuperscriptBox[
       RowBox[{"Log", "[", "x", "]"}], "2"], "-", 
      RowBox[{
       SuperscriptBox["x", "2"], " ", 
       RowBox[{"Log", "[", "x", "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "/", "x"}], ")"}], 
       RowBox[{"Log", "[", "x", "]"}]}], "+", 
      SuperscriptBox["x", "2"], "+", "x"}], 
     RowBox[{
      SuperscriptBox[
       RowBox[{"Log", "[", "x", "]"}], "4"], "-", 
      RowBox[{"2", 
       SuperscriptBox["x", "2"], 
       SuperscriptBox[
        RowBox[{"Log", "[", "x", "]"}], "2"]}], "+", 
      SuperscriptBox["x", "4"]}]], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"problem", " ", "8", " ", "from", " ", "geddes"}], ",", " ", 
    RowBox[{"integral", " ", "not", " ", "elementary"}]}], " ", 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.395545246251137*^9, 3.395545302732984*^9}, {
  3.3955453379282007`*^9, 3.395545352114374*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PureLogPart", "::", "\<\"warning\"\>"}], ":", 
  " ", "\<\"Integral not elementary - roots of resultant polynomial are non \
constant.\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.396323287386516*^9, 3.396324897170844*^9, 
  3.396483663600178*^9, 3.396590457818406*^9, 3.396600845164289*^9, 
  3.39660370497659*^9, 3.396665874588182*^9, 3.396750953630608*^9, 
  3.39675351972285*^9, 3.396873385993236*^9, 3.409123214440774*^9, 
  3.409889327992077*^9, 3.410396134969098*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"Risch", "[", 
   RowBox[{
    FractionBox[
     RowBox[{"x", "+", 
      SuperscriptBox["x", "2"], "+", 
      FractionBox[
       RowBox[{"Log", "[", "x", "]"}], "x"], "-", 
      RowBox[{
       SuperscriptBox["x", "2"], " ", 
       RowBox[{"Log", "[", "x", "]"}]}], "-", 
      SuperscriptBox[
       RowBox[{"Log", "[", "x", "]"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"Log", "[", "x", "]"}], "3"]}], 
     RowBox[{
      SuperscriptBox["x", "4"], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["x", "2"], " ", 
       SuperscriptBox[
        RowBox[{"Log", "[", "x", "]"}], "2"]}], "+", 
      SuperscriptBox[
       RowBox[{"Log", "[", "x", "]"}], "4"]}]], ",", "x"}], "]"}],
  HoldForm]], "Output",
 CellChangeTimes->{3.396323287389763*^9, 3.39632489719383*^9, 
  3.396483663603661*^9, 3.3965904578408213`*^9, 3.396600845168891*^9, 
  3.396603705003035*^9, 3.396665874611135*^9, 3.396750953653552*^9, 
  3.3967535197453136`*^9, 3.396873386021607*^9, 3.409123214462647*^9, 
  3.4098893279963627`*^9, 3.410396134973422*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Risch", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{
       FractionBox[
        RowBox[{"1", "-", "x"}], 
        RowBox[{"1", "+", 
         RowBox[{"Exp", "[", "x", "]"}]}]], "+", 
       RowBox[{"Log", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Exp", "[", "x", "]"}], 
          RowBox[{"Exp", "[", 
           RowBox[{"x", "-", "1"}], "]"}]}], "-", "1"}], "]"}]}], ",", "x"}], 
     "]"}], "//", "Together"}], ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.395313699048375*^9, 3.395313701565311*^9}, {
   3.395313735055225*^9, 3.395313735784136*^9}, {3.395314023113666*^9, 
   3.3953140434650583`*^9}, {3.3954961094963617`*^9, 3.395496121255046*^9}, {
   3.395498156058867*^9, 3.395498181747046*^9}, {3.395498226905085*^9, 
   3.395498230351824*^9}, {3.39675123504001*^9, 3.396751248975793*^9}, {
   3.3967512815601263`*^9, 3.396751284111425*^9}, {3.396751685077641*^9, 
   3.396751691071374*^9}, {3.39675210151404*^9, 3.396752101920927*^9}, 
   3.396752156297407*^9, {3.4103961475497293`*^9, 3.410396149455665*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"1", "-", "x"}], 
   RowBox[{"1", "+", 
    SuperscriptBox["\[ExponentialE]", "x"]}]], "+", 
  RowBox[{"2", " ", "x"}]}]], "Output",
 CellChangeTimes->{3.3967521037095337`*^9, 3.39675214332764*^9, 
  3.396753524273423*^9, 3.396873386491164*^9, 3.409123220522429*^9, 
  3.4098893510294857`*^9, 3.41039613592925*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    FractionBox[
     RowBox[{
      SqrtBox["2"], "-", 
      RowBox[{
       SqrtBox["3"], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"1", "+", "x", "+", 
         SuperscriptBox["x", "2"]}]], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"2", " ", "x"}]}], ")"}]}], "+", 
      RowBox[{
       SqrtBox["2"], " ", 
       RowBox[{"Log", "[", "x", "]"}]}]}], 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        SqrtBox["3"]}], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"1", "+", "x", "+", 
         SuperscriptBox["x", "2"]}]]}], "+", 
      RowBox[{
       SqrtBox["2"], " ", "x", " ", 
       RowBox[{"Log", "[", "x", "]"}]}]}]], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"bug", ",", " ", 
    RowBox[{"now", " ", "fixed"}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.395201732627198*^9, 3.395201736777152*^9}, {
   3.395201772212997*^9, 3.395201772630101*^9}, {3.3952045168212233`*^9, 
   3.395204526628536*^9}, {3.395204748934883*^9, 3.395204778875896*^9}, {
   3.395204927157483*^9, 3.395204941056555*^9}, {3.39529658298851*^9, 
   3.3952965900799713`*^9}, {3.395491582999909*^9, 3.395491583333061*^9}, {
   3.395493393458329*^9, 3.395493408082391*^9}, 3.395493582228655*^9, {
   3.395494034964778*^9, 3.395494042116152*^9}, {3.395495812598073*^9, 
   3.39549582329315*^9}, 3.395659483572342*^9, {3.39565979059442*^9, 
   3.3956597917588453`*^9}, {3.395723259288582*^9, 3.39572325942142*^9}, {
   3.3962694215785837`*^9, 3.396269423951573*^9}, {3.396343660810628*^9, 
   3.396343667048641*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Log", "[", "x", "]"}], "+", 
  RowBox[{"Log", "[", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{
       SqrtBox[
        FractionBox["3", "2"]], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"1", "+", "x", "+", 
         SuperscriptBox["x", "2"]}]]}], "x"]}], "+", 
    RowBox[{"Log", "[", "x", "]"}]}], "]"}]}]], "Output",
 CellChangeTimes->{3.3962693662371883`*^9, 3.396324895163685*^9, 
  3.3964836701431513`*^9, 3.396590459608891*^9, 3.396603706372426*^9, 
  3.3966658766944523`*^9, 3.396750958169116*^9, 3.396752182395112*^9, 
  3.396753524851555*^9, 3.39687338729335*^9, 3.4091232318356247`*^9, 
  3.409889359222725*^9, 3.4103961560712748`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Risch", "[", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"2", " ", 
      SuperscriptBox[
       RowBox[{"Exp", "[", "x", "]"}], "2"]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"3", "-", 
        SuperscriptBox[
         RowBox[{"Log", "[", "x", "]"}], "2"], "+", 
        RowBox[{"2", " ", 
         RowBox[{
          RowBox[{"Log", "[", "x", "]"}], "/", "x"}]}]}], ")"}], 
      RowBox[{"Exp", "[", "x", "]"}]}], "+", 
     RowBox[{"2", " ", 
      RowBox[{
       RowBox[{"Log", "[", "x", "]"}], "/", "x"}]}], "+", "1"}], 
    RowBox[{
     SuperscriptBox[
      RowBox[{"Exp", "[", "x", "]"}], "2"], "+", 
     RowBox[{"2", " ", 
      RowBox[{"Exp", "[", "x", "]"}]}], "+", "1"}]], ",", "x"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.3955454709257097`*^9, 3.395545565645731*^9}, {
  3.39554562490305*^9, 3.3955456317982903`*^9}, {3.395746877104617*^9, 
  3.3957468829280148`*^9}, {3.3975553130004797`*^9, 3.39755531365409*^9}}],

Cell[BoxData[
 RowBox[{"x", "+", 
  RowBox[{"Log", "[", 
   RowBox[{"1", "+", 
    SuperscriptBox["\[ExponentialE]", "x"]}], "]"}], "+", 
  FractionBox[
   SuperscriptBox[
    RowBox[{"Log", "[", "x", "]"}], "2"], 
   RowBox[{"1", "+", 
    SuperscriptBox["\[ExponentialE]", "x"]}]]}]], "Output",
 CellChangeTimes->{3.3962679039119043`*^9, 3.396269351816758*^9, 
  3.3963233000802*^9, 3.3963249002057047`*^9, 3.396483680102921*^9, 
  3.396590460292767*^9, 3.396603707136282*^9, 3.396665877922014*^9, 
  3.396750959141273*^9, 3.396873387846052*^9, 3.397555314365081*^9, 
  3.409123232530429*^9, 3.409889368704467*^9, 3.410396156846521*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Risch", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{
       FractionBox["1", 
        RowBox[{
         SuperscriptBox["x", "3"], "-", "x", "+", "1"}]], "+", 
       RowBox[{
        RowBox[{"Exp", "[", "x", "]"}], " ", 
        RowBox[{"Log", "[", 
         RowBox[{
          SuperscriptBox["x", "3"], "-", "x", "+", "1"}], "]"}]}]}], ",", 
      "x"}], "]"}], "//", "Together"}], ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.395297628060498*^9, 3.395297649062971*^9}, {
   3.395297699016993*^9, 3.395297768766358*^9}, {3.3954604125133753`*^9, 
   3.395460425915512*^9}, 3.395578404105754*^9, {3.395991942261614*^9, 
   3.395991946002839*^9}, {3.395998409162321*^9, 3.39599841604923*^9}, 
   3.396093875326679*^9, {3.396343732191465*^9, 3.3963437387429543`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"1", "-", "x", "+", 
    SuperscriptBox["x", "3"]}]], "+", 
  RowBox[{
   SuperscriptBox["\[ExponentialE]", "x"], " ", 
   RowBox[{"Log", "[", 
    RowBox[{"1", "-", "x", "+", 
     SuperscriptBox["x", "3"]}], "]"}]}]}]], "Output",
 CellChangeTimes->{3.396267915100994*^9, 3.396269323848373*^9, 
  3.3963233502340727`*^9, 3.3963249101488*^9, 3.3963418603055468`*^9, 
  3.396484831156274*^9, 3.3965904614902678`*^9, 3.396603707888595*^9, 
  3.3966658791327047`*^9, 3.396750959874699*^9, 3.396752189085637*^9, 
  3.3968733883837967`*^9, 3.409123233233643*^9, 3.4098893695056868`*^9, 
  3.410396157575193*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    FractionBox[
     RowBox[{"x", "+", 
      RowBox[{
       RowBox[{"Exp", "[", 
        RowBox[{
         SuperscriptBox["x", "2"], "+", "x", "+", "1"}], "]"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", "x", "-", 
         RowBox[{"2", 
          SuperscriptBox["x", "2"]}]}], ")"}]}]}], 
     RowBox[{"x", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"x", " ", 
         RowBox[{"Log", "[", "x", "]"}]}], "-", 
        RowBox[{"Exp", "[", 
         RowBox[{
          SuperscriptBox["x", "2"], "+", "x", "+", "1"}], "]"}]}], ")"}]}]], 
    ",", "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"bug", ",", " ", 
    RowBox[{
    "now", " ", "fixed", " ", "by", " ", "making", " ", "subresultants", " ", 
     "monic"}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.395661074006542*^9, 3.395661090836932*^9}, {
  3.395663093966968*^9, 3.3956630958622313`*^9}, {3.3957212012251587`*^9, 
  3.395721208528985*^9}, {3.395731713005011*^9, 3.395731761954362*^9}, {
  3.397555522419314*^9, 3.397555534777093*^9}}],

Cell[BoxData[
 RowBox[{"Log", "[", 
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"1", "+", "x", "+", 
       SuperscriptBox["x", "2"]}]], "x"]}], "+", 
   RowBox[{"Log", "[", "x", "]"}]}], "]"}]], "Output",
 CellChangeTimes->{3.3962679163242617`*^9, 3.3963233551273947`*^9, 
  3.3963249110000763`*^9, 3.396341861610208*^9, 3.396484837130691*^9, 
  3.396590462240775*^9, 3.396603708498664*^9, 3.396665880135351*^9, 
  3.396750961641693*^9, 3.396873388880104*^9, 3.409123234226677*^9, 
  3.409889395460992*^9, 3.410396158250556*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"Log", "[", 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"1", "+", "x", "+", 
            SuperscriptBox["x", "2"]}]], "-", 
          RowBox[{"x", " ", 
           RowBox[{"Log", "[", 
            RowBox[{"x", "-", 
             RowBox[{"Exp", "[", "x", "]"}]}], "]"}]}]}], "]"}], ",", "x"}], 
       "]"}], "//", "Simplify"}], "//", "Together"}], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", "fixed", " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.3957249093731213`*^9, 3.395724935776903*^9}, {
  3.395725163440682*^9, 3.395725164702648*^9}, {3.395727601052803*^9, 
  3.3957276044996843`*^9}, {3.395731744364552*^9, 3.395731777505621*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Log", "[", "x", "]"}], "+", 
  RowBox[{"Log", "[", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"1", "+", "x", "+", 
        SuperscriptBox["x", "2"]}]], "x"]}], "+", 
    RowBox[{"Log", "[", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["\[ExponentialE]", "x"]}], "+", "x"}], "]"}]}], 
   "]"}]}]], "Output",
 CellChangeTimes->{3.3962679176625023`*^9, 3.396323362432773*^9, 
  3.396324911749156*^9, 3.396341863007366*^9, 3.396590463329174*^9, 
  3.3966037093069553`*^9, 3.396665881531111*^9, 3.3967509652411747`*^9, 
  3.396873389646942*^9, 3.4091232357593737`*^9, 3.409889410238638*^9, 
  3.4103961613785133`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    FractionBox["x", 
     SuperscriptBox[
      RowBox[{"Log", "[", "x", "]"}], "5"]], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{
   "This", " ", "result", " ", "can", " ", "be", " ", "obtained", " ", "by", 
    " ", "reduction", " ", "formulae", " ", "in", " ", "CRC", " ", "tables"}],
    " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.396005400218446*^9, 3.3960054093631687`*^9}, {
  3.396006591237505*^9, 3.396006651861389*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PureLogPart", "::", "\<\"warning\"\>"}], ":", 
  " ", "\<\"Integral not elementary - roots of resultant polynomial are non \
constant.\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.3962679202813263`*^9, 3.396323471047804*^9, 
  3.39632491548215*^9, 3.39634186944506*^9, 3.396590464054975*^9, 
  3.396603710043634*^9, 3.396665882705955*^9, 3.396750966073202*^9, 
  3.396873390149083*^9, 3.3987418328420963`*^9, 3.409889459901902*^9, 
  3.410396162090873*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"Risch", "[", 
   RowBox[{
    FractionBox["x", 
     SuperscriptBox[
      RowBox[{"Log", "[", "x", "]"}], "5"]], ",", "x"}], "]"}],
  HoldForm]], "Output",
 CellChangeTimes->{3.396267920303829*^9, 3.396323471051293*^9, 
  3.396324915485962*^9, 3.396341869448822*^9, 3.396590464075707*^9, 
  3.396603710070249*^9, 3.396665882727223*^9, 3.396750966076892*^9, 
  3.3968733901787148`*^9, 3.3987418328461437`*^9, 3.40988945990585*^9, 
  3.410396162094803*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Risch", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", "x"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SqrtBox["3"], " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"2", " ", "x"}]], " ", "x", " ", 
         SuperscriptBox[
          RowBox[{"Log", "[", "x", "]"}], "3"]}], "+", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", "x"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            SqrtBox["3"], " ", "x"}], "+", "x", "+", 
           RowBox[{
            SqrtBox["3"], " ", 
            SuperscriptBox["\[ExponentialE]", "x"]}]}], ")"}], " ", 
         SuperscriptBox[
          RowBox[{"Log", "[", "x", "]"}], "2"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SqrtBox["3"], " ", "x"}], "+", 
           RowBox[{"2", " ", "\[ExponentialE]", " ", "x"}], "-", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"2", " ", "x"}]], "+", 
           RowBox[{
            SuperscriptBox["\[ExponentialE]", "x"], " ", 
            RowBox[{"(", 
             RowBox[{"x", "+", 
              RowBox[{"2", " ", 
               SqrtBox["3"]}], "+", "1"}], ")"}]}]}], ")"}], " ", 
         RowBox[{"Log", "[", "x", "]"}]}], "-", 
        RowBox[{"2", " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"x", "+", "1"}]]}], "+", 
        RowBox[{"2", " ", "\[ExponentialE]", " ", 
         RowBox[{"(", 
          RowBox[{"x", "+", "1"}], ")"}]}], "+", 
        SqrtBox["3"]}], ")"}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"x", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["\[ExponentialE]", "x"], " ", 
          RowBox[{"Log", "[", "x", "]"}]}], "+", "1"}], ")"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["\[ExponentialE]", "x"], " ", 
         RowBox[{"Log", "[", "x", "]"}]}], "+", 
        RowBox[{"2", " ", "\[ExponentialE]"}]}], ")"}]}], ")"}]}], ",", "x"}],
   "]"}]], "Input",
 CellChangeTimes->{{3.39573760022059*^9, 3.395737616028282*^9}, {
   3.3957376552233763`*^9, 3.395737690861808*^9}, {3.3957380073868523`*^9, 
   3.395738042355225*^9}, {3.395980824025798*^9, 3.395980825131362*^9}, {
   3.39609795944057*^9, 3.396097960709737*^9}, 3.3963249652732277`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SqrtBox["3"], " ", "x"}], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    SuperscriptBox["\[ExponentialE]", "x"]}], 
   RowBox[{"1", "+", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", "x"], " ", 
     RowBox[{"Log", "[", "x", "]"}]}]}]], "+", 
  RowBox[{
   SqrtBox["3"], " ", 
   RowBox[{"Log", "[", 
    RowBox[{
     RowBox[{"2", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"1", "-", "x"}]]}], "+", 
     RowBox[{"Log", "[", "x", "]"}]}], "]"}]}]}]], "Output",
 CellChangeTimes->{3.39675219721979*^9, 3.39687339083598*^9, 
  3.4098894652720957`*^9, 3.410396165774395*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Risch", "[", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"-", "1"}], "-", 
     SuperscriptBox["\[ExponentialE]", "x"], "+", 
     RowBox[{"2", " ", "x"}], "-", 
     RowBox[{"2", " ", 
      SuperscriptBox["\[ExponentialE]", "x"], " ", "x"}], "+", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", "x"], " ", 
      SuperscriptBox["x", "2"]}], "+", 
     SuperscriptBox["x", "3"], "-", 
     SuperscriptBox["x", "4"], "+", 
     SuperscriptBox["x", "5"]}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", "x"], "-", "x"}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SuperscriptBox["x", "2"]}], ")"}], "2"]}]], ",", "x"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.396416235568231*^9, 3.396416239012609*^9}, {
  3.3964168547867537`*^9, 3.396416855080361*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "x"}], "+", 
  FractionBox[
   RowBox[{"1", "-", "x"}], 
   RowBox[{"1", "+", 
    SuperscriptBox["x", "2"]}]], "+", 
  RowBox[{"Log", "[", 
   RowBox[{
    SuperscriptBox["\[ExponentialE]", "x"], "-", "x"}], "]"}]}]], "Output",
 CellChangeTimes->{
  3.396416240123205*^9, {3.3964167898719053`*^9, 3.3964168600147038`*^9}, 
   3.396484988563539*^9, 3.396590465954595*^9, 3.3965959268968897`*^9, 
   3.3966037141912413`*^9, 3.396665888348134*^9, 3.396750986385563*^9, 
   3.396873391447711*^9, 3.408862816894587*^9, 3.409123239456176*^9, 
   3.409123878121772*^9, 3.409124149925378*^9, 3.409125208486437*^9, 
   3.40988946603971*^9, 3.4100815963377533`*^9, 3.41039616661309*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    FractionBox[
     RowBox[{
      SuperscriptBox["2", "x"], "+", 
      SuperscriptBox["8", "x"]}], 
     RowBox[{"1", "+", 
      SuperscriptBox["2", "x"]}]], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"M", "-", " ", 
    RowBox[{
    "cannot", " ", "do", " ", "in", " ", "terms", " ", "elementary", " ", 
     "functions"}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.398070576143714*^9, 3.398070588353187*^9}, {
  3.3980706346391563`*^9, 3.398070638685589*^9}, {3.398070722152307*^9, 
  3.398070769895677*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    SuperscriptBox["2", "x"], 
    RowBox[{"Log", "[", "2", "]"}]]}], "+", 
  FractionBox[
   SuperscriptBox["2", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     RowBox[{"2", " ", "x"}]}]], 
   RowBox[{"Log", "[", "2", "]"}]], "+", 
  FractionBox[
   RowBox[{"2", " ", 
    RowBox[{"Log", "[", 
     RowBox[{"1", "+", 
      SuperscriptBox["2", "x"]}], "]"}]}], 
   RowBox[{"Log", "[", "2", "]"}]]}]], "Output",
 CellChangeTimes->{{3.398070589095037*^9, 3.398070601389325*^9}, 
   3.3980706406934633`*^9, 3.398137453437327*^9, 3.408862808322953*^9, 
   3.409125209383698*^9, 3.4098894667641068`*^9, 3.4100815976975393`*^9, 
   3.410396167295227*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Risch", "[", 
  RowBox[{
   FractionBox["1", 
    RowBox[{
     RowBox[{"Exp", "[", 
      RowBox[{"2", " ", "x"}], "]"}], "-", 
     RowBox[{"3", " ", 
      RowBox[{"Exp", "[", "x", "]"}]}]}]], ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.396779192290834*^9, 3.396779206226025*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", "x"}]], "3"], "-", 
  FractionBox["x", "9"], "+", 
  RowBox[{
   FractionBox["1", "9"], " ", 
   RowBox[{"Log", "[", 
    RowBox[{
     RowBox[{"-", "3"}], "+", 
     SuperscriptBox["\[ExponentialE]", "x"]}], "]"}]}]}]], "Output",
 CellChangeTimes->{{3.396779207681872*^9, 3.396779218345476*^9}, 
   3.396779398027684*^9, 3.396779466925708*^9, 3.396873393071335*^9, 
   3.3975564854413853`*^9, 3.408862805117442*^9, 3.409125210082324*^9, 
   3.4098894701633053`*^9, 3.410081599859829*^9, 3.4103961679931173`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"D", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Exp", "[", 
     RowBox[{"1", "/", 
      RowBox[{"(", 
       RowBox[{"x", " ", 
        RowBox[{"Exp", "[", "x", "]"}]}], ")"}]}], "]"}], 
    RowBox[{"(", 
     FractionBox[
      RowBox[{"Exp", "[", "x", "]"}], 
      RowBox[{"1", "-", 
       RowBox[{"Log", "[", 
        RowBox[{"x", "-", "1"}], "]"}]}]], ")"}]}], ",", "x"}], 
  "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     FractionBox[
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"-", "x"}]], "x"], "+", "x"}]], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "x"}], ")"}], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"Log", "[", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "x"}], "]"}]}], ")"}], "2"]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"-", "x"}]], "x"], "+", "x"}]], " ", 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"-", "x"}]], 
       SuperscriptBox["x", "2"]], "-", 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"-", "x"}]], "x"]}], ")"}]}], 
   RowBox[{"1", "-", 
    RowBox[{"Log", "[", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "x"}], "]"}]}]]}]], "Output",
 CellChangeTimes->{3.409125210609551*^9, 3.409889470830955*^9, 
  3.410081601270323*^9, 3.410396168716696*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Risch", "[", 
  RowBox[{
   RowBox[{
    FractionBox[
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       FractionBox[
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"-", "x"}]], "x"], "+", "x"}]], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "x"}], ")"}], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"Log", "[", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "x"}], "]"}]}], ")"}], "2"]}]], "+", 
    FractionBox[
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        FractionBox[
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"-", "x"}]], "x"], "+", "x"}]], " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        FractionBox[
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"-", "x"}]], 
         SuperscriptBox["x", "2"]], "-", 
        FractionBox[
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"-", "x"}]], "x"]}], ")"}]}], 
     RowBox[{"1", "-", 
      RowBox[{"Log", "[", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "x"}], "]"}]}]]}], ",", "x"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.396590512269775*^9, 3.396590514539418*^9}, {
  3.3965906923466053`*^9, 3.396590714393696*^9}, {3.39659584556355*^9, 
  3.3965958477444973`*^9}, {3.39755655685714*^9, 3.3975565647030354`*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     FractionBox[
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"-", "x"}]], "x"], "+", "x"}]], 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    RowBox[{"Log", "[", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "x"}], "]"}]}]]}]], "Output",
 CellChangeTimes->{3.408862780884429*^9, 3.409125214151004*^9, 
  3.4098894716139507`*^9, 3.410081603002775*^9, 3.410396171124214*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Risch", "[", 
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{
       SuperscriptBox["\[ExponentialE]", "x"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", "x"}], ")"}], "2"]}], "+", 
      RowBox[{"6", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SuperscriptBox["x", "2"]}], ")"}]}], "+", 
      RowBox[{"6", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"3", " ", 
          SuperscriptBox["x", "2"]}]}], ")"}], " ", 
       RowBox[{"Log", "[", "x", "]"}]}]}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SuperscriptBox["x", "2"]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", "x"], "+", 
        RowBox[{"6", " ", "x", " ", 
         RowBox[{"Log", "[", "x", "]"}]}]}], ")"}]}]], "-", 
    FractionBox[
     RowBox[{"6", " ", "x", " ", 
      RowBox[{"(", 
       RowBox[{"9", "+", 
        RowBox[{"Log", "[", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"16", " ", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"2", " ", "x"}]]}]}], "]"}]}], ")"}]}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "2"}], "+", 
        RowBox[{"3", " ", 
         SuperscriptBox["x", "2"]}]}], ")"}], " ", 
      SuperscriptBox[
       RowBox[{"Log", "[", 
        RowBox[{"6", "-", 
         RowBox[{"9", " ", 
          SuperscriptBox["x", "2"]}]}], "]"}], "2"]}]], "+", 
    FractionBox[
     RowBox[{"32", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"2", " ", "x"}]]}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"16", " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"2", " ", "x"}]]}]}], ")"}], " ", 
      RowBox[{"Log", "[", 
       RowBox[{"6", "-", 
        RowBox[{"9", " ", 
         SuperscriptBox["x", "2"]}]}], "]"}]}]]}], ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.397457143472352*^9, 3.397457166829702*^9}, {
   3.397457212087734*^9, 3.3974572696387863`*^9}, {3.3974573326327753`*^9, 
   3.397457371652317*^9}, {3.397457402866201*^9, 3.397457408875699*^9}, 
   3.397457522702722*^9, 3.397457748629171*^9, {3.397457868973205*^9, 
   3.3974578910934973`*^9}, {3.397457932553384*^9, 3.397457938920458*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Exp", "[", "x", "]"}]}], " ", 
       SuperscriptBox[
        RowBox[{"Log", "[", "x", "]"}], "2"]}], "+", 
      RowBox[{
       RowBox[{"Log", "[", "x", "]"}], 
       RowBox[{"(", 
        FractionBox[
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Exp", "[", "x", "]"}], "+", "1"}], ")"}]}], "x"], 
        ")"}]}], "+", 
      RowBox[{"Exp", "[", "x", "]"}], "+", 
      RowBox[{"Exp", "[", 
       RowBox[{"2", "x"}], "]"}]}], 
     RowBox[{"1", "+", 
      RowBox[{"2", " ", 
       RowBox[{"Exp", "[", "x", "]"}]}], "+", 
      RowBox[{"Exp", "[", 
       RowBox[{"2", " ", "x"}], "]"}]}]], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"problem", " ", "from", " ", "Computer", " ", "Algebra"}], ",", 
    " ", 
    RowBox[{"Davenport", " ", "et", " ", "al"}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.3978053035920677`*^9, 3.397805361745263*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Log", "[", 
   RowBox[{"1", "+", 
    SuperscriptBox["\[ExponentialE]", "x"]}], "]"}], "+", 
  FractionBox[
   SuperscriptBox[
    RowBox[{"Log", "[", "x", "]"}], "2"], 
   RowBox[{"1", "+", 
    SuperscriptBox["\[ExponentialE]", "x"]}]]}]], "Output",
 CellChangeTimes->{3.3978053648711567`*^9, 3.397805483585751*^9, 
  3.409125241010388*^9, 3.409889473579986*^9, 3.410081605055987*^9, 
  3.410396182714872*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"2", " ", "x", " ", 
      RowBox[{"Exp", "[", 
       SuperscriptBox["x", "2"], "]"}], 
      RowBox[{"Log", "[", "x", "]"}]}], "+", 
     FractionBox[
      RowBox[{"Exp", "[", 
       SuperscriptBox["x", "2"], "]"}], "x"], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"Log", "[", "x", "]"}], "-", "2"}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"Log", "[", "x", "]"}], "2"], "+", "x"}], ")"}], "2"]], "+", 
     FractionBox[
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"2", "/", "x"}], ")"}], 
        RowBox[{"Log", "[", "x", "]"}]}], "+", 
       RowBox[{"1", "/", "x"}], "+", "1"}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"Log", "[", "x", "]"}], "2"], "+", "x"}]]}], ",", "x"}], 
   "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{
   "The", " ", "first", " ", "ever", " ", "elementary", " ", "integral", " ", 
    "calculated", " ", "using", " ", "the", " ", "Risch", " ", "algorithm", 
    " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Risch", ",", " ", 
       RowBox[{
       "The", " ", "Problem", " ", "of", " ", "Integration", " ", "In", " ", 
        "Finite", " ", "Terms"}], ",", " ", "1969"}], ")"}], "."}]}], " ", 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.397652532791195*^9, 3.3976527456338587`*^9}, {
   3.397724148792303*^9, 3.397724149700633*^9}, 3.3977295976665497`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", "x", "+", 
        RowBox[{"x", " ", 
         RowBox[{"Exp", "[", "x", "]"}]}]}], ")"}], 
      RowBox[{"(", 
       RowBox[{"x", " ", "+", 
        RowBox[{"Log", "[", "x", "]"}], "+", 
        RowBox[{"Exp", "[", "x", "]"}], "-", "1"}], ")"}]}], 
     RowBox[{"x", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Log", "[", "x", "]"}], "+", 
         RowBox[{"Exp", "[", "x", "]"}], "+", "x"}], ")"}], "2"]}]], ",", 
    "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"Bronstein", " ", "PMINT", " ", "example"}], " ", 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.398317838087899*^9, 3.39831792524378*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{
    SuperscriptBox["\[ExponentialE]", "x"], "+", "x", "+", 
    RowBox[{"Log", "[", "x", "]"}]}]], "+", 
  RowBox[{"Log", "[", 
   RowBox[{
    SuperscriptBox["\[ExponentialE]", "x"], "+", "x", "+", 
    RowBox[{"Log", "[", "x", "]"}]}], "]"}]}]], "Output",
 CellChangeTimes->{3.398317910780884*^9, 3.409125249016355*^9, 
  3.409889478926058*^9, 3.410396195806574*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    FractionBox[
     SuperscriptBox["2", "x"], 
     RowBox[{"1", "+", 
      SuperscriptBox["2", "x"], "+", 
      SuperscriptBox["4", "x"]}]], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{
   "fixed", " ", "with", " ", "PreprocessedExponents", " ", "written", " ", 
    "into", " ", "RischStructure"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.3966008729127073`*^9, 3.396600885336317*^9}, {
  3.3966035299160957`*^9, 3.3966035308085318`*^9}, {3.396603607803631*^9, 
  3.396603656321274*^9}, {3.39666591199395*^9, 3.3966659139127607`*^9}, {
  3.3975562088386908`*^9, 3.397556209292302*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"2", " ", 
   RowBox[{"ArcTan", "[", 
    FractionBox[
     RowBox[{
      SqrtBox["3"], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SuperscriptBox["2", 
         RowBox[{"1", "+", "x"}]]}], ")"}], " ", 
      RowBox[{"Log", "[", "2", "]"}]}], 
     RowBox[{"Log", "[", "8", "]"}]], "]"}]}], 
  RowBox[{
   SqrtBox["3"], " ", 
   RowBox[{"Log", "[", "2", "]"}]}]]], "Output",
 CellChangeTimes->{
  3.3966008863408737`*^9, {3.396603374871578*^9, 3.3966033996324863`*^9}, {
   3.39660349935905*^9, 3.396603560273396*^9}, {3.3966036043797703`*^9, 
   3.396603608366547*^9}, 3.3966037148977337`*^9, {3.396665889824522*^9, 
   3.396665914593853*^9}, 3.3967509870275173`*^9, 3.396752203828227*^9, 
   3.396817911283337*^9, 3.3968733921004972`*^9, 3.39755620998636*^9, {
   3.398139570210279*^9, 3.3981395720322638`*^9}, 3.39813965911692*^9, {
   3.400487104343766*^9, 3.400487125531601*^9}, {3.4004871871699877`*^9, 
   3.400487205497983*^9}, 3.408862763558919*^9, 3.4091252477506247`*^9, 
   3.409889485650859*^9, 3.4099445189502583`*^9, 3.41039619642695*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Exp", "[", "x", "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"Log", "[", "x", "]"}]], "-", 
       FractionBox["1", 
        RowBox[{"x", " ", 
         SuperscriptBox[
          RowBox[{"Log", "[", "x", "]"}], "2"]}]]}], ")"}]}], ",", "x"}], 
   "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"example", " ", "from", " ", "wikipedia"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.4046673259156017`*^9, 3.4046673744897623`*^9}, {
  3.404667410788465*^9, 3.4046674199938173`*^9}, {3.404672751842835*^9, 
  3.4046727634664392`*^9}}],

Cell[BoxData[
 FractionBox[
  SuperscriptBox["\[ExponentialE]", "x"], 
  RowBox[{"Log", "[", "x", "]"}]]], "Output",
 CellChangeTimes->{3.4079901492534037`*^9, 3.4080019138966293`*^9, 
  3.408009361545724*^9, 3.4088622144932947`*^9, 3.408862663801199*^9, 
  3.4091252450212173`*^9, 3.409889506495088*^9, 3.410396197076784*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    RowBox[{
     FractionBox["1", 
      RowBox[{"Exp", "[", "x", "]"}]], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "x"], "-", 
       RowBox[{"Log", "[", "x", "]"}]}], ")"}]}], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"example", " ", "from", " ", "wikipedia"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.4046674436491203`*^9, 3.404667460193246*^9}, {
  3.40467276979692*^9, 3.404672771828319*^9}, {3.407990578493186*^9, 
  3.4079905858376217`*^9}, {3.408862217992638*^9, 3.4088622204535093`*^9}}],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{"-", "x"}]], " ", 
  RowBox[{"Log", "[", "x", "]"}]}]], "Output",
 CellChangeTimes->{{3.407990434681926*^9, 3.407990444650731*^9}, 
   3.407990586628083*^9, 3.408001915035184*^9, {3.408862215158228*^9, 
   3.408862223495976*^9}, 3.4091252455431232`*^9, 3.4098895073740273`*^9, 
   3.410396197771675*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    FractionBox[
     RowBox[{"5", " ", 
      SuperscriptBox["\[ExponentialE]", "x"], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "x"}], ")"}], " ", 
      SuperscriptBox[
       RowBox[{"Log", "[", 
        RowBox[{"1", "+", 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", "x"], " ", "x"}]}], "]"}], "4"]}], 
     RowBox[{"1", "+", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", "x"], " ", "x"}]}]], ",", "x"}], 
   "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"BUG", ":", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"5", " ", 
        RowBox[{"rischLog", "[", "x", "]"}]}], " ", "+", " ", 
       RowBox[{"5", "*", 
        RowBox[{"rischLog", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", " ", "+", " ", 
            RowBox[{"x", " ", 
             RowBox[{"theta", "[", "1", "]"}]}]}], ")"}], "/", "x"}], "]"}], 
        " ", "needs", " ", "to", " ", "be", " ", "simplified", " ", "with", 
        " ", "structure", " ", "theorems", " ", "before", " ", "checking", 
        " ", "if", " ", "new", " ", "logarithms", " ", "have", " ", 
        "entered"}]}], "..."}], " ", "FIXED"}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.4018810245155582`*^9, 3.401881027567561*^9}, {
  3.4018810845498037`*^9, 3.401881088680841*^9}, {3.401881204356517*^9, 
  3.401881227472734*^9}, {3.409944449877434*^9, 3.409944478751521*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Trig/Hyperbolic Rational Functions", "Subsection",
 CellChangeTimes->{{3.396342136281209*^9, 3.3963421497981462`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    FractionBox[
     RowBox[{"2", "+", 
      SuperscriptBox[
       RowBox[{"Tan", "[", "x", "]"}], "2"]}], 
     RowBox[{"1", "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"x", "+", 
         RowBox[{"Tan", "[", "x", "]"}]}], ")"}], "2"]}]], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"Bronstein", " ", "p", ".180"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.396006149439979*^9, 3.396006251420101*^9}, {
   3.396006429291561*^9, 3.396006443979294*^9}, {3.396753443017304*^9, 
   3.396753452690055*^9}, {3.397454070164647*^9, 3.397454110708452*^9}, 
   3.397454142572855*^9, {3.397454303169571*^9, 3.397454322634302*^9}, {
   3.397454477539733*^9, 3.397454478016659*^9}, {3.4090159643806257`*^9, 
   3.409015977484768*^9}}],

Cell[BoxData["Indeterminate"], "Output",
 CellChangeTimes->{
  3.397455026668709*^9, 3.3995460364105453`*^9, {3.4090159607327013`*^9, 
   3.409015978173647*^9}, 3.409127085866239*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    RowBox[{
     FractionBox["1", 
      RowBox[{"1", "+", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"2", " ", "x"}]], " ", 
        SuperscriptBox[
         RowBox[{"Log", "[", "x", "]"}], "2"]}]}]], 
     SuperscriptBox["\[ExponentialE]", "x"], " ", 
     SuperscriptBox["x", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", "x"], " ", 
        RowBox[{"Log", "[", "x", "]"}]}]}]], " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"x", " ", 
        RowBox[{"Log", "[", "x", "]"}]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"ArcTan", "[", 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", "x"], " ", 
          RowBox[{"Log", "[", "x", "]"}]}], "]"}], " ", 
        RowBox[{"Log", "[", "x", "]"}]}], "+", 
       RowBox[{"x", " ", 
        RowBox[{"ArcTan", "[", 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", "x"], " ", 
          RowBox[{"Log", "[", "x", "]"}]}], "]"}], " ", 
        SuperscriptBox[
         RowBox[{"Log", "[", "x", "]"}], "2"]}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"2", " ", "x"}]], " ", 
        RowBox[{"ArcTan", "[", 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", "x"], " ", 
          RowBox[{"Log", "[", "x", "]"}]}], "]"}], " ", 
        SuperscriptBox[
         RowBox[{"Log", "[", "x", "]"}], "3"]}], "+", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"2", " ", "x"}]], " ", "x", " ", 
        RowBox[{"ArcTan", "[", 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", "x"], " ", 
          RowBox[{"Log", "[", "x", "]"}]}], "]"}], " ", 
        SuperscriptBox[
         RowBox[{"Log", "[", "x", "]"}], "4"]}]}], ")"}]}], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{
   "refixed", " ", "with", " ", "extra", " ", "IO", " ", "TrigToExp"}], " ", 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.396442970892766*^9, 3.396442984929613*^9}, {
   3.39644302223372*^9, 3.396443061394218*^9}, {3.396443321929332*^9, 
   3.3964433239760237`*^9}, {3.396443403104257*^9, 3.396443403294943*^9}, {
   3.3964434392588873`*^9, 3.396443441249673*^9}, {3.3964434761224413`*^9, 
   3.396443480697774*^9}, 3.397454355693959*^9, {3.39745468255427*^9, 
   3.397454696580864*^9}, {3.397557297025134*^9, 3.397557298986586*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
   SuperscriptBox["x", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", "x"], " ", 
     RowBox[{"Log", "[", "x", "]"}]}]], " ", 
   RowBox[{"Log", "[", 
    RowBox[{"1", "-", 
     RowBox[{"\[ImaginaryI]", " ", 
      SuperscriptBox["\[ExponentialE]", "x"], " ", 
      RowBox[{"Log", "[", "x", "]"}]}]}], "]"}]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
   SuperscriptBox["x", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", "x"], " ", 
     RowBox[{"Log", "[", "x", "]"}]}]], " ", 
   RowBox[{"Log", "[", 
    RowBox[{"1", "+", 
     RowBox[{"\[ImaginaryI]", " ", 
      SuperscriptBox["\[ExponentialE]", "x"], " ", 
      RowBox[{"Log", "[", "x", "]"}]}]}], "]"}]}]}]], "Output",
 CellChangeTimes->{3.397454674348381*^9, 3.397557307884285*^9, 
  3.409015982102713*^9, 3.409127095444647*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{"2", "+", 
        SuperscriptBox[
         RowBox[{"Tan", "[", "x", "]"}], "2"]}], ")"}], 
      SuperscriptBox[
       RowBox[{"Sec", "[", "x", "]"}], "2"]}], 
     RowBox[{"1", "+", 
      SuperscriptBox[
       RowBox[{"Tan", "[", "x", "]"}], "3"]}]], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Here", " ", "extensions", " ", "into", " ", "tangents", " ", "would", 
     " ", "be", " ", "extremely", " ", "helpful"}], "..."}], " ", 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.396779363946001*^9, 3.396779366438941*^9}, {
  3.396779470082067*^9, 3.396779484743816*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["\[Pi]", 
   RowBox[{"2", " ", 
    SqrtBox["3"]}]], "-", 
  FractionBox[
   RowBox[{"2", " ", 
    RowBox[{"ArcTan", "[", 
     RowBox[{
      FractionBox[
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "x"}], "]"}], 
       RowBox[{"2", "+", 
        SqrtBox["3"]}]], "+", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", "x"}], "]"}]}], 
       RowBox[{"2", "+", 
        SqrtBox["3"]}]]}], "]"}]}], 
   SqrtBox["3"]], "-", 
  RowBox[{"Log", "[", 
   RowBox[{
    RowBox[{"-", "\[ImaginaryI]"}], "-", 
    RowBox[{"\[ImaginaryI]", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", "x"}], "]"}]}], "+", 
    RowBox[{"Sin", "[", 
     RowBox[{"2", " ", "x"}], "]"}]}], "]"}], "+", 
  RowBox[{"Log", "[", 
   RowBox[{"1", "-", 
    RowBox[{"\[ImaginaryI]", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", "x"}], "]"}]}], "+", 
    RowBox[{"Sin", "[", 
     RowBox[{"2", " ", "x"}], "]"}]}], "]"}]}]], "Output",
 CellChangeTimes->{
  3.396779367283183*^9, 3.396779398484747*^9, 3.3967794675530653`*^9, 
   3.397454443239731*^9, 3.399546037954649*^9, 3.4090159866713333`*^9, 
   3.409127096968594*^9, {3.409901473384502*^9, 3.409901478219882*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{"Cosh", "[", "x", "]"}], 
       RowBox[{"Sinh", "[", "x", "]"}]}]}]], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{
   "Mathematica", " ", "writes", " ", "this", " ", "as", " ", "an", " ", 
    "arctanh"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.396779990449767*^9, 3.3967800370092783`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"Log", "[", 
    RowBox[{"2", "-", 
     SqrtBox["5"], "+", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"2", " ", "x"}]]}], "]"}], 
   SqrtBox["5"]], "-", 
  FractionBox[
   RowBox[{"Log", "[", 
    RowBox[{"2", "+", 
     SqrtBox["5"], "+", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"2", " ", "x"}]]}], "]"}], 
   SqrtBox["5"]]}]], "Output",
 CellChangeTimes->{{3.396780006066139*^9, 3.396780010272374*^9}, 
   3.397454424794063*^9, 3.409016006541626*^9, 3.409127125202085*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    FractionBox[
     RowBox[{
      SuperscriptBox["\[ExponentialE]", "x"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["x", "2"], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"1", "-", 
           FractionBox["1", "x"]}], "]"}]}], "-", 
        RowBox[{"Sin", "[", 
         RowBox[{"1", "-", 
          FractionBox["1", "x"]}], "]"}]}], ")"}]}], 
     SuperscriptBox["x", "2"]], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"GOOD", ":", " ", 
    RowBox[{"requires", " ", "exponential", " ", "cancellation", " ", 
     RowBox[{"case", "."}]}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.3974709386269913`*^9, 3.397471051244466*^9}, {
   3.397471102261014*^9, 3.397471111788748*^9}, {3.3974718713690968`*^9, 
   3.3974718734402733`*^9}, 3.397564519312067*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"1", "-", 
     FractionBox["1", "x"], "-", 
     RowBox[{"\[ImaginaryI]", " ", "x"}]}], "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"1", "-", 
     FractionBox["1", "x"], "+", 
     RowBox[{"\[ImaginaryI]", " ", "x"}]}], "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"1", "-", 
     FractionBox["1", "x"], "-", 
     RowBox[{"\[ImaginaryI]", " ", "x"}]}], "]"}]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"1", "-", 
     FractionBox["1", "x"], "+", 
     RowBox[{"\[ImaginaryI]", " ", "x"}]}], "]"}]}]}]], "Output",
 CellChangeTimes->{3.397564519853057*^9, 3.397959272160112*^9, 
  3.397993420697125*^9, 3.409016007557679*^9, 3.4091271263486*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    FractionBox[
     RowBox[{"Cos", "[", "x", "]"}], 
     RowBox[{"1", "-", 
      RowBox[{"Sin", "[", "x", "]"}]}]], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"poor", " ", "answer"}], ",", " ", 
    RowBox[{
    "better", " ", "to", " ", "use", " ", "derivative", " ", "divides", " ", 
     "prior", " ", "to", " ", "Risch", " ", "integration"}]}], " ", 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.396783377296979*^9, 3.3967834299627323`*^9}, {
  3.3967834616537437`*^9, 3.396783493364978*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[ImaginaryI]", " ", "x"}], "-", 
  RowBox[{"2", " ", 
   RowBox[{"Log", "[", 
    RowBox[{
     RowBox[{"-", "\[ImaginaryI]"}], "+", 
     RowBox[{"Cos", "[", "x", "]"}], "+", 
     RowBox[{"\[ImaginaryI]", " ", 
      RowBox[{"Sin", "[", "x", "]"}]}]}], "]"}]}]}]], "Output",
 CellChangeTimes->{3.396873312078307*^9, 3.3970170440746317`*^9, 
  3.397019335292458*^9, 3.3970237432160473`*^9, 3.397024192654119*^9, 
  3.397029433879984*^9, 3.397202915180807*^9, 3.39736380269238*^9, 
  3.397450375593441*^9, 3.3974551261007013`*^9, 3.39745518531124*^9, 
  3.3974688065233173`*^9, 3.397959274689295*^9, 3.409016009553853*^9, 
  3.409127129706067*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    FractionBox[
     RowBox[{
      SuperscriptBox[
       RowBox[{"Tan", "[", "x", "]"}], "5"], "+", 
      SuperscriptBox[
       RowBox[{"Tan", "[", "x", "]"}], "3"], "+", 
      RowBox[{
       SuperscriptBox["x", "2"], " ", 
       RowBox[{"Tan", "[", "x", "]"}]}], "+", "1"}], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"Tan", "[", "x", "]"}], "2"], "+", "1"}], ")"}], "3"]], ",", 
    "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"Example", " ", "from", " ", "Bronstein", " ", "p", 
    RowBox[{".170", ".", " ", "This"}], " ", "is", " ", "a", " ", "nice", " ",
     "solution", " ", "without", " ", "using", " ", "tangential", " ", 
    "extensions"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.397705233294138*^9, 3.39770526214388*^9}, {
  3.397705322713688*^9, 3.397705354463111*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"5", " ", "x"}], "16"], "-", 
  RowBox[{
   FractionBox["11", "128"], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"2", " ", "x"}], "]"}]}], "-", 
  RowBox[{
   FractionBox["5", "64"], " ", 
   SuperscriptBox["x", "2"], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"2", " ", "x"}], "]"}]}], "+", 
  RowBox[{
   FractionBox["9", "256"], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"4", " ", "x"}], "]"}]}], "-", 
  RowBox[{
   FractionBox["1", "32"], " ", 
   SuperscriptBox["x", "2"], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"4", " ", "x"}], "]"}]}], "+", 
  FractionBox[
   RowBox[{"Cos", "[", 
    RowBox[{"6", " ", "x"}], "]"}], "3456"], "-", 
  RowBox[{
   FractionBox["1", "192"], " ", 
   SuperscriptBox["x", "2"], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"6", " ", "x"}], "]"}]}], "+", 
  RowBox[{
   FractionBox["15", "64"], " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"2", " ", "x"}], "]"}]}], "+", 
  RowBox[{
   FractionBox["5", "64"], " ", "x", " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"2", " ", "x"}], "]"}]}], "+", 
  RowBox[{
   FractionBox["3", "64"], " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"4", " ", "x"}], "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "64"], " ", "x", " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"4", " ", "x"}], "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "192"], " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"6", " ", "x"}], "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "576"], " ", "x", " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"6", " ", "x"}], "]"}]}]}]], "Output",
 CellChangeTimes->{3.397705267893075*^9, 3.3977290441153297`*^9, 
  3.3979592692486057`*^9, 3.3979934223215857`*^9, 3.409016019314898*^9, 
  3.4091271311268883`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    FractionBox[
     RowBox[{"5", " ", 
      SuperscriptBox["\[ExponentialE]", "x"]}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"4", "-", 
        RowBox[{"5", " ", 
         SuperscriptBox["\[ExponentialE]", "x"]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"Log", "[", 
            RowBox[{"4", "-", 
             RowBox[{"5", " ", 
              SuperscriptBox["\[ExponentialE]", "x"]}]}], "]"}]}], ")"}], 
         "2"]}], ")"}]}]], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"fixed", " ", "bug", " ", "in", " ", "purelogpart"}], " ", 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.395302936849259*^9, 3.395302939201483*^9}, {
  3.395302995707967*^9, 3.3953029962835693`*^9}, {3.395303222159601*^9, 
  3.3953032409113617`*^9}, {3.3953120487838717`*^9, 3.39531205292306*^9}, {
  3.395313518770915*^9, 3.395313523158432*^9}, {3.396343574095709*^9, 
  3.3963435803348513`*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{"ArcTan", "[", 
   RowBox[{"1", "+", 
    RowBox[{"Log", "[", 
     RowBox[{"4", "-", 
      RowBox[{"5", " ", 
       SuperscriptBox["\[ExponentialE]", "x"]}]}], "]"}]}], "]"}]}]], "Output",
 CellChangeTimes->{{3.3989117552881517`*^9, 3.398911797348775*^9}, {
   3.398911967887472*^9, 3.398911997387554*^9}, 3.398912105499984*^9, 
   3.398912151219697*^9, {3.398912181511468*^9, 3.398912222619895*^9}, 
   3.398912252885728*^9, 3.398912345434519*^9, 3.409016022109877*^9, 
   3.409127131876233*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Logarithmic Polynomials", "Subsection",
 CellChangeTimes->{{3.39634244276785*^9, 3.3963424428484383`*^9}, {
  3.396342988642952*^9, 3.396342997656543*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", "x"}], "+", "1"}], ")"}], 
     SuperscriptBox[
      RowBox[{"Log", "[", 
       RowBox[{
        SuperscriptBox["x", "2"], "+", "x", "-", "1"}], "]"}], "2"]}], ",", 
    "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"mathematica", " ", "hates", " ", "this", " ", "one"}], "..."}], 
   " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.393479873779375*^9, 3.393479892654375*^9}, {
  3.39348050163875*^9, 3.393480503998125*^9}, {3.39348117307625*^9, 
  3.393481204029375*^9}, {3.393481323060625*^9, 3.393481377060625*^9}, {
  3.393482682935625*^9, 3.39348269742*^9}, {3.3934827699825*^9, 
  3.3934828462325*^9}, {3.393482920560625*^9, 3.393482926998125*^9}, {
  3.393482998045*^9, 3.393483076795*^9}, {3.393516931466*^9, 
  3.393516949856625*^9}, {3.394132794371875*^9, 3.39413280135625*^9}, {
  3.3941329810125*^9, 3.394132982246875*^9}, {3.408853804669531*^9, 
  3.408853810487342*^9}, {3.4088610031792383`*^9, 3.408861030507806*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"2", " ", "x"}], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox["x", "2"]}], "+", 
  RowBox[{"2", " ", 
   RowBox[{"Log", "[", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "x", "+", 
     SuperscriptBox["x", "2"]}], "]"}]}], "-", 
  RowBox[{"2", " ", "x", " ", 
   RowBox[{"Log", "[", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "x", "+", 
     SuperscriptBox["x", "2"]}], "]"}]}], "-", 
  RowBox[{"2", " ", 
   SuperscriptBox["x", "2"], " ", 
   RowBox[{"Log", "[", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "x", "+", 
     SuperscriptBox["x", "2"]}], "]"}]}], "-", 
  SuperscriptBox[
   RowBox[{"Log", "[", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "x", "+", 
     SuperscriptBox["x", "2"]}], "]"}], "2"], "+", 
  RowBox[{"x", " ", 
   SuperscriptBox[
    RowBox[{"Log", "[", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "x", "+", 
      SuperscriptBox["x", "2"]}], "]"}], "2"]}], "+", 
  RowBox[{
   SuperscriptBox["x", "2"], " ", 
   SuperscriptBox[
    RowBox[{"Log", "[", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "x", "+", 
      SuperscriptBox["x", "2"]}], "]"}], "2"]}]}]], "Output",
 CellChangeTimes->{
  3.396267870422516*^9, 3.396269594479158*^9, 3.396323129145422*^9, 
   3.396324860294414*^9, 3.396753422025031*^9, 3.3970164386831303`*^9, 
   3.397016500618535*^9, 3.3974504700663757`*^9, 3.397453956087243*^9, 
   3.397456932167747*^9, 3.399287510447301*^9, {3.408853796666275*^9, 
   3.408853811104698*^9}, 3.40885512099294*^9, {3.4088609862704983`*^9, 
   3.4088610052051077`*^9}, {3.409125256963626*^9, 3.4091252590967712`*^9}, {
   3.409889165253744*^9, 3.409889172038636*^9}, {3.410203863413666*^9, 
   3.410203864927147*^9}, {3.4102039588735228`*^9, 3.4102039601561623`*^9}, 
   3.41033477991551*^9, 3.4103359102050247`*^9, 3.410337714067779*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{"%", ",", "x"}], "]"}], "-", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", "x"}], "+", "1"}], ")"}], 
    SuperscriptBox[
     RowBox[{"Log", "[", 
      RowBox[{
       SuperscriptBox["x", "2"], "+", "x", "-", "1"}], "]"}], "2"]}]}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.409889173182523*^9, 3.409889186962287*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.40988918768784*^9, 3.410203871553084*^9, 
  3.410203961449956*^9, 3.410334781623139*^9, 3.410335911196718*^9, 
  3.4103377150162563`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"3", 
        SuperscriptBox["x", "2"]}], "+", "1"}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"Log", "[", 
       RowBox[{
        SuperscriptBox["x", "3"], "+", "x"}], "]"}], "2"]}], ",", "x"}], 
   "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"mathematica", " ", "hates", " ", "this", " ", "one"}], "..."}], 
   " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.393547311166625*^9, 3.3935473632135*^9}, {
  3.393547675041625*^9, 3.393547680510375*^9}, {3.393548388510375*^9, 
  3.393548395135375*^9}, {3.39413186366875*^9, 3.394131866278125*^9}, {
  3.394313395013875*^9, 3.39431343224825*^9}, {3.4088538153774767`*^9, 
  3.40885382172305*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"2", " ", "x"}], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox["x", "3"]}], "-", 
  RowBox[{"2", " ", "x", " ", 
   RowBox[{"Log", "[", 
    RowBox[{"x", "+", 
     SuperscriptBox["x", "3"]}], "]"}]}], "-", 
  RowBox[{"2", " ", 
   SuperscriptBox["x", "3"], " ", 
   RowBox[{"Log", "[", 
    RowBox[{"x", "+", 
     SuperscriptBox["x", "3"]}], "]"}]}], "+", 
  RowBox[{"x", " ", 
   SuperscriptBox[
    RowBox[{"Log", "[", 
     RowBox[{"x", "+", 
      SuperscriptBox["x", "3"]}], "]"}], "2"]}], "+", 
  RowBox[{
   SuperscriptBox["x", "3"], " ", 
   SuperscriptBox[
    RowBox[{"Log", "[", 
     RowBox[{"x", "+", 
      SuperscriptBox["x", "3"]}], "]"}], "2"]}]}]], "Output",
 CellChangeTimes->{
  3.3973020285749702`*^9, 3.397453956727158*^9, 3.397456932688377*^9, 
   3.399287511077025*^9, {3.408853813774452*^9, 3.408853816948489*^9}, 
   3.408861019810549*^9, 3.4091252807967033`*^9, 3.409889169080505*^9, 
   3.410203962376522*^9, 3.410334782491139*^9, 3.410335912069228*^9, 
   3.410337715480494*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{"%", ",", "x"}], "]"}], "-", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"3", 
       SuperscriptBox["x", "2"]}], "+", "1"}], ")"}], " ", 
    SuperscriptBox[
     RowBox[{"Log", "[", 
      RowBox[{
       SuperscriptBox["x", "3"], "+", "x"}], "]"}], "2"]}]}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.4102039652788153`*^9, 3.410203977829535*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.410203978410399*^9, 3.410334783252981*^9, 
  3.4103359126350803`*^9, 3.4103377159013443`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"3", " ", "x"}], "+", "1"}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"Log", "[", 
       RowBox[{
        SuperscriptBox["x", "2"], "+", "1"}], "]"}], "5"]}], ",", "x"}], 
   "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{
   "constructs", " ", "a", " ", "vaild", " ", "proof", " ", "that", " ", 
    "the", " ", "integral", " ", "is", " ", "not", " ", "elementary"}], " ", 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.393790535639625*^9, 3.393790538874*^9}, {
  3.393790920077125*^9, 3.393790933358375*^9}, {3.3941600597625*^9, 
  3.394160071934375*^9}, {3.3942280297946253`*^9, 3.3942280398727503`*^9}, {
  3.395313574287343*^9, 3.395313577070628*^9}, {3.396159420099169*^9, 
  3.3961594204002028`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RischLogarithmicPolynomial", "::", "\<\"warning\"\>"}], ":", 
  " ", "\<\"Integral not elementary - recursive integration introduced new \
logarithms.\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.410335914028862*^9, 3.410335977956777*^9, 
  3.410337716347518*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"Risch", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"3", " ", "x"}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"Log", "[", 
       RowBox[{"1", "+", 
        SuperscriptBox["x", "2"]}], "]"}], "5"]}], ",", "x"}], "]"}],
  HoldForm]], "Output",
 CellChangeTimes->{3.410335914031967*^9, 3.410335977960692*^9, 
  3.410337716351543*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"Log", "[", 
       RowBox[{"x", "+", "1"}], "]"}], "+", 
      RowBox[{"Log", "[", 
       FractionBox["x", 
        RowBox[{"x", "+", "1"}]], "]"}]}], "x"], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"good", " ", "structure", " ", "theorem", " ", "result"}], " ", 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.394310879388875*^9, 3.394310914326375*^9}, {
  3.394310967388875*^9, 3.3943109756545*^9}, {3.394311077388875*^9, 
  3.39431109837325*^9}, {3.394369627045*^9, 3.394369634248125*^9}, {
  3.395149229253294*^9, 3.395149239993367*^9}}],

Cell[BoxData[
 FractionBox[
  SuperscriptBox[
   RowBox[{"Log", "[", "x", "]"}], "2"], "2"]], "Output",
 CellChangeTimes->{{3.4103359803029947`*^9, 3.410335984041484*^9}, 
   3.41033771731157*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Risch", "[", 
  RowBox[{
   RowBox[{"Log", "[", 
    RowBox[{"1", "-", 
     SuperscriptBox["x", "4"]}], "]"}], ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.39434430915375*^9, 3.394344352935*^9}, {
   3.394344406075625*^9, 3.39434442006*^9}, {3.394345214856875*^9, 
   3.39434524096625*^9}, {3.394345388513125*^9, 3.3943453932475*^9}, {
   3.39440043712425*^9, 3.3944004444055*^9}, {3.39440099562425*^9, 
   3.394400999014875*^9}, {3.395315230361594*^9, 3.395315233480468*^9}, {
   3.396483466227942*^9, 3.396483467008382*^9}, {3.397558876888041*^9, 
   3.3975588888613453`*^9}, 3.399287523120973*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "4"}], " ", "x"}], "+", 
  RowBox[{"2", " ", 
   RowBox[{"ArcTan", "[", "x", "]"}]}], "-", 
  RowBox[{"Log", "[", 
   RowBox[{
    RowBox[{"-", "1"}], "+", "x"}], "]"}], "+", 
  RowBox[{"Log", "[", 
   RowBox[{"1", "+", "x"}], "]"}], "+", 
  RowBox[{"x", " ", 
   RowBox[{"Log", "[", 
    RowBox[{"1", "-", 
     SuperscriptBox["x", "4"]}], "]"}]}]}]], "Output",
 CellChangeTimes->{
  3.3962678760150757`*^9, 3.396269440907896*^9, 3.396323197283287*^9, 
   3.396324867853394*^9, 3.396341837773093*^9, 3.396483461961938*^9, 
   3.396753428003056*^9, 3.397016447725298*^9, 3.397016503596665*^9, 
   3.397453963354261*^9, 3.397456935406036*^9, 3.397558918451261*^9, {
   3.3992875158134003`*^9, 3.399287523839493*^9}, 3.402524418811915*^9, {
   3.404033318513576*^9, 3.404033332313225*^9}, 3.408853834503824*^9, 
   3.408861074015057*^9, 3.40912528462466*^9, 3.4098891448834143`*^9, 
   3.410335986316451*^9, 3.410337718761158*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{
       RowBox[{"Log", "[", "x", "]"}], 
       RowBox[{"Log", "[", 
        RowBox[{"Log", "[", "x", "]"}], "]"}]}], "+", "1"}], 
     RowBox[{"Log", "[", "x", "]"}]], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"example", " ", "from", " ", "talk"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.395200527985189*^9, 3.395200556324067*^9}, {
  3.395200602650991*^9, 3.395200609209839*^9}, {3.3963427933475037`*^9, 
  3.3963427937948303`*^9}}],

Cell[BoxData[
 RowBox[{"x", " ", 
  RowBox[{"Log", "[", 
   RowBox[{"Log", "[", "x", "]"}], "]"}]}]], "Output",
 CellChangeTimes->{
  3.396267881464904*^9, 3.396269433669949*^9, 3.3963232229362373`*^9, 
   3.3963248749551907`*^9, {3.396342785025185*^9, 3.396342794805481*^9}, 
   3.396342844820792*^9, 3.39648347264399*^9, 3.396753428785613*^9, 
   3.397016449100617*^9, 3.397016504034883*^9, 3.3974539642791853`*^9, 
   3.3974569363183517`*^9, 3.3992875243748627`*^9, 3.408861075372793*^9, 
   3.409015941475643*^9, 3.4091252858055897`*^9, 3.40988914566735*^9, 
   3.410335988048662*^9, 3.410337719459058*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    FractionBox[
     RowBox[{"1", "+", 
      RowBox[{"x", " ", 
       RowBox[{"Log", "[", "x", "]"}]}], "+", 
      RowBox[{
       RowBox[{"Log", "[", "x", "]"}], " ", 
       RowBox[{"Log", "[", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", "x"], " ", 
         RowBox[{"Log", "[", "x", "]"}]}], "]"}]}]}], 
     RowBox[{"Log", "[", "x", "]"}]], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"M", "-", " ", 
    RowBox[{"has", " ", "problems"}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.395200751670949*^9, 3.3952007673522577`*^9}, {
  3.395200938206379*^9, 3.395200960763731*^9}, {3.395201305348119*^9, 
  3.395201305767556*^9}, {3.39520145632859*^9, 3.395201461287932*^9}, {
  3.3952049804977827`*^9, 3.395204981952121*^9}, {3.396342789846084*^9, 
  3.396342790427135*^9}}],

Cell[BoxData[
 RowBox[{"x", " ", 
  RowBox[{"Log", "[", 
   RowBox[{
    SuperscriptBox["\[ExponentialE]", "x"], " ", 
    RowBox[{"Log", "[", "x", "]"}]}], "]"}]}]], "Output",
 CellChangeTimes->{
  3.396267882168816*^9, 3.3962694341828938`*^9, 3.396323231087647*^9, 
   3.3963248755154333`*^9, 3.3963427860765247`*^9, {3.396342845413883*^9, 
   3.3963428583070707`*^9}, 3.3964834794673853`*^9, 3.396753429394136*^9, 
   3.3970164499386377`*^9, 3.397016504628871*^9, 3.397275950548959*^9, 
   3.397453965032205*^9, 3.3974569373175573`*^9, 3.3992875259607162`*^9, 
   3.4088610795195627`*^9, 3.409015942635399*^9, 3.409125289347538*^9, 
   3.409889146274782*^9, 3.410204009041369*^9, 3.4103359896082687`*^9, 
   3.4103377200722733`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Risch", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Log", "[", "x", "]"}], "/", "x"}], ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.395302298508491*^9, 3.395302305383959*^9}, {
   3.3953081334151373`*^9, 3.3953081390868187`*^9}, {3.395312152953656*^9, 
   3.395312155554472*^9}, 3.410335996248341*^9}],

Cell[BoxData[
 FractionBox[
  SuperscriptBox[
   RowBox[{"Log", "[", "x", "]"}], "2"], "2"]], "Output",
 CellChangeTimes->{{3.4103359909550247`*^9, 3.4103359978927298`*^9}, 
   3.410337720548752*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Risch", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["x", "5"], "-", "1"}], ")"}], 
    RowBox[{"Log", "[", 
     RowBox[{
      SuperscriptBox["x", "2"], "-", "x", "+", "1"}], "]"}]}], ",", "x"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.393479873779375*^9, 3.393479892654375*^9}, {
   3.39348055120125*^9, 3.393480555373125*^9}, {3.39348084113875*^9, 
   3.393480841529375*^9}, 3.39348180426375*^9, {3.39348253076375*^9, 
   3.393482531998125*^9}, {3.393520413934125*^9, 3.39352041538725*^9}, {
   3.395193846381675*^9, 3.395193855745249*^9}, {3.395199157883472*^9, 
   3.395199159104495*^9}, {3.395496342943158*^9, 3.395496351502097*^9}, {
   3.395496400518476*^9, 3.395496401854018*^9}, {3.3954979116948566`*^9, 
   3.3954979352305098`*^9}, {3.395746904032082*^9, 3.395746909150529*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"11", " ", "x"}], "6"], "+", 
  FractionBox[
   SuperscriptBox["x", "2"], "12"], "+", 
  FractionBox[
   SuperscriptBox["x", "3"], "9"], "+", 
  FractionBox[
   SuperscriptBox["x", "4"], "24"], "-", 
  FractionBox[
   SuperscriptBox["x", "5"], "30"], "-", 
  FractionBox[
   SuperscriptBox["x", "6"], "18"], "+", 
  RowBox[{
   SqrtBox["3"], " ", 
   RowBox[{"ArcTan", "[", 
    FractionBox[
     RowBox[{"1", "-", 
      RowBox[{"2", " ", "x"}]}], 
     SqrtBox["3"]], "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "3"], " ", 
   RowBox[{"Log", "[", 
    RowBox[{"1", "-", "x", "+", 
     SuperscriptBox["x", "2"]}], "]"}]}], "-", 
  RowBox[{"x", " ", 
   RowBox[{"Log", "[", 
    RowBox[{"1", "-", "x", "+", 
     SuperscriptBox["x", "2"]}], "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "6"], " ", 
   SuperscriptBox["x", "6"], " ", 
   RowBox[{"Log", "[", 
    RowBox[{"1", "-", "x", "+", 
     SuperscriptBox["x", "2"]}], "]"}]}]}]], "Output",
 CellChangeTimes->{
  3.397302134278388*^9, 3.3974539663293667`*^9, 3.3974569385266943`*^9, 
   3.3974688336424417`*^9, 3.3992875269439497`*^9, 3.408861146644039*^9, 
   3.409015947837696*^9, 3.409125290592347*^9, 3.409889148027646*^9, {
   3.410204015411331*^9, 3.410204016472394*^9}, 3.410335998862075*^9, 
   3.410337721643476*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Log", "[", "x", "]"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Log", "[", 
        RowBox[{"x", "+", "1"}], "]"}], "+", 
       FractionBox["1", 
        RowBox[{"x", "+", "1"}]]}], ")"}]}], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"problem", " ", "11", " ", "from", " ", "geddes", 
    RowBox[{"(", 
     RowBox[{"NOT", " ", "ELEMENTARY"}], ")"}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.3955453673327427`*^9, 3.395545439068202*^9}, {
  3.395736016637615*^9, 3.3957360453331413`*^9}, {3.395736085291503*^9, 
  3.395736089422203*^9}, {3.395746811861228*^9, 3.395746844175901*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RischLogarithmicPolynomial", "::", "\<\"warning\"\>"}], ":", 
  " ", "\<\"Integral not elementary - recursive integration introduced new \
logarithms.\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.4103360001381693`*^9, 3.410337722279619*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RischLogarithmicPolynomial", "::", "\<\"warning\"\>"}], ":", 
  " ", "\<\"Integral not elementary - recursive integration introduced new \
logarithms.\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.4103360001381693`*^9, 3.410337722302354*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"Risch", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Log", "[", "x", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"1", "+", "x"}]], "+", 
       RowBox[{"Log", "[", 
        RowBox[{"1", "+", "x"}], "]"}]}], ")"}]}], ",", "x"}], "]"}],
  HoldForm]], "Output",
 CellChangeTimes->{3.4103360002018423`*^9, 3.410337722344459*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"x", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{"1", "/", "2"}], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x", "+", 
             FractionBox["1", "2"]}], ")"}], 
           RowBox[{"Log", "[", 
            RowBox[{"x", "+", 
             FractionBox["1", "2"]}], "]"}]}]], "+", 
         FractionBox[
          RowBox[{"1", "+", 
           RowBox[{"2", " ", 
            RowBox[{"Log", "[", "x", "]"}]}]}], "x"]}], ")"}], "2"]}], "+", 
     FractionBox[
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], 
           RowBox[{"Log", "[", 
            RowBox[{"x", "+", 
             FractionBox["1", "2"]}], "]"}]}], "-", "x"}], ")"}], 
        SuperscriptBox[
         RowBox[{"Log", "[", "x", "]"}], "2"]}], "-", 
       RowBox[{"x", "/", "4"}]}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"x", "+", 
          FractionBox["1", "2"]}], ")"}], "2"], 
       SuperscriptBox[
        RowBox[{"Log", "[", 
         RowBox[{"x", "+", 
          FractionBox["1", "2"]}], "]"}], "2"]}]], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["x", "2"], "+", "x", "+", "1"}], ")"}], 
          RowBox[{"Log", "[", 
           RowBox[{"x", "+", 
            FractionBox["1", "2"]}], "]"}]}], "+", 
         SuperscriptBox["x", "2"], "-", "1"}], ")"}], 
       RowBox[{"Log", "[", "x", "]"}]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"x", "+", 
         FractionBox["1", "2"]}], ")"}], "2"]], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"x", "-", 
        FractionBox["1", "x"]}], ")"}], 
      RowBox[{"(", 
       FractionBox[
        RowBox[{"Log", "[", 
         RowBox[{"x", "+", 
          FractionBox["1", "2"]}], "]"}], 
        RowBox[{"x", "+", 
         FractionBox["1", "2"]}]], ")"}]}]}], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Geddes", " ", "example", " ", "12.11"}], ":", " ", 
     RowBox[{
     "Integration", " ", "of", " ", "Logarithmic", " ", "polynomials"}]}], 
    ",", " ", 
    RowBox[{
     RowBox[{"200", " ", "times", " ", "faster", " ", "than", " ", "M"}], 
     "-"}]}], " ", "*)"}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.397015465404784*^9, 3.3970156620527277`*^9}, {
  3.397015739274832*^9, 3.397015739679267*^9}, {3.397015770358366*^9, 
  3.397015891049843*^9}, {3.397016178930704*^9, 3.397016186623519*^9}, {
  3.397559103797915*^9, 3.397559104147553*^9}, {3.408861972056849*^9, 
  3.4088619736478024`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"4", " ", 
    SuperscriptBox[
     RowBox[{"Log", "[", "x", "]"}], "3"]}], "3"], "+", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"Log", "[", "x", "]"}], "2"], " ", 
   RowBox[{"(", 
    RowBox[{"2", "+", 
     FractionBox[
      RowBox[{"2", " ", "x"}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"2", " ", "x"}]}], ")"}], " ", 
       RowBox[{"Log", "[", 
        RowBox[{
         FractionBox["1", "2"], "+", "x"}], "]"}]}]]}], ")"}]}], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"Log", "[", "x", "]"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"2", " ", "x"}], "+", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         SuperscriptBox["x", "2"]}], ")"}], " ", 
       RowBox[{"Log", "[", 
        RowBox[{
         FractionBox["1", "2"], "+", "x"}], "]"}]}]}], ")"}]}], 
   RowBox[{"1", "+", 
    RowBox[{"2", " ", "x"}]}]], "+", 
  RowBox[{"Log", "[", 
   RowBox[{"Log", "[", 
    RowBox[{
     FractionBox["1", "2"], "+", "x"}], "]"}], "]"}]}]], "Output",
 CellChangeTimes->{{3.39701566825443*^9, 3.397015683432535*^9}, 
   3.397015761615704*^9, {3.397015836057762*^9, 3.397015891641309*^9}, 
   3.39701645661548*^9, 3.397016506937489*^9, 3.3972759862029123`*^9, 
   3.397453971105238*^9, 3.397456942062891*^9, 3.397559108334996*^9, 
   3.399287529473899*^9, 3.4088619380996227`*^9, 3.408861974265848*^9, 
   3.40886208062786*^9, 3.409889152545496*^9, 3.410204027032044*^9, 
   3.410336005116325*^9, 3.41033772355334*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Risch", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Log", "[", "x", "]"}], 
    RowBox[{"Log", "[", 
     RowBox[{"3", " ", "x"}], "]"}], 
    RowBox[{"Log", "[", 
     RowBox[{"6", " ", "x"}], "]"}]}], ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.397455283034499*^9, 3.397455288670298*^9}, {
  3.397455390977314*^9, 3.397455415216373*^9}, {3.397455698435678*^9, 
  3.397455715507481*^9}, {3.397456428927697*^9, 3.397456429417345*^9}, {
  3.3974567498015547`*^9, 3.397456773257053*^9}, {3.397456883810575*^9, 
  3.3974568873779984`*^9}, {3.408862054916081*^9, 3.408862066795383*^9}, {
  3.4103377423371067`*^9, 3.4103377640057583`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "6"}], " ", "x"}], "-", 
  RowBox[{"x", " ", 
   RowBox[{"Log", "[", "3", "]"}], " ", 
   RowBox[{"Log", "[", "6", "]"}]}], "+", 
  RowBox[{"x", " ", 
   RowBox[{"Log", "[", "324", "]"}]}], "+", 
  RowBox[{"6", " ", "x", " ", 
   RowBox[{"Log", "[", "x", "]"}]}], "+", 
  RowBox[{"x", " ", 
   RowBox[{"Log", "[", "3", "]"}], " ", 
   RowBox[{"Log", "[", "6", "]"}], " ", 
   RowBox[{"Log", "[", "x", "]"}]}], "-", 
  RowBox[{"2", " ", "x", " ", 
   RowBox[{"Log", "[", "18", "]"}], " ", 
   RowBox[{"Log", "[", "x", "]"}]}], "-", 
  RowBox[{"3", " ", "x", " ", 
   SuperscriptBox[
    RowBox[{"Log", "[", "x", "]"}], "2"]}], "+", 
  RowBox[{"x", " ", 
   RowBox[{"Log", "[", "18", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"Log", "[", "x", "]"}], "2"]}], "+", 
  RowBox[{"x", " ", 
   SuperscriptBox[
    RowBox[{"Log", "[", "x", "]"}], "3"]}]}]], "Output",
 CellChangeTimes->{3.410344956226572*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Exponential Polynomials", "Subsection",
 CellChangeTimes->{{3.3963430060055656`*^9, 3.3963430106005487`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Risch", "[", 
  RowBox[{
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"1", "+", 
        FractionBox["1", "x"]}]], " ", "x"}]], "-", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"1", "+", 
      FractionBox["1", "x"], "+", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"1", "+", 
         FractionBox["1", "x"]}]], " ", "x"}]}]], "+", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"1", "+", 
       FractionBox["1", "x"], "+", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"1", "+", 
          FractionBox["1", "x"]}]], " ", "x"}]}]], " ", "x"}]}], ",", "x"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.410341342740494*^9, 3.4103413704192057`*^9}}],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"1", "+", 
      FractionBox["1", "x"]}]], " ", "x"}]], " ", "x"}]], "Output",
 CellChangeTimes->{3.410341371143341*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       FractionBox["1", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         SuperscriptBox["\[ExponentialE]", "x"]}]], "+", 
       FractionBox["1", "x"], "+", 
       FractionBox["1", 
        RowBox[{"1", "+", "x"}]]}]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox["\[ExponentialE]", "x"], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            SuperscriptBox["\[ExponentialE]", "x"]}], ")"}], "2"]]}], "-", 
       FractionBox["1", 
        SuperscriptBox["x", "2"]], "-", 
       FractionBox["1", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", "x"}], ")"}], "2"]]}], ")"}]}], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"old", " ", "bug"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.401690169651813*^9, 3.4016901997124968`*^9}, {
  3.408009376185719*^9, 3.408009376751296*^9}, {3.4098889104044437`*^9, 
  3.409888911259521*^9}}],

Cell[BoxData[
 SuperscriptBox["\[ExponentialE]", 
  RowBox[{
   FractionBox["1", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     SuperscriptBox["\[ExponentialE]", "x"]}]], "+", 
   FractionBox["1", "x"], "+", 
   FractionBox["1", 
    RowBox[{"1", "+", "x"}]]}]]], "Output",
 CellChangeTimes->{3.401871973415381*^9, 3.401872721197946*^9, 
  3.401937451610783*^9, 3.404031162403923*^9, 3.404544916934765*^9, 
  3.4080093746031446`*^9, 3.4090206945829983`*^9, 3.409201662711029*^9, 
  3.409888755995816*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox["x", "3"], 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", "x"]}]]}], "+", 
       FractionBox["x", 
        RowBox[{"1", "+", "x"}]]}]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"3", " ", 
          SuperscriptBox["x", "2"]}], 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", "x"]}]]}], "+", 
       FractionBox[
        RowBox[{
         SuperscriptBox["\[ExponentialE]", "x"], " ", 
         SuperscriptBox["x", "3"]}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox["\[ExponentialE]", "x"]}], ")"}], "2"]], "-", 
       FractionBox["x", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", "x"}], ")"}], "2"]], "+", 
       FractionBox["1", 
        RowBox[{"1", "+", "x"}]]}], ")"}]}], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"old", " ", "bug"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.4016902695394907`*^9, 3.401690306196192*^9}, {
  3.40800937921595*^9, 3.408009380023542*^9}, {3.409888913484618*^9, 
  3.409888914347939*^9}}],

Cell[BoxData[
 SuperscriptBox["\[ExponentialE]", 
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     SuperscriptBox["x", "3"], 
     RowBox[{"1", "+", 
      SuperscriptBox["\[ExponentialE]", "x"]}]]}], "+", 
   FractionBox["x", 
    RowBox[{"1", "+", "x"}]]}]]], "Output",
 CellChangeTimes->{3.4018728422784243`*^9, 3.404031164021402*^9, 
  3.404544918762618*^9, 3.408009380558022*^9, 3.409020688106533*^9, 
  3.4092016643015347`*^9, 3.4098887567247066`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       FractionBox["1", "x"], "+", 
       FractionBox["1", 
        RowBox[{"1", "+", "x"}]], "+", 
       FractionBox["1", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"Log", "[", "x", "]"}]}]]}]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", 
         SuperscriptBox["x", "2"]]}], "-", 
       FractionBox["1", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", "x"}], ")"}], "2"]], "-", 
       FractionBox["1", 
        RowBox[{"x", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"Log", "[", "x", "]"}]}], ")"}], "2"]}]]}], ")"}]}], ",", 
    "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"old", " ", "bug"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.401689872163608*^9, 3.4016898751858673`*^9}, {
  3.401690102507112*^9, 3.401690105074667*^9}, {3.40902069090832*^9, 
  3.4090206915457087`*^9}, {3.409888916924418*^9, 3.409888918971656*^9}}],

Cell[BoxData[
 SuperscriptBox["\[ExponentialE]", 
  RowBox[{
   FractionBox["1", "x"], "+", 
   FractionBox["1", 
    RowBox[{"1", "+", "x"}]], "+", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     RowBox[{"Log", "[", "x", "]"}]}]]}]]], "Output",
 CellChangeTimes->{
  3.401872848382288*^9, 3.404031165891508*^9, 3.404544920364203*^9, 
   3.408009381859235*^9, {3.4090206839112377`*^9, 3.409020685288184*^9}, 
   3.409201664903151*^9, 3.409888758981234*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       FractionBox["1", 
        SuperscriptBox["x", "4"]], "+", 
       FractionBox[
        SuperscriptBox["x", "7"], 
        RowBox[{"1", "+", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"1", "-", 
           FractionBox["1", "x"]}]]}]], "+", 
       FractionBox[
        SuperscriptBox["\[ExponentialE]", "x"], 
        RowBox[{"1", "+", "x", "-", 
         SuperscriptBox["x", "2"]}]]}]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["4", 
         SuperscriptBox["x", "5"]]}], "-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"1", "+", 
           FractionBox["1", "x"]}]], " ", 
         SuperscriptBox["x", "5"]}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"\[ExponentialE]", "+", 
           SuperscriptBox["\[ExponentialE]", 
            FractionBox["1", "x"]]}], ")"}], "2"]], "+", 
       FractionBox[
        RowBox[{"7", " ", 
         SuperscriptBox["x", "6"]}], 
        RowBox[{"1", "+", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"1", "-", 
           FractionBox["1", "x"]}]]}]], "+", 
       FractionBox[
        RowBox[{
         SuperscriptBox["\[ExponentialE]", "x"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{"2", " ", "x"}]}], ")"}]}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", "x", "-", 
           SuperscriptBox["x", "2"]}], ")"}], "2"]], "+", 
       FractionBox[
        SuperscriptBox["\[ExponentialE]", "x"], 
        RowBox[{"1", "+", "x", "-", 
         SuperscriptBox["x", "2"]}]]}], ")"}]}], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{
   "with", " ", "new", " ", "structure", " ", "theorem", " ", 
    "implementation", " ", "we", " ", "now", " ", "have", " ", "an", " ", 
    "extremely", " ", "difficult", " ", "system", " ", "of", " ", "equations",
     " ", "to", " ", "solve", " ", "and", " ", "basically", " ", "crashes", 
    " ", "the", " ", "computer"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.4016915150737047`*^9, 3.401691517140112*^9}, {
  3.401691549602746*^9, 3.401691549776823*^9}, {3.409020760013476*^9, 
  3.409020793520177*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Risch", "[", 
  RowBox[{
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SuperscriptBox["\[ExponentialE]", "x"], "+", 
      FractionBox["1", "x"], "+", 
      FractionBox["1", 
       RowBox[{"1", "-", 
        SuperscriptBox["x", "2"]}]]}]], " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", "x"], "-", 
      FractionBox["1", 
       SuperscriptBox["x", "2"]], "+", 
      FractionBox[
       RowBox[{"2", " ", "x"}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SuperscriptBox["x", "2"]}], ")"}], "2"]]}], ")"}]}], ",", "x"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.4016913952934017`*^9, 3.401691410664339*^9}, {
  3.409015808373762*^9, 3.409015847930337*^9}}],

Cell[BoxData[
 SuperscriptBox["\[ExponentialE]", 
  RowBox[{
   RowBox[{"-", "1"}], "+", 
   SuperscriptBox["\[ExponentialE]", "x"], "+", 
   FractionBox["1", "x"], "+", 
   FractionBox["1", 
    RowBox[{"1", "-", 
     SuperscriptBox["x", "2"]}]]}]]], "Output",
 CellChangeTimes->{{3.40901583211112*^9, 3.409015848593145*^9}, 
   3.409020757623838*^9, 3.409053383722908*^9, 3.4091253575165997`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", 
       FractionBox["1", 
        RowBox[{"x", " ", 
         SuperscriptBox[
          RowBox[{"Log", "[", "x", "]"}], "2"]}]]}], ")"}], 
     RowBox[{"Exp", "[", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"Log", "[", "x", "]"}]], "+", "x"}], "]"}]}], ",", "x"}], 
   "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"example", " ", "from", " ", "project"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.397296901749133*^9, 3.39729694599881*^9}}],

Cell[BoxData[
 SuperscriptBox["\[ExponentialE]", 
  RowBox[{"x", "+", 
   FractionBox["1", 
    RowBox[{"Log", "[", "x", "]"}]]}]]], "Output",
 CellChangeTimes->{3.408002055383254*^9, 3.408002123075046*^9, 
  3.40800221222621*^9, 3.4088678064456778`*^9, 3.4090158517500763`*^9, 
  3.409125360826373*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Risch", "[", 
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    SuperscriptBox["x", "2"]], ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.3960035671627827`*^9, 3.3960035786394567`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RischDE", "::", "\<\"warning\"\>"}], ":", 
  " ", "\<\"Integral not elementary - Risch DE: y' + \\!\\(2\\\\ x\\) y = \\!\
\\(1\\) has no solution.\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.40800204893003*^9, 3.408867802138596*^9, 
  3.409015853076412*^9, 3.409125361979848*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"Risch", "[", 
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     SuperscriptBox["x", "2"]], ",", "x"}], "]"}],
  HoldForm]], "Output",
 CellChangeTimes->{
  3.396267852316221*^9, {3.3963248256189117`*^9, 3.396324834462819*^9}, {
   3.39633020146432*^9, 3.396330212346426*^9}, 3.39633747484489*^9, {
   3.396583177401286*^9, 3.396583216024556*^9}, 3.3965911763931513`*^9, 
   3.396753408569861*^9, 3.396777912053945*^9, 3.397019284011711*^9, 
   3.397022589031163*^9, 3.397450479057235*^9, 3.399381749961404*^9, 
   3.4040312025129337`*^9, {3.408001986025082*^9, 3.408001998821167*^9}, 
   3.408002048933352*^9, 3.408867802142994*^9, 3.409015853080184*^9, 
   3.409125361984809*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    RowBox[{
     SuperscriptBox["x", "3"], " ", 
     RowBox[{"Exp", "[", 
      RowBox[{"-", 
       SuperscriptBox["x", "5"]}], "]"}]}], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"bug", ",", " ", 
    RowBox[{
    "this", " ", "needs", " ", "to", " ", "go", " ", "to", " ", "RDE"}], ",", 
    " ", 
    RowBox[{"not", " ", 
     RowBox[{"LRTR", ".", " ", "Now"}], " ", "fixed"}]}], " ", 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.395992614062402*^9, 3.39599262088212*^9}, {
  3.395997956122223*^9, 3.395997974137824*^9}, {3.396005803037643*^9, 
  3.3960058537559223`*^9}, {3.3960059985944347`*^9, 3.3960060007048492`*^9}, {
  3.396076083566845*^9, 3.3960760935961*^9}, {3.396080661708064*^9, 
  3.396080664371472*^9}, {3.3960807046603813`*^9, 3.3960807413236103`*^9}, {
  3.396342464116025*^9, 3.3963424702107143`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RischDE", "::", "\<\"warning\"\>"}], ":", 
  " ", "\<\"Integral not elementary - Risch DE: y' + \\!\\(\\(\\(-5\\)\\)\\\\ \
x\\^4\\) y = \\!\\(x\\^3\\) has no solution.\"\>"}]], "Message", "MSG",
 CellChangeTimes->{
  3.396342471115646*^9, 3.396483411536042*^9, {3.396583188454166*^9, 
   3.39658321677332*^9}, 3.396591177819993*^9, 3.39675340903222*^9, 
   3.396777912855609*^9, 3.3970192848380623`*^9, 3.397022590010181*^9, 
   3.397450479876107*^9, 3.3993817518643217`*^9, 3.404031203969789*^9, 
   3.408867799376116*^9, 3.40901585416396*^9, 3.409125365483327*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"Risch", "[", 
   RowBox[{
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"-", 
       SuperscriptBox["x", "5"]}]], " ", 
     SuperscriptBox["x", "3"]}], ",", "x"}], "]"}],
  HoldForm]], "Output",
 CellChangeTimes->{
  3.3962678503036213`*^9, 3.396269536450986*^9, 3.396324834959176*^9, 
   3.396337476087034*^9, 3.396337829399703*^9, {3.396342465544384*^9, 
   3.3963424711184607`*^9}, 3.396483411538308*^9, {3.396583188456641*^9, 
   3.39658321677691*^9}, 3.396591177824087*^9, 3.396753409036056*^9, 
   3.3967779128592567`*^9, 3.3970192848414803`*^9, 3.397022590013955*^9, 
   3.3974504798797197`*^9, 3.399381751868773*^9, 3.4040312039734707`*^9, 
   3.408867799380249*^9, 3.4090158541853323`*^9, 3.409125365507807*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"x", "+", "1"}], 
      SuperscriptBox["x", "4"]], 
     RowBox[{"Exp", "[", 
      RowBox[{"1", "/", "x"}], "]"}]}], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"nice", " ", "little", " ", "Risch", " ", "DEQ", " ", "Example"}],
     ",", " ", 
    RowBox[{"this", " ", "was", " ", "used", " ", "in", " ", "my", " ", 
     RowBox[{"project", "."}]}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.3878438332335*^9, 3.38784384307725*^9}, {
  3.387843874999125*^9, 3.387843885842875*^9}, {3.395149089809353*^9, 
  3.395149101713365*^9}, {3.395990850364305*^9, 3.395990852669683*^9}, {
  3.395991798621235*^9, 3.395991799866069*^9}, {3.3959920757548122`*^9, 
  3.395992076890267*^9}, {3.396096734219751*^9, 3.396096739312828*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    FractionBox["1", "x"]], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "x", "-", 
     SuperscriptBox["x", "2"]}], ")"}]}], 
  SuperscriptBox["x", "2"]]], "Output",
 CellChangeTimes->{3.4090158571953773`*^9, 3.4090533870112667`*^9, 
  3.4091253660641403`*^9, 3.4098889614768457`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "1"}], "-", "x", "-", 
        SuperscriptBox["x", "2"], "+", 
        SuperscriptBox["x", "3"]}], 
       RowBox[{"1", "-", 
        RowBox[{"2", " ", 
         SuperscriptBox["x", "2"]}], "+", 
        SuperscriptBox["x", "4"]}]], ")"}], 
     RowBox[{"Exp", "[", "x", "]"}]}], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"nice", " ", "RDE", " ", "example"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.394423767827375*^9, 3.394423808093*^9}, {
  3.395833364567195*^9, 3.395833371116304*^9}, {3.395833430728759*^9, 
  3.3958334760522137`*^9}, {3.3958335471085033`*^9, 3.39583354749763*^9}, {
  3.395991774523529*^9, 3.39599177781849*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["\[ExponentialE]", "x"], " ", "x"}], 
  RowBox[{
   RowBox[{"-", "1"}], "+", 
   SuperscriptBox["x", "2"]}]]], "Output",
 CellChangeTimes->{3.3965832224981117`*^9, 3.396591180856192*^9, 
  3.3967534099234133`*^9, 3.3967779136692047`*^9, 3.3970192865971203`*^9, 
  3.397022591431041*^9, 3.397276778908002*^9, 3.397368684119938*^9, 
  3.39745048139417*^9, 3.3978177766848087`*^9, 3.398851061895007*^9, 
  3.399381756037757*^9, 3.4040312056342993`*^9, 3.408867785192375*^9, 
  3.409015858478643*^9, 3.409053389766097*^9, 3.4091253664969893`*^9, 
  3.409888962162993*^9}]
}, Open  ]],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"rischDebug", "=", "False"}], ";"}], TraditionalForm]], "Input",
 CellChangeTimes->{{3.417339716652219*^9, 3.41733972061558*^9}, {
  3.5405937224482594`*^9, 3.540593723344059*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"f", "=", 
   RowBox[{
    FractionBox[
     RowBox[{
      SuperscriptBox["x", "2"], "-", "1"}], "x"], "+", 
    FractionBox["1", 
     RowBox[{"x", "+", 
      RowBox[{"Exp", "[", "x", "]"}]}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Risch", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     FractionBox[
      RowBox[{
       RowBox[{"Exp", "[", "x", "]"}], "-", 
       SuperscriptBox["x", "2"], "+", 
       RowBox[{"2", "x"}]}], 
      RowBox[{
       SuperscriptBox["x", "2"], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"x", "+", 
          RowBox[{"Exp", "[", "x", "]"}]}], ")"}], "2"]}]], ")"}], 
    RowBox[{"Exp", "[", "f", "]"}]}], ",", "x"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Integrate", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     FractionBox[
      RowBox[{
       RowBox[{"Exp", "[", "x", "]"}], "-", 
       SuperscriptBox["x", "2"], "+", 
       RowBox[{"2", "x"}]}], 
      RowBox[{
       SuperscriptBox["x", "2"], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"x", "+", 
          RowBox[{"Exp", "[", "x", "]"}]}], ")"}], "2"]}]], ")"}], 
    RowBox[{"Exp", "[", "f", "]"}]}], ",", "x"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "f", "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"Example", " ", "from", " ", "Bronstein", " ", 
    RowBox[{"1990", " ", "--"}], " ", 
    RowBox[{"Davenport", "'"}], "s", " ", "RDE", " ", "algorithm", " ", 
    RowBox[{"fails", ".", " ", "Mathematica"}], " ", "fails"}], " ", 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.395978107331211*^9, 3.3959781786260777`*^9}, {
  3.395978266993709*^9, 3.395978309437768*^9}, {3.395992096709066*^9, 
  3.39599211931575*^9}, {3.396075013145393*^9, 3.396075013573463*^9}, {
  3.396342709549239*^9, 3.396342718141369*^9}, {3.3974532487984247`*^9, 
  3.397453249917486*^9}, {3.397559849939108*^9, 3.39755985100849*^9}, {
  3.398851071386839*^9, 3.398851077235877*^9}, {3.5405936143364697`*^9, 
  3.540593623001091*^9}}],

Cell[BoxData[
 SuperscriptBox["\[ExponentialE]", 
  RowBox[{
   RowBox[{"-", "x"}], "+", 
   FractionBox["1", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", "x"], "+", "x"}]], "+", 
   FractionBox[
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     SuperscriptBox["x", "2"]}], "x"]}]]], "Output",
 CellChangeTimes->{3.5405936629044323`*^9}],

Cell[BoxData[
 RowBox[{"\[Integral]", 
  RowBox[{
   FractionBox[
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       FractionBox["1", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", "x"], "+", "x"}]], "+", 
       FractionBox[
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         SuperscriptBox["x", "2"]}], "x"]}]], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", "x"], "+", 
       RowBox[{"2", " ", "x"}], "-", 
       SuperscriptBox["x", "2"]}], ")"}]}], 
    RowBox[{
     SuperscriptBox["x", "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", "x"], "+", "x"}], ")"}], "2"]}]], 
   RowBox[{"\[DifferentialD]", "x"}]}]}]], "Output",
 CellChangeTimes->{3.540593662979682*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"Exp", "[", 
       FractionBox["1", 
        RowBox[{"Log", "[", "x", "]"}]], "]"}], 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"Log", "[", "x", "]"}], "2"], "-", "1"}], ")"}]}], 
     SuperscriptBox[
      RowBox[{"Log", "[", "x", "]"}], "2"]], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"MAJOR", " ", 
     RowBox[{"BUG", "!"}], " ", "Problem", " ", "is", " ", "in", " ", 
     RowBox[{"SPDE", ".", " ", "Fixed"}], " ", "after", " ", "looking", " ", 
     "at", " ", 
     RowBox[{"Bronstein", "'"}], "s", " ", "AXIOM", " ", 
     RowBox[{"code", ".", " ", "Problem"}], " ", "was", " ", 
     "\[IndentingNewLine]", "that", " ", "deg", 
     RowBox[{"(", "A", ")"}]}], " ", "<", " ", 
    RowBox[{"deg", 
     RowBox[{"(", "R", ")"}], " ", "ws", " ", "not", " ", "always", " ", 
     RowBox[{"satisfied", "."}]}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.397446348218925*^9, 3.397446373810278*^9}, {
   3.397446407254232*^9, 3.397446412725128*^9}, {3.3974472962208138`*^9, 
   3.397447301932423*^9}, {3.397450321498745*^9, 3.397450358602254*^9}, {
   3.397452971076273*^9, 3.397453000428216*^9}, 3.397453179614225*^9, {
   3.397559977147608*^9, 3.397559977800231*^9}}],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["\[ExponentialE]", 
   FractionBox["1", 
    RowBox[{"Log", "[", "x", "]"}]]], " ", "x"}]], "Output",
 CellChangeTimes->{
  3.397446929426415*^9, 3.397450313364132*^9, {3.397450344789276*^9, 
   3.397450359208055*^9}, 3.39745056015737*^9, {3.397450883549405*^9, 
   3.397450885901383*^9}, 3.39745093372972*^9, 3.397452495522649*^9, 
   3.397452963233509*^9, 3.397453172951254*^9, 3.39745325312998*^9, 
   3.39755998217835*^9, 3.39772471575819*^9, 3.39779441689578*^9, 
   3.39885108659452*^9, 3.39938176036609*^9, 3.40403121165919*^9, 
   3.408867749176999*^9, 3.409015862085194*^9, 3.409125370990443*^9, 
   3.4098889667224693`*^9, 3.409889585228862*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      FractionBox[
       RowBox[{"1", "+", 
        RowBox[{"Exp", "[", "x", "]"}]}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"x", "+", 
          RowBox[{"Exp", "[", "x", "]"}]}], ")"}], "2"]], ")"}], 
     RowBox[{"Exp", "[", 
      FractionBox["1", 
       RowBox[{"x", "+", 
        RowBox[{"Exp", "[", "x", "]"}]}]], "]"}]}], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{
   "Simple", " ", "integral", " ", "requiring", " ", "trivial", " ", "RDE"}], 
   " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.396087903588932*^9, 3.3960879410941563`*^9}, {
  3.396088022031938*^9, 3.396088059478513*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  SuperscriptBox["\[ExponentialE]", 
   FractionBox["1", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", "x"], "+", "x"}]]]}]], "Output",
 CellChangeTimes->{3.396267653628333*^9, 3.396267921208386*^9, 
  3.396269162197714*^9, 3.396269235990162*^9, 3.396323475571281*^9, 
  3.396324916329094*^9, 3.396341870260302*^9, 3.396583232502672*^9, 
  3.396753412095812*^9, 3.396777914294372*^9, 3.397019290296981*^9, 
  3.397022592989018*^9, 3.3972767853977222`*^9, 3.397453269587034*^9, 
  3.398851089213889*^9, 3.399381762386055*^9, 3.4040312123810062`*^9, 
  3.4088677352835217`*^9, 3.4090158653421288`*^9, 3.409053395339518*^9, 
  3.409125371664805*^9, 3.409888967202318*^9, 3.409889611652832*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Risch", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     FractionBox[
      RowBox[{
       RowBox[{"2581284541", " ", 
        RowBox[{"Exp", "[", "x", "]"}]}], "+", "1757211400"}], 
      RowBox[{
       RowBox[{"39916800", 
        RowBox[{"Exp", "[", 
         RowBox[{"3", "x"}], "]"}]}], "+", 
       RowBox[{"119750400", 
        RowBox[{"Exp", "[", 
         RowBox[{"2", "x"}], "]"}]}], "+", 
       RowBox[{"119750400", 
        RowBox[{"Exp", "[", "x", "]"}]}], "+", "39916800"}]], ")"}], 
    RowBox[{"Exp", "[", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"1", "+", 
        RowBox[{"Exp", "[", "x", "]"}]}]], "-", 
      RowBox[{"10", "x"}]}], "]"}]}], ",", "x"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Bug", " ", "--"}], " ", "Rothstein", " ", 
    RowBox[{"example", ".", " ", "Now"}], " ", "fixed", " ", "with", " ", 
    "changing", " ", "of", " ", "special", " ", "case", " ", "degree", " ", 
    RowBox[{"bound", "."}]}], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.396253234768569*^9, 3.396253241854354*^9}, {
  3.3962691851394053`*^9, 3.396269185480413*^9}, {3.398851110530854*^9, 
  3.398851124050046*^9}}],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"1", "+", 
      SuperscriptBox["\[ExponentialE]", "x"]}]], "-", 
    RowBox[{"10", " ", "x"}]}]], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["1255151", 
      RowBox[{"285120", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SuperscriptBox["\[ExponentialE]", "x"]}], ")"}]}]]}], "+", 
    FractionBox[
     RowBox[{"1441729", " ", 
      SuperscriptBox["\[ExponentialE]", "x"]}], 
     RowBox[{"403200", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SuperscriptBox["\[ExponentialE]", "x"]}], ")"}]}]], "-", 
    FractionBox[
     RowBox[{"65461", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"2", " ", "x"}]]}], 
     RowBox[{"22680", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SuperscriptBox["\[ExponentialE]", "x"]}], ")"}]}]], "+", 
    FractionBox[
     RowBox[{"13327", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"3", " ", "x"}]]}], 
     RowBox[{"5760", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SuperscriptBox["\[ExponentialE]", "x"]}], ")"}]}]], "-", 
    FractionBox[
     RowBox[{"773", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"4", " ", "x"}]]}], 
     RowBox[{"420", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SuperscriptBox["\[ExponentialE]", "x"]}], ")"}]}]], "+", 
    FractionBox[
     RowBox[{"209", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"5", " ", "x"}]]}], 
     RowBox[{"144", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SuperscriptBox["\[ExponentialE]", "x"]}], ")"}]}]], "-", 
    FractionBox[
     RowBox[{"17", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"6", " ", "x"}]]}], 
     RowBox[{"15", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SuperscriptBox["\[ExponentialE]", "x"]}], ")"}]}]], "+", 
    FractionBox[
     RowBox[{"7", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"7", " ", "x"}]]}], 
     RowBox[{"8", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SuperscriptBox["\[ExponentialE]", "x"]}], ")"}]}]], "-", 
    FractionBox[
     RowBox[{"2", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"8", " ", "x"}]]}], 
     RowBox[{"3", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SuperscriptBox["\[ExponentialE]", "x"]}], ")"}]}]], "+", 
    FractionBox[
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"9", " ", "x"}]], 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SuperscriptBox["\[ExponentialE]", "x"]}], ")"}]}]], "+", 
    FractionBox[
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"11", " ", "x"}]], 
     RowBox[{"1", "+", 
      SuperscriptBox["\[ExponentialE]", "x"]}]]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.397724681716086*^9, 3.398851124992075*^9, 3.3993817643594427`*^9, 
   3.40403121316422*^9, {3.40886771965523*^9, 3.408867722687402*^9}, 
   3.409015866520817*^9, 3.409125373446412*^9, 3.409888971969111*^9, 
   3.409889612938315*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Risch", "[", 
  RowBox[{
   FractionBox[
    RowBox[{
     SuperscriptBox["\[ExponentialE]", "x"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"1289", " ", "x"}], "+", 
       RowBox[{"278", " ", 
        SuperscriptBox["x", "2"]}], "+", 
       RowBox[{"55", " ", 
        SuperscriptBox["x", "3"]}], "+", 
       RowBox[{"56", " ", 
        SuperscriptBox["x", "4"]}]}], ")"}]}], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "392"}], "+", "x", "-", 
       RowBox[{"56", " ", 
        SuperscriptBox["x", "2"]}]}], ")"}], "2"]], ",", "x"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.3960023672032137`*^9, 3.396002381672174*^9}, {
   3.396076181712985*^9, 3.396076182734825*^9}, 3.396097971228086*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["\[ExponentialE]", "x"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "x", "+", 
     SuperscriptBox["x", "2"]}], ")"}]}], 
  RowBox[{"392", "-", "x", "+", 
   RowBox[{"56", " ", 
    SuperscriptBox["x", "2"]}]}]]], "Output",
 CellChangeTimes->{
  3.396267976003051*^9, {3.396269212812593*^9, 3.3962692152605553`*^9}, 
   3.396320868527198*^9, 3.396323610200528*^9, 3.3963249364435053`*^9, 
   3.396341906774239*^9, 3.3963420033567553`*^9, 3.396342055710539*^9, 
   3.3965832461929502`*^9, 3.396753414539761*^9, 3.3967779154117727`*^9, 
   3.397019294619748*^9, 3.397022594971426*^9, 3.397276793252899*^9, 
   3.397453276864359*^9, {3.3975603157313223`*^9, 3.397560325285158*^9}, 
   3.397817781549395*^9, 3.3988511321243362`*^9, 3.399381766396847*^9, 
   3.404031214075204*^9, 3.40886770595393*^9, 3.409015870291367*^9, 
   3.4091253773560057`*^9, 3.409889049399393*^9, 3.409889613803334*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    RowBox[{
     SuperscriptBox["x", "x"], " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"Log", "[", "x", "]"}]}], ")"}]}], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"classic", " ", "Risch", " ", "example"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.396418127455297*^9, 3.396418134565201*^9}, {
  3.3964190534629173`*^9, 3.3964190711658707`*^9}, {3.3964389481989613`*^9, 
  3.396438957342105*^9}}],

Cell[BoxData[
 SuperscriptBox["x", "x"]], "Output",
 CellChangeTimes->{{3.3964371204512033`*^9, 3.396437137704534*^9}, 
   3.396437719555139*^9, 3.3964378607582083`*^9, 3.396437992839325*^9, 
   3.396438920444695*^9, 3.396441107950732*^9, 3.396583247377593*^9, 
   3.3967534151838017`*^9, 3.396777915962454*^9, 3.3970192952969427`*^9, 
   3.3970225958978662`*^9, 3.397276794325165*^9, 3.397368588488998*^9, 
   3.397453277542049*^9, 3.398851133417698*^9, 3.3993817681063137`*^9, 
   3.404031215288912*^9, 3.408867700902204*^9, 3.4090158711886663`*^9, 
   3.409125378063801*^9, 3.409889049826651*^9, 3.40988963257438*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    RowBox[{
     SuperscriptBox["x", 
      RowBox[{"x", "-", 
       RowBox[{"Log", "[", "x", "]"}]}]], " ", 
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        RowBox[{"x", "-", 
         RowBox[{"Log", "[", "x", "]"}]}], "x"], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          FractionBox["1", "x"]}], ")"}], " ", 
        RowBox[{"Log", "[", "x", "]"}]}]}], ")"}]}], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"bug", ",", " ", 
    RowBox[{"solution", " ", 
     RowBox[{"x", "^", 
      RowBox[{"(", 
       RowBox[{"x", "-", 
        RowBox[{"Log", "[", "x", "]"}]}], ")"}]}]}], ",", " ", "fixed", ",", 
    " ", 
    RowBox[{
    "but", " ", "I", " ", "am", " ", "not", " ", "sure", " ", "how", " ", "I",
      " ", "fixed", " ", "it"}], ",", " ", 
    RowBox[{
     RowBox[{
     "must", " ", "have", " ", "been", " ", "related", " ", "to", " ", 
      "another", " ", "class", " ", "of", " ", 
      RowBox[{"integrals", ".", " ", "Fixed"}], " ", "if", " ", "we", " ", 
      "use", " ", "Simplify", " ", "on", " ", "the", " ", "integrand", " ", 
      "before", " ", "evaluation"}], "..."}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.396438976040007*^9, 3.396439060807497*^9}, {
  3.39675236395538*^9, 3.396752391863563*^9}, {3.3967536482036333`*^9, 
  3.396753650096366*^9}, {3.3967537802946987`*^9, 3.396753838099894*^9}, {
  3.404033429213647*^9, 3.404033453831909*^9}}],

Cell[BoxData[
 SuperscriptBox["x", 
  RowBox[{"x", "-", 
   RowBox[{"Log", "[", "x", "]"}]}]]], "Output",
 CellChangeTimes->{
  3.4040312165759783`*^9, {3.4040334268498497`*^9, 3.4040334316050053`*^9}, 
   3.408867677919539*^9, 3.409015874728242*^9, 3.40912537865874*^9, 
   3.4098890505050173`*^9, 3.4098896336264477`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"4", " ", 
         SuperscriptBox["x", "2"]}], "+", 
        RowBox[{"4", "x"}], "-", "1"}], ")"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Exp", "[", 
         SuperscriptBox["x", "2"], "]"}], "+", "1"}], ")"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Exp", "[", 
         SuperscriptBox["x", "2"], "]"}], "-", "1"}], ")"}]}], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"x", "+", "1"}], ")"}], "2"]], ",", "x"}], "]"}], "//", 
  "Together", 
  RowBox[{"(*", " ", 
   RowBox[{"Geddes", " ", 
    RowBox[{"example", ":", " ", 
     RowBox[{
     "Fixed", " ", "with", " ", "changes", " ", "to", " ", 
      "RischExponentialPolynomial"}]}]}], "  ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.3970178529354887`*^9, 3.39701789385072*^9}, {
  3.397019099300165*^9, 3.397019136232985*^9}, {3.408867555897623*^9, 
  3.408867564414513*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"1", "-", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"2", " ", 
      SuperscriptBox["x", "2"]}]], "+", 
    RowBox[{"4", " ", "x"}], "+", 
    RowBox[{"4", " ", 
     SuperscriptBox["x", "2"]}], "-", 
    RowBox[{"4", " ", 
     RowBox[{"Log", "[", 
      RowBox[{"1", "+", "x"}], "]"}]}], "-", 
    RowBox[{"4", " ", "x", " ", 
     RowBox[{"Log", "[", 
      RowBox[{"1", "+", "x"}], "]"}]}]}], 
   RowBox[{"1", "+", "x"}]]}]], "Output",
 CellChangeTimes->{3.4090158862098637`*^9, 3.409125382344545*^9, 
  3.409889051299252*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       FractionBox[
        RowBox[{"Exp", "[", 
         RowBox[{
          SqrtBox["3"], "x"}], "]"}], 
        RowBox[{"1", "-", 
         RowBox[{"x", " ", 
          RowBox[{"Exp", "[", "x", "]"}]}]}]], ",", "x"}], "]"}], "//", 
     "Together"}], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"old", " ", "bug"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.3974701144056177`*^9, 3.397470135835198*^9}, {
  3.39747017970922*^9, 3.397470183666551*^9}, {3.397470690029725*^9, 
  3.397470757985461*^9}, {3.409889062321678*^9, 3.409889064306965*^9}}],

Cell[BoxData[
 FractionBox[
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{
    SqrtBox["3"], " ", "x"}]], 
  RowBox[{"1", "-", 
   RowBox[{
    SuperscriptBox["\[ExponentialE]", "x"], " ", "x"}]}]]], "Output",
 CellChangeTimes->{{3.397470132112871*^9, 3.397470161881379*^9}, 
   3.397470192799904*^9, 3.397470512889817*^9, 3.3974706762254467`*^9, 
   3.398851249252678*^9, 3.399381796034111*^9, 3.404031235668936*^9, 
   3.408867532249398*^9, 3.409015890260944*^9, 3.409125402318741*^9, {
   3.409889055915286*^9, 3.4098890669087257`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"1", "/", "x"}], "+", 
       RowBox[{"1", "/", 
        RowBox[{"Log", "[", "x", "]"}]}]}], "]"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"x", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           SuperscriptBox[
            RowBox[{"Log", "[", "x", "]"}], "2"]}], "-", "2"}], ")"}]}], "-", 
       SuperscriptBox[
        RowBox[{"Log", "[", "x", "]"}], "2"], "+", 
       FractionBox[
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "1"}], "/", "x"}], "]"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", 
            RowBox[{"Log", "[", "x", "]"}]}], "-", "1"}], ")"}]}], 
        RowBox[{"2", "x"}]], "+", 
       RowBox[{"Log", "[", "x", "]"}], "+", 
       FractionBox["x", 
        RowBox[{"Log", "[", "x", "]"}]]}], ")"}]}], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Example", " ", "from", " ", "Davenport", " ", "1987"}], ",", " ", 
    RowBox[{"p", 
     RowBox[{".913", "."}]}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.39779447594133*^9, 3.3977945366738577`*^9}, {
  3.3977946266110487`*^9, 3.397794654074942*^9}, {3.3977947021432343`*^9, 
  3.397794720792334*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  SuperscriptBox["\[ExponentialE]", 
   FractionBox["1", 
    RowBox[{"Log", "[", "x", "]"}]]], " ", 
  RowBox[{"Log", "[", "x", "]"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "2"}], " ", 
     SuperscriptBox["\[ExponentialE]", 
      FractionBox["1", "x"]], " ", 
     SuperscriptBox["x", "2"]}], "+", 
    RowBox[{"Log", "[", "x", "]"}], "+", 
    RowBox[{"2", " ", 
     SuperscriptBox["\[ExponentialE]", 
      FractionBox["1", "x"]], " ", 
     SuperscriptBox["x", "2"], " ", 
     RowBox[{"Log", "[", "x", "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.398851269026224*^9, 3.399381798693247*^9, 3.404031240078174*^9, 
   3.408867525355301*^9, 3.409015901422073*^9, 3.409125403167*^9, {
   3.409889057405899*^9, 3.409889069527014*^9}, 3.409889650991544*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    FractionBox[
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["x", "2"]}]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "x"}], "+", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", "x"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{"2", " ", "x"}]}], ")"}]}]}], ")"}]}], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["\[ExponentialE]", "x"]}], ")"}], "2"]], ",", "x"}], 
   "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"project", " ", 
    RowBox[{"example", "."}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.397795404977213*^9, 3.397795406703*^9}, {
  3.397795808727375*^9, 3.397795815656699*^9}}],

Cell[BoxData[
 FractionBox[
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    SuperscriptBox["x", "2"]}]], 
  RowBox[{
   RowBox[{"-", "1"}], "+", 
   SuperscriptBox["\[ExponentialE]", "x"]}]]], "Output",
 CellChangeTimes->{3.397795409401164*^9, 3.3977958185480747`*^9, 
  3.3977963739817944`*^9, 3.397796450494534*^9, 3.3977978646124573`*^9, 
  3.3978177922916327`*^9, 3.3988512758421993`*^9, 3.399381801102393*^9, 
  3.404031240789459*^9, 3.4088675233012047`*^9, 3.4090159060597553`*^9, 
  3.409053400669593*^9, 3.409125407917499*^9, 3.409889072756918*^9, 
  3.409889652456169*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    FractionBox[
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       FractionBox["1", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "x"}]]], " ", 
      RowBox[{"(", 
       RowBox[{"3", "+", "x", "-", 
        RowBox[{"2", " ", 
         SuperscriptBox["x", "2"]}], "+", 
        SuperscriptBox["x", "3"]}], ")"}]}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "x"}], ")"}], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "+", "x", "+", 
         SuperscriptBox["x", "2"]}], ")"}], "2"]}]], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"project", " ", "example"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.397817842365904*^9, 3.397817844185872*^9}, {
  3.397820800729636*^9, 3.397820807964232*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    FractionBox["1", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "x"}]]], " ", 
   RowBox[{"(", 
    RowBox[{"1", "-", "x"}], ")"}]}], 
  RowBox[{"1", "+", "x", "+", 
   SuperscriptBox["x", "2"]}]]], "Output",
 CellChangeTimes->{{3.397820817941944*^9, 3.397820835145053*^9}, {
   3.397824045034018*^9, 3.397824078543021*^9}, 3.398851277433715*^9, 
   3.399381802949711*^9, 3.404031241322096*^9, 3.408867519561214*^9, 
   3.409015908858754*^9, 3.409053401801175*^9, 3.409125408621088*^9, 
   3.40988907773251*^9, 3.409889653042283*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["x", "3"], "+", 
        RowBox[{"2", "x"}]}], ")"}], 
      RowBox[{"Cos", "[", 
       SuperscriptBox["x", "2"], "]"}]}], "+", 
     RowBox[{"x", " ", 
      RowBox[{"Sin", "[", 
       SuperscriptBox["x", "2"], "]"}]}]}], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"Geddes", " ", "paper", " ", "example"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.3978767176146727`*^9, 3.3978767358336153`*^9}, {
  3.397876779755331*^9, 3.397876797786167*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Sin", "[", 
   SuperscriptBox["x", "2"], "]"}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   SuperscriptBox["x", "2"], " ", 
   RowBox[{"Sin", "[", 
    SuperscriptBox["x", "2"], "]"}]}]}]], "Output",
 CellChangeTimes->{
  3.397876740734902*^9, 3.397959267609479*^9, 3.397993424227673*^9, 
   3.399381804691127*^9, 3.4040312419257298`*^9, 3.404033462206087*^9, {
   3.408867514395176*^9, 3.408867516404765*^9}, 3.4090159099790154`*^9, 
   3.4091254097636766`*^9, 3.409889078270954*^9, 3.409889653749185*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Risch", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     FractionBox[
      RowBox[{"1", "-", 
       FractionBox[
        SuperscriptBox["x", "100"], "100"]}], 
      SuperscriptBox["x", "101"]], ")"}], 
    SuperscriptBox["\[ExponentialE]", 
     FractionBox[
      SuperscriptBox["x", "100"], "100"]]}], ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.404720139140129*^9, 3.404720145353694*^9}, {
  3.4051492447033777`*^9, 3.405149254425098*^9}, {3.4066220708297043`*^9, 
  3.406622092861561*^9}, {3.408865710068659*^9, 3.408865716632934*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   SuperscriptBox["\[ExponentialE]", 
    FractionBox[
     SuperscriptBox["x", "100"], "100"]], 
   RowBox[{"100", " ", 
    SuperscriptBox["x", "100"]}]]}]], "Output",
 CellChangeTimes->{
  3.407988000335894*^9, 3.4079884717060204`*^9, 3.407988899387487*^9, {
   3.40799013822897*^9, 3.407990139953731*^9}, 3.408001975268207*^9, 
   3.408153264231008*^9, {3.408865705897932*^9, 3.4088657188607817`*^9}, 
   3.408867517336672*^9, 3.409015911002885*^9, 3.409053404396655*^9, 
   3.409125412929373*^9, 3.409889080210373*^9, 3.4098896543761997`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Risch", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Exp", "[", 
     RowBox[{"Exp", "[", "x", "]"}], "]"}], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"x", " ", 
       RowBox[{"Exp", "[", "x", "]"}]}]}], ")"}], 
    RowBox[{"Cos", "[", 
     RowBox[{"x", " ", 
      RowBox[{"Exp", "[", 
       RowBox[{"Exp", "[", "x", "]"}], "]"}]}], "]"}]}], ",", "x"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.3977932142089777`*^9, 3.397793245991797*^9}, {
  3.4090205958038177`*^9, 3.409020597304954*^9}}],

Cell[BoxData[
 RowBox[{"Sin", "[", 
  SuperscriptBox["\[ExponentialE]", 
   SuperscriptBox["\[ExponentialE]", "x"]], "]"}]], "Output",
 CellChangeTimes->{{3.3979934068753767`*^9, 3.39799341643884*^9}, 
   3.39938191016014*^9, {3.409020589176751*^9, 3.409020597801683*^9}, 
   3.409053406804949*^9, 3.409125413996915*^9, {3.409889083240513*^9, 
   3.409889085248551*^9}, 3.409889655241467*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["SENAC Examples", "Subsection",
 CellChangeTimes->{{3.396343917247164*^9, 3.396343921216647*^9}}],

Cell["All of these integrals were bugs in the Macsyma CAS", "Text",
 CellChangeTimes->{{3.396351225524681*^9, 3.3963512569471483`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", 
       FractionBox["1", 
        RowBox[{"x", " ", 
         SuperscriptBox[
          RowBox[{"Log", "[", "x", "]"}], "2"]}]]}], ")"}], 
     RowBox[{"Exp", "[", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"Log", "[", "x", "]"}]], "+", "x"}], "]"}]}], ",", "x"}], 
   "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"SENAC", " ", "paper"}], ",", " ", 
    RowBox[{
     RowBox[{"example", " ", "1.", " ", "Faster", " ", "than", " ", "M"}], 
     "-"}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.396088744966586*^9, 3.396088804637899*^9}, {
  3.396089199899633*^9, 3.3960892209690323`*^9}, {3.396089280183076*^9, 
  3.396089281238558*^9}, {3.3960893844469833`*^9, 3.396089391446669*^9}, {
  3.3962534386295424`*^9, 3.396253438978623*^9}}],

Cell[BoxData[
 SuperscriptBox["\[ExponentialE]", 
  RowBox[{"x", "+", 
   FractionBox["1", 
    RowBox[{"Log", "[", "x", "]"}]]}]]], "Output",
 CellChangeTimes->{
  3.396267650960586*^9, 3.396267922179246*^9, 3.396269163131507*^9, 
   3.396269237497963*^9, 3.396320810044445*^9, 3.3963234803508377`*^9, 
   3.3963249173381643`*^9, 3.396341870991534*^9, 3.396357995092721*^9, 
   3.396441270347454*^9, 3.396483059930325*^9, 3.396589002976535*^9, 
   3.3966997040441504`*^9, 3.3967533959821777`*^9, 3.39736381291096*^9, 
   3.397368307456061*^9, 3.397453309875003*^9, 3.397729526120398*^9, 
   3.3988513246561213`*^9, 3.3993818591969976`*^9, 3.40403125662602*^9, 
   3.4040970832876472`*^9, {3.408009973755965*^9, 3.4080099883394547`*^9}, {
   3.408862891555512*^9, 3.408862921547433*^9}, 3.409016030924735*^9, 
   3.409125424179064*^9, 3.409199750053678*^9, 3.409201583209762*^9, 
   3.409822521102635*^9, 3.409889124786098*^9, 3.4099093186381483`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"Exp", "[", 
         RowBox[{"x", "+", "1"}], "]"}], "/", "x"}], "]"}], 
      RowBox[{"Exp", "[", 
       SuperscriptBox["x", "2"], "]"}]], 
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        RowBox[{"Exp", "[", 
         RowBox[{"x", "+", "1"}], "]"}], "x"], "-", 
       FractionBox[
        RowBox[{"Exp", "[", 
         RowBox[{"x", "+", "1"}], "]"}], 
        SuperscriptBox["x", "2"]], "-", 
       RowBox[{"2", "x"}]}], ")"}]}], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"SENAC", " ", "paper"}], ",", " ", 
    RowBox[{
     RowBox[{"example", " ", "2.", " ", "Faster", " ", "than", " ", "M"}], 
     "-"}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.3960893142158012`*^9, 3.396089361286923*^9}, {
  3.396089396783745*^9, 3.396089427535552*^9}, {3.396253430422209*^9, 
  3.396253430819336*^9}}],

Cell[BoxData[
 SuperscriptBox["\[ExponentialE]", 
  RowBox[{
   FractionBox[
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"1", "+", "x"}]], "x"], "-", 
   SuperscriptBox["x", "2"]}]]], "Output",
 CellChangeTimes->{
  3.396267646180372*^9, 3.396267922850274*^9, 3.396269163748798*^9, {
   3.396320827315446*^9, 3.39632084007032*^9}, 3.39632348740687*^9, 
   3.39632491849305*^9, 3.396341872084552*^9, 3.396357995900383*^9, 
   3.396441271525725*^9, 3.396483060706243*^9, 3.3965890041007032`*^9, 
   3.3966997047984667`*^9, 3.3967533976888037`*^9, 3.397276227093288*^9, 
   3.39736381375098*^9, 3.3973683084438543`*^9, 3.397369466391397*^9, 
   3.397453310502224*^9, 3.397729527242198*^9, 3.397794380338923*^9, 
   3.3988513253764467`*^9, 3.399381860408944*^9, 3.404031257285448*^9, 
   3.4040970839872704`*^9, 3.409016031684054*^9, 3.409125424807675*^9, 
   3.409199750775785*^9, 3.409201584459094*^9, 3.409822521386773*^9, 
   3.409889117914764*^9, 3.409909317971089*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    FractionBox[
     RowBox[{
      SuperscriptBox["\[ExponentialE]", "x"], "+", "x", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SuperscriptBox["\[ExponentialE]", "x"]}], ")"}], " ", "x", " ", 
       RowBox[{"Log", "[", "x", "]"}], " ", 
       RowBox[{"Log", "[", 
        RowBox[{"1", "+", 
         FractionBox["1", 
          RowBox[{"Log", "[", "x", "]"}]]}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SuperscriptBox["\[ExponentialE]", "x"]}], ")"}], " ", "x", " ", 
       SuperscriptBox[
        RowBox[{"Log", "[", "x", "]"}], "2"], " ", 
       RowBox[{"Log", "[", 
        RowBox[{"1", "+", 
         FractionBox["1", 
          RowBox[{"Log", "[", "x", "]"}]]}], "]"}]}]}], 
     RowBox[{"x", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", "x"], "+", "x"}], ")"}], "2"], " ", 
      RowBox[{"Log", "[", "x", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"Log", "[", "x", "]"}]}], ")"}]}]], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", "BUG", " ", "*)"}], 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"SENAC", " ", "paper"}], ",", " ", 
    RowBox[{
     RowBox[{
     "example", " ", "3.", " ", "10", "x", " ", "faster", " ", "than", " ", 
      "M"}], "-"}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.39608952021301*^9, 3.3960896224539022`*^9}, {
  3.3962534269910517`*^9, 3.3962534273565483`*^9}, {3.409016047528879*^9, 
  3.4090160504921207`*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"Log", "[", 
    RowBox[{"1", "+", 
     FractionBox["1", 
      RowBox[{"Log", "[", "x", "]"}]]}], "]"}], 
   RowBox[{
    SuperscriptBox["\[ExponentialE]", "x"], "+", "x"}]]}]], "Output",
 CellChangeTimes->{3.409125425490677*^9, 3.409199752171006*^9, 
  3.4092015855337954`*^9, 3.409822521738268*^9, 3.409889118552711*^9, 
  3.409909316891376*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    FractionBox["1", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"x", " ", 
          RowBox[{"Exp", "[", "x", "]"}]}], "+", 
         SuperscriptBox["x", "2"]}], ")"}], 
       RowBox[{"Log", "[", "x", "]"}]}], "+", 
      RowBox[{"x", " ", 
       RowBox[{"Exp", "[", "x", "]"}]}], "+", 
      SuperscriptBox["x", "2"]}]], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"SENAC", " ", "paper"}], ",", " ", 
    RowBox[{"remaining", " ", "integral", " ", "from", " ", "MACSYMA", " ", 
     RowBox[{"bug", " ", "--"}], " ", "NOT", " ", "ELEMENTARY"}]}], " ", 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.396089837404272*^9, 3.396089862270811*^9}, {
  3.396089893224395*^9, 3.396089923479807*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PureLogPart", "::", "\<\"warning\"\>"}], ":", 
  " ", "\<\"Integral not elementary - roots of resultant polynomial are non \
constant.\"\>"}]], "Message", "MSG",
 CellChangeTimes->{
  3.396267641125608*^9, 3.396267924951898*^9, 3.3962691658144817`*^9, 
   3.396323562574717*^9, 3.396324922733034*^9, 3.396341895088333*^9, 
   3.396357997533482*^9, 3.3964412783673964`*^9, 3.396483062861211*^9, 
   3.396699706220882*^9, 3.396753398814028*^9, 3.397276229249172*^9, 
   3.397363816245573*^9, 3.397368308882071*^9, 3.397453316416245*^9, {
   3.397729530842453*^9, 3.3977295336813297`*^9}, 3.398851330100739*^9, 
   3.3993818614524527`*^9, 3.404031259182727*^9, 3.404097085902906*^9, 
   3.409016054093253*^9, 3.409125429038301*^9, 3.4091997541696978`*^9, 
   3.409201587669567*^9, 3.4098225223996477`*^9, 3.409889115206921*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"Risch", "[", 
   RowBox[{
    FractionBox["1", 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[ExponentialE]", "x"], " ", "x"}], "+", 
      SuperscriptBox["x", "2"], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["\[ExponentialE]", "x"], " ", "x"}], "+", 
         SuperscriptBox["x", "2"]}], ")"}], " ", 
       RowBox[{"Log", "[", "x", "]"}]}]}]], ",", "x"}], "]"}],
  HoldForm]], "Output",
 CellChangeTimes->{3.398851330103445*^9, 3.399381861455768*^9, 
  3.404031259202073*^9, 3.404097085925377*^9, 3.409016054097107*^9, 
  3.409125429041973*^9, 3.409199754172909*^9, 3.409201587675565*^9, 
  3.409822522403331*^9, 3.40988911521101*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    FractionBox[
     RowBox[{"Exp", "[", 
      RowBox[{"1", "/", 
       RowBox[{"Log", "[", "x", "]"}]}], "]"}], 
     RowBox[{"x", " ", 
      SuperscriptBox[
       RowBox[{"Log", "[", "x", "]"}], "3"]}]], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", "BUG", " ", "*)"}], 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "SENAC", " ", "paper", " ", "example", " ", "7.", " ", "Bug", " ", "in", 
     " ", "RischExpLogSimplify"}], ",", " ", 
    RowBox[{"NOW", " ", "FIXED"}]}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.3960905452245083`*^9, 3.396090568697069*^9}, {
  3.39609060006597*^9, 3.396090607265374*^9}, {3.396172265716461*^9, 
  3.3961722817767572`*^9}, {3.396172435386444*^9, 3.396172446890092*^9}, {
  3.396343932069738*^9, 3.396343933979218*^9}, {3.409016065181295*^9, 
  3.409016067738132*^9}, {3.409125447237975*^9, 3.409125454133198*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    FractionBox["1", 
     RowBox[{"Log", "[", "x", "]"}]]], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     RowBox[{"Log", "[", "x", "]"}]}], ")"}]}], 
  RowBox[{"Log", "[", "x", "]"}]]], "Output",
 CellChangeTimes->{{3.396267615177505*^9, 3.396267639061932*^9}, 
   3.3962679260863113`*^9, 3.396269168328311*^9, 3.3963208458866*^9, 
   3.396323566839505*^9, 3.396324927449608*^9, 3.396358001381466*^9, 
   3.3964412800741177`*^9, 3.396483065974955*^9, 3.396589011882345*^9, 
   3.396699711070822*^9, 3.3967534007745113`*^9, 3.397276233246888*^9, 
   3.397363817177834*^9, 3.397368309188508*^9, 3.3974533173069963`*^9, 
   3.39772954309546*^9, 3.398851331236834*^9, 3.399381861739291*^9, 
   3.404031262644971*^9, 3.404097090105706*^9, 3.4090160582914457`*^9, {
   3.409125430033401*^9, 3.409125454818206*^9}, {3.409199759009253*^9, 
   3.40919977017136*^9}, 3.409201592370328*^9, 3.409822514818467*^9, 
   3.409889112408197*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{"x", "+", "1"}], ")"}], 
      RowBox[{"Exp", "[", 
       RowBox[{"x", "/", 
        RowBox[{"Exp", "[", 
         RowBox[{"1", "/", "x"}], "]"}]}], "]"}]}], 
     RowBox[{"Exp", "[", 
      RowBox[{"2", "/", "x"}], "]"}]], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", "BUG", " ", "*)"}], 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"SENAC", " ", "example", " ", "5"}], ",", " ", 
    RowBox[{"bug", " ", "now", " ", "fixed"}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.396090050500976*^9, 3.396090107374176*^9}, {
  3.396090986997272*^9, 3.396090990116754*^9}, {3.396091431524014*^9, 
  3.3960914360890417`*^9}, {3.396093597032246*^9, 3.396093597541321*^9}, {
  3.396172904508854*^9, 3.396172916770007*^9}, {3.396175382738872*^9, 
  3.396175385485634*^9}, {3.3961756219835243`*^9, 3.396175638690411*^9}, {
  3.3962676348111277`*^9, 3.3962676368507757`*^9}, {3.39658902707157*^9, 
  3.3965890460792313`*^9}, {3.4090160772598667`*^9, 3.4090160804341927`*^9}}],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["2", "x"]}], "+", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "1"}], "/", "x"}]], " ", "x"}]}]], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"2", "/", "x"}]]}], "+", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      FractionBox["1", "x"]], " ", "x"}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.409125440124631*^9, 3.409201594327365*^9, 
  3.4098225169946136`*^9, 3.4098891105261097`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    RowBox[{
     FractionBox["1", 
      RowBox[{"x", " ", 
       RowBox[{"Log", "[", 
        RowBox[{
         RowBox[{"Exp", "[", "x", "]"}], "+", "1"}], "]"}]}]], "-", 
     FractionBox[
      RowBox[{
       RowBox[{"Exp", "[", "x", "]"}], 
       RowBox[{"Log", "[", "x", "]"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Exp", "[", "x", "]"}], "+", "1"}], ")"}], 
       SuperscriptBox[
        RowBox[{"Log", "[", 
         RowBox[{
          RowBox[{"Exp", "[", "x", "]"}], "+", "1"}], "]"}], "2"]}]]}], ",", 
    "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"SENAC", " ", "example", " ", "4."}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.396089928614675*^9, 3.396090003332613*^9}, {
   3.396090045398855*^9, 3.396090045508298*^9}, 3.396093792396826*^9, {
   3.396237709311347*^9, 3.396237715290592*^9}, {3.396269176882324*^9, 
   3.3962691775512657`*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"Log", "[", "x", "]"}], 
  RowBox[{"Log", "[", 
   RowBox[{"1", "+", 
    SuperscriptBox["\[ExponentialE]", "x"]}], "]"}]]], "Output",
 CellChangeTimes->{
  3.396267606033373*^9, 3.396267960710973*^9, {3.39626917052601*^9, 
   3.396269178574502*^9}, 3.396269616905519*^9, 3.39632084798155*^9, 
   3.3963235780145903`*^9, 3.396324930240622*^9, 3.396341900837646*^9, 
   3.396358002974945*^9, 3.396441282893005*^9, 3.396483067813542*^9, 
   3.3965890775609617`*^9, 3.3966997151425962`*^9, 3.396753403813315*^9, 
   3.397276235016967*^9, 3.397363818198448*^9, 3.3973683105264072`*^9, 
   3.397453319398363*^9, 3.397729548026939*^9, 3.3977943501655684`*^9, 
   3.398851333152701*^9, 3.3993818630814753`*^9, 3.4040312637681932`*^9, 
   3.4040331914079723`*^9, 3.404097091053913*^9, 3.409016082742784*^9, 
   3.409125441256351*^9, 3.409201595714634*^9, 3.409822517481805*^9, 
   3.409889108681209*^9, 3.409909320064187*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      FractionBox[
       RowBox[{"Exp", "[", 
        FractionBox["1", 
         RowBox[{
          RowBox[{"Exp", "[", "x", "]"}], "+", "1"}]], "]"}], 
       RowBox[{"39916800", " ", 
        RowBox[{"Exp", "[", 
         RowBox[{"10", "x"}], "]"}]}]], ")"}], 
     RowBox[{"(", 
      FractionBox[
       RowBox[{"1757211400", "+", 
        RowBox[{"2581284541", " ", 
         RowBox[{"Exp", "[", "x", "]"}]}]}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Exp", "[", "x", "]"}], "+", "1"}], ")"}], "3"]], ")"}]}], 
    ",", "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"SENAC", " ", "example", " ", "6"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.3973683389297037`*^9, 3.397368427158845*^9}}],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"1", "+", 
      SuperscriptBox["\[ExponentialE]", "x"]}]], "-", 
    RowBox[{"10", " ", "x"}]}]], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["1255151", 
      RowBox[{"285120", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SuperscriptBox["\[ExponentialE]", "x"]}], ")"}]}]]}], "+", 
    FractionBox[
     RowBox[{"1441729", " ", 
      SuperscriptBox["\[ExponentialE]", "x"]}], 
     RowBox[{"403200", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SuperscriptBox["\[ExponentialE]", "x"]}], ")"}]}]], "-", 
    FractionBox[
     RowBox[{"65461", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"2", " ", "x"}]]}], 
     RowBox[{"22680", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SuperscriptBox["\[ExponentialE]", "x"]}], ")"}]}]], "+", 
    FractionBox[
     RowBox[{"13327", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"3", " ", "x"}]]}], 
     RowBox[{"5760", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SuperscriptBox["\[ExponentialE]", "x"]}], ")"}]}]], "-", 
    FractionBox[
     RowBox[{"773", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"4", " ", "x"}]]}], 
     RowBox[{"420", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SuperscriptBox["\[ExponentialE]", "x"]}], ")"}]}]], "+", 
    FractionBox[
     RowBox[{"209", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"5", " ", "x"}]]}], 
     RowBox[{"144", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SuperscriptBox["\[ExponentialE]", "x"]}], ")"}]}]], "-", 
    FractionBox[
     RowBox[{"17", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"6", " ", "x"}]]}], 
     RowBox[{"15", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SuperscriptBox["\[ExponentialE]", "x"]}], ")"}]}]], "+", 
    FractionBox[
     RowBox[{"7", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"7", " ", "x"}]]}], 
     RowBox[{"8", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SuperscriptBox["\[ExponentialE]", "x"]}], ")"}]}]], "-", 
    FractionBox[
     RowBox[{"2", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"8", " ", "x"}]]}], 
     RowBox[{"3", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SuperscriptBox["\[ExponentialE]", "x"]}], ")"}]}]], "+", 
    FractionBox[
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"9", " ", "x"}]], 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SuperscriptBox["\[ExponentialE]", "x"]}], ")"}]}]], "+", 
    FractionBox[
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"11", " ", "x"}]], 
     RowBox[{"1", "+", 
      SuperscriptBox["\[ExponentialE]", "x"]}]]}], ")"}]}]], "Output",
 CellChangeTimes->{3.397561767478465*^9, 3.3977295493396597`*^9, 
  3.3988513378822727`*^9, 3.399381863724731*^9, 3.4040312648239*^9, 
  3.404033178529285*^9, 3.404097091547632*^9, 3.409016083445978*^9, 
  3.409125441938733*^9, 3.409201597574006*^9, 3.409822517990624*^9, 
  3.409889106980247*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Gillies and Char Examples", "Subsection",
 CellChangeTimes->{{3.396581072523559*^9, 3.396581080183572*^9}}],

Cell[TextData[{
 "From \"Practical Aspects of Symbolic Integration over \
\[DoubleStruckCapitalQ](",
 StyleBox["x",
  FontSlant->"Italic"],
 ")\", David Gillies and Bruce Char, University of Waterloo, EuroCal 1987."
}], "Text",
 CellChangeTimes->{{3.396581082903425*^9, 3.396581129167448*^9}, {
  3.39658122016842*^9, 3.396581262758669*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Risch", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["x", "101"], "+", "1"}], ")"}], 
      RowBox[{"Exp", "[", "x", "]"}]}], ",", "x"}], "]"}], "//", "Timing"}], "//",
   "First", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Example", " ", "1"}], ":", " ", 
    RowBox[{"Davenport", " ", "<", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"Risch", ".", " ", "Faster"}], " ", "than", " ", "M"}], 
      "-"}]}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.396581286483061*^9, 3.396581339374979*^9}, {
   3.3965813992591467`*^9, 3.396581458455716*^9}, {3.396581589762315*^9, 
   3.396581606000167*^9}, 3.397561915229472*^9, {3.397562101815341*^9, 
   3.3975621045870323`*^9}}],

Cell[BoxData["0.05232299999999945`"], "Output",
 CellChangeTimes->{{3.409016116480569*^9, 3.409016125790769*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Risch", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       FractionBox[
        RowBox[{
         SuperscriptBox["x", "101"], "+", "1"}], 
        RowBox[{"x", "+", "1"}]], ")"}], 
      RowBox[{"Exp", "[", "x", "]"}]}], ",", "x"}], "]"}], "//", "Timing"}], "//",
   "First", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Example", " ", "2"}], ":", " ", "Davenport"}], " ", ">>", " ", 
    RowBox[{
     RowBox[{"Risch", " ", "Faster", " ", "than", " ", "M"}], "-"}]}], " ", 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.396581505893443*^9, 3.3965815544322147`*^9}, {
  3.39658160848834*^9, 3.39658162424857*^9}}],

Cell[BoxData["0.15856499999999984`"], "Output",
 CellChangeTimes->{{3.3965815245268*^9, 3.396581534668804*^9}, 
   3.396589093610066*^9, 3.396753375459351*^9, 3.397276286530018*^9, 
   3.3974533338195972`*^9, 3.40901613311769*^9, 3.4091254735016813`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      FractionBox[
       RowBox[{
        SuperscriptBox["x", "2"], "-", "x", "-", "1"}], 
       RowBox[{
        SuperscriptBox["x", "2"], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"x", "+", "1"}], ")"}], "2"]}]], ")"}], 
     RowBox[{"Exp", "[", "x", "]"}]}], ",", "x"}], "]"}], "//", "Timing", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Example", " ", "3"}], ":", " ", "Davenport"}], " ", ">>", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"Risch", "."}], " ", "Faster", " ", "than", " ", "M"}], "-"}]}],
    " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.396581633867383*^9, 3.396581685056525*^9}, {
  3.396581721960821*^9, 3.396581722545857*^9}, {3.396581846593938*^9, 
  3.396581859255457*^9}, {3.39658208825994*^9, 3.39658209208296*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.014517000000000113`", ",", 
   FractionBox[
    SuperscriptBox["\[ExponentialE]", "x"], 
    RowBox[{"x", " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", "x"}], ")"}]}]]}], "}"}]], "Output",
 CellChangeTimes->{
  3.396581663115283*^9, {3.396581847653281*^9, 3.3965818598458033`*^9}, 
   3.396589094797553*^9, 3.396753376978286*^9, 3.397276287336822*^9, 
   3.397453339873829*^9, 3.398851371430522*^9, 3.4090161381699467`*^9, 
   3.40912547852526*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      FractionBox[
       RowBox[{
        SuperscriptBox["x", "4"], "+", 
        RowBox[{"2", 
         SuperscriptBox["x", "3"]}], "-", 
        RowBox[{"7", 
         SuperscriptBox["x", "2"]}], "-", 
        RowBox[{"16", "x"}], "-", "6"}], 
       RowBox[{
        SuperscriptBox["x", "2"], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"x", "+", "1"}], ")"}], "2"], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"x", "+", "2"}], ")"}], "2"], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"x", "+", "3"}], ")"}], "2"]}]], ")"}], 
     RowBox[{"Exp", "[", "x", "]"}]}], ",", "x"}], "]"}], "//", "Timing", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Example", " ", "4"}], ":", " ", "Davenport"}], " ", ">>>", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"Risch", "."}], " ", "Slightly", " ", "faster", " ", "than", 
      " ", "M"}], "-"}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.396581778704103*^9, 3.3965818392635727`*^9}, {
  3.396581878841093*^9, 3.396581925776382*^9}, {3.396582094572021*^9, 
  3.3965820972562323`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.023836999999999886`", ",", 
   FractionBox[
    SuperscriptBox["\[ExponentialE]", "x"], 
    RowBox[{"x", " ", 
     RowBox[{"(", 
      RowBox[{"6", "+", 
       RowBox[{"11", " ", "x"}], "+", 
       RowBox[{"6", " ", 
        SuperscriptBox["x", "2"]}], "+", 
       SuperscriptBox["x", "3"]}], ")"}]}]]}], "}"}]], "Output",
 CellChangeTimes->{{3.3965818422127028`*^9, 3.3965818630092278`*^9}, 
   3.396581903485817*^9, 3.396589095993505*^9, 3.396753379252245*^9, 
   3.397276288050696*^9, 3.397453341021372*^9, 3.398851372111512*^9, 
   3.409016104354887*^9, 3.409125479374524*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      FractionBox[
       RowBox[{"x", "-", "100"}], 
       SuperscriptBox["x", "101"]], ")"}], 
     RowBox[{"Exp", "[", "x", "]"}]}], ",", "x"}], "]"}], "//", "Timing", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Example", " ", "5"}], ":", " ", 
    RowBox[{"Davenport", " ", "<", " ", "Risch"}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.396581937056794*^9, 3.396582008658114*^9}, {
  3.396582103194647*^9, 3.396582120522393*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.010315000000000074`", ",", 
   FractionBox[
    SuperscriptBox["\[ExponentialE]", "x"], 
    SuperscriptBox["x", "100"]]}], "}"}]], "Output",
 CellChangeTimes->{3.396581963146422*^9, 3.396582000089349*^9, 
  3.3965891041640377`*^9, 3.396753380931349*^9, 3.397276289142983*^9, 
  3.397453344449911*^9, 3.398851372693975*^9, 3.4090161052835484`*^9, 
  3.409125479977324*^9, 3.409901409036373*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      FractionBox[
       RowBox[{"x", "-", "99"}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"x", "+", "2"}], ")"}], "102"]], ")"}], 
     RowBox[{"Exp", "[", "x", "]"}]}], ",", "x"}], "]"}], "//", "Timing", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Example", " ", "6"}], ":", " ", 
     RowBox[{
      RowBox[{"Davenport", " ", 
       RowBox[{
        RowBox[{"<<", " ", "Risch"}], ".", " ", "Slower"}], " ", "than", " ", 
       "M"}], "-"}]}], ",", " ", 
    RowBox[{"as", " ", "expected"}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.396582122627383*^9, 3.396582200242938*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      FractionBox[
       RowBox[{"1", "-", 
        RowBox[{
         FractionBox["1", "100"], 
         SuperscriptBox["x", "100"]}]}], 
       SuperscriptBox["x", "101"]], ")"}], 
     RowBox[{"Exp", "[", 
      FractionBox[
       SuperscriptBox["x", "100"], "100"], "]"}]}], ",", "x"}], "]"}], "//", 
  "Timing", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Example", " ", "7"}], ":", " ", 
    RowBox[{"Davenport", " ", 
     RowBox[{
      RowBox[{"<<", " ", "Risch"}], "."}]}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.396582246001108*^9, 3.396582348954534*^9}, {
  3.396583276642186*^9, 3.396583276914031*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.011241000000000057`", ",", 
   RowBox[{"-", 
    FractionBox[
     SuperscriptBox["\[ExponentialE]", 
      FractionBox[
       SuperscriptBox["x", "100"], "100"]], 
     RowBox[{"100", " ", 
      SuperscriptBox["x", "100"]}]]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.396582326609951*^9, {3.3965832778619328`*^9, 3.3965832827293253`*^9}, 
   3.396589099235886*^9, 3.396753385259954*^9, 3.3972763058301287`*^9, 
   3.397453345667221*^9, 3.398851374095903*^9, 3.409016107093926*^9, 
   3.4091254867555523`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      FractionBox[
       RowBox[{
        SuperscriptBox["x", "4"], "-", 
        RowBox[{"4", " ", 
         SuperscriptBox["x", "3"]}], "-", 
        RowBox[{"29", " ", 
         SuperscriptBox["x", "2"]}], "-", 
        RowBox[{"34", "x"}], "-", "6"}], 
       RowBox[{
        SuperscriptBox["x", "2"], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"x", "+", "1"}], ")"}], "3"], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"x", "+", "2"}], ")"}], "4"], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"x", "+", "3"}], ")"}], "5"]}]], ")"}], 
     RowBox[{"Exp", "[", "x", "]"}]}], ",", "x"}], "]"}], "//", "Timing", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Example", " ", "9"}], ":", " ", "Davenport"}], " ", ">>", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"Risch", ".", " ", "Faster"}], " ", "than", " ", "M"}], "-"}]}],
    " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.3965823941969147`*^9, 3.396582512099606*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.035944999999999894`", ",", 
   FractionBox[
    SuperscriptBox["\[ExponentialE]", "x"], 
    RowBox[{"x", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", "x"}], ")"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"2", "+", "x"}], ")"}], "3"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"3", "+", "x"}], ")"}], "4"]}]]}], "}"}]], "Output",
 CellChangeTimes->{
  3.396582453481077*^9, 3.396582487036873*^9, {3.396583278896397*^9, 
   3.39658329409973*^9}, 3.396589099945615*^9, 3.396753386974347*^9, 
   3.397276306744923*^9, 3.397453346420865*^9, 3.398851409333766*^9, 
   3.40901611314073*^9, 3.409125487567634*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Trig/Hyperbolic Functions", "Subsection",
 CellChangeTimes->{{3.3963433009379463`*^9, 3.396343306816407*^9}, {
  3.396344987729385*^9, 3.396344989224801*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Risch", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{"2", "x"}], "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"Sin", "[", "x", "]"}], "]"}]}], ",", "x"}], "]"}], "//", 
   "Timing"}], "//", "Simplify", 
  RowBox[{"(*", " ", 
   RowBox[{"compare", " ", "with", " ", "Integrate"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.402126566374736*^9, 3.402126588872332*^9}, {
  3.402126686775206*^9, 3.4021266877240267`*^9}, {3.4021276663159122`*^9, 
  3.402127670499565*^9}, {3.402220628303329*^9, 3.4022206299745398`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.0445190000027651`", ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "2"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"Sin", "[", "x", "]"}], "]"}], " ", 
     RowBox[{"Sin", "[", "x", "]"}]}], "+", 
    RowBox[{"2", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"Sin", "[", "x", "]"}], "]"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.409822484685171*^9, 3.409888627619615*^9, 
  3.410056966088085*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Risch", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{"2", " ", "x"}], "]"}], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"Cos", "[", "x", "]"}], "]"}]}], ",", "x"}], "]"}], "//", 
   "Timing"}], "//", "Simplify", 
  RowBox[{"(*", " ", 
   RowBox[{"Compare", " ", "with", " ", "timings", " ", "from", " ", 
    RowBox[{"Integrate", "!"}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.402220581303705*^9, 3.4022206029925013`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.045101999999999975`", ",", 
   RowBox[{
    RowBox[{"-", "2"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"Cos", "[", "x", "]"}], "]"}], "+", 
      RowBox[{
       RowBox[{"Cos", "[", "x", "]"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"Cos", "[", "x", "]"}], "]"}]}]}], ")"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.402220582981408*^9, 3.402220588375424*^9}, 
   3.409822488133654*^9, 3.409888628195629*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"12", " ", 
      SuperscriptBox["x", "4"]}], "+", 
     RowBox[{"5", " ", 
      SuperscriptBox["x", "4"], " ", 
      RowBox[{"Log", "[", 
       RowBox[{
        SuperscriptBox["x", "12"], " ", 
        RowBox[{"Cos", "[", "x", "]"}]}], "]"}]}], "-", 
     RowBox[{
      SuperscriptBox["x", "5"], " ", 
      RowBox[{"Tan", "[", "x", "]"}]}]}], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"this", " ", "is", " ", "my", " ", "favourite", " ", 
    RowBox[{"example", "!"}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.392757429544375*^9, 3.392757452606875*^9}, {
   3.395315522970248*^9, 3.3953155959868526`*^9}, {3.395315700838039*^9, 
   3.3953157104698133`*^9}, 3.395315912205621*^9, {3.395460457871994*^9, 
   3.3954604757514887`*^9}, {3.3961593597147293`*^9, 3.396159360072226*^9}, {
   3.396343353149705*^9, 3.39634336101577*^9}, {3.3967777889406633`*^9, 
   3.396777790265877*^9}, {3.397562631120961*^9, 3.397562635229567*^9}, {
   3.399546126479912*^9, 3.39954612752658*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    SuperscriptBox["x", "5"]}], " ", 
   RowBox[{"Log", "[", "2", "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["x", "5"], " ", 
   RowBox[{"Log", "[", 
    RowBox[{
     SuperscriptBox["x", "12"], " ", 
     RowBox[{"Cos", "[", "x", "]"}]}], "]"}]}]}]], "Output",
 CellChangeTimes->{
  3.397453873472032*^9, {3.397562636582231*^9, 3.397562647189747*^9}, 
   3.397724777698718*^9, 3.39772955730094*^9, 3.3988514344656754`*^9, 
   3.399381813920369*^9, {3.399546128207552*^9, 3.399546158044973*^9}, 
   3.4091255168790607`*^9, 3.409201930564055*^9, 3.40982249029779*^9, 
   3.4098886287805223`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"Sinh", "[", "x", "]"}], "6"], ",", "x"}], "]"}], 
  RowBox[{"(*", 
   RowBox[{" ", 
    RowBox[{"bug", ",", " ", 
     RowBox[{"fixed", " ", "with", " ", "massive", " ", 
      RowBox[{"changes", " ", ":"}]}]}], ")"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.3960066710371723`*^9, 3.396006678645424*^9}, {
   3.3960067148301163`*^9, 3.3960067179646177`*^9}, {3.39600676004459*^9, 
   3.396006779737631*^9}, {3.396006900853153*^9, 3.396006915266293*^9}, 
   3.3960976147293663`*^9, {3.3963182178107233`*^9, 3.396318218874298*^9}, 
   3.396330001351589*^9, {3.39633012097834*^9, 3.396330172351533*^9}, {
   3.39634201342026*^9, 3.396342028411126*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    FractionBox["1", "384"]}], " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     RowBox[{"-", "6"}], " ", "x"}]]}], "+", 
  FractionBox[
   RowBox[{"3", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "4"}], " ", "x"}]]}], "128"], "-", 
  FractionBox[
   RowBox[{"15", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "2"}], " ", "x"}]]}], "128"], "+", 
  FractionBox[
   RowBox[{"15", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"2", " ", "x"}]]}], "128"], "-", 
  FractionBox[
   RowBox[{"3", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"4", " ", "x"}]]}], "128"], "+", 
  FractionBox[
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"6", " ", "x"}]], "384"], "-", 
  FractionBox[
   RowBox[{"5", " ", "x"}], "16"]}]], "Output",
 CellChangeTimes->{3.397453875747115*^9, 3.397729558429709*^9, 
  3.398851435250877*^9, 3.399381815652586*^9, 3.409125523815095*^9, 
  3.409822491846664*^9, 3.4098886299447947`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Risch", "[", 
  RowBox[{
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"x", "-", "1"}], ")"}], "2"], 
    SuperscriptBox[
     RowBox[{"Cosh", "[", "x", "]"}], "4"]}], ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.396344124969845*^9, 3.39634416227424*^9}, {
  3.409125552084799*^9, 3.4091255619240093`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"3", " ", "x"}], "8"], "-", 
  FractionBox[
   RowBox[{"3", " ", 
    SuperscriptBox["x", "2"]}], "8"], "+", 
  FractionBox[
   SuperscriptBox["x", "3"], "8"], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     RowBox[{"-", "2"}], " ", "x"}]], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "4"]}], "+", 
     FractionBox["x", "2"], "-", 
     FractionBox[
      SuperscriptBox["x", "2"], "2"]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "16"], " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     RowBox[{"-", "4"}], " ", "x"}]], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["5", "32"]}], "+", 
     FractionBox[
      RowBox[{"3", " ", "x"}], "8"], "-", 
     FractionBox[
      SuperscriptBox["x", "2"], "4"]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "16"], " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"4", " ", "x"}]], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox["13", "32"], "-", 
     FractionBox[
      RowBox[{"5", " ", "x"}], "8"], "+", 
     FractionBox[
      SuperscriptBox["x", "2"], "4"]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"2", " ", "x"}]], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox["5", "4"], "-", 
     FractionBox[
      RowBox[{"3", " ", "x"}], "2"], "+", 
     FractionBox[
      SuperscriptBox["x", "2"], "2"]}], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.397453876577917*^9, 3.398851463130404*^9, 3.399381817723248*^9, 
   3.4091255245678864`*^9, {3.409125556370812*^9, 3.409125562748255*^9}, 
   3.4098247037263937`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Risch", "[", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"Tanh", "[", 
     RowBox[{
      RowBox[{"9", "x"}], "+", "11"}], "]"}], "3"], ",", "x"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.39634418439613*^9, 3.3963442260502453`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox["2", 
    RowBox[{"9", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"22", "+", 
          RowBox[{"18", " ", "x"}]}]]}], ")"}], "2"]}]]}], "+", 
  FractionBox["2", 
   RowBox[{"9", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"22", "+", 
        RowBox[{"18", " ", "x"}]}]]}], ")"}]}]], "+", 
  RowBox[{
   FractionBox["1", "9"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "11"}], "-", 
     RowBox[{"9", " ", "x"}]}], ")"}]}], "+", "x", "+", 
  RowBox[{
   FractionBox["1", "9"], " ", 
   RowBox[{"Log", "[", 
    RowBox[{"1", "+", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"22", "+", 
       RowBox[{"18", " ", "x"}]}]]}], "]"}]}]}]], "Output",
 CellChangeTimes->{3.3974538781403437`*^9, 3.398851492476693*^9, 
  3.3993818191372213`*^9, 3.4091255640642443`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Risch", "[", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"Tan", "[", 
     RowBox[{
      RowBox[{"9", "x"}], "+", "11"}], "]"}], "3"], ",", "x"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.39634418439613*^9, 3.3963442260502453`*^9}, {
  3.396441328091206*^9, 3.396441331209263*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{"11", " ", "\[ImaginaryI]"}], "9"]}], "+", 
  RowBox[{
   FractionBox["1", "9"], " ", 
   RowBox[{"Log", "[", 
    RowBox[{"1", "+", 
     RowBox[{"Cos", "[", 
      RowBox[{"22", "+", 
       RowBox[{"18", " ", "x"}]}], "]"}], "+", 
     RowBox[{"\[ImaginaryI]", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"22", "+", 
        RowBox[{"18", " ", "x"}]}], "]"}]}]}], "]"}]}], "-", 
  FractionBox["2", 
   RowBox[{"9", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"Cos", "[", 
        RowBox[{"22", "+", 
         RowBox[{"18", " ", "x"}]}], "]"}], "+", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"22", "+", 
          RowBox[{"18", " ", "x"}]}], "]"}]}]}], ")"}], "2"]}]], "+", 
  FractionBox["2", 
   RowBox[{"9", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"Cos", "[", 
       RowBox[{"22", "+", 
        RowBox[{"18", " ", "x"}]}], "]"}], "+", 
      RowBox[{"\[ImaginaryI]", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"22", "+", 
         RowBox[{"18", " ", "x"}]}], "]"}]}]}], ")"}]}]]}]], "Output",
 CellChangeTimes->{
  3.39745387872377*^9, 3.398851493333749*^9, 3.399381821180524*^9, 
   3.4091255682567472`*^9, {3.4099014485422583`*^9, 3.4099014542910557`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Cosh", "[", 
      RowBox[{"1", "+", 
       RowBox[{
        SuperscriptBox["x", "5"], " ", 
        RowBox[{"Log", "[", 
         RowBox[{"Cosh", "[", "x", "]"}], "]"}]}]}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"5", " ", 
        SuperscriptBox["x", "4"], " ", 
        RowBox[{"Log", "[", 
         RowBox[{"Cosh", "[", "x", "]"}], "]"}]}], "+", 
       RowBox[{
        SuperscriptBox["x", "5"], " ", 
        RowBox[{"Tanh", "[", "x", "]"}]}]}], ")"}]}], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Integrate", " ", "gives", " ", "nicer", " ", "solution"}], ",", 
    " ", 
    RowBox[{
     RowBox[{"but", " ", "is", " ", "slow"}], "..."}]}], "  ", 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.396344979865378*^9, 3.3963449810737667`*^9}, {
   3.39634506345004*^9, 3.3963450646286793`*^9}, {3.39634532788146*^9, 
   3.39634534134861*^9}, 3.3963460626142073`*^9, {3.396346096197135*^9, 
   3.3963460964558*^9}, {3.3963462180067863`*^9, 3.3963462206216393`*^9}, {
   3.396357354313178*^9, 3.396357355504813*^9}, {3.404032567288443*^9, 
   3.404032589205325*^9}, {3.404032670696369*^9, 3.404032746456436*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    FractionBox["1", "2"]}], " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     RowBox[{"-", "1"}], "-", 
     RowBox[{
      SuperscriptBox["x", "5"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Log", "[", "2", "]"}]}], "+", 
        RowBox[{"Log", "[", 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"-", "x"}]], "+", 
          SuperscriptBox["\[ExponentialE]", "x"]}], "]"}]}], ")"}]}]}]]}], 
  "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"1", "+", 
     RowBox[{
      SuperscriptBox["x", "5"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Log", "[", "2", "]"}]}], "+", 
        RowBox[{"Log", "[", 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"-", "x"}]], "+", 
          SuperscriptBox["\[ExponentialE]", "x"]}], "]"}]}], 
       ")"}]}]}]]}]}]], "Output",
 CellChangeTimes->{3.4040327121952744`*^9, 3.40912557495217*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Risch", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Sin", "[", 
     RowBox[{"2", " ", "x"}], "]"}], " ", 
    SuperscriptBox[
     RowBox[{"Cos", "[", "x", "]"}], "6"]}], ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.396357318337352*^9, 3.396357337991074*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    FractionBox["7", "64"]}], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"2", " ", "x"}], "]"}]}], "-", 
  RowBox[{
   FractionBox["7", "128"], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"4", " ", "x"}], "]"}]}], "-", 
  RowBox[{
   FractionBox["1", "64"], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"6", " ", "x"}], "]"}]}], "-", 
  RowBox[{
   FractionBox["1", "512"], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"8", " ", "x"}], "]"}]}]}]], "Output",
 CellChangeTimes->{3.397453886938055*^9, 3.39756314534341*^9, 
  3.398851503591208*^9, 3.399381822955121*^9, 3.404032754803267*^9, 
  3.409125575643567*^9, 3.4098128229950857`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Risch", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Cos", "[", "x", "]"}], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"Sin", "[", "x", "]"}]}], ")"}], "10"]}], ",", "x"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.396357357827468*^9, 3.396357374542306*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    FractionBox["11305", "256"]}], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"2", " ", "x"}], "]"}]}], "+", 
  RowBox[{
   FractionBox["969", "64"], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"4", " ", "x"}], "]"}]}], "-", 
  RowBox[{
   FractionBox["1197", "512"], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"6", " ", "x"}], "]"}]}], "+", 
  RowBox[{
   FractionBox["35", "256"], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"8", " ", "x"}], "]"}]}], "-", 
  RowBox[{
   FractionBox["1", "512"], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"10", " ", "x"}], "]"}]}], "+", 
  FractionBox[
   RowBox[{"29393", " ", 
    RowBox[{"Sin", "[", "x", "]"}]}], "512"], "-", 
  RowBox[{
   FractionBox["14535", "512"], " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"3", " ", "x"}], "]"}]}], "+", 
  FractionBox[
   RowBox[{"6783", " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"5", " ", "x"}], "]"}]}], "1024"], "-", 
  FractionBox[
   RowBox[{"665", " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"7", " ", "x"}], "]"}]}], "1024"], "+", 
  FractionBox[
   RowBox[{"21", " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"9", " ", "x"}], "]"}]}], "1024"], "-", 
  FractionBox[
   RowBox[{"Sin", "[", 
    RowBox[{"11", " ", "x"}], "]"}], "11264"]}]], "Output",
 CellChangeTimes->{3.39885150444601*^9, 3.399381823408444*^9, 
  3.404032755372388*^9, 3.4091255764330387`*^9, 3.409812827079444*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Risch", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Sech", "[", "x", "]"}], " ", 
    RowBox[{"Tanh", "[", "x", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"Tanh", "[", "x", "]"}]}], ")"}], "3"]}], ",", "x"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.396357435665371*^9, 3.396357463717929*^9}, {
  3.396357548356125*^9, 3.396357564018561*^9}, {3.396357610731845*^9, 
  3.396357611106711*^9}, {3.396753001697323*^9, 3.396753034598487*^9}, {
  3.396753097529421*^9, 3.396753102358491*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"4", " ", 
    SuperscriptBox["\[ExponentialE]", "x"]}], 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"1", "+", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"2", " ", "x"}]]}], ")"}], "4"]], "-", 
  FractionBox[
   RowBox[{"14", " ", 
    SuperscriptBox["\[ExponentialE]", "x"]}], 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"1", "+", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"2", " ", "x"}]]}], ")"}], "3"]], "+", 
  FractionBox[
   RowBox[{"37", " ", 
    SuperscriptBox["\[ExponentialE]", "x"]}], 
   RowBox[{"2", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "+", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"2", " ", "x"}]]}], ")"}], "2"]}]], "-", 
  FractionBox[
   RowBox[{"49", " ", 
    SuperscriptBox["\[ExponentialE]", "x"]}], 
   RowBox[{"4", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"2", " ", "x"}]]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{"15", " ", 
    RowBox[{"ArcTan", "[", 
     SuperscriptBox["\[ExponentialE]", "x"], "]"}]}], "4"]}]], "Output",
 CellChangeTimes->{3.397453888607801*^9, 3.398851506679228*^9, 
  3.399381824390601*^9, 3.404032756512527*^9, 3.4091255775069733`*^9, 
  3.409812828830943*^9, 3.4098224791644163`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Risch", "[", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{"Log", "[", "x", "]"}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"Sin", "[", 
       RowBox[{"Log", "[", "x", "]"}], "]"}], "]"}]}], "x"], ",", "x"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.396357625908437*^9, 3.3963576708107023`*^9}, {
  3.4091256063659487`*^9, 3.409125608268396*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{"Cosh", "[", 
   RowBox[{
    FractionBox[
     SuperscriptBox["x", 
      RowBox[{"-", "\[ImaginaryI]"}]], "2"], "-", 
    FractionBox[
     SuperscriptBox["x", "\[ImaginaryI]"], "2"]}], "]"}]}]], "Output",
 CellChangeTimes->{{3.409125581095498*^9, 3.409125609604343*^9}, 
   3.40981283041833*^9, 3.409822477268997*^9, 3.4098246954883957`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    RowBox[{"Sin", "[", 
     RowBox[{"Sin", "[", "x", "]"}], "]"}], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{
   "proof", " ", "integral", " ", "from", " ", "M", " ", "book", " ", "is", 
    " ", "not", " ", "elementary"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.396357703040872*^9, 3.396357754122591*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RischDE", "::", "\<\"warning\"\>"}], ":", 
  " ", "\<\"Integral not elementary - Risch DE: y' + \\!\\(-\\(\\(\\(\
\[ImaginaryI]\\\\ \\(\\((1 + \[Theta]\\_1\\%2)\\)\\)\\)\\/\\(2\\\\ \
\[Theta]\\_1\\)\\)\\)\\) y = \\!\\(\[ImaginaryI]\\/2\\) has no \
solution.\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.3974538970414963`*^9, 3.409125611366755*^9, 
  3.409812833735057*^9, 3.409822474639183*^9, 3.4098246934156513`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"Risch", "[", 
   RowBox[{
    RowBox[{"Sin", "[", 
     RowBox[{"Sin", "[", "x", "]"}], "]"}], ",", "x"}], "]"}],
  HoldForm]], "Output",
 CellChangeTimes->{3.397453897043985*^9, 3.4091256113706284`*^9, 
  3.409812833738428*^9, 3.4098224746433992`*^9, 3.4098246934197083`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cos", "[", "x", "]"}], "+", 
       RowBox[{"Sin", "[", "x", "]"}]}], ")"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       RowBox[{"Cos", "[", "x", "]"}], "-", 
       RowBox[{"Sin", "[", "x", "]"}]}], "]"}]}], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"bug", ":", " ", 
    RowBox[{
    "FIXED", " ", "after", " ", "changing", " ", "rischCoefficientList"}]}], 
   " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.396357793058426*^9, 3.396357843010746*^9}, {
  3.396777819234642*^9, 3.396777838842345*^9}}],

Cell[BoxData[
 RowBox[{"Cos", "[", 
  RowBox[{
   RowBox[{"Cos", "[", "x", "]"}], "-", 
   RowBox[{"Sin", "[", "x", "]"}]}], "]"}]], "Output",
 CellChangeTimes->{3.397453899901025*^9, 3.398851532367139*^9, 
  3.399381834264091*^9, 3.409125614494904*^9, 3.409812837625614*^9, 
  3.409822472031942*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"3", " ", 
      SuperscriptBox["x", "2"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"x", " ", 
        RowBox[{"Log", "[", "x", "]"}]}], "]"}]}], "-", 
     RowBox[{
      SuperscriptBox["x", "3"], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"x", " ", 
        RowBox[{"Log", "[", "x", "]"}]}], "]"}]}], "-", 
     RowBox[{
      SuperscriptBox["x", "3"], " ", 
      RowBox[{"Log", "[", "x", "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"x", " ", 
        RowBox[{"Log", "[", "x", "]"}]}], "]"}]}]}], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"bug", ",", " ", 
    RowBox[{"solution", ":", " ", 
     RowBox[{
      SuperscriptBox["x", "3"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"x", " ", 
        RowBox[{"Log", "[", "x", "]"}]}], "]"}]}]}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.396357877093342*^9, 3.396357918326799*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "2"], " ", 
   SuperscriptBox["x", 
    RowBox[{"3", "-", 
     RowBox[{"\[ImaginaryI]", " ", "x"}]}]]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   SuperscriptBox["x", 
    RowBox[{"3", "+", 
     RowBox[{"\[ImaginaryI]", " ", "x"}]}]]}]}]], "Output",
 CellChangeTimes->{3.397024245639669*^9, 3.397029497755989*^9, 
  3.397453903079398*^9, 3.398851535974801*^9, 3.3993818350103197`*^9, 
  3.4040327715666637`*^9, 3.409125617345286*^9, 3.409812839209651*^9, 
  3.409822468917461*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"E", "^", 
      RowBox[{"Sin", "[", "x", "]"}]}], "*", 
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{"2", "*", "x"}], "]"}], "/", "2"}]}], ",", "x"}], "]"}], "//", 
  "FullSimplify", 
  RowBox[{"(*", " ", 
   RowBox[{"bug", ",", " ", 
    RowBox[{
    "fixed", " ", "with", " ", "changes", " ", "to", " ", "OrderFunction"}]}],
    " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.3961694993870573`*^9, 3.3961695015848722`*^9}, {
  3.396169536907897*^9, 3.396169539928966*^9}, {3.3965886971274548`*^9, 
  3.3965887046221857`*^9}, {3.396777856212289*^9, 3.3967778731227913`*^9}, {
  3.3972764085769663`*^9, 3.3972764112468576`*^9}, {3.397563461286353*^9, 
  3.397563461766306*^9}, {3.409822448917115*^9, 3.40982245410876*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    RowBox[{"Sin", "[", "x", "]"}]}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Cosh", "[", 
     RowBox[{"Sin", "[", "x", "]"}], "]"}], "+", 
    RowBox[{"Sinh", "[", 
     RowBox[{"Sin", "[", "x", "]"}], "]"}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.409822445571332*^9, 3.409822454407922*^9}, 
   3.409888616336206*^9, 3.410057227846858*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Risch", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Exp", "[", "x", "]"}], " ", 
    RowBox[{"Cos", "[", 
     RowBox[{"Exp", "[", "x", "]"}], "]"}]}], ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.396780132484406*^9, 3.3967801394077873`*^9}, {
   3.3967802639218273`*^9, 3.3967802793289137`*^9}, 3.4098224426012173`*^9}],

Cell[BoxData[
 RowBox[{"Sin", "[", 
  SuperscriptBox["\[ExponentialE]", "x"], "]"}]], "Output",
 CellChangeTimes->{3.396780201101013*^9, 3.396780291575116*^9, 
  3.397024257669445*^9, 3.3974539078353157`*^9, 3.3988516141881247`*^9, 
  3.399381836276155*^9, 3.404032773366514*^9, 3.409125640340871*^9, 
  3.409822438015642*^9, 3.409888617060583*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    RowBox[{
     SuperscriptBox["x", "3"], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SuperscriptBox["x", "2"], "+", "1"}], "]"}]}], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"good", " ", "answer"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.396783502967339*^9, 3.396783567626903*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    FractionBox["1", "2"]}], " ", 
   SuperscriptBox["x", "2"], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"1", "+", 
     SuperscriptBox["x", "2"]}], "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"1", "+", 
     SuperscriptBox["x", "2"]}], "]"}]}]}]], "Output",
 CellChangeTimes->{{3.396783507907292*^9, 3.396783552143824*^9}, 
   3.39702425924175*^9, 3.3972766985404577`*^9, 3.397453908626593*^9, 
   3.397729581080468*^9, 3.398851615119162*^9, 3.399381836883895*^9, 
   3.404032774330336*^9, 3.409125641948986*^9, 3.409888617711878*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"Tan", "[", 
       RowBox[{"Tan", "[", "x", "]"}], "]"}], ",", "x"}], "]"}], ",", "x"}], 
   "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"GOOD", ":", " ", 
    RowBox[{
    "Interesting", " ", "to", " ", "see", " ", "the", " ", "constant", " ", 
     "of", " ", "integration", " ", "is", " ", "I"}]}], " ", 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.3965908339201403`*^9, 3.3965909543051853`*^9}, {
  3.396753349641663*^9, 3.3967533528772173`*^9}, {3.3967778792061253`*^9, 
  3.396777897600274*^9}, {3.3968173448089*^9, 3.3968173593422956`*^9}, {
  3.3975636346089*^9, 3.3975636364303637`*^9}}],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.3970242603245163`*^9, 3.397276701665147*^9, 
  3.397453910414157*^9, 3.3975636370408382`*^9, 3.3988516809163313`*^9, 
  3.399381837711684*^9, 3.4040327753569517`*^9, 3.4091256528642063`*^9, 
  3.409822435393998*^9, 3.40988860218506*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{
        SuperscriptBox["x", 
         RowBox[{
          RowBox[{"Exp", "[", "x", "]"}], 
          RowBox[{"Log", "[", "x", "]"}]}]], 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"Exp", "[", "x", "]"}], 
          RowBox[{"Log", "[", "x", "]"}]}], "]"}]}], ",", "x"}], "]"}], "//", 
     "Together"}], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"bug", ",", " ", 
    RowBox[{
    "fixed", " ", "with", " ", "changes", " ", "to", " ", 
     "RischExponentialPolynomial"}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.396442970892766*^9, 3.396442984929613*^9}, {
  3.39644302223372*^9, 3.396443061394218*^9}, {3.396443321929332*^9, 
  3.3964433239760237`*^9}, {3.396443403104257*^9, 3.396443403294943*^9}, {
  3.3964434392588873`*^9, 3.396443441249673*^9}, {3.3964434761224413`*^9, 
  3.396443480697774*^9}, {3.396443519496313*^9, 3.3964435701138477`*^9}, {
  3.3970236833770514`*^9, 3.397023702651256*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
   SuperscriptBox["x", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "\[ImaginaryI]"}], " ", 
      SuperscriptBox["\[ExponentialE]", "x"]}], "+", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", "x"], " ", 
      RowBox[{"Log", "[", "x", "]"}]}]}]]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
   SuperscriptBox["x", 
    RowBox[{
     RowBox[{"\[ImaginaryI]", " ", 
      SuperscriptBox["\[ExponentialE]", "x"]}], "+", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", "x"], " ", 
      RowBox[{"Log", "[", "x", "]"}]}]}]]}]}]], "Output",
 CellChangeTimes->{3.397276378837085*^9, 3.397276705576788*^9, 
  3.397453911350556*^9, 3.398851683218841*^9, 3.3993818383975067`*^9, 
  3.4040327812123404`*^9, 3.409125659083365*^9, 3.4098224254704857`*^9, 
  3.409888592608699*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"Cos", "[", "x", "]"}], "-", 
         SuperscriptBox["x", "12"]}], "]"}], " ", 
       RowBox[{"Log", "[", "x", "]"}]}], ",", "x"}], "]"}], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
     "Problems", " ", "solving", " ", "the", " ", "RDE", " ", "here"}], 
     "..."}], " ", "Fixed", " ", "with", " ", "changes", " ", "to", " ", 
    "RischExponentialPolynomial"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.396783633829907*^9, 3.396783646018957*^9}, {
  3.396784013596755*^9, 3.396784026108206*^9}, {3.396784879102165*^9, 
  3.39678488652614*^9}, {3.3970237075848923`*^9, 3.397023715806013*^9}, {
  3.3972763456431713`*^9, 3.397276371064694*^9}, {3.39756381572968*^9, 
  3.397563816071166*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Cos", "[", 
   RowBox[{
    SuperscriptBox["x", "12"], "-", 
    RowBox[{"Cos", "[", "x", "]"}]}], "]"}], " ", 
  RowBox[{"Log", "[", "x", "]"}]}]], "Output",
 CellChangeTimes->{3.397023569351365*^9, 3.397023716455574*^9, 
  3.397024268374609*^9, 3.397218943775221*^9, 3.397276347943555*^9, 
  3.397276379769876*^9, 3.397276712514221*^9, 3.397453912815781*^9, 
  3.39772475986788*^9, 3.3977295860354233`*^9, 3.398851694884501*^9, 
  3.399381839374421*^9, 3.4040327879053392`*^9, 3.4091256600049334`*^9, 
  3.409888590181676*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Sin", "[", "x", "]"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"Cos", "[", "x", "]"}], "]"}]}], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"bug", ":", " ", 
     RowBox[{
     "Fixed", " ", "with", " ", "changes", " ", "to", " ", "RischStructure", 
      " ", "the", " ", "fixed", " ", "problems", " ", "with", " ", 
      "integration", " ", "of", " ", "exponential", " ", "polynomials"}]}], 
    ",", " ", 
    RowBox[{
    "mainly", " ", "problems", " ", "in", " ", "rischCoefficientList"}]}], 
   " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.396446768712975*^9, 3.39644682365484*^9}, {
  3.396614396059539*^9, 3.396614403042369*^9}, {3.396616438413662*^9, 
  3.3966164409254227`*^9}, {3.396675051689777*^9, 3.396675054079687*^9}, {
  3.396698293763029*^9, 3.3966983114881077`*^9}, {3.396703582099657*^9, 
  3.396703588385089*^9}, {3.396703848761796*^9, 3.396703849685096*^9}, {
  3.396749357952421*^9, 3.396749360542842*^9}, {3.396750789370083*^9, 
  3.396750808270302*^9}, {3.396756634922893*^9, 3.39675668303354*^9}, {
  3.396777363728792*^9, 3.396777367172105*^9}, {3.3967775893458567`*^9, 
  3.396777591625849*^9}, {3.396777680042985*^9, 3.396777702265798*^9}, {
  3.3967779828497868`*^9, 3.396777993806507*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{"Sin", "[", 
   RowBox[{"Cos", "[", "x", "]"}], "]"}]}]], "Output",
 CellChangeTimes->{{3.409822410664937*^9, 3.409822411782518*^9}, 
   3.409888586812254*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", 
       SuperscriptBox[
        RowBox[{"Tan", "[", "x", "]"}], "2"]}], ")"}], " ", 
     RowBox[{"Log", "[", 
      RowBox[{"Tan", "[", "x", "]"}], "]"}]}], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"again", ",", " ", 
    RowBox[{
     RowBox[{
     "extensions", " ", "into", " ", "tangents", " ", "would", " ", "help", 
      " ", "here"}], "..."}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.3967796880041647`*^9, 3.396779804865397*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Power", "::", "\<\"infy\"\>"}], ":", 
  " ", "\<\"Infinite expression \\!\\(1\\/0\\) encountered. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/infy\\\", \
ButtonNote -> \\\"Power::infy\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.40982234864437*^9, 3.4099014336676826`*^9}],

Cell[BoxData["Indeterminate"], "Output",
 CellChangeTimes->{3.409822348647873*^9, 3.409901433671111*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Risch", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Sin", "[", 
     RowBox[{"3", "x"}], "]"}], 
    RowBox[{"Sin", "[", 
     RowBox[{"2", "x"}], "]"}]}], ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.396778687300496*^9, 3.396778695877202*^9}, {
  3.396778874935156*^9, 3.396778933681666*^9}, {3.396778970665104*^9, 
  3.3967789728308277`*^9}, {3.396779014057642*^9, 3.3967790467175198`*^9}, {
  3.397019320965157*^9, 3.397019321134149*^9}, {3.409822345105991*^9, 
  3.4098223452281923`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"Sin", "[", "x", "]"}], "2"], "-", 
  RowBox[{
   FractionBox["1", "10"], " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"5", " ", "x"}], "]"}]}]}]], "Output",
 CellChangeTimes->{{3.409822342051364*^9, 3.4098223456818523`*^9}, 
   3.4098224140944967`*^9, 3.409888578858613*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Tan", "[", "x", "]"}], " ", 
     RowBox[{"Tan", "[", 
      RowBox[{"x", "+", "1"}], "]"}]}], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "needs", " ", "better", " ", "simplification", " ", "back", " ", "to", 
     " ", "trigs"}], "..."}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.4093679738563223`*^9, 3.409367979502267*^9}, {
  3.409368039351253*^9, 3.409368042310389*^9}, {3.4098062926896353`*^9, 
  3.409806292835774*^9}, {3.4098113429180317`*^9, 3.409811354427099*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "x"}], "+", 
  RowBox[{
   RowBox[{"Cot", "[", "1", "]"}], " ", 
   RowBox[{"Log", "[", 
    RowBox[{"Cos", "[", "x", "]"}], "]"}]}], "-", 
  RowBox[{
   RowBox[{"Cot", "[", "1", "]"}], " ", 
   RowBox[{"Log", "[", 
    RowBox[{
     RowBox[{"Cos", "[", "2", "]"}], "+", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", "x"}], "]"}], "-", 
     RowBox[{"\[ImaginaryI]", " ", 
      RowBox[{"Sin", "[", "2", "]"}]}], "+", 
     RowBox[{"\[ImaginaryI]", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"2", " ", "x"}], "]"}]}]}], "]"}]}]}]], "Output",
 CellChangeTimes->{{3.409806296502626*^9, 3.409806312121429*^9}, 
   3.409806667782687*^9, 3.409807514920342*^9, 3.409811133972682*^9, 
   3.409811240750003*^9, {3.4098113351924686`*^9, 3.4098113616314487`*^9}, 
   3.409822340701934*^9, 3.40982241571426*^9, 3.409888574190365*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", "x"}], "]"}], 
     RowBox[{"Cos", "[", 
      RowBox[{"Sin", "[", "x", "]"}], "]"}]}], ",", "x"}], "]"}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.409020804640522*^9, 3.409020859864625*^9}, {
  3.40902097597095*^9, 3.409020978736516*^9}, {3.4090210198704367`*^9, 
  3.4090210200648003`*^9}, {3.4090438875826807`*^9, 3.409043890003543*^9}, {
  3.409044178803865*^9, 3.409044190827772*^9}, {3.409822290045035*^9, 
  3.409822292476301*^9}}],

Cell[BoxData[
 RowBox[{"2", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Cos", "[", 
     RowBox[{"Sin", "[", "x", "]"}], "]"}], "+", 
    RowBox[{
     RowBox[{"Sin", "[", "x", "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"Sin", "[", "x", "]"}], "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.4098222809038887`*^9, 3.4098222929720497`*^9}, 
   3.4098224167293253`*^9, {3.409888563806017*^9, 3.409888571591749*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Risch", "[", 
  RowBox[{
   RowBox[{"Cot", "[", "x", "]"}], ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.4098135048373423`*^9, 3.4098135088748293`*^9}, {
  3.409819291972292*^9, 3.409819307595696*^9}, {3.4098885683001747`*^9, 
  3.409888568658476*^9}}],

Cell[BoxData[
 RowBox[{"Log", "[", 
  RowBox[{"Sin", "[", "x", "]"}], "]"}]], "Output",
 CellChangeTimes->{
  3.409813518072338*^9, 3.4098135870827703`*^9, {3.409819278479516*^9, 
   3.409819307784028*^9}, 3.409822417773067*^9, {3.409888559221158*^9, 
   3.4098885692523127`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", "x"}], "]"}], 
     SuperscriptBox[
      RowBox[{"Sin", "[", 
       RowBox[{"Sin", "[", "x", "]"}], "]"}], "2"]}], ",", "x"}], "]"}], "//",
   "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.4098198601695347`*^9, 3.409819938636009*^9}, {
  3.409822298526682*^9, 3.409822314316477*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "4"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", "x"}], "]"}]}], "-", 
    RowBox[{"Cos", "[", 
     RowBox[{"2", " ", 
      RowBox[{"Sin", "[", "x", "]"}]}], "]"}], "-", 
    RowBox[{"2", " ", 
     RowBox[{"Sin", "[", "x", "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", 
       RowBox[{"Sin", "[", "x", "]"}]}], "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.409822314833404*^9, 3.409822419460655*^9, 
  3.4098885551812153`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    RowBox[{"1", "/", 
     RowBox[{"Tan", "[", 
      RowBox[{"a", " ", "x"}], "]"}]}], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"better", " ", 
    RowBox[{"solution", "!!"}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.4098229144023657`*^9, 3.4098229334228363`*^9}, {
  3.409823131662607*^9, 3.409823135444397*^9}, {3.4098232794692287`*^9, 
  3.4098232847325907`*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"Log", "[", 
   RowBox[{"Sin", "[", 
    RowBox[{"a", " ", "x"}], "]"}], "]"}], "a"]], "Output",
 CellChangeTimes->{{3.4098229175057487`*^9, 3.40982293398588*^9}, {
   3.409823120245393*^9, 3.409823135690557*^9}, 3.409823266475967*^9, 
   3.409823844465592*^9, 3.409823973425647*^9, 3.409824089734502*^9, 
   3.40982432302969*^9, 3.4098244932794447`*^9, 3.409824633292317*^9, 
   3.409888552843334*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    RowBox[{"Tan", "[", 
     RowBox[{"a", " ", "x"}], "]"}], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"better", " ", "solution"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.409822935906612*^9, 3.4098229399080753`*^9}, {
  3.4098231686367598`*^9, 3.4098231687482357`*^9}, {3.409823286932913*^9, 
  3.409823289956458*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"Log", "[", 
    RowBox[{"Cos", "[", 
     RowBox[{"a", " ", "x"}], "]"}], "]"}], "a"]}]], "Output",
 CellChangeTimes->{{3.4098229403245792`*^9, 3.409822969339129*^9}, 
   3.409823117180677*^9, 3.4098231692102947`*^9, 3.409823268998967*^9, 
   3.409823844816175*^9, 3.409823974659051*^9, 3.4098240879523706`*^9, 
   3.409824322017865*^9, 3.40982449374546*^9, 3.4098246345252533`*^9, 
   3.409888551113657*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"Sec", "[", 
      RowBox[{"a", " ", "x"}], "]"}], "3"], ",", "x"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"this", " ", 
    RowBox[{"better", "!"}]}], " ", "*)"}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.4098232922009993`*^9, 3.409823307996294*^9}, {
  3.4098238095268106`*^9, 3.4098238101180763`*^9}, {3.409824134591258*^9, 
  3.4098241440038977`*^9}, {3.409824187886641*^9, 3.409824198065879*^9}, {
  3.409824250637019*^9, 3.409824283484321*^9}, {3.409824328429327*^9, 
  3.409824405212471*^9}, {3.4098246761814632`*^9, 3.409824681084638*^9}, {
  3.409886321144902*^9, 3.409886330912571*^9}, {3.409886665308642*^9, 
  3.409886696433655*^9}, {3.4098867352589693`*^9, 3.409886735554407*^9}, {
  3.409888073656454*^9, 3.40988807742132*^9}, {3.409888141520314*^9, 
  3.4098881421732883`*^9}, {3.409888445430092*^9, 3.409888445954516*^9}, {
  3.409888523043907*^9, 3.409888526675041*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox[
    RowBox[{"Sec", "[", 
     RowBox[{"a", " ", "x"}], "]"}], "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Log", "[", 
      RowBox[{
       RowBox[{"Sec", "[", 
        RowBox[{"a", " ", "x"}], "]"}], "+", 
       RowBox[{"Tan", "[", 
        RowBox[{"a", " ", "x"}], "]"}]}], "]"}], "+", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", "a", " ", "x"}], "]"}], " ", 
      RowBox[{"Log", "[", 
       RowBox[{
        RowBox[{"Sec", "[", 
         RowBox[{"a", " ", "x"}], "]"}], "+", 
        RowBox[{"Tan", "[", 
         RowBox[{"a", " ", "x"}], "]"}]}], "]"}]}], "+", 
     RowBox[{"2", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"a", " ", "x"}], "]"}]}]}], ")"}]}], 
  RowBox[{"4", " ", "a"}]]], "Output",
 CellChangeTimes->{{3.409823297136094*^9, 3.409823309208119*^9}, {
   3.4098238060944433`*^9, 3.409823845059664*^9}, 3.409823876475569*^9, {
   3.409823915216651*^9, 3.409823917329126*^9}, {3.40982398236978*^9, 
   3.409824000461936*^9}, 3.40982404994875*^9, {3.409824090592531*^9, 
   3.409824144421378*^9}, {3.409824183645562*^9, 3.40982419823835*^9}, 
   3.409824252083441*^9, {3.409824284334094*^9, 3.409824310408216*^9}, {
   3.409824352445552*^9, 3.409824436920815*^9}, 3.409824490533433*^9, 
   3.409824635293486*^9, 3.409886077450725*^9, 3.40988617921316*^9, {
   3.409886317596242*^9, 3.409886331513382*^9}, {3.409886666339839*^9, 
   3.409886697062303*^9}, 3.409886737072514*^9, 3.409887896033395*^9, 
   3.409887946023988*^9, {3.409887992731957*^9, 3.4098880049465113`*^9}, 
   3.4098880426677017`*^9, {3.40988807480507*^9, 3.4098880780380087`*^9}, 
   3.40988814348204*^9, 3.409888446717452*^9, 3.4099014404194603`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Risch", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Cos", "[", "x", "]"}], " ", 
     SuperscriptBox["2", 
      RowBox[{"Sin", "[", "x", "]"}]]}], ",", "x"}], "]"}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.409892387433887*^9, 3.4098924126181803`*^9}}],

Cell[BoxData[
 FractionBox[
  SuperscriptBox["2", 
   RowBox[{"Sin", "[", "x", "]"}]], 
  RowBox[{"Log", "[", "2", "]"}]]], "Output",
 CellChangeTimes->{{3.409892400076898*^9, 3.409892413344255*^9}, 
   3.409901442015615*^9}]
}, Open  ]]
}, Closed]]
}, Closed]]
}, Open  ]]
},
AutoGeneratedPackage->None,
WindowSize->{1280, 980},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
ShowSelection->True,
Magnification->1.25,
FrontEndVersion->"9.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (January 25, \
2013)",
StyleDefinitions->"Default"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "Info3414092188-3301112"->{
  Cell[1109, 37, 308, 5, 51, "Print",
   CellTags->"Info3414092188-3301112"]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"Info3414092188-3301112", 1229780, 33124}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[567, 22, 176, 2, 114, "Title"],
Cell[746, 26, 173, 2, 36, "Subsubtitle"],
Cell[CellGroupData[{
Cell[944, 32, 162, 3, 35, "Input"],
Cell[1109, 37, 308, 5, 51, "Print",
 CellTags->"Info3414092188-3301112"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1454, 47, 897, 20, 42, "Input"],
Cell[2354, 69, 3766, 106, 110, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6157, 180, 1032, 28, 57, "Input"],
Cell[7192, 210, 290, 6, 28, "Message"],
Cell[7485, 218, 329, 6, 28, "Message"],
Cell[7817, 226, 968, 21, 42, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8822, 252, 423, 9, 59, "Input"],
Cell[9248, 263, 433, 8, 28, "Message"],
Cell[9684, 273, 603, 14, 53, "Output"]
}, Open  ]],
Cell[10302, 290, 465, 12, 57, "Input"],
Cell[CellGroupData[{
Cell[10792, 306, 440, 13, 63, "Input"],
Cell[11235, 321, 560, 18, 57, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11832, 344, 454, 13, 42, "Input"],
Cell[12289, 359, 812, 26, 57, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13138, 390, 272, 6, 35, "Input"],
Cell[13413, 398, 73, 1, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13523, 404, 155, 2, 100, "Section"],
Cell[13681, 408, 139, 1, 37, "Text"],
Cell[13823, 411, 1009, 19, 36, "Input",
 InitializationCell->True],
Cell[14835, 432, 1009, 19, 36, "Input",
 InitializationCell->True],
Cell[15847, 453, 764, 19, 36, "Input",
 InitializationCell->True],
Cell[16614, 474, 182, 4, 36, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[16821, 482, 179, 2, 54, "Subsection"],
Cell[17003, 486, 418, 9, 57, "Input",
 InitializationCell->True],
Cell[17424, 497, 426, 12, 57, "Input",
 InitializationCell->True],
Cell[17853, 511, 499, 15, 36, "Input",
 InitializationCell->True],
Cell[18355, 528, 9276, 175, 519, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[27668, 708, 104, 1, 43, "Subsection"],
Cell[27775, 711, 416, 9, 33, "Input",
 InitializationCell->True],
Cell[28194, 722, 436, 10, 33, "Input",
 InitializationCell->True],
Cell[28633, 734, 7644, 159, 680, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[36302, 897, 347, 10, 56, "Input"],
Cell[36652, 909, 2261, 77, 119, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[38962, 992, 121, 1, 43, "Subsection"],
Cell[39086, 995, 573, 18, 37, "Input",
 InitializationCell->True],
Cell[39662, 1015, 556, 17, 37, "Input",
 InitializationCell->True],
Cell[40221, 1034, 544, 16, 37, "Input",
 InitializationCell->True],
Cell[40768, 1052, 629, 18, 42, "Input",
 InitializationCell->True],
Cell[41400, 1072, 1038, 24, 141, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[42463, 1100, 351, 10, 62, "Input"],
Cell[42817, 1112, 74, 1, 35, "Output"]
}, Open  ]],
Cell[42906, 1116, 594, 14, 141, "Input",
 InitializationCell->True],
Cell[43503, 1132, 742, 18, 141, "Input",
 InitializationCell->True],
Cell[44248, 1152, 7132, 168, 478, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[51405, 1324, 344, 7, 37, "Input"],
Cell[51752, 1333, 196, 3, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[51985, 1341, 460, 15, 58, "Input"],
Cell[52448, 1358, 75, 1, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[52560, 1364, 620, 18, 63, "Input"],
Cell[53183, 1384, 73, 1, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[53293, 1390, 435, 10, 42, "Input"],
Cell[53731, 1402, 73, 1, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[53841, 1408, 492, 10, 58, "Input"],
Cell[54336, 1420, 74, 1, 35, "Output"]
}, Open  ]],
Cell[54425, 1424, 1759, 39, 246, "Input",
 InitializationCell->True],
Cell[56187, 1465, 237, 6, 58, "Input"],
Cell[56427, 1473, 1059, 26, 63, "Input",
 InitializationCell->True],
Cell[57489, 1501, 2446, 52, 288, "Input",
 InitializationCell->True],
Cell[59938, 1555, 270, 7, 62, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[60245, 1567, 114, 1, 43, "Subsection"],
Cell[60362, 1570, 4478, 97, 519, "Input",
 InitializationCell->True],
Cell[64843, 1669, 2294, 52, 267, "Input",
 InitializationCell->True],
Cell[67140, 1723, 1957, 57, 120, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[69122, 1784, 508, 13, 42, "Input"],
Cell[69633, 1799, 739, 16, 58, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[70409, 1820, 521, 9, 36, "Input"],
Cell[70933, 1831, 473, 9, 58, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[71443, 1845, 638, 13, 41, "Input"],
Cell[72084, 1860, 685, 17, 59, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[72806, 1882, 470, 11, 36, "Input"],
Cell[73279, 1895, 530, 11, 36, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[73858, 1912, 200, 2, 43, "Subsection"],
Cell[74061, 1916, 1058, 24, 129, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[75156, 1945, 122, 1, 43, "Subsection"],
Cell[75281, 1948, 766, 19, 110, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[76084, 1972, 102, 1, 43, "Subsection"],
Cell[76189, 1975, 6002, 141, 319, "Input",
 InitializationCell->True],
Cell[82194, 2118, 4523, 100, 222, "Input",
 InitializationCell->True],
Cell[86720, 2220, 218, 5, 33, "Input"],
Cell[86941, 2227, 421, 11, 57, "Input"],
Cell[87365, 2240, 456, 10, 58, "Input"],
Cell[87824, 2252, 282, 8, 40, "Input"],
Cell[88109, 2262, 9241, 220, 433, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[97375, 2486, 333, 10, 33, "Input"],
Cell[97711, 2498, 363, 9, 33, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[98123, 2513, 115, 1, 43, "Subsection"],
Cell[98241, 2516, 1734, 52, 58, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[100000, 2572, 175, 4, 35, "Input"],
Cell[100178, 2578, 160, 5, 58, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[100375, 2588, 245, 7, 36, "Input"],
Cell[100623, 2597, 306, 11, 61, "Output"]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[100990, 2615, 154, 2, 100, "Section"],
Cell[CellGroupData[{
Cell[101169, 2621, 37, 0, 42, "Subsection"],
Cell[101209, 2623, 4111, 104, 447, "Input",
 InitializationCell->True],
Cell[105323, 2729, 24, 0, 32, "Text"],
Cell[105350, 2731, 335, 10, 42, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[105722, 2746, 112, 1, 31, "Subsection"],
Cell[105837, 2749, 529, 16, 42, "Input"],
Cell[106369, 2767, 795, 23, 60, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[107189, 2794, 277, 8, 42, "Input"],
Cell[107469, 2804, 145, 2, 33, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[107663, 2812, 200, 3, 31, "Subsection"],
Cell[107866, 2817, 2461, 49, 72, "Input",
 InitializationCell->True],
Cell[110330, 2868, 2610, 52, 72, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[112965, 2924, 358, 9, 42, "Input"],
Cell[113326, 2935, 176, 4, 41, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[113539, 2944, 634, 16, 56, "Input"],
Cell[114176, 2962, 269, 7, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[114482, 2974, 481, 11, 42, "Input"],
Cell[114966, 2987, 203, 5, 38, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[115206, 2997, 287, 7, 33, "Input"],
Cell[115496, 3006, 176, 4, 33, "Output"]
}, Open  ]],
Cell[115687, 3013, 659, 14, 33, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[116371, 3031, 748, 21, 62, "Input"],
Cell[117122, 3054, 373, 13, 59, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[117532, 3072, 426, 11, 42, "Input"],
Cell[117961, 3085, 152, 4, 41, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[118162, 3095, 101, 1, 31, "Subsection"],
Cell[118266, 3098, 900, 22, 33, "Input",
 InitializationCell->True],
Cell[119169, 3122, 1042, 25, 167, "Input",
 InitializationCell->True],
Cell[120214, 3149, 312, 8, 41, "Input"],
Cell[120529, 3159, 315, 9, 33, "Input"],
Cell[120847, 3170, 334, 9, 33, "Input"],
Cell[121184, 3181, 210, 5, 33, "Input"],
Cell[121397, 3188, 194, 4, 33, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[121628, 3197, 116, 1, 31, "Subsection"],
Cell[121747, 3200, 2968, 74, 262, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[124752, 3279, 160, 2, 31, "Subsection"],
Cell[124915, 3283, 56, 0, 32, "Text"],
Cell[124974, 3285, 906, 34, 39, "Text"],
Cell[125883, 3321, 6920, 156, 547, "Input",
 InitializationCell->True],
Cell[132806, 3479, 6530, 145, 614, "Input"],
Cell[CellGroupData[{
Cell[139361, 3628, 313, 10, 42, "Input"],
Cell[139677, 3640, 520, 12, 47, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[140234, 3657, 589, 18, 42, "Input"],
Cell[140826, 3677, 480, 13, 47, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[141343, 3695, 226, 5, 42, "Input"],
Cell[141572, 3702, 328, 7, 42, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[141949, 3715, 34, 0, 31, "Subsection"],
Cell[141986, 3717, 56, 0, 32, "Text"],
Cell[142045, 3719, 1002, 41, 32, "Text"],
Cell[143050, 3762, 12290, 311, 818, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[155365, 4077, 74, 1, 31, "Subsubsection"],
Cell[CellGroupData[{
Cell[155464, 4082, 198, 6, 42, "Input"],
Cell[155665, 4090, 849, 17, 42, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[156551, 4112, 195, 6, 42, "Input"],
Cell[156749, 4120, 117, 2, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[156903, 4127, 335, 11, 42, "Input"],
Cell[157241, 4140, 1170, 36, 42, "Output"]
}, Open  ]],
Cell[158426, 4179, 62, 0, 32, "Text"],
Cell[158491, 4181, 1154, 40, 73, "Input"],
Cell[CellGroupData[{
Cell[159670, 4225, 643, 14, 33, "Input"],
Cell[160316, 4241, 292, 4, 33, "Output"]
}, Open  ]],
Cell[160623, 4248, 1407, 45, 53, "Input"],
Cell[CellGroupData[{
Cell[162055, 4297, 448, 12, 33, "Input"],
Cell[162506, 4311, 113, 1, 33, "Output"]
}, Open  ]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[162680, 4319, 103, 1, 31, "Subsection"],
Cell[162786, 4322, 699, 19, 91, "Input",
 InitializationCell->True],
Cell[163488, 4343, 727, 21, 91, "Input",
 InitializationCell->True],
Cell[164218, 4366, 466, 11, 33, "Input",
 InitializationCell->True],
Cell[164687, 4379, 7140, 152, 528, "Input",
 InitializationCell->True],
Cell[171830, 4533, 709, 19, 33, "Input",
 InitializationCell->True],
Cell[172542, 4554, 1217, 26, 53, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[173784, 4584, 1046, 29, 58, "Input"],
Cell[174833, 4615, 401, 11, 56, "Output"]
}, Open  ]],
Cell[175249, 4629, 1091, 35, 42, "Input"],
Cell[CellGroupData[{
Cell[176365, 4668, 518, 16, 55, "Input"],
Cell[176886, 4686, 2784, 100, 81, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[179707, 4791, 812, 18, 33, "Input"],
Cell[180522, 4811, 228, 7, 52, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[180799, 4824, 110, 1, 31, "Subsection"],
Cell[180912, 4827, 4189, 97, 243, "Input",
 InitializationCell->True],
Cell[185104, 4926, 1091, 35, 42, "Input"],
Cell[186198, 4963, 361, 12, 55, "Input"],
Cell[CellGroupData[{
Cell[186584, 4979, 798, 20, 55, "Input"],
Cell[187385, 5001, 791, 25, 53, "Output"]
}, Open  ]],
Cell[188191, 5029, 1054, 32, 55, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[189282, 5066, 167, 2, 31, "Subsection"],
Cell[189452, 5070, 5776, 132, 281, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[195253, 5206, 413, 11, 33, "Input"],
Cell[195669, 5219, 337, 9, 33, "Output"]
}, Open  ]],
Cell[196021, 5231, 1091, 35, 42, "Input"],
Cell[197115, 5268, 385, 12, 55, "Input"],
Cell[CellGroupData[{
Cell[197525, 5284, 545, 16, 55, "Input"],
Cell[198073, 5302, 700, 24, 53, "Output"]
}, Open  ]],
Cell[198788, 5329, 1047, 35, 62, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[199872, 5369, 111, 1, 31, "Subsection"],
Cell[199986, 5372, 6225, 124, 281, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[206236, 5500, 570, 16, 65, "Input"],
Cell[206809, 5518, 277, 7, 63, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[207123, 5530, 1072, 30, 68, "Input"],
Cell[208198, 5562, 803, 22, 66, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[209038, 5589, 1482, 41, 65, "Input"],
Cell[210523, 5632, 503, 15, 58, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[211063, 5652, 1036, 30, 58, "Input"],
Cell[212102, 5684, 648, 20, 59, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[212787, 5709, 709, 17, 57, "Input"],
Cell[213499, 5728, 268, 8, 55, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[213804, 5741, 891, 20, 63, "Input"],
Cell[214698, 5763, 338, 10, 61, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[215073, 5778, 1010, 25, 68, "Input"],
Cell[216086, 5805, 433, 13, 66, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[216556, 5823, 721, 20, 63, "Input"],
Cell[217280, 5845, 450, 14, 61, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[217779, 5865, 96, 1, 31, "Subsection"],
Cell[217878, 5868, 2114, 50, 205, "Input",
 InitializationCell->True],
Cell[219995, 5920, 737, 24, 105, "Input"],
Cell[220735, 5946, 343, 7, 33, "Input"],
Cell[221081, 5955, 293, 9, 42, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[221411, 5969, 105, 1, 31, "Subsection"],
Cell[221519, 5972, 2001, 51, 224, "Input",
 InitializationCell->True],
Cell[223523, 6025, 428, 12, 59, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[223988, 6042, 112, 1, 31, "Subsection"],
Cell[224103, 6045, 984, 37, 81, "Input",
 InitializationCell->True],
Cell[225090, 6084, 3702, 86, 284, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[228829, 6175, 102, 1, 31, "Subsection"],
Cell[228934, 6178, 226, 5, 33, "Input",
 InitializationCell->True],
Cell[229163, 6185, 3540, 86, 348, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[232728, 6275, 454, 12, 67, "Input"],
Cell[233185, 6289, 327, 5, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[233549, 6299, 312, 7, 42, "Input"],
Cell[233864, 6308, 193, 3, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[234094, 6316, 449, 12, 64, "Input"],
Cell[234546, 6330, 236, 5, 33, "Output"]
}, Open  ]],
Cell[234797, 6338, 126, 2, 33, "Input"],
Cell[CellGroupData[{
Cell[234948, 6344, 366, 9, 57, "Input"],
Cell[235317, 6355, 169, 3, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[235523, 6363, 681, 20, 57, "Input"],
Cell[236207, 6385, 145, 3, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[236389, 6393, 410, 11, 42, "Input"],
Cell[236802, 6406, 147, 3, 33, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[236998, 6415, 102, 1, 31, "Subsection"],
Cell[237103, 6418, 8685, 210, 547, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[245813, 6632, 685, 19, 79, "Input"],
Cell[246501, 6653, 413, 10, 68, "Output"]
}, Open  ]],
Cell[246929, 6666, 5762, 137, 496, "Input",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[252740, 6809, 123, 1, 62, "Section"],
Cell[CellGroupData[{
Cell[252888, 6814, 122, 1, 42, "Subsection"],
Cell[253013, 6817, 1320, 28, 501, "Text"],
Cell[254336, 6847, 6469, 147, 528, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[260830, 6998, 527, 16, 60, "Input"],
Cell[261360, 7016, 396, 10, 59, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[261793, 7031, 1548, 30, 57, "Input"],
Cell[263344, 7063, 357, 8, 51, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[263750, 7077, 174, 2, 31, "Subsection"],
Cell[263927, 7081, 14473, 275, 585, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[278425, 7360, 493, 15, 60, "Input"],
Cell[278921, 7377, 441, 13, 58, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[279399, 7395, 99, 1, 31, "Subsubsection"],
Cell[CellGroupData[{
Cell[279523, 7400, 1500, 30, 57, "Input"],
Cell[281026, 7432, 188, 6, 51, "Output"]
}, Open  ]],
Cell[281229, 7441, 825, 21, 70, "Input"],
Cell[CellGroupData[{
Cell[282079, 7466, 907, 24, 67, "Input"],
Cell[282989, 7492, 310, 10, 62, "Output"]
}, Open  ]],
Cell[283314, 7505, 373, 12, 55, "Input"],
Cell[283690, 7519, 746, 21, 68, "Input"],
Cell[284439, 7542, 395, 12, 55, "Input"],
Cell[284837, 7556, 762, 21, 68, "Input"],
Cell[285602, 7579, 662, 20, 70, "Input"],
Cell[286267, 7601, 537, 12, 33, "Input"],
Cell[286807, 7615, 477, 15, 61, "Input"],
Cell[287287, 7632, 362, 9, 33, "Input"],
Cell[287652, 7643, 463, 15, 68, "Input"],
Cell[288118, 7660, 1206, 35, 67, "Input"],
Cell[289327, 7697, 794, 26, 70, "Input"],
Cell[290124, 7725, 1544, 47, 73, "Input"],
Cell[291671, 7774, 1160, 29, 68, "Input"],
Cell[292834, 7805, 518, 14, 60, "Input"],
Cell[293355, 7821, 330, 10, 33, "Input"],
Cell[293688, 7833, 984, 28, 61, "Input"],
Cell[294675, 7863, 699, 18, 58, "Input"],
Cell[295377, 7883, 451, 12, 33, "Input"],
Cell[295831, 7897, 1283, 40, 63, "Input"],
Cell[297117, 7939, 385, 10, 33, "Input"],
Cell[297505, 7951, 845, 23, 55, "Input"],
Cell[298353, 7976, 1334, 39, 83, "Input"],
Cell[299690, 8017, 661, 16, 42, "Input"],
Cell[300354, 8035, 663, 18, 33, "Input"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[301066, 8059, 107, 1, 31, "Subsection"],
Cell[301176, 8062, 3672, 88, 237, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[304873, 8154, 830, 22, 42, "Input"],
Cell[305706, 8178, 200, 6, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[305943, 8189, 687, 18, 42, "Input"],
Cell[306633, 8209, 321, 10, 57, "Output"]
}, Open  ]],
Cell[306969, 8222, 468, 13, 42, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[307474, 8240, 195, 2, 31, "Subsection"],
Cell[307672, 8244, 1110, 29, 129, "Input",
 InitializationCell->True],
Cell[308785, 8275, 800, 18, 53, "Input",
 InitializationCell->True],
Cell[309588, 8295, 402, 9, 33, "Input",
 InitializationCell->True],
Cell[309993, 8306, 46568, 859, 2019, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[356586, 9169, 657, 19, 55, "Input"],
Cell[357246, 9190, 468, 12, 38, "Output"]
}, Open  ]],
Cell[357729, 9205, 2873, 67, 186, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[360627, 9276, 349, 10, 33, "Input"],
Cell[360979, 9288, 658, 18, 56, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[361674, 9311, 431, 11, 57, "Input"],
Cell[362108, 9324, 726, 18, 55, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[362883, 9348, 123, 1, 31, "Subsection"],
Cell[363009, 9351, 10249, 227, 813, "Input",
 InitializationCell->True],
Cell[373261, 9580, 3874, 98, 281, "Input",
 InitializationCell->True],
Cell[377138, 9680, 302, 8, 42, "Input"],
Cell[377443, 9690, 872, 27, 53, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[378340, 9721, 395, 10, 42, "Input"],
Cell[378738, 9733, 193, 3, 33, "Output"]
}, Open  ]],
Cell[378946, 9739, 14122, 278, 927, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[393093, 10021, 575, 16, 60, "Input"],
Cell[393671, 10039, 811, 23, 68, "Output"]
}, Open  ]],
Cell[394497, 10065, 1455, 36, 148, "Input",
 InitializationCell->True],
Cell[395955, 10103, 5926, 144, 471, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[401906, 10251, 3404, 88, 145, "Input"],
Cell[405313, 10341, 850, 20, 41, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[406200, 10366, 1016, 29, 100, "Input"],
Cell[407219, 10397, 561, 12, 68, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[407817, 10414, 588, 16, 55, "Input"],
Cell[408408, 10432, 829, 13, 54, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[409274, 10450, 516, 15, 56, "Input"],
Cell[409793, 10467, 844, 17, 54, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[410674, 10489, 576, 15, 33, "Input"],
Cell[411253, 10506, 1656, 48, 80, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[412946, 10559, 97, 1, 31, "Subsubsection"],
Cell[413046, 10562, 910, 24, 60, "Input"],
Cell[413959, 10588, 989, 29, 62, "Input"],
Cell[414951, 10619, 1371, 37, 65, "Input"],
Cell[416325, 10658, 512, 14, 57, "Input"],
Cell[416840, 10674, 975, 28, 60, "Input"],
Cell[417818, 10704, 227, 5, 32, "Input"],
Cell[418048, 10711, 421, 13, 41, "Input"],
Cell[418472, 10726, 1642, 50, 65, "Input"],
Cell[420117, 10778, 2002, 62, 156, "Input"],
Cell[422122, 10842, 1212, 33, 110, "Input"],
Cell[423337, 10877, 869, 23, 123, "Input"],
Cell[424209, 10902, 1236, 26, 57, "Input"],
Cell[425448, 10930, 1063, 23, 32, "Input"],
Cell[426514, 10955, 868, 25, 76, "Input"],
Cell[427385, 10982, 758, 21, 46, "Input"],
Cell[428146, 11005, 1226, 36, 52, "Input"],
Cell[429375, 11043, 509, 15, 62, "Input"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[429933, 11064, 126, 1, 31, "Subsection"],
Cell[430062, 11067, 355, 8, 53, "Input",
 InitializationCell->True],
Cell[430420, 11077, 308, 8, 33, "Input"],
Cell[430731, 11087, 6004, 137, 357, "Input",
 InitializationCell->True],
Cell[436738, 11226, 3646, 86, 262, "Input",
 InitializationCell->True],
Cell[440387, 11314, 241, 6, 33, "Input",
 InitializationCell->True],
Cell[440631, 11322, 5167, 122, 395, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[445823, 11448, 1293, 38, 78, "Input"],
Cell[447119, 11488, 312, 7, 56, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[447468, 11500, 842, 24, 55, "Input"],
Cell[448313, 11526, 1288, 33, 42, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[449638, 11564, 562, 16, 55, "Input"],
Cell[450203, 11582, 943, 24, 42, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[451183, 11611, 505, 14, 33, "Input"],
Cell[451691, 11627, 599, 12, 57, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[452327, 11644, 573, 15, 33, "Input"],
Cell[452903, 11661, 574, 16, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[453514, 11682, 905, 27, 79, "Input"],
Cell[454422, 11711, 530, 14, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[454989, 11730, 504, 14, 55, "Input"],
Cell[455496, 11746, 1235, 25, 42, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[456768, 11776, 2211, 45, 57, "Input"],
Cell[458982, 11823, 1064, 27, 42, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[460083, 11855, 790, 22, 60, "Input"],
Cell[460876, 11879, 821, 20, 33, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[461746, 11905, 128, 1, 31, "Subsection"],
Cell[461877, 11908, 14234, 287, 794, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[476136, 12199, 1300, 34, 114, "Input"],
Cell[477439, 12235, 234, 6, 55, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[477710, 12246, 832, 25, 57, "Input"],
Cell[478545, 12273, 359, 8, 55, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[478941, 12286, 1140, 33, 88, "Input"],
Cell[480084, 12321, 669, 15, 57, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[480790, 12341, 1983, 55, 112, "Input"],
Cell[482776, 12398, 353, 10, 56, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[483166, 12413, 1333, 42, 97, "Input"],
Cell[484502, 12457, 1313, 31, 65, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[485852, 12493, 562, 14, 33, "Input"],
Cell[486417, 12509, 265, 4, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[486719, 12518, 617, 17, 59, "Input"],
Cell[487339, 12537, 418, 8, 58, "Output"]
}, Open  ]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[487818, 12552, 115, 1, 62, "Section"],
Cell[CellGroupData[{
Cell[487958, 12557, 102, 1, 54, "Subsection"],
Cell[488063, 12560, 607, 12, 33, "Input",
 InitializationCell->True],
Cell[488673, 12574, 18076, 365, 1374, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[506774, 12943, 948, 29, 62, "Input"],
Cell[507725, 12974, 242, 7, 56, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[508004, 12986, 1126, 30, 68, "Input"],
Cell[509133, 13018, 439, 9, 55, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[509609, 13032, 754, 19, 57, "Input"],
Cell[510366, 13053, 291, 8, 58, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[510694, 13066, 1309, 31, 78, "Input"],
Cell[512006, 13099, 711, 18, 57, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[512766, 13123, 153, 2, 43, "Subsection"],
Cell[512922, 13127, 5701, 135, 357, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[518648, 13266, 312, 8, 55, "Input"],
Cell[518963, 13276, 462, 8, 37, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[519474, 13290, 56, 0, 43, "Subsection"],
Cell[519533, 13292, 7125, 158, 496, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[526683, 13454, 544, 12, 33, "Input"],
Cell[527230, 13468, 76, 1, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[527343, 13474, 774, 20, 42, "Input"],
Cell[528120, 13496, 325, 11, 42, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[528482, 13512, 797, 24, 67, "Input"],
Cell[529282, 13538, 564, 16, 65, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[529895, 13560, 352, 4, 43, "Subsection"],
Cell[530250, 13566, 4951, 110, 490, "Input",
 InitializationCell->True],
Cell[535204, 13678, 451, 14, 42, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[535692, 13697, 241, 3, 43, "Subsection"],
Cell[535936, 13702, 13995, 295, 1136, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[549956, 14001, 683, 19, 42, "Input"],
Cell[550642, 14022, 70, 1, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[550749, 14028, 917, 26, 76, "Input"],
Cell[551669, 14056, 138, 3, 33, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[551856, 14065, 189, 2, 43, "Subsection"],
Cell[552048, 14069, 10480, 249, 984, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[562553, 14322, 982, 29, 67, "Input"],
Cell[563538, 14353, 1158, 24, 42, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[564733, 14382, 1487, 45, 66, "Input"],
Cell[566223, 14429, 839, 23, 68, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[567099, 14457, 1200, 36, 42, "Input"],
Cell[568302, 14495, 803, 24, 42, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[569142, 14524, 890, 27, 58, "Input"],
Cell[570035, 14553, 620, 18, 42, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[570692, 14576, 1275, 36, 66, "Input"],
Cell[571970, 14614, 859, 24, 42, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[572878, 14644, 138, 1, 43, "Subsection"],
Cell[573019, 14647, 20593, 417, 1309, "Input",
 InitializationCell->True],
Cell[593615, 15066, 1778, 48, 86, "Input"],
Cell[CellGroupData[{
Cell[595418, 15118, 530, 16, 55, "Input"],
Cell[595951, 15136, 357, 6, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[596345, 15147, 1059, 32, 42, "Input"],
Cell[597407, 15181, 533, 8, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[597977, 15194, 691, 21, 55, "Input"],
Cell[598671, 15217, 386, 5, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[599094, 15227, 973, 29, 67, "Input"],
Cell[600070, 15258, 372, 6, 32, "Output"]
}, Closed]],
Cell[CellGroupData[{
Cell[600479, 15269, 1191, 37, 49, "Input"],
Cell[601673, 15308, 234, 6, 32, "Output"]
}, Closed]],
Cell[601922, 15317, 1141, 29, 34, "Input"],
Cell[CellGroupData[{
Cell[603088, 15350, 380, 9, 33, "Input"],
Cell[603471, 15361, 110, 3, 32, "Output"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[603630, 15370, 127, 1, 43, "Subsection"],
Cell[603760, 15373, 8650, 218, 824, "Input",
 InitializationCell->True],
Cell[612413, 15593, 595, 18, 42, "Input"],
Cell[CellGroupData[{
Cell[613033, 15615, 680, 18, 61, "Input"],
Cell[613716, 15635, 676, 15, 56, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[614429, 15655, 517, 13, 33, "Input"],
Cell[614949, 15670, 613, 13, 54, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[615599, 15688, 352, 10, 42, "Input"],
Cell[615954, 15700, 712, 13, 38, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[616703, 15718, 1716, 46, 42, "Input"],
Cell[618422, 15766, 209, 4, 38, "Output"]
}, Open  ]],
Cell[618646, 15773, 287, 6, 33, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[618970, 15784, 177, 2, 43, "Subsection"],
Cell[619150, 15788, 2041, 45, 205, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[621228, 15838, 262, 3, 43, "Subsection"],
Cell[621493, 15843, 9966, 244, 832, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[631496, 16092, 169, 2, 43, "Subsection"],
Cell[631668, 16096, 13909, 296, 1202, "Input",
 InitializationCell->True],
Cell[645580, 16394, 1624, 45, 133, "Input"],
Cell[CellGroupData[{
Cell[647229, 16443, 754, 20, 42, "Input"],
Cell[647986, 16465, 1329, 22, 57, "Output"]
}, Open  ]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[649376, 16494, 301, 4, 62, "Section"],
Cell[CellGroupData[{
Cell[649702, 16502, 715, 20, 57, "Input"],
Cell[650420, 16524, 1960, 52, 67, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[652417, 16581, 2071, 60, 100, "Input"],
Cell[654491, 16643, 2539, 66, 117, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[657067, 16714, 810, 20, 35, "Input"],
Cell[657880, 16736, 2492, 65, 161, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[660409, 16806, 375, 10, 42, "Input"],
Cell[660787, 16818, 820, 19, 55, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[661644, 16842, 920, 27, 63, "Input"],
Cell[662567, 16871, 259, 7, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[662863, 16883, 149, 2, 54, "Subsection"],
Cell[663015, 16887, 4932, 111, 319, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[667972, 17002, 519, 13, 56, "Input"],
Cell[668494, 17017, 829, 20, 59, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[669360, 17042, 627, 16, 56, "Input"],
Cell[669990, 17060, 742, 21, 59, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[670769, 17086, 844, 23, 57, "Input"],
Cell[671616, 17111, 2540, 71, 118, "Output"]
}, Open  ]],
Cell[674171, 17185, 493, 15, 42, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[674689, 17204, 312, 9, 33, "Input"],
Cell[675004, 17215, 362, 10, 38, "Output"]
}, Open  ]],
Cell[675381, 17228, 1092, 29, 53, "Input",
 InitializationCell->True],
Cell[676476, 17259, 542, 16, 33, "Input",
 InitializationCell->True],
Cell[677021, 17277, 2024, 49, 223, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[679070, 17330, 534, 15, 33, "Input"],
Cell[679607, 17347, 74, 1, 33, "Output"]
}, Open  ]],
Cell[679696, 17351, 2008, 48, 243, "Input",
 InitializationCell->True],
Cell[681707, 17401, 3568, 78, 281, "Input",
 InitializationCell->True],
Cell[685278, 17481, 1288, 38, 63, "Input"],
Cell[686569, 17521, 1065, 32, 59, "Input"],
Cell[687637, 17555, 1205, 35, 59, "Input"],
Cell[688845, 17592, 534, 16, 33, "Input"],
Cell[689382, 17610, 586, 17, 33, "Input",
 InitializationCell->True],
Cell[689971, 17629, 311, 7, 33, "Input",
 InitializationCell->True],
Cell[690285, 17638, 3664, 92, 148, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[693974, 17734, 427, 13, 55, "Input"],
Cell[694404, 17749, 234, 6, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[694675, 17760, 406, 11, 33, "Input"],
Cell[695084, 17773, 633, 13, 38, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[695754, 17791, 236, 6, 33, "Input"],
Cell[695993, 17799, 185, 4, 56, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[696215, 17808, 1923, 56, 71, "Input"],
Cell[698141, 17866, 1529, 48, 73, "Output"]
}, Open  ]],
Cell[699685, 17917, 987, 28, 53, "Input",
 InitializationCell->True],
Cell[700675, 17947, 1609, 42, 110, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[702309, 17993, 473, 12, 59, "Input"],
Cell[702785, 18007, 332, 7, 33, "Output"]
}, Open  ]],
Cell[703132, 18017, 785, 22, 33, "Input",
 InitializationCell->True],
Cell[703920, 18041, 1606, 36, 129, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[705551, 18081, 885, 24, 33, "Input"],
Cell[706439, 18107, 367, 10, 56, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[706843, 18122, 1609, 44, 68, "Input"],
Cell[708455, 18168, 657, 19, 59, "Output"]
}, Open  ]],
Cell[709127, 18190, 1404, 37, 148, "Input",
 InitializationCell->True],
Cell[710534, 18229, 398, 12, 33, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[710957, 18245, 409, 10, 33, "Input"],
Cell[711369, 18257, 195, 3, 33, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[711613, 18266, 102, 1, 43, "Subsection"],
Cell[711718, 18269, 18369, 349, 756, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[730112, 18622, 457, 13, 56, "Input"],
Cell[730572, 18637, 796, 24, 58, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[731405, 18666, 212, 5, 33, "Input"],
Cell[731620, 18673, 736, 16, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[732393, 18694, 976, 24, 59, "Input"],
Cell[733372, 18720, 1730, 52, 99, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[735139, 18777, 553, 16, 62, "Input"],
Cell[735695, 18795, 1262, 33, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[736994, 18833, 284, 6, 54, "Input"],
Cell[737281, 18841, 613, 15, 53, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[737943, 18862, 109, 1, 43, "Subsection"],
Cell[738055, 18865, 10114, 212, 908, "Input",
 InitializationCell->True],
Cell[748172, 19079, 145, 3, 33, "Input"],
Cell[CellGroupData[{
Cell[748342, 19086, 643, 16, 62, "Input"],
Cell[748988, 19104, 1105, 29, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[750130, 19138, 675, 16, 42, "Input"],
Cell[750808, 19156, 1135, 31, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[751980, 19192, 749, 19, 64, "Input"],
Cell[752732, 19213, 739, 20, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[753508, 19238, 320, 7, 54, "Input"],
Cell[753831, 19247, 346, 11, 53, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[754226, 19264, 122, 1, 43, "Subsection"],
Cell[754351, 19267, 2449, 54, 262, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[756825, 19325, 341, 8, 33, "Input"],
Cell[757169, 19335, 348, 9, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[757554, 19349, 673, 17, 53, "Input"],
Cell[758230, 19368, 711, 21, 33, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[758990, 19395, 152, 2, 43, "Subsection"],
Cell[759145, 19399, 789, 22, 53, "Input",
 InitializationCell->True],
Cell[759937, 19423, 965, 24, 53, "Input",
 InitializationCell->True],
Cell[760905, 19449, 833, 22, 33, "Input",
 InitializationCell->True],
Cell[761741, 19473, 9736, 213, 604, "Input",
 InitializationCell->True],
Cell[771480, 19688, 1086, 31, 55, "Input"],
Cell[772569, 19721, 369, 10, 55, "Input"],
Cell[772941, 19733, 334, 7, 33, "Input"],
Cell[773278, 19742, 706, 21, 33, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[774021, 19768, 106, 1, 43, "Subsection"],
Cell[774130, 19771, 13320, 276, 794, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[787475, 20051, 766, 22, 91, "Input"],
Cell[788244, 20075, 1357, 33, 56, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[789638, 20113, 1970, 44, 124, "Input"],
Cell[791611, 20159, 2281, 53, 88, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[793929, 20217, 1237, 33, 66, "Input"],
Cell[795169, 20252, 1377, 37, 56, "Output"]
}, Open  ]],
Cell[796561, 20292, 2905, 74, 205, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[799491, 20370, 1120, 31, 58, "Input"],
Cell[800614, 20403, 618, 17, 57, "Output"]
}, Open  ]],
Cell[801247, 20423, 3207, 78, 262, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[804491, 20506, 105, 1, 43, "Subsection"],
Cell[804599, 20509, 3844, 90, 414, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[808468, 20603, 304, 8, 57, "Input"],
Cell[808775, 20613, 189, 4, 54, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[809001, 20622, 1204, 32, 83, "Input"],
Cell[810208, 20656, 201, 3, 33, "Output"]
}, Open  ]],
Cell[810424, 20662, 6898, 150, 547, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[817347, 20816, 1996, 57, 110, "Input"],
Cell[819346, 20875, 148, 2, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[819531, 20882, 567, 13, 56, "Input"],
Cell[820101, 20897, 100, 1, 33, "Output"]
}, Open  ]],
Cell[820216, 20901, 3675, 80, 262, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[823916, 20985, 1258, 32, 53, "Input"],
Cell[825177, 21019, 707, 10, 33, "Output"]
}, Open  ]],
Cell[825899, 21032, 3698, 79, 243, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[829634, 21116, 136, 2, 43, "Subsection"],
Cell[829773, 21120, 8968, 212, 737, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[838766, 21336, 514, 15, 33, "Input"],
Cell[839283, 21353, 627, 17, 41, "Output"]
}, Open  ]],
Cell[839925, 21373, 997, 22, 75, "Input"],
Cell[CellGroupData[{
Cell[840947, 21399, 775, 22, 53, "Input"],
Cell[841725, 21423, 1414, 40, 85, "Output"]
}, Open  ]],
Cell[843154, 21466, 2943, 78, 281, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[846134, 21549, 126, 1, 43, "Subsection"],
Cell[846263, 21552, 5668, 130, 604, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[851956, 21686, 498, 13, 33, "Input"],
Cell[CellGroupData[{
Cell[852479, 21703, 1395, 27, 25, "Print"],
Cell[853877, 21732, 651, 14, 25, "Print"],
Cell[854531, 21748, 428, 10, 25, "Print"],
Cell[854962, 21760, 1041, 21, 25, "Print"],
Cell[856006, 21783, 1055, 21, 25, "Print"],
Cell[857064, 21806, 361, 7, 25, "Print"],
Cell[857428, 21815, 562, 14, 25, "Print"],
Cell[857993, 21831, 314, 9, 25, "Print"],
Cell[858310, 21842, 588, 15, 25, "Print"],
Cell[858901, 21859, 413, 10, 25, "Print"],
Cell[859317, 21871, 1070, 21, 25, "Print"],
Cell[860390, 21894, 474, 11, 30, "Print"],
Cell[860867, 21907, 1330, 27, 30, "Print"],
Cell[862200, 21936, 500, 12, 30, "Print"],
Cell[862703, 21950, 694, 14, 30, "Print"]
}, Open  ]],
Cell[863412, 21967, 340, 9, 41, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[863789, 21981, 383, 11, 33, "Input"],
Cell[CellGroupData[{
Cell[864197, 21996, 902, 23, 25, "Print"],
Cell[865102, 22021, 475, 11, 25, "Print"],
Cell[865580, 22034, 444, 11, 25, "Print"],
Cell[866027, 22047, 757, 20, 25, "Print"],
Cell[866787, 22069, 708, 18, 25, "Print"],
Cell[867498, 22089, 335, 7, 25, "Print"],
Cell[867836, 22098, 428, 11, 25, "Print"],
Cell[868267, 22111, 446, 11, 25, "Print"],
Cell[868716, 22124, 343, 7, 25, "Print"],
Cell[869062, 22133, 382, 8, 25, "Print"]
}, Open  ]],
Cell[869459, 22144, 104, 2, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[869600, 22151, 544, 15, 47, "Input"],
Cell[870147, 22168, 104, 1, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[870288, 22174, 513, 14, 33, "Input"],
Cell[870804, 22190, 244, 7, 56, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[871097, 22203, 114, 1, 43, "Subsection"],
Cell[871214, 22206, 342, 7, 33, "Input",
 InitializationCell->True],
Cell[871559, 22215, 335, 8, 33, "Input",
 InitializationCell->True],
Cell[871897, 22225, 6111, 132, 509, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[878033, 22361, 665, 19, 55, "Input"],
Cell[878701, 22382, 147, 3, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[878885, 22390, 802, 24, 58, "Input"],
Cell[879690, 22416, 328, 7, 59, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[880055, 22428, 480, 12, 33, "Input"],
Cell[880538, 22442, 435, 7, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[881010, 22454, 666, 18, 33, "Input"],
Cell[881679, 22474, 433, 10, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[882149, 22489, 974, 28, 76, "Input"],
Cell[883126, 22519, 195, 5, 33, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[883370, 22530, 112, 1, 43, "Subsection"],
Cell[883485, 22533, 1575, 52, 111, "Input"],
Cell[CellGroupData[{
Cell[885085, 22589, 614, 14, 53, "Input"],
Cell[885702, 22605, 3345, 97, 132, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[889084, 22707, 581, 15, 59, "Input"],
Cell[889668, 22724, 1050, 29, 56, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[890755, 22758, 739, 18, 33, "Input"],
Cell[891497, 22778, 773, 22, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[892307, 22805, 669, 19, 80, "Input"],
Cell[892979, 22826, 934, 27, 59, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[893950, 22858, 568, 14, 63, "Input"],
Cell[894521, 22874, 515, 14, 53, "Output"]
}, Open  ]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[895097, 22895, 204, 3, 62, "Section"],
Cell[CellGroupData[{
Cell[895326, 22902, 1338, 36, 115, "Input"],
Cell[896667, 22940, 1014, 32, 72, "Output"],
Cell[897684, 22974, 485, 15, 64, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[898206, 22994, 560, 15, 42, "Input"],
Cell[898769, 23011, 6036, 182, 210, "Output"]
}, Open  ]],
Cell[904820, 23196, 1379, 35, 126, "Input"],
Cell[CellGroupData[{
Cell[906224, 23235, 713, 21, 60, "Input"],
Cell[906940, 23258, 1765, 51, 64, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[908742, 23314, 99, 1, 54, "Subsection"],
Cell[908844, 23317, 2105, 54, 96, "Input"],
Cell[910952, 23373, 3349, 77, 99, "Input"],
Cell[914304, 23452, 1376, 41, 106, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[915717, 23498, 99, 1, 43, "Subsection"],
Cell[CellGroupData[{
Cell[915841, 23503, 1168, 34, 64, "Input"],
Cell[917012, 23539, 389, 12, 41, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[917438, 23556, 255, 7, 33, "Input"],
Cell[917696, 23565, 240, 6, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[917973, 23576, 583, 13, 33, "Input"],
Cell[918559, 23591, 281, 7, 56, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[918877, 23603, 573, 15, 55, "Input"],
Cell[919453, 23620, 354, 7, 38, "Output"]
}, Open  ]],
Cell[919822, 23630, 515, 15, 68, "Input"],
Cell[920340, 23647, 1284, 36, 96, "Input"],
Cell[CellGroupData[{
Cell[921649, 23687, 543, 13, 59, "Input"],
Cell[922195, 23702, 488, 13, 63, "Output"]
}, Open  ]],
Cell[922698, 23718, 528, 14, 33, "Input"],
Cell[CellGroupData[{
Cell[923251, 23736, 661, 18, 56, "Input"],
Cell[923915, 23756, 741, 22, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[924693, 23783, 576, 15, 58, "Input"],
Cell[925272, 23800, 649, 20, 55, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[925958, 23825, 621, 16, 58, "Input"],
Cell[926582, 23843, 1478, 59, 131, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[928097, 23907, 1186, 34, 97, "Input"],
Cell[929286, 23943, 576, 16, 69, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[929899, 23964, 517, 15, 33, "Input"],
Cell[930419, 23981, 724, 12, 72, "Message"],
Cell[931146, 23995, 628, 19, 38, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[931811, 24019, 835, 26, 65, "Input"],
Cell[932649, 24047, 379, 10, 33, "Output"]
}, Open  ]],
Cell[933043, 24060, 1077, 22, 33, "Input"],
Cell[CellGroupData[{
Cell[934145, 24086, 501, 11, 33, "Input"],
Cell[934649, 24099, 646, 18, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[935332, 24122, 625, 16, 42, "Input"],
Cell[935960, 24140, 848, 26, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[936845, 24171, 483, 14, 57, "Input"],
Cell[937331, 24187, 747, 18, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[938115, 24210, 789, 24, 73, "Input"],
Cell[938907, 24236, 144, 2, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[939088, 24243, 957, 27, 91, "Input"],
Cell[940048, 24272, 1460, 47, 64, "Output"]
}, Open  ]],
Cell[941523, 24322, 406, 12, 33, "Input"],
Cell[941932, 24336, 1205, 30, 92, "Input"],
Cell[CellGroupData[{
Cell[943162, 24370, 943, 26, 73, "Input"],
Cell[944108, 24398, 76, 1, 33, "Output"]
}, Open  ]],
Cell[944199, 24402, 1816, 53, 77, "Input"],
Cell[CellGroupData[{
Cell[946040, 24459, 1310, 36, 66, "Input"],
Cell[947353, 24497, 488, 13, 54, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[947890, 24516, 106, 1, 43, "Subsection"],
Cell[CellGroupData[{
Cell[948021, 24521, 762, 21, 109, "Input"],
Cell[948786, 24544, 1202, 41, 68, "Output"],
Cell[949991, 24587, 2374, 68, 141, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[952402, 24660, 580, 15, 63, "Input"],
Cell[952985, 24677, 1214, 37, 68, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[954236, 24719, 383, 13, 67, "Input"],
Cell[954622, 24734, 1637, 48, 108, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[956296, 24787, 1475, 40, 118, "Input"],
Cell[957774, 24829, 1048, 31, 60, "Output"],
Cell[958825, 24862, 1265, 41, 77, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[960127, 24908, 385, 11, 60, "Input"],
Cell[960515, 24921, 3036, 76, 128, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[963588, 25002, 1924, 55, 89, "Input"],
Cell[965515, 25059, 3333, 92, 122, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[968885, 25156, 886, 24, 85, "Input"],
Cell[969774, 25182, 1066, 34, 55, "Output"]
}, Open  ]],
Cell[970855, 25219, 915, 29, 42, "Input"],
Cell[971773, 25250, 1895, 49, 282, "Input"],
Cell[973671, 25301, 357, 9, 36, "Input"],
Cell[974031, 25312, 145, 3, 36, "Input"],
Cell[CellGroupData[{
Cell[974201, 25319, 680, 18, 64, "Input"],
Cell[974884, 25339, 483, 13, 59, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[975404, 25357, 612, 17, 64, "Input"],
Cell[976019, 25376, 957, 31, 63, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[977013, 25412, 475, 10, 60, "Input"],
Cell[977491, 25424, 879, 18, 61, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[978407, 25447, 274, 7, 60, "Input"],
Cell[978684, 25456, 2203, 74, 136, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[980924, 25535, 457, 13, 61, "Input"],
Cell[981384, 25550, 1012, 26, 75, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[982433, 25581, 570, 17, 63, "Input"],
Cell[983006, 25600, 652, 18, 58, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[983695, 25623, 572, 16, 63, "Input"],
Cell[984270, 25641, 776, 18, 55, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[985083, 25664, 376, 8, 58, "Input"],
Cell[985462, 25674, 560, 11, 59, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[986059, 25690, 433, 12, 60, "Input"],
Cell[986495, 25704, 1206, 33, 75, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[987738, 25742, 790, 21, 64, "Input"],
Cell[988531, 25765, 673, 17, 55, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[989241, 25787, 1054, 29, 63, "Input"],
Cell[990298, 25818, 1718, 49, 109, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[992053, 25872, 1156, 34, 78, "Input"],
Cell[993212, 25908, 976, 28, 44, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[994225, 25941, 1147, 34, 63, "Input"],
Cell[995375, 25977, 1104, 37, 55, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[996516, 26019, 822, 27, 80, "Input"],
Cell[997341, 26048, 655, 20, 55, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[998033, 26073, 1840, 44, 140, "Input"],
Cell[999876, 26119, 1745, 48, 55, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1001658, 26172, 438, 12, 60, "Input"],
Cell[1002099, 26186, 2226, 74, 136, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1004362, 26265, 223, 6, 60, "Input"],
Cell[1004588, 26273, 686, 21, 75, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1005311, 26299, 223, 6, 60, "Input"],
Cell[1005537, 26307, 1016, 35, 68, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1006590, 26347, 234, 7, 60, "Input"],
Cell[1006827, 26356, 2085, 62, 128, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1008949, 26423, 347, 9, 62, "Input"],
Cell[1009299, 26434, 2446, 87, 191, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1011782, 26526, 1191, 35, 64, "Input"],
Cell[1012976, 26563, 2400, 74, 164, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1015413, 26642, 565, 15, 61, "Input"],
Cell[1015981, 26659, 1408, 32, 66, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[1017438, 26697, 116, 1, 54, "Subsection"],
Cell[CellGroupData[{
Cell[1017579, 26702, 544, 12, 58, "Input"],
Cell[1018126, 26716, 935, 23, 56, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1019098, 26744, 343, 9, 58, "Input"],
Cell[1019444, 26755, 1529, 53, 54, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1021010, 26813, 605, 19, 80, "Input"],
Cell[1021618, 26834, 428, 8, 26, "Message"],
Cell[1022049, 26844, 697, 20, 67, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1022783, 26869, 809, 24, 61, "Input"],
Cell[1023595, 26895, 809, 15, 57, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1024441, 26915, 849, 23, 59, "Input"],
Cell[1025293, 26940, 709, 14, 40, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1026039, 26959, 865, 22, 60, "Input"],
Cell[1026907, 26983, 917, 22, 53, "Output"]
}, Open  ]],
Cell[1027839, 27008, 1006, 25, 71, "Input"],
Cell[1028848, 27035, 356, 9, 58, "Input"],
Cell[1029207, 27046, 741, 21, 71, "Input"],
Cell[CellGroupData[{
Cell[1029973, 27071, 835, 17, 58, "Input"],
Cell[1030811, 27090, 632, 11, 40, "Output"]
}, Open  ]],
Cell[1031458, 27104, 145, 3, 33, "Input"],
Cell[CellGroupData[{
Cell[1031628, 27111, 2392, 69, 99, "Input"],
Cell[1034023, 27182, 1206, 39, 69, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1035266, 27226, 1093, 32, 85, "Input"],
Cell[1036362, 27260, 512, 9, 26, "Message"],
Cell[1036877, 27271, 1081, 29, 68, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1037995, 27305, 1102, 25, 58, "Input"],
Cell[1039100, 27332, 364, 9, 54, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1039501, 27346, 1653, 41, 71, "Input"],
Cell[1041157, 27389, 721, 18, 83, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1041915, 27412, 984, 28, 66, "Input"],
Cell[1042902, 27442, 638, 14, 57, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1043577, 27461, 830, 20, 57, "Input"],
Cell[1044410, 27483, 661, 15, 55, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1045108, 27503, 1088, 31, 69, "Input"],
Cell[1046199, 27536, 584, 13, 60, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1046820, 27554, 820, 21, 49, "Input"],
Cell[1047643, 27577, 721, 19, 60, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1048401, 27601, 505, 13, 56, "Input"],
Cell[1048909, 27616, 494, 9, 26, "Message"],
Cell[1049406, 27627, 489, 12, 54, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1049932, 27644, 2447, 66, 111, "Input"],
Cell[1052382, 27712, 656, 21, 57, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1053075, 27738, 884, 26, 68, "Input"],
Cell[1053962, 27766, 716, 16, 55, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1054715, 27787, 593, 17, 56, "Input"],
Cell[1055311, 27806, 707, 21, 59, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1056055, 27832, 314, 9, 58, "Input"],
Cell[1056372, 27843, 606, 15, 55, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1057015, 27863, 422, 15, 57, "Input"],
Cell[1057440, 27880, 1181, 39, 78, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1058658, 27924, 1414, 43, 80, "Input"],
Cell[1060075, 27969, 478, 14, 69, "Output"]
}, Open  ]],
Cell[1060568, 27986, 2376, 70, 71, "Input"],
Cell[CellGroupData[{
Cell[1062969, 28060, 1074, 33, 93, "Input"],
Cell[1064046, 28095, 446, 12, 57, "Output"]
}, Open  ]],
Cell[1064507, 28110, 1498, 44, 114, "Input"],
Cell[CellGroupData[{
Cell[1066030, 28158, 778, 24, 60, "Input"],
Cell[1066811, 28184, 424, 11, 56, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1067272, 28200, 667, 16, 56, "Input"],
Cell[1067942, 28218, 1108, 25, 82, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1069087, 28248, 654, 19, 61, "Input"],
Cell[1069744, 28269, 326, 6, 57, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1070107, 28280, 593, 15, 58, "Input"],
Cell[1070703, 28297, 375, 8, 36, "Output"]
}, Open  ]],
Cell[1071093, 28308, 1462, 38, 119, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[1072592, 28351, 124, 1, 43, "Subsection"],
Cell[CellGroupData[{
Cell[1072741, 28356, 821, 20, 63, "Input"],
Cell[1073565, 28378, 183, 3, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1073785, 28386, 2465, 63, 140, "Input"],
Cell[1076253, 28451, 923, 25, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1077213, 28481, 730, 22, 66, "Input"],
Cell[1077946, 28505, 1269, 39, 73, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1079252, 28549, 445, 13, 58, "Input"],
Cell[1079700, 28564, 552, 17, 66, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1080289, 28586, 884, 24, 67, "Input"],
Cell[1081176, 28612, 937, 27, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1082150, 28644, 584, 16, 78, "Input"],
Cell[1082737, 28662, 683, 15, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1083457, 28682, 920, 25, 91, "Input"],
Cell[1084380, 28709, 1716, 56, 95, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1086133, 28770, 1073, 29, 64, "Input"],
Cell[1087209, 28801, 538, 12, 40, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[1087796, 28819, 161, 2, 43, "Subsection"],
Cell[CellGroupData[{
Cell[1087982, 28825, 1076, 25, 47, "Input"],
Cell[1089061, 28852, 1807, 48, 68, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1090905, 28905, 424, 14, 44, "Input"],
Cell[1091332, 28921, 187, 3, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1091556, 28929, 783, 22, 47, "Input"],
Cell[1092342, 28953, 1042, 30, 43, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1093421, 28988, 446, 15, 44, "Input"],
Cell[1093870, 29005, 143, 2, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1094050, 29012, 831, 22, 43, "Input"],
Cell[1094884, 29036, 301, 6, 26, "Message"],
Cell[1095188, 29044, 420, 14, 42, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1095645, 29063, 658, 17, 63, "Input"],
Cell[1096306, 29082, 196, 5, 56, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1096539, 29092, 631, 12, 42, "Input"],
Cell[1097173, 29106, 979, 23, 41, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1098189, 29134, 559, 15, 58, "Input"],
Cell[1098751, 29151, 610, 11, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1099398, 29167, 871, 22, 59, "Input"],
Cell[1100272, 29191, 735, 14, 40, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1101044, 29210, 329, 7, 33, "Input"],
Cell[1101376, 29219, 199, 5, 56, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1101612, 29229, 853, 18, 42, "Input"],
Cell[1102468, 29249, 1333, 41, 62, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1103838, 29295, 700, 18, 55, "Input"],
Cell[1104541, 29315, 278, 5, 26, "Message"],
Cell[1104822, 29322, 278, 5, 26, "Message"],
Cell[1105103, 29329, 402, 13, 54, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1105542, 29347, 2811, 86, 174, "Input"],
Cell[1108356, 29435, 1592, 46, 73, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1109985, 29486, 664, 14, 33, "Input"],
Cell[1110652, 29502, 953, 28, 57, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[1111654, 29536, 115, 1, 43, "Subsection"],
Cell[CellGroupData[{
Cell[1111794, 29541, 837, 25, 60, "Input"],
Cell[1112634, 29568, 245, 7, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1112916, 29580, 1141, 34, 63, "Input"],
Cell[1114060, 29616, 507, 13, 49, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1114604, 29634, 1335, 40, 68, "Input"],
Cell[1115942, 29676, 458, 12, 54, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1116437, 29693, 1160, 35, 63, "Input"],
Cell[1117600, 29730, 479, 13, 49, "Output"]
}, Open  ]],
Cell[1118094, 29746, 2382, 66, 143, "Input"],
Cell[CellGroupData[{
Cell[1120501, 29816, 839, 26, 70, "Input"],
Cell[1121343, 29844, 399, 10, 51, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1121779, 29859, 572, 18, 61, "Input"],
Cell[1122354, 29879, 303, 7, 49, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1122694, 29891, 216, 5, 49, "Input"],
Cell[1122913, 29898, 318, 6, 26, "Message"],
Cell[1123234, 29906, 720, 15, 49, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1123991, 29926, 897, 22, 41, "Input"],
Cell[1124891, 29950, 601, 10, 30, "Message"],
Cell[1125495, 29962, 776, 17, 48, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1126308, 29984, 858, 20, 57, "Input"],
Cell[1127169, 30006, 383, 11, 71, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1127589, 30022, 802, 21, 63, "Input"],
Cell[1128394, 30045, 624, 13, 56, "Output"]
}, Open  ]],
Cell[1129033, 30061, 226, 5, 33, "Input"],
Cell[CellGroupData[{
Cell[1129284, 30070, 2032, 58, 191, "Input"],
Cell[1131319, 30130, 344, 11, 54, "Output"],
Cell[1131666, 30143, 816, 26, 86, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1132519, 30174, 1343, 32, 117, "Input"],
Cell[1133865, 30208, 696, 13, 49, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1134598, 30226, 725, 22, 61, "Input"],
Cell[1135326, 30250, 726, 13, 49, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1136089, 30268, 1224, 34, 81, "Input"],
Cell[1137316, 30304, 3143, 95, 117, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1140496, 30404, 800, 24, 71, "Input"],
Cell[1141299, 30430, 971, 20, 63, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1142307, 30455, 495, 13, 40, "Input"],
Cell[1142805, 30470, 620, 9, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1143462, 30484, 1505, 39, 78, "Input"],
Cell[1144970, 30525, 323, 7, 37, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1145330, 30537, 1019, 31, 88, "Input"],
Cell[1146352, 30570, 596, 18, 62, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1146985, 30593, 675, 19, 70, "Input"],
Cell[1147663, 30614, 541, 12, 62, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1148241, 30631, 1342, 40, 100, "Input"],
Cell[1149586, 30673, 850, 23, 59, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1150473, 30701, 933, 30, 68, "Input"],
Cell[1151409, 30733, 616, 14, 63, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1152062, 30752, 853, 26, 80, "Input"],
Cell[1152918, 30780, 613, 15, 68, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1153568, 30800, 610, 18, 41, "Input"],
Cell[1154181, 30820, 549, 13, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1154767, 30838, 576, 15, 86, "Input"],
Cell[1155346, 30855, 591, 13, 75, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1155974, 30873, 532, 16, 33, "Input"],
Cell[1156509, 30891, 392, 7, 46, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[1156950, 30904, 102, 1, 43, "Subsection"],
Cell[1157055, 30907, 135, 1, 37, "Text"],
Cell[CellGroupData[{
Cell[1157215, 30912, 882, 25, 65, "Input"],
Cell[1158100, 30939, 951, 16, 48, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1159088, 30960, 995, 30, 92, "Input"],
Cell[1160086, 30992, 978, 18, 50, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1161101, 31015, 1600, 45, 104, "Input"],
Cell[1162704, 31062, 404, 11, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1163145, 31078, 817, 23, 92, "Input"],
Cell[1163965, 31103, 859, 14, 28, "Message"],
Cell[1164827, 31119, 737, 20, 64, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1165601, 31144, 918, 22, 89, "Input"],
Cell[1166522, 31168, 1031, 21, 73, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1167590, 31194, 1092, 25, 62, "Input"],
Cell[1168685, 31221, 613, 19, 56, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1169335, 31245, 967, 28, 64, "Input"],
Cell[1170305, 31275, 955, 17, 58, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1171297, 31297, 839, 26, 88, "Input"],
Cell[1172139, 31325, 3184, 95, 112, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[1175372, 31426, 113, 1, 43, "Subsection"],
Cell[1175488, 31429, 341, 8, 37, "Text"],
Cell[CellGroupData[{
Cell[1175854, 31441, 781, 22, 42, "Input"],
Cell[1176638, 31465, 113, 1, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1176788, 31471, 685, 21, 67, "Input"],
Cell[1177476, 31494, 254, 3, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1177767, 31502, 884, 25, 67, "Input"],
Cell[1178654, 31529, 493, 12, 59, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1179184, 31546, 1212, 36, 67, "Input"],
Cell[1180399, 31584, 627, 15, 65, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1181063, 31604, 538, 15, 60, "Input"],
Cell[1181604, 31621, 436, 9, 58, "Output"]
}, Open  ]],
Cell[1182055, 31633, 723, 22, 63, "Input"],
Cell[CellGroupData[{
Cell[1182803, 31659, 728, 23, 80, "Input"],
Cell[1183534, 31684, 557, 14, 75, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1184128, 31703, 1107, 34, 67, "Input"],
Cell[1185238, 31739, 723, 19, 61, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[1186010, 31764, 164, 2, 43, "Subsection"],
Cell[CellGroupData[{
Cell[1186199, 31770, 607, 15, 33, "Input"],
Cell[1186809, 31787, 452, 13, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1187298, 31805, 513, 14, 53, "Input"],
Cell[1187814, 31821, 504, 14, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1188355, 31840, 1087, 25, 61, "Input"],
Cell[1189445, 31867, 647, 17, 41, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1190129, 31889, 751, 16, 42, "Input"],
Cell[1190883, 31907, 1065, 33, 57, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1191985, 31945, 355, 10, 42, "Input"],
Cell[1192343, 31957, 1737, 59, 113, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1194117, 32021, 258, 8, 42, "Input"],
Cell[1194378, 32031, 989, 32, 63, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1195404, 32068, 306, 9, 42, "Input"],
Cell[1195713, 32079, 1349, 41, 100, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1197099, 32125, 1249, 32, 80, "Input"],
Cell[1198351, 32159, 1095, 36, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1199483, 32200, 288, 8, 42, "Input"],
Cell[1199774, 32210, 681, 21, 54, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1200492, 32236, 316, 10, 42, "Input"],
Cell[1200811, 32248, 1415, 46, 139, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1202263, 32299, 558, 14, 42, "Input"],
Cell[1202824, 32315, 1341, 41, 64, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1204202, 32361, 419, 12, 56, "Input"],
Cell[1204624, 32375, 383, 10, 56, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1205044, 32390, 388, 10, 33, "Input"],
Cell[1205435, 32402, 456, 8, 59, "Message"],
Cell[1205894, 32412, 310, 8, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1206241, 32425, 647, 19, 53, "Input"],
Cell[1206891, 32446, 300, 7, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1207228, 32458, 966, 29, 64, "Input"],
Cell[1208197, 32489, 547, 15, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1208781, 32509, 821, 20, 53, "Input"],
Cell[1209605, 32531, 442, 13, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1210084, 32549, 348, 8, 33, "Input"],
Cell[1210435, 32559, 348, 6, 40, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1210820, 32570, 374, 11, 42, "Input"],
Cell[1211197, 32583, 638, 17, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1211872, 32605, 707, 18, 53, "Input"],
Cell[1212582, 32625, 293, 4, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1212912, 32634, 1071, 27, 60, "Input"],
Cell[1213986, 32663, 903, 24, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1214926, 32692, 914, 23, 80, "Input"],
Cell[1215843, 32717, 563, 12, 41, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1216443, 32734, 1339, 28, 91, "Input"],
Cell[1217785, 32764, 198, 5, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1218020, 32774, 576, 17, 61, "Input"],
Cell[1218599, 32793, 412, 7, 48, "Message"],
Cell[1219014, 32802, 104, 1, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1219155, 32808, 520, 12, 33, "Input"],
Cell[1219678, 32822, 322, 9, 55, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1220037, 32836, 596, 15, 53, "Input"],
Cell[1220636, 32853, 871, 22, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1221544, 32880, 580, 14, 33, "Input"],
Cell[1222127, 32896, 431, 11, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1222595, 32912, 282, 6, 33, "Input"],
Cell[1222880, 32920, 280, 6, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1223197, 32931, 413, 12, 42, "Input"],
Cell[1223613, 32945, 554, 17, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1224204, 32967, 449, 12, 33, "Input"],
Cell[1224656, 32981, 440, 9, 55, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1225133, 32995, 399, 10, 33, "Input"],
Cell[1225535, 33007, 464, 10, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1226036, 33022, 995, 19, 42, "Input"],
Cell[1227034, 33043, 1736, 39, 57, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1228807, 33087, 307, 9, 42, "Input"],
Cell[1229117, 33098, 225, 6, 59, "Output"]
}, Open  ]]
}, Closed]]
}, Closed]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
